function jj(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var iG=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ej(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var c1={exports:{}},sh={},u1={exports:{}},Cr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wb;function Aj(){if(Wb)return Cr;Wb=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),i=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function x(K){return K===null||typeof K!="object"?null:(K=p&&K[p]||K["@@iterator"],typeof K=="function"?K:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,y={};function w(K,E,W){this.props=K,this.context=E,this.refs=y,this.updater=W||m}w.prototype.isReactComponent={},w.prototype.setState=function(K,E){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,E,"setState")},w.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function S(){}S.prototype=w.prototype;function k(K,E,W){this.props=K,this.context=E,this.refs=y,this.updater=W||m}var A=k.prototype=new S;A.constructor=k,b(A,w.prototype),A.isPureReactComponent=!0;var z=Array.isArray,H=Object.prototype.hasOwnProperty,V={current:null},B={key:!0,ref:!0,__self:!0,__source:!0};function R(K,E,W){var L,F={},q=null,he=null;if(E!=null)for(L in E.ref!==void 0&&(he=E.ref),E.key!==void 0&&(q=""+E.key),E)H.call(E,L)&&!B.hasOwnProperty(L)&&(F[L]=E[L]);var me=arguments.length-2;if(me===1)F.children=W;else if(1<me){for(var Z=Array(me),Se=0;Se<me;Se++)Z[Se]=arguments[Se+2];F.children=Z}if(K&&K.defaultProps)for(L in me=K.defaultProps,me)F[L]===void 0&&(F[L]=me[L]);return{$$typeof:t,type:K,key:q,ref:he,props:F,_owner:V.current}}function O(K,E){return{$$typeof:t,type:K.type,key:E,ref:K.ref,props:K.props,_owner:K._owner}}function ee(K){return typeof K=="object"&&K!==null&&K.$$typeof===t}function I(K){var E={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(W){return E[W]})}var P=/\/+/g;function ae(K,E){return typeof K=="object"&&K!==null&&K.key!=null?I(""+K.key):E.toString(36)}function G(K,E,W,L,F){var q=typeof K;(q==="undefined"||q==="boolean")&&(K=null);var he=!1;if(K===null)he=!0;else switch(q){case"string":case"number":he=!0;break;case"object":switch(K.$$typeof){case t:case e:he=!0}}if(he)return he=K,F=F(he),K=L===""?"."+ae(he,0):L,z(F)?(W="",K!=null&&(W=K.replace(P,"$&/")+"/"),G(F,E,W,"",function(Se){return Se})):F!=null&&(ee(F)&&(F=O(F,W+(!F.key||he&&he.key===F.key?"":(""+F.key).replace(P,"$&/")+"/")+K)),E.push(F)),1;if(he=0,L=L===""?".":L+":",z(K))for(var me=0;me<K.length;me++){q=K[me];var Z=L+ae(q,me);he+=G(q,E,W,Z,F)}else if(Z=x(K),typeof Z=="function")for(K=Z.call(K),me=0;!(q=K.next()).done;)q=q.value,Z=L+ae(q,me++),he+=G(q,E,W,Z,F);else if(q==="object")throw E=String(K),Error("Objects are not valid as a React child (found: "+(E==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":E)+"). If you meant to render a collection of children, use an array instead.");return he}function M(K,E,W){if(K==null)return K;var L=[],F=0;return G(K,L,"","",function(q){return E.call(W,q,F++)}),L}function te(K){if(K._status===-1){var E=K._result;E=E(),E.then(function(W){(K._status===0||K._status===-1)&&(K._status=1,K._result=W)},function(W){(K._status===0||K._status===-1)&&(K._status=2,K._result=W)}),K._status===-1&&(K._status=0,K._result=E)}if(K._status===1)return K._result.default;throw K._result}var ie={current:null},le={transition:null},X={ReactCurrentDispatcher:ie,ReactCurrentBatchConfig:le,ReactCurrentOwner:V};function fe(){throw Error("act(...) is not supported in production builds of React.")}return Cr.Children={map:M,forEach:function(K,E,W){M(K,function(){E.apply(this,arguments)},W)},count:function(K){var E=0;return M(K,function(){E++}),E},toArray:function(K){return M(K,function(E){return E})||[]},only:function(K){if(!ee(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},Cr.Component=w,Cr.Fragment=r,Cr.Profiler=s,Cr.PureComponent=k,Cr.StrictMode=n,Cr.Suspense=c,Cr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,Cr.act=fe,Cr.cloneElement=function(K,E,W){if(K==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+K+".");var L=b({},K.props),F=K.key,q=K.ref,he=K._owner;if(E!=null){if(E.ref!==void 0&&(q=E.ref,he=V.current),E.key!==void 0&&(F=""+E.key),K.type&&K.type.defaultProps)var me=K.type.defaultProps;for(Z in E)H.call(E,Z)&&!B.hasOwnProperty(Z)&&(L[Z]=E[Z]===void 0&&me!==void 0?me[Z]:E[Z])}var Z=arguments.length-2;if(Z===1)L.children=W;else if(1<Z){me=Array(Z);for(var Se=0;Se<Z;Se++)me[Se]=arguments[Se+2];L.children=me}return{$$typeof:t,type:K.type,key:F,ref:q,props:L,_owner:he}},Cr.createContext=function(K){return K={$$typeof:i,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},K.Provider={$$typeof:a,_context:K},K.Consumer=K},Cr.createElement=R,Cr.createFactory=function(K){var E=R.bind(null,K);return E.type=K,E},Cr.createRef=function(){return{current:null}},Cr.forwardRef=function(K){return{$$typeof:l,render:K}},Cr.isValidElement=ee,Cr.lazy=function(K){return{$$typeof:h,_payload:{_status:-1,_result:K},_init:te}},Cr.memo=function(K,E){return{$$typeof:d,type:K,compare:E===void 0?null:E}},Cr.startTransition=function(K){var E=le.transition;le.transition={};try{K()}finally{le.transition=E}},Cr.unstable_act=fe,Cr.useCallback=function(K,E){return ie.current.useCallback(K,E)},Cr.useContext=function(K){return ie.current.useContext(K)},Cr.useDebugValue=function(){},Cr.useDeferredValue=function(K){return ie.current.useDeferredValue(K)},Cr.useEffect=function(K,E){return ie.current.useEffect(K,E)},Cr.useId=function(){return ie.current.useId()},Cr.useImperativeHandle=function(K,E,W){return ie.current.useImperativeHandle(K,E,W)},Cr.useInsertionEffect=function(K,E){return ie.current.useInsertionEffect(K,E)},Cr.useLayoutEffect=function(K,E){return ie.current.useLayoutEffect(K,E)},Cr.useMemo=function(K,E){return ie.current.useMemo(K,E)},Cr.useReducer=function(K,E,W){return ie.current.useReducer(K,E,W)},Cr.useRef=function(K){return ie.current.useRef(K)},Cr.useState=function(K){return ie.current.useState(K)},Cr.useSyncExternalStore=function(K,E,W){return ie.current.useSyncExternalStore(K,E,W)},Cr.useTransition=function(){return ie.current.useTransition()},Cr.version="18.3.1",Cr}var Vb;function pv(){return Vb||(Vb=1,u1.exports=Aj()),u1.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qb;function Cj(){if(qb)return sh;qb=1;var t=pv(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function i(l,c,d){var h,p={},x=null,m=null;d!==void 0&&(x=""+d),c.key!==void 0&&(x=""+c.key),c.ref!==void 0&&(m=c.ref);for(h in c)n.call(c,h)&&!a.hasOwnProperty(h)&&(p[h]=c[h]);if(l&&l.defaultProps)for(h in c=l.defaultProps,c)p[h]===void 0&&(p[h]=c[h]);return{$$typeof:e,type:l,key:x,ref:m,props:p,_owner:s.current}}return sh.Fragment=r,sh.jsx=i,sh.jsxs=i,sh}var Gb;function Tj(){return Gb||(Gb=1,c1.exports=Cj()),c1.exports}var o=Tj(),Q=pv();const Fj=Ej(Q),Pj=jj({__proto__:null,default:Fj},[Q]);var xm={},d1={exports:{}},ci={},f1={exports:{}},h1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xb;function Lj(){return Xb||(Xb=1,(function(t){function e(le,X){var fe=le.length;le.push(X);e:for(;0<fe;){var K=fe-1>>>1,E=le[K];if(0<s(E,X))le[K]=X,le[fe]=E,fe=K;else break e}}function r(le){return le.length===0?null:le[0]}function n(le){if(le.length===0)return null;var X=le[0],fe=le.pop();if(fe!==X){le[0]=fe;e:for(var K=0,E=le.length,W=E>>>1;K<W;){var L=2*(K+1)-1,F=le[L],q=L+1,he=le[q];if(0>s(F,fe))q<E&&0>s(he,F)?(le[K]=he,le[q]=fe,K=q):(le[K]=F,le[L]=fe,K=L);else if(q<E&&0>s(he,fe))le[K]=he,le[q]=fe,K=q;else break e}}return X}function s(le,X){var fe=le.sortIndex-X.sortIndex;return fe!==0?fe:le.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var c=[],d=[],h=1,p=null,x=3,m=!1,b=!1,y=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(le){for(var X=r(d);X!==null;){if(X.callback===null)n(d);else if(X.startTime<=le)n(d),X.sortIndex=X.expirationTime,e(c,X);else break;X=r(d)}}function z(le){if(y=!1,A(le),!b)if(r(c)!==null)b=!0,te(H);else{var X=r(d);X!==null&&ie(z,X.startTime-le)}}function H(le,X){b=!1,y&&(y=!1,S(R),R=-1),m=!0;var fe=x;try{for(A(X),p=r(c);p!==null&&(!(p.expirationTime>X)||le&&!I());){var K=p.callback;if(typeof K=="function"){p.callback=null,x=p.priorityLevel;var E=K(p.expirationTime<=X);X=t.unstable_now(),typeof E=="function"?p.callback=E:p===r(c)&&n(c),A(X)}else n(c);p=r(c)}if(p!==null)var W=!0;else{var L=r(d);L!==null&&ie(z,L.startTime-X),W=!1}return W}finally{p=null,x=fe,m=!1}}var V=!1,B=null,R=-1,O=5,ee=-1;function I(){return!(t.unstable_now()-ee<O)}function P(){if(B!==null){var le=t.unstable_now();ee=le;var X=!0;try{X=B(!0,le)}finally{X?ae():(V=!1,B=null)}}else V=!1}var ae;if(typeof k=="function")ae=function(){k(P)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,M=G.port2;G.port1.onmessage=P,ae=function(){M.postMessage(null)}}else ae=function(){w(P,0)};function te(le){B=le,V||(V=!0,ae())}function ie(le,X){R=w(function(){le(t.unstable_now())},X)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(le){le.callback=null},t.unstable_continueExecution=function(){b||m||(b=!0,te(H))},t.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<le?Math.floor(1e3/le):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(le){switch(x){case 1:case 2:case 3:var X=3;break;default:X=x}var fe=x;x=X;try{return le()}finally{x=fe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(le,X){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var fe=x;x=le;try{return X()}finally{x=fe}},t.unstable_scheduleCallback=function(le,X,fe){var K=t.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?K+fe:K):fe=K,le){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=fe+E,le={id:h++,callback:X,priorityLevel:le,startTime:fe,expirationTime:E,sortIndex:-1},fe>K?(le.sortIndex=fe,e(d,le),r(c)===null&&le===r(d)&&(y?(S(R),R=-1):y=!0,ie(z,fe-K))):(le.sortIndex=E,e(c,le),b||m||(b=!0,te(H))),le},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(le){var X=x;return function(){var fe=x;x=X;try{return le.apply(this,arguments)}finally{x=fe}}}})(h1)),h1}var Yb;function Dj(){return Yb||(Yb=1,f1.exports=Lj()),f1.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kb;function Rj(){if(Kb)return ci;Kb=1;var t=pv(),e=Dj();function r(u){for(var f="https://reactjs.org/docs/error-decoder.html?invariant="+u,g=1;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g]);return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function a(u,f){i(u,f),i(u+"Capture",f)}function i(u,f){for(s[u]=f,u=0;u<f.length;u++)n.add(f[u])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function x(u){return c.call(p,u)?!0:c.call(h,u)?!1:d.test(u)?p[u]=!0:(h[u]=!0,!1)}function m(u,f,g,_){if(g!==null&&g.type===0)return!1;switch(typeof f){case"function":case"symbol":return!0;case"boolean":return _?!1:g!==null?!g.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function b(u,f,g,_){if(f===null||typeof f>"u"||m(u,f,g,_))return!0;if(_)return!1;if(g!==null)switch(g.type){case 3:return!f;case 4:return f===!1;case 5:return isNaN(f);case 6:return isNaN(f)||1>f}return!1}function y(u,f,g,_,C,D,ne){this.acceptsBooleans=f===2||f===3||f===4,this.attributeName=_,this.attributeNamespace=C,this.mustUseProperty=g,this.propertyName=u,this.type=f,this.sanitizeURL=D,this.removeEmptyString=ne}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){w[u]=new y(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var f=u[0];w[f]=new y(f,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){w[u]=new y(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){w[u]=new y(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){w[u]=new y(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){w[u]=new y(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){w[u]=new y(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){w[u]=new y(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){w[u]=new y(u,5,!1,u.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function k(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var f=u.replace(S,k);w[f]=new y(f,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var f=u.replace(S,k);w[f]=new y(f,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var f=u.replace(S,k);w[f]=new y(f,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){w[u]=new y(u,1,!1,u.toLowerCase(),null,!1,!1)}),w.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){w[u]=new y(u,1,!1,u.toLowerCase(),null,!0,!0)});function A(u,f,g,_){var C=w.hasOwnProperty(f)?w[f]:null;(C!==null?C.type!==0:_||!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(b(f,g,C,_)&&(g=null),_||C===null?x(f)&&(g===null?u.removeAttribute(f):u.setAttribute(f,""+g)):C.mustUseProperty?u[C.propertyName]=g===null?C.type===3?!1:"":g:(f=C.attributeName,_=C.attributeNamespace,g===null?u.removeAttribute(f):(C=C.type,g=C===3||C===4&&g===!0?"":""+g,_?u.setAttributeNS(_,f,g):u.setAttribute(f,g))))}var z=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,H=Symbol.for("react.element"),V=Symbol.for("react.portal"),B=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),ee=Symbol.for("react.provider"),I=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),te=Symbol.for("react.lazy"),ie=Symbol.for("react.offscreen"),le=Symbol.iterator;function X(u){return u===null||typeof u!="object"?null:(u=le&&u[le]||u["@@iterator"],typeof u=="function"?u:null)}var fe=Object.assign,K;function E(u){if(K===void 0)try{throw Error()}catch(g){var f=g.stack.trim().match(/\n( *(at )?)/);K=f&&f[1]||""}return`
`+K+u}var W=!1;function L(u,f){if(!u||W)return"";W=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(f)if(f=function(){throw Error()},Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(Ge){var _=Ge}Reflect.construct(u,[],f)}else{try{f.call()}catch(Ge){_=Ge}u.call(f.prototype)}else{try{throw Error()}catch(Ge){_=Ge}u()}}catch(Ge){if(Ge&&_&&typeof Ge.stack=="string"){for(var C=Ge.stack.split(`
`),D=_.stack.split(`
`),ne=C.length-1,Ne=D.length-1;1<=ne&&0<=Ne&&C[ne]!==D[Ne];)Ne--;for(;1<=ne&&0<=Ne;ne--,Ne--)if(C[ne]!==D[Ne]){if(ne!==1||Ne!==1)do if(ne--,Ne--,0>Ne||C[ne]!==D[Ne]){var Ae=`
`+C[ne].replace(" at new "," at ");return u.displayName&&Ae.includes("<anonymous>")&&(Ae=Ae.replace("<anonymous>",u.displayName)),Ae}while(1<=ne&&0<=Ne);break}}}finally{W=!1,Error.prepareStackTrace=g}return(u=u?u.displayName||u.name:"")?E(u):""}function F(u){switch(u.tag){case 5:return E(u.type);case 16:return E("Lazy");case 13:return E("Suspense");case 19:return E("SuspenseList");case 0:case 2:case 15:return u=L(u.type,!1),u;case 11:return u=L(u.type.render,!1),u;case 1:return u=L(u.type,!0),u;default:return""}}function q(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case B:return"Fragment";case V:return"Portal";case O:return"Profiler";case R:return"StrictMode";case ae:return"Suspense";case G:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case I:return(u.displayName||"Context")+".Consumer";case ee:return(u._context.displayName||"Context")+".Provider";case P:var f=u.render;return u=u.displayName,u||(u=f.displayName||f.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case M:return f=u.displayName||null,f!==null?f:q(u.type)||"Memo";case te:f=u._payload,u=u._init;try{return q(u(f))}catch{}}return null}function he(u){var f=u.type;switch(u.tag){case 24:return"Cache";case 9:return(f.displayName||"Context")+".Consumer";case 10:return(f._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=f.render,u=u.displayName||u.name||"",f.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return f;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q(f);case 8:return f===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f}return null}function me(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function Z(u){var f=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function Se(u){var f=Z(u)?"checked":"value",g=Object.getOwnPropertyDescriptor(u.constructor.prototype,f),_=""+u[f];if(!u.hasOwnProperty(f)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var C=g.get,D=g.set;return Object.defineProperty(u,f,{configurable:!0,get:function(){return C.call(this)},set:function(ne){_=""+ne,D.call(this,ne)}}),Object.defineProperty(u,f,{enumerable:g.enumerable}),{getValue:function(){return _},setValue:function(ne){_=""+ne},stopTracking:function(){u._valueTracker=null,delete u[f]}}}}function We(u){u._valueTracker||(u._valueTracker=Se(u))}function ue(u){if(!u)return!1;var f=u._valueTracker;if(!f)return!0;var g=f.getValue(),_="";return u&&(_=Z(u)?u.checked?"true":"false":u.value),u=_,u!==g?(f.setValue(u),!0):!1}function nt(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function rt(u,f){var g=f.checked;return fe({},f,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:g??u._wrapperState.initialChecked})}function De(u,f){var g=f.defaultValue==null?"":f.defaultValue,_=f.checked!=null?f.checked:f.defaultChecked;g=me(f.value!=null?f.value:g),u._wrapperState={initialChecked:_,initialValue:g,controlled:f.type==="checkbox"||f.type==="radio"?f.checked!=null:f.value!=null}}function ve(u,f){f=f.checked,f!=null&&A(u,"checked",f,!1)}function Xe(u,f){ve(u,f);var g=me(f.value),_=f.type;if(g!=null)_==="number"?(g===0&&u.value===""||u.value!=g)&&(u.value=""+g):u.value!==""+g&&(u.value=""+g);else if(_==="submit"||_==="reset"){u.removeAttribute("value");return}f.hasOwnProperty("value")?Ke(u,f.type,g):f.hasOwnProperty("defaultValue")&&Ke(u,f.type,me(f.defaultValue)),f.checked==null&&f.defaultChecked!=null&&(u.defaultChecked=!!f.defaultChecked)}function Re(u,f,g){if(f.hasOwnProperty("value")||f.hasOwnProperty("defaultValue")){var _=f.type;if(!(_!=="submit"&&_!=="reset"||f.value!==void 0&&f.value!==null))return;f=""+u._wrapperState.initialValue,g||f===u.value||(u.value=f),u.defaultValue=f}g=u.name,g!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,g!==""&&(u.name=g)}function Ke(u,f,g){(f!=="number"||nt(u.ownerDocument)!==u)&&(g==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+g&&(u.defaultValue=""+g))}var it=Array.isArray;function pt(u,f,g,_){if(u=u.options,f){f={};for(var C=0;C<g.length;C++)f["$"+g[C]]=!0;for(g=0;g<u.length;g++)C=f.hasOwnProperty("$"+u[g].value),u[g].selected!==C&&(u[g].selected=C),C&&_&&(u[g].defaultSelected=!0)}else{for(g=""+me(g),f=null,C=0;C<u.length;C++){if(u[C].value===g){u[C].selected=!0,_&&(u[C].defaultSelected=!0);return}f!==null||u[C].disabled||(f=u[C])}f!==null&&(f.selected=!0)}}function vt(u,f){if(f.dangerouslySetInnerHTML!=null)throw Error(r(91));return fe({},f,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function Pt(u,f){var g=f.value;if(g==null){if(g=f.children,f=f.defaultValue,g!=null){if(f!=null)throw Error(r(92));if(it(g)){if(1<g.length)throw Error(r(93));g=g[0]}f=g}f==null&&(f=""),g=f}u._wrapperState={initialValue:me(g)}}function Dt(u,f){var g=me(f.value),_=me(f.defaultValue);g!=null&&(g=""+g,g!==u.value&&(u.value=g),f.defaultValue==null&&u.defaultValue!==g&&(u.defaultValue=g)),_!=null&&(u.defaultValue=""+_)}function Ot(u){var f=u.textContent;f===u._wrapperState.initialValue&&f!==""&&f!==null&&(u.value=f)}function Yt(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lr(u,f){return u==null||u==="http://www.w3.org/1999/xhtml"?Yt(f):u==="http://www.w3.org/2000/svg"&&f==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var Qt,It=(function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(f,g,_,C){MSApp.execUnsafeLocalFunction(function(){return u(f,g,_,C)})}:u})(function(u,f){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=f;else{for(Qt=Qt||document.createElement("div"),Qt.innerHTML="<svg>"+f.valueOf().toString()+"</svg>",f=Qt.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;f.firstChild;)u.appendChild(f.firstChild)}});function bt(u,f){if(f){var g=u.firstChild;if(g&&g===u.lastChild&&g.nodeType===3){g.nodeValue=f;return}}u.textContent=f}var lt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tr=["Webkit","ms","Moz","O"];Object.keys(lt).forEach(function(u){tr.forEach(function(f){f=f+u.charAt(0).toUpperCase()+u.substring(1),lt[f]=lt[u]})});function ke(u,f,g){return f==null||typeof f=="boolean"||f===""?"":g||typeof f!="number"||f===0||lt.hasOwnProperty(u)&&lt[u]?(""+f).trim():f+"px"}function $t(u,f){u=u.style;for(var g in f)if(f.hasOwnProperty(g)){var _=g.indexOf("--")===0,C=ke(g,f[g],_);g==="float"&&(g="cssFloat"),_?u.setProperty(g,C):u[g]=C}}var $e=fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wt(u,f){if(f){if($e[u]&&(f.children!=null||f.dangerouslySetInnerHTML!=null))throw Error(r(137,u));if(f.dangerouslySetInnerHTML!=null){if(f.children!=null)throw Error(r(60));if(typeof f.dangerouslySetInnerHTML!="object"||!("__html"in f.dangerouslySetInnerHTML))throw Error(r(61))}if(f.style!=null&&typeof f.style!="object")throw Error(r(62))}}function Wt(u,f){if(u.indexOf("-")===-1)return typeof f.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jt=null;function hr(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Vt=null,Sr=null,Ur=null;function rr(u){if(u=pu(u)){if(typeof Vt!="function")throw Error(r(280));var f=u.stateNode;f&&(f=Ed(f),Vt(u.stateNode,u.type,f))}}function Ut(u){Sr?Ur?Ur.push(u):Ur=[u]:Sr=u}function cr(){if(Sr){var u=Sr,f=Ur;if(Ur=Sr=null,rr(u),f)for(u=0;u<f.length;u++)rr(f[u])}}function Te(u,f){return u(f)}function yt(){}var pr=!1;function hn(u,f,g){if(pr)return u(f,g);pr=!0;try{return Te(u,f,g)}finally{pr=!1,(Sr!==null||Ur!==null)&&(yt(),cr())}}function Mt(u,f){var g=u.stateNode;if(g===null)return null;var _=Ed(g);if(_===null)return null;g=_[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(u=u.type,_=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!_;break e;default:u=!1}if(u)return null;if(g&&typeof g!="function")throw Error(r(231,f,typeof g));return g}var Un=!1;if(l)try{var yn={};Object.defineProperty(yn,"passive",{get:function(){Un=!0}}),window.addEventListener("test",yn,yn),window.removeEventListener("test",yn,yn)}catch{Un=!1}function zn(u,f,g,_,C,D,ne,Ne,Ae){var Ge=Array.prototype.slice.call(arguments,3);try{f.apply(g,Ge)}catch(ht){this.onError(ht)}}var pn=!1,mn=null,se=!1,ye=null,pe={onError:function(u){pn=!0,mn=u}};function xe(u,f,g,_,C,D,ne,Ne,Ae){pn=!1,mn=null,zn.apply(pe,arguments)}function be(u,f,g,_,C,D,ne,Ne,Ae){if(xe.apply(this,arguments),pn){if(pn){var Ge=mn;pn=!1,mn=null}else throw Error(r(198));se||(se=!0,ye=Ge)}}function we(u){var f=u,g=u;if(u.alternate)for(;f.return;)f=f.return;else{u=f;do f=u,(f.flags&4098)!==0&&(g=f.return),u=f.return;while(u)}return f.tag===3?g:null}function Ue(u){if(u.tag===13){var f=u.memoizedState;if(f===null&&(u=u.alternate,u!==null&&(f=u.memoizedState)),f!==null)return f.dehydrated}return null}function Je(u){if(we(u)!==u)throw Error(r(188))}function Be(u){var f=u.alternate;if(!f){if(f=we(u),f===null)throw Error(r(188));return f!==u?null:u}for(var g=u,_=f;;){var C=g.return;if(C===null)break;var D=C.alternate;if(D===null){if(_=C.return,_!==null){g=_;continue}break}if(C.child===D.child){for(D=C.child;D;){if(D===g)return Je(C),u;if(D===_)return Je(C),f;D=D.sibling}throw Error(r(188))}if(g.return!==_.return)g=C,_=D;else{for(var ne=!1,Ne=C.child;Ne;){if(Ne===g){ne=!0,g=C,_=D;break}if(Ne===_){ne=!0,_=C,g=D;break}Ne=Ne.sibling}if(!ne){for(Ne=D.child;Ne;){if(Ne===g){ne=!0,g=D,_=C;break}if(Ne===_){ne=!0,_=D,g=C;break}Ne=Ne.sibling}if(!ne)throw Error(r(189))}}if(g.alternate!==_)throw Error(r(190))}if(g.tag!==3)throw Error(r(188));return g.stateNode.current===g?u:f}function He(u){return u=Be(u),u!==null?qe(u):null}function qe(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var f=qe(u);if(f!==null)return f;u=u.sibling}return null}var ut=e.unstable_scheduleCallback,Nt=e.unstable_cancelCallback,Ct=e.unstable_shouldYield,gt=e.unstable_requestPaint,mt=e.unstable_now,ur=e.unstable_getCurrentPriorityLevel,Ir=e.unstable_ImmediatePriority,Qr=e.unstable_UserBlockingPriority,_n=e.unstable_NormalPriority,vi=e.unstable_LowPriority,Mi=e.unstable_IdlePriority,Oa=null,Xn=null;function Bi(u){if(Xn&&typeof Xn.onCommitFiberRoot=="function")try{Xn.onCommitFiberRoot(Oa,u,void 0,(u.current.flags&128)===128)}catch{}}var Nn=Math.clz32?Math.clz32:Nf,Hn=Math.log,_f=Math.LN2;function Nf(u){return u>>>=0,u===0?32:31-(Hn(u)/_f|0)|0}var Ul=64,tl=4194304;function zl(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function oa(u,f){var g=u.pendingLanes;if(g===0)return 0;var _=0,C=u.suspendedLanes,D=u.pingedLanes,ne=g&268435455;if(ne!==0){var Ne=ne&~C;Ne!==0?_=zl(Ne):(D&=ne,D!==0&&(_=zl(D)))}else ne=g&~C,ne!==0?_=zl(ne):D!==0&&(_=zl(D));if(_===0)return 0;if(f!==0&&f!==_&&(f&C)===0&&(C=_&-_,D=f&-f,C>=D||C===16&&(D&4194240)!==0))return f;if((_&4)!==0&&(_|=g&16),f=u.entangledLanes,f!==0)for(u=u.entanglements,f&=_;0<f;)g=31-Nn(f),C=1<<g,_|=u[g],f&=~C;return _}function zc(u,f){switch(u){case 1:case 2:case 4:return f+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function la(u,f){for(var g=u.suspendedLanes,_=u.pingedLanes,C=u.expirationTimes,D=u.pendingLanes;0<D;){var ne=31-Nn(D),Ne=1<<ne,Ae=C[ne];Ae===-1?((Ne&g)===0||(Ne&_)!==0)&&(C[ne]=zc(Ne,f)):Ae<=f&&(u.expiredLanes|=Ne),D&=~Ne}}function Hl(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function ld(){var u=Ul;return Ul<<=1,(Ul&4194240)===0&&(Ul=64),u}function cd(u){for(var f=[],g=0;31>g;g++)f.push(u);return f}function rl(u,f,g){u.pendingLanes|=f,f!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,f=31-Nn(f),u[f]=g}function M0(u,f){var g=u.pendingLanes&~f;u.pendingLanes=f,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=f,u.mutableReadLanes&=f,u.entangledLanes&=f,f=u.entanglements;var _=u.eventTimes;for(u=u.expirationTimes;0<g;){var C=31-Nn(g),D=1<<C;f[C]=0,_[C]=-1,u[C]=-1,g&=~D}}function Hc(u,f){var g=u.entangledLanes|=f;for(u=u.entanglements;g;){var _=31-Nn(g),C=1<<_;C&f|u[_]&f&&(u[_]|=f),g&=~C}}var zr=0;function $c(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var Sf,ud,kf,Ui,$l,nl=!1,Wl=[],Sn=null,zi=null,yi=null,ir=new Map,Vl=new Map,Hi=[],$i="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function dd(u,f){switch(u){case"focusin":case"focusout":Sn=null;break;case"dragenter":case"dragleave":zi=null;break;case"mouseover":case"mouseout":yi=null;break;case"pointerover":case"pointerout":ir.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vl.delete(f.pointerId)}}function sl(u,f,g,_,C,D){return u===null||u.nativeEvent!==D?(u={blockedOn:f,domEventName:g,eventSystemFlags:_,nativeEvent:D,targetContainers:[C]},f!==null&&(f=pu(f),f!==null&&ud(f)),u):(u.eventSystemFlags|=_,f=u.targetContainers,C!==null&&f.indexOf(C)===-1&&f.push(C),u)}function Wc(u,f,g,_,C){switch(f){case"focusin":return Sn=sl(Sn,u,f,g,_,C),!0;case"dragenter":return zi=sl(zi,u,f,g,_,C),!0;case"mouseover":return yi=sl(yi,u,f,g,_,C),!0;case"pointerover":var D=C.pointerId;return ir.set(D,sl(ir.get(D)||null,u,f,g,_,C)),!0;case"gotpointercapture":return D=C.pointerId,Vl.set(D,sl(Vl.get(D)||null,u,f,g,_,C)),!0}return!1}function Vc(u){var f=ml(u.target);if(f!==null){var g=we(f);if(g!==null){if(f=g.tag,f===13){if(f=Ue(g),f!==null){u.blockedOn=f,$l(u.priority,function(){kf(g)});return}}else if(f===3&&g.stateNode.current.memoizedState.isDehydrated){u.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}u.blockedOn=null}function qc(u){if(u.blockedOn!==null)return!1;for(var f=u.targetContainers;0<f.length;){var g=Xc(u.domEventName,u.eventSystemFlags,f[0],u.nativeEvent);if(g===null){g=u.nativeEvent;var _=new g.constructor(g.type,g);jt=_,g.target.dispatchEvent(_),jt=null}else return f=pu(g),f!==null&&ud(f),u.blockedOn=g,!1;f.shift()}return!0}function jf(u,f,g){qc(u)&&g.delete(f)}function B0(){nl=!1,Sn!==null&&qc(Sn)&&(Sn=null),zi!==null&&qc(zi)&&(zi=null),yi!==null&&qc(yi)&&(yi=null),ir.forEach(jf),Vl.forEach(jf)}function vo(u,f){u.blockedOn===f&&(u.blockedOn=null,nl||(nl=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,B0)))}function bi(u){function f(C){return vo(C,u)}if(0<Wl.length){vo(Wl[0],u);for(var g=1;g<Wl.length;g++){var _=Wl[g];_.blockedOn===u&&(_.blockedOn=null)}}for(Sn!==null&&vo(Sn,u),zi!==null&&vo(zi,u),yi!==null&&vo(yi,u),ir.forEach(f),Vl.forEach(f),g=0;g<Hi.length;g++)_=Hi[g],_.blockedOn===u&&(_.blockedOn=null);for(;0<Hi.length&&(g=Hi[0],g.blockedOn===null);)Vc(g),g.blockedOn===null&&Hi.shift()}var Ma=z.ReactCurrentBatchConfig,Gc=!0;function ql(u,f,g,_){var C=zr,D=Ma.transition;Ma.transition=null;try{zr=1,al(u,f,g,_)}finally{zr=C,Ma.transition=D}}function fd(u,f,g,_){var C=zr,D=Ma.transition;Ma.transition=null;try{zr=4,al(u,f,g,_)}finally{zr=C,Ma.transition=D}}function al(u,f,g,_){if(Gc){var C=Xc(u,f,g,_);if(C===null)Sd(u,f,_,Gl,g),dd(u,_);else if(Wc(C,u,f,g,_))_.stopPropagation();else if(dd(u,_),f&4&&-1<$i.indexOf(u)){for(;C!==null;){var D=pu(C);if(D!==null&&Sf(D),D=Xc(u,f,g,_),D===null&&Sd(u,f,_,Gl,g),D===C)break;C=D}C!==null&&_.stopPropagation()}else Sd(u,f,_,null,g)}}var Gl=null;function Xc(u,f,g,_){if(Gl=null,u=hr(_),u=ml(u),u!==null)if(f=we(u),f===null)u=null;else if(g=f.tag,g===13){if(u=Ue(f),u!==null)return u;u=null}else if(g===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;u=null}else f!==u&&(u=null);return Gl=u,null}function hd(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ur()){case Ir:return 1;case Qr:return 4;case _n:case vi:return 16;case Mi:return 536870912;default:return 16}default:return 16}}var wi=null,Ja=null,Qa=null;function Ef(){if(Qa)return Qa;var u,f=Ja,g=f.length,_,C="value"in wi?wi.value:wi.textContent,D=C.length;for(u=0;u<g&&f[u]===C[u];u++);var ne=g-u;for(_=1;_<=ne&&f[g-_]===C[D-_];_++);return Qa=C.slice(u,1<_?1-_:void 0)}function _i(u){var f=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&f===13&&(u=13)):u=f,u===10&&(u=13),32<=u||u===13?u:0}function ca(){return!0}function Yc(){return!1}function is(u){function f(g,_,C,D,ne){this._reactName=g,this._targetInst=C,this.type=_,this.nativeEvent=D,this.target=ne,this.currentTarget=null;for(var Ne in u)u.hasOwnProperty(Ne)&&(g=u[Ne],this[Ne]=g?g(D):D[Ne]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?ca:Yc,this.isPropagationStopped=Yc,this}return fe(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=ca)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=ca)},persist:function(){},isPersistent:ca}),f}var il={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ol=is(il),Xl=fe({},il,{view:0,detail:0}),pd=is(Xl),Yl,Kc,Wi,ll=fe({},Xl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tt,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==Wi&&(Wi&&u.type==="mousemove"?(Yl=u.screenX-Wi.screenX,Kc=u.screenY-Wi.screenY):Kc=Yl=0,Wi=u),Yl)},movementY:function(u){return"movementY"in u?u.movementY:Kc}}),Jc=is(ll),Af=fe({},ll,{dataTransfer:0}),U0=is(Af),Qc=fe({},Xl,{relatedTarget:0}),yo=is(Qc),md=fe({},il,{animationName:0,elapsedTime:0,pseudoElement:0}),cl=is(md),xd=fe({},il,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),j=is(xd),J=fe({},il,{data:0}),_e=is(J),je={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ie={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ze={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dt(u){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(u):(u=Ze[u])?!!f[u]:!1}function Tt(){return dt}var Jt=fe({},Xl,{key:function(u){if(u.key){var f=je[u.key]||u.key;if(f!=="Unidentified")return f}return u.type==="keypress"?(u=_i(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?Ie[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tt,charCode:function(u){return u.type==="keypress"?_i(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?_i(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),yr=is(Jt),vr=fe({},ll,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fr=is(vr),kn=fe({},Xl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tt}),Rn=is(kn),Yn=fe({},il,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ps=is(Yn),ys=fe({},ll,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),Ni=is(ys),Ba=[9,13,27,32],Za=l&&"CompositionEvent"in window,ul=null;l&&"documentMode"in document&&(ul=document.documentMode);var gd=l&&"TextEvent"in window&&!ul,Zc=l&&(!Za||ul&&8<ul&&11>=ul),Kl=" ",eu=!1;function tu(u,f){switch(u){case"keyup":return Ba.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jl(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var In=!1;function ru(u,f){switch(u){case"compositionend":return Jl(f);case"keypress":return f.which!==32?null:(eu=!0,Kl);case"textInput":return u=f.data,u===Kl&&eu?null:u;default:return null}}function nu(u,f){if(In)return u==="compositionend"||!Za&&tu(u,f)?(u=Ef(),Qa=Ja=wi=null,In=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return Zc&&f.locale!=="ko"?null:f.data;default:return null}}var su={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function au(u){var f=u&&u.nodeName&&u.nodeName.toLowerCase();return f==="input"?!!su[u.type]:f==="textarea"}function Xs(u,f,g,_){Ut(_),f=Pf(f,"onChange"),0<f.length&&(g=new ol("onChange","change",null,g,_),u.push({event:g,listeners:f}))}var Ql=null,bo=null;function Cf(u){_d(u,0)}function Ys(u){var f=oc(u);if(ue(f))return u}function iu(u,f){if(u==="change")return f}var vd=!1;if(l){var ou;if(l){var Vi="oninput"in document;if(!Vi){var dl=document.createElement("div");dl.setAttribute("oninput","return;"),Vi=typeof dl.oninput=="function"}ou=Vi}else ou=!1;vd=ou&&(!document.documentMode||9<document.documentMode)}function Ks(){Ql&&(Ql.detachEvent("onpropertychange",Ls),bo=Ql=null)}function Ls(u){if(u.propertyName==="value"&&Ys(bo)){var f=[];Xs(f,bo,u,hr(u)),hn(Cf,f)}}function fl(u,f,g){u==="focusin"?(Ks(),Ql=f,bo=g,Ql.attachEvent("onpropertychange",Ls)):u==="focusout"&&Ks()}function wo(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return Ys(bo)}function _o(u,f){if(u==="click")return Ys(f)}function lu(u,f){if(u==="input"||u==="change")return Ys(f)}function No(u,f){return u===f&&(u!==0||1/u===1/f)||u!==u&&f!==f}var Hr=typeof Object.is=="function"?Object.is:No;function So(u,f){if(Hr(u,f))return!0;if(typeof u!="object"||u===null||typeof f!="object"||f===null)return!1;var g=Object.keys(u),_=Object.keys(f);if(g.length!==_.length)return!1;for(_=0;_<g.length;_++){var C=g[_];if(!c.call(f,C)||!Hr(u[C],f[C]))return!1}return!0}function Ds(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function Ua(u,f){var g=Ds(u);u=0;for(var _;g;){if(g.nodeType===3){if(_=u+g.textContent.length,u<=f&&_>=f)return{node:g,offset:f-u};u=_}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=Ds(g)}}function Zl(u,f){return u&&f?u===f?!0:u&&u.nodeType===3?!1:f&&f.nodeType===3?Zl(u,f.parentNode):"contains"in u?u.contains(f):u.compareDocumentPosition?!!(u.compareDocumentPosition(f)&16):!1:!1}function yd(){for(var u=window,f=nt();f instanceof u.HTMLIFrameElement;){try{var g=typeof f.contentWindow.location.href=="string"}catch{g=!1}if(g)u=f.contentWindow;else break;f=nt(u.document)}return f}function ec(u){var f=u&&u.nodeName&&u.nodeName.toLowerCase();return f&&(f==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||f==="textarea"||u.contentEditable==="true")}function tc(u){var f=yd(),g=u.focusedElem,_=u.selectionRange;if(f!==g&&g&&g.ownerDocument&&Zl(g.ownerDocument.documentElement,g)){if(_!==null&&ec(g)){if(f=_.start,u=_.end,u===void 0&&(u=f),"selectionStart"in g)g.selectionStart=f,g.selectionEnd=Math.min(u,g.value.length);else if(u=(f=g.ownerDocument||document)&&f.defaultView||window,u.getSelection){u=u.getSelection();var C=g.textContent.length,D=Math.min(_.start,C);_=_.end===void 0?D:Math.min(_.end,C),!u.extend&&D>_&&(C=_,_=D,D=C),C=Ua(g,D);var ne=Ua(g,_);C&&ne&&(u.rangeCount!==1||u.anchorNode!==C.node||u.anchorOffset!==C.offset||u.focusNode!==ne.node||u.focusOffset!==ne.offset)&&(f=f.createRange(),f.setStart(C.node,C.offset),u.removeAllRanges(),D>_?(u.addRange(f),u.extend(ne.node,ne.offset)):(f.setEnd(ne.node,ne.offset),u.addRange(f)))}}for(f=[],u=g;u=u.parentNode;)u.nodeType===1&&f.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<f.length;g++)u=f[g],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var rc=l&&"documentMode"in document&&11>=document.documentMode,za=null,ko=null,qi=null,jo=!1;function Eo(u,f,g){var _=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;jo||za==null||za!==nt(_)||(_=za,"selectionStart"in _&&ec(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),qi&&So(qi,_)||(qi=_,_=Pf(ko,"onSelect"),0<_.length&&(f=new ol("onSelect","select",null,f,g),u.push({event:f,listeners:_}),f.target=za)))}function hl(u,f){var g={};return g[u.toLowerCase()]=f.toLowerCase(),g["Webkit"+u]="webkit"+f,g["Moz"+u]="moz"+f,g}var ks={animationend:hl("Animation","AnimationEnd"),animationiteration:hl("Animation","AnimationIteration"),animationstart:hl("Animation","AnimationStart"),transitionend:hl("Transition","TransitionEnd")},ua={},sn={};l&&(sn=document.createElement("div").style,"AnimationEvent"in window||(delete ks.animationend.animation,delete ks.animationiteration.animation,delete ks.animationstart.animation),"TransitionEvent"in window||delete ks.transitionend.transition);function Zr(u){if(ua[u])return ua[u];if(!ks[u])return u;var f=ks[u],g;for(g in f)if(f.hasOwnProperty(g)&&g in sn)return ua[u]=f[g];return u}var On=Zr("animationend"),Kn=Zr("animationiteration"),Gi=Zr("animationstart"),cu=Zr("transitionend"),nc=new Map,bd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xi(u,f){nc.set(u,f),a(f,[u])}for(var uu=0;uu<bd.length;uu++){var Js=bd[uu],ei=Js.toLowerCase(),Tf=Js[0].toUpperCase()+Js.slice(1);Xi(ei,"on"+Tf)}Xi(On,"onAnimationEnd"),Xi(Kn,"onAnimationIteration"),Xi(Gi,"onAnimationStart"),Xi("dblclick","onDoubleClick"),Xi("focusin","onFocus"),Xi("focusout","onBlur"),Xi(cu,"onTransitionEnd"),i("onMouseEnter",["mouseout","mouseover"]),i("onMouseLeave",["mouseout","mouseover"]),i("onPointerEnter",["pointerout","pointerover"]),i("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ip=new Set("cancel close invalid load scroll toggle".split(" ").concat(pl));function wd(u,f,g){var _=u.type||"unknown-event";u.currentTarget=g,be(_,f,void 0,u),u.currentTarget=null}function _d(u,f){f=(f&4)!==0;for(var g=0;g<u.length;g++){var _=u[g],C=_.event;_=_.listeners;e:{var D=void 0;if(f)for(var ne=_.length-1;0<=ne;ne--){var Ne=_[ne],Ae=Ne.instance,Ge=Ne.currentTarget;if(Ne=Ne.listener,Ae!==D&&C.isPropagationStopped())break e;wd(C,Ne,Ge),D=Ae}else for(ne=0;ne<_.length;ne++){if(Ne=_[ne],Ae=Ne.instance,Ge=Ne.currentTarget,Ne=Ne.listener,Ae!==D&&C.isPropagationStopped())break e;wd(C,Ne,Ge),D=Ae}}}if(se)throw u=ye,se=!1,ye=null,u}function an(u,f){var g=f[fa];g===void 0&&(g=f[fa]=new Set);var _=u+"__bubble";g.has(_)||(Nd(f,u,2,!1),g.add(_))}function Ff(u,f,g){var _=0;f&&(_|=4),Nd(g,u,_,f)}var du="_reactListening"+Math.random().toString(36).slice(2);function sc(u){if(!u[du]){u[du]=!0,n.forEach(function(g){g!=="selectionchange"&&(Ip.has(g)||Ff(g,!1,u),Ff(g,!0,u))});var f=u.nodeType===9?u:u.ownerDocument;f===null||f[du]||(f[du]=!0,Ff("selectionchange",!1,f))}}function Nd(u,f,g,_){switch(hd(f)){case 1:var C=ql;break;case 4:C=fd;break;default:C=al}g=C.bind(null,f,g,u),C=void 0,!Un||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(C=!0),_?C!==void 0?u.addEventListener(f,g,{capture:!0,passive:C}):u.addEventListener(f,g,!0):C!==void 0?u.addEventListener(f,g,{passive:C}):u.addEventListener(f,g,!1)}function Sd(u,f,g,_,C){var D=_;if((f&1)===0&&(f&2)===0&&_!==null)e:for(;;){if(_===null)return;var ne=_.tag;if(ne===3||ne===4){var Ne=_.stateNode.containerInfo;if(Ne===C||Ne.nodeType===8&&Ne.parentNode===C)break;if(ne===4)for(ne=_.return;ne!==null;){var Ae=ne.tag;if((Ae===3||Ae===4)&&(Ae=ne.stateNode.containerInfo,Ae===C||Ae.nodeType===8&&Ae.parentNode===C))return;ne=ne.return}for(;Ne!==null;){if(ne=ml(Ne),ne===null)return;if(Ae=ne.tag,Ae===5||Ae===6){_=D=ne;continue e}Ne=Ne.parentNode}}_=_.return}hn(function(){var Ge=D,ht=hr(g),xt=[];e:{var ft=nc.get(u);if(ft!==void 0){var Rt=ol,zt=u;switch(u){case"keypress":if(_i(g)===0)break e;case"keydown":case"keyup":Rt=yr;break;case"focusin":zt="focus",Rt=yo;break;case"focusout":zt="blur",Rt=yo;break;case"beforeblur":case"afterblur":Rt=yo;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Rt=Jc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Rt=U0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Rt=Rn;break;case On:case Kn:case Gi:Rt=cl;break;case cu:Rt=Ps;break;case"scroll":Rt=pd;break;case"wheel":Rt=Ni;break;case"copy":case"cut":case"paste":Rt=j;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Rt=Fr}var qt=(f&4)!==0,us=!qt&&u==="scroll",ze=qt?ft!==null?ft+"Capture":null:ft;qt=[];for(var Pe=Ge,Ve;Pe!==null;){Ve=Pe;var _t=Ve.stateNode;if(Ve.tag===5&&_t!==null&&(Ve=_t,ze!==null&&(_t=Mt(Pe,ze),_t!=null&&qt.push(kd(Pe,_t,Ve)))),us)break;Pe=Pe.return}0<qt.length&&(ft=new Rt(ft,zt,null,g,ht),xt.push({event:ft,listeners:qt}))}}if((f&7)===0){e:{if(ft=u==="mouseover"||u==="pointerover",Rt=u==="mouseout"||u==="pointerout",ft&&g!==jt&&(zt=g.relatedTarget||g.fromElement)&&(ml(zt)||zt[Rs]))break e;if((Rt||ft)&&(ft=ht.window===ht?ht:(ft=ht.ownerDocument)?ft.defaultView||ft.parentWindow:window,Rt?(zt=g.relatedTarget||g.toElement,Rt=Ge,zt=zt?ml(zt):null,zt!==null&&(us=we(zt),zt!==us||zt.tag!==5&&zt.tag!==6)&&(zt=null)):(Rt=null,zt=Ge),Rt!==zt)){if(qt=Jc,_t="onMouseLeave",ze="onMouseEnter",Pe="mouse",(u==="pointerout"||u==="pointerover")&&(qt=Fr,_t="onPointerLeave",ze="onPointerEnter",Pe="pointer"),us=Rt==null?ft:oc(Rt),Ve=zt==null?ft:oc(zt),ft=new qt(_t,Pe+"leave",Rt,g,ht),ft.target=us,ft.relatedTarget=Ve,_t=null,ml(ht)===Ge&&(qt=new qt(ze,Pe+"enter",zt,g,ht),qt.target=Ve,qt.relatedTarget=us,_t=qt),us=_t,Rt&&zt)t:{for(qt=Rt,ze=zt,Pe=0,Ve=qt;Ve;Ve=ac(Ve))Pe++;for(Ve=0,_t=ze;_t;_t=ac(_t))Ve++;for(;0<Pe-Ve;)qt=ac(qt),Pe--;for(;0<Ve-Pe;)ze=ac(ze),Ve--;for(;Pe--;){if(qt===ze||ze!==null&&qt===ze.alternate)break t;qt=ac(qt),ze=ac(ze)}qt=null}else qt=null;Rt!==null&&Op(xt,ft,Rt,qt,!1),zt!==null&&us!==null&&Op(xt,us,zt,qt,!0)}}e:{if(ft=Ge?oc(Ge):window,Rt=ft.nodeName&&ft.nodeName.toLowerCase(),Rt==="select"||Rt==="input"&&ft.type==="file")var Xt=iu;else if(au(ft))if(vd)Xt=lu;else{Xt=wo;var nr=fl}else(Rt=ft.nodeName)&&Rt.toLowerCase()==="input"&&(ft.type==="checkbox"||ft.type==="radio")&&(Xt=_o);if(Xt&&(Xt=Xt(u,Ge))){Xs(xt,Xt,g,ht);break e}nr&&nr(u,ft,Ge),u==="focusout"&&(nr=ft._wrapperState)&&nr.controlled&&ft.type==="number"&&Ke(ft,"number",ft.value)}switch(nr=Ge?oc(Ge):window,u){case"focusin":(au(nr)||nr.contentEditable==="true")&&(za=nr,ko=Ge,qi=null);break;case"focusout":qi=ko=za=null;break;case"mousedown":jo=!0;break;case"contextmenu":case"mouseup":case"dragend":jo=!1,Eo(xt,g,ht);break;case"selectionchange":if(rc)break;case"keydown":case"keyup":Eo(xt,g,ht)}var sr;if(Za)e:{switch(u){case"compositionstart":var gr="onCompositionStart";break e;case"compositionend":gr="onCompositionEnd";break e;case"compositionupdate":gr="onCompositionUpdate";break e}gr=void 0}else In?tu(u,g)&&(gr="onCompositionEnd"):u==="keydown"&&g.keyCode===229&&(gr="onCompositionStart");gr&&(Zc&&g.locale!=="ko"&&(In||gr!=="onCompositionStart"?gr==="onCompositionEnd"&&In&&(sr=Ef()):(wi=ht,Ja="value"in wi?wi.value:wi.textContent,In=!0)),nr=Pf(Ge,gr),0<nr.length&&(gr=new _e(gr,u,null,g,ht),xt.push({event:gr,listeners:nr}),sr?gr.data=sr:(sr=Jl(g),sr!==null&&(gr.data=sr)))),(sr=gd?ru(u,g):nu(u,g))&&(Ge=Pf(Ge,"onBeforeInput"),0<Ge.length&&(ht=new _e("onBeforeInput","beforeinput",null,g,ht),xt.push({event:ht,listeners:Ge}),ht.data=sr))}_d(xt,f)})}function kd(u,f,g){return{instance:u,listener:f,currentTarget:g}}function Pf(u,f){for(var g=f+"Capture",_=[];u!==null;){var C=u,D=C.stateNode;C.tag===5&&D!==null&&(C=D,D=Mt(u,g),D!=null&&_.unshift(kd(u,D,C)),D=Mt(u,f),D!=null&&_.push(kd(u,D,C))),u=u.return}return _}function ac(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function Op(u,f,g,_,C){for(var D=f._reactName,ne=[];g!==null&&g!==_;){var Ne=g,Ae=Ne.alternate,Ge=Ne.stateNode;if(Ae!==null&&Ae===_)break;Ne.tag===5&&Ge!==null&&(Ne=Ge,C?(Ae=Mt(g,D),Ae!=null&&ne.unshift(kd(g,Ae,Ne))):C||(Ae=Mt(g,D),Ae!=null&&ne.push(kd(g,Ae,Ne)))),g=g.return}ne.length!==0&&u.push({event:f,listeners:ne})}var Ng=/\r\n?/g,Sg=/\u0000|\uFFFD/g;function Mp(u){return(typeof u=="string"?u:""+u).replace(Ng,`
`).replace(Sg,"")}function Lf(u,f,g){if(f=Mp(f),Mp(u)!==f&&g)throw Error(r(425))}function fu(){}var jd=null,ic=null;function z0(u,f){return u==="textarea"||u==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var H0=typeof setTimeout=="function"?setTimeout:void 0,Bp=typeof clearTimeout=="function"?clearTimeout:void 0,Up=typeof Promise=="function"?Promise:void 0,kg=typeof queueMicrotask=="function"?queueMicrotask:typeof Up<"u"?function(u){return Up.resolve(null).then(u).catch(jg)}:H0;function jg(u){setTimeout(function(){throw u})}function $0(u,f){var g=f,_=0;do{var C=g.nextSibling;if(u.removeChild(g),C&&C.nodeType===8)if(g=C.data,g==="/$"){if(_===0){u.removeChild(C),bi(f);return}_--}else g!=="$"&&g!=="$?"&&g!=="$!"||_++;g=C}while(g);bi(f)}function Qs(u){for(;u!=null;u=u.nextSibling){var f=u.nodeType;if(f===1||f===3)break;if(f===8){if(f=u.data,f==="$"||f==="$!"||f==="$?")break;if(f==="/$")return null}}return u}function ti(u){u=u.previousSibling;for(var f=0;u;){if(u.nodeType===8){var g=u.data;if(g==="$"||g==="$!"||g==="$?"){if(f===0)return u;f--}else g==="/$"&&f++}u=u.previousSibling}return null}var da=Math.random().toString(36).slice(2),Yi="__reactFiber$"+da,hu="__reactProps$"+da,Rs="__reactContainer$"+da,fa="__reactEvents$"+da,Eg="__reactListeners$"+da,Ag="__reactHandles$"+da;function ml(u){var f=u[Yi];if(f)return f;for(var g=u.parentNode;g;){if(f=g[Rs]||g[Yi]){if(g=f.alternate,f.child!==null||g!==null&&g.child!==null)for(u=ti(u);u!==null;){if(g=u[Yi])return g;u=ti(u)}return f}u=g,g=u.parentNode}return null}function pu(u){return u=u[Yi]||u[Rs],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function oc(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(r(33))}function Ed(u){return u[hu]||null}var W0=[],Ao=-1;function Si(u){return{current:u}}function en(u){0>Ao||(u.current=W0[Ao],W0[Ao]=null,Ao--)}function rn(u,f){Ao++,W0[Ao]=u.current,u.current=f}var xl={},js=Si(xl),ha=Si(!1),lc=xl;function mu(u,f){var g=u.type.contextTypes;if(!g)return xl;var _=u.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===f)return _.__reactInternalMemoizedMaskedChildContext;var C={},D;for(D in g)C[D]=f[D];return _&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=f,u.__reactInternalMemoizedMaskedChildContext=C),C}function pa(u){return u=u.childContextTypes,u!=null}function Df(){en(ha),en(js)}function zp(u,f,g){if(js.current!==xl)throw Error(r(168));rn(js,f),rn(ha,g)}function V0(u,f,g){var _=u.stateNode;if(f=f.childContextTypes,typeof _.getChildContext!="function")return g;_=_.getChildContext();for(var C in _)if(!(C in f))throw Error(r(108,he(u)||"Unknown",C));return fe({},g,_)}function cc(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||xl,lc=js.current,rn(js,u),rn(ha,ha.current),!0}function Hp(u,f,g){var _=u.stateNode;if(!_)throw Error(r(169));g?(u=V0(u,f,lc),_.__reactInternalMemoizedMergedChildContext=u,en(ha),en(js),rn(js,u)):en(ha),rn(ha,g)}var Co=null,Ad=!1,v=!1;function N(u){Co===null?Co=[u]:Co.push(u)}function T(u){Ad=!0,N(u)}function U(){if(!v&&Co!==null){v=!0;var u=0,f=zr;try{var g=Co;for(zr=1;u<g.length;u++){var _=g[u];do _=_(!0);while(_!==null)}Co=null,Ad=!1}catch(C){throw Co!==null&&(Co=Co.slice(u+1)),ut(Ir,U),C}finally{zr=f,v=!1}}return null}var Y=[],re=0,oe=null,ce=0,de=[],ge=0,Ee=null,Oe=1,Me="";function Le(u,f){Y[re++]=ce,Y[re++]=oe,oe=u,ce=f}function ot(u,f,g){de[ge++]=Oe,de[ge++]=Me,de[ge++]=Ee,Ee=u;var _=Oe;u=Me;var C=32-Nn(_)-1;_&=~(1<<C),g+=1;var D=32-Nn(f)+C;if(30<D){var ne=C-C%5;D=(_&(1<<ne)-1).toString(32),_>>=ne,C-=ne,Oe=1<<32-Nn(f)+C|g<<C|_,Me=D+u}else Oe=1<<D|g<<C|_,Me=u}function Ye(u){u.return!==null&&(Le(u,1),ot(u,1,0))}function Ce(u){for(;u===oe;)oe=Y[--re],Y[re]=null,ce=Y[--re],Y[re]=null;for(;u===Ee;)Ee=de[--ge],de[ge]=null,Me=de[--ge],de[ge]=null,Oe=de[--ge],de[ge]=null}var Fe=null,tt=null,et=!1,at=null;function Lt(u,f){var g=to(5,null,null,0);g.elementType="DELETED",g.stateNode=f,g.return=u,f=u.deletions,f===null?(u.deletions=[g],u.flags|=16):f.push(g)}function Et(u,f){switch(u.tag){case 5:var g=u.type;return f=f.nodeType!==1||g.toLowerCase()!==f.nodeName.toLowerCase()?null:f,f!==null?(u.stateNode=f,Fe=u,tt=Qs(f.firstChild),!0):!1;case 6:return f=u.pendingProps===""||f.nodeType!==3?null:f,f!==null?(u.stateNode=f,Fe=u,tt=null,!0):!1;case 13:return f=f.nodeType!==8?null:f,f!==null?(g=Ee!==null?{id:Oe,overflow:Me}:null,u.memoizedState={dehydrated:f,treeContext:g,retryLane:1073741824},g=to(18,null,null,0),g.stateNode=f,g.return=u,u.child=g,Fe=u,tt=null,!0):!1;default:return!1}}function Zt(u){return(u.mode&1)!==0&&(u.flags&128)===0}function At(u){if(et){var f=tt;if(f){var g=f;if(!Et(u,f)){if(Zt(u))throw Error(r(418));f=Qs(g.nextSibling);var _=Fe;f&&Et(u,f)?Lt(_,g):(u.flags=u.flags&-4097|2,et=!1,Fe=u)}}else{if(Zt(u))throw Error(r(418));u.flags=u.flags&-4097|2,et=!1,Fe=u}}}function Or(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;Fe=u}function Mr(u){if(u!==Fe)return!1;if(!et)return Or(u),et=!0,!1;var f;if((f=u.tag!==3)&&!(f=u.tag!==5)&&(f=u.type,f=f!=="head"&&f!=="body"&&!z0(u.type,u.memoizedProps)),f&&(f=tt)){if(Zt(u))throw Pr(),Error(r(418));for(;f;)Lt(u,f),f=Qs(f.nextSibling)}if(Or(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(r(317));e:{for(u=u.nextSibling,f=0;u;){if(u.nodeType===8){var g=u.data;if(g==="/$"){if(f===0){tt=Qs(u.nextSibling);break e}f--}else g!=="$"&&g!=="$!"&&g!=="$?"||f++}u=u.nextSibling}tt=null}}else tt=Fe?Qs(u.stateNode.nextSibling):null;return!0}function Pr(){for(var u=tt;u;)u=Qs(u.nextSibling)}function wr(){tt=Fe=null,et=!1}function tn(u){at===null?at=[u]:at.push(u)}var nn=z.ReactCurrentBatchConfig;function mr(u,f,g){if(u=g.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(g._owner){if(g=g._owner,g){if(g.tag!==1)throw Error(r(309));var _=g.stateNode}if(!_)throw Error(r(147,u));var C=_,D=""+u;return f!==null&&f.ref!==null&&typeof f.ref=="function"&&f.ref._stringRef===D?f.ref:(f=function(ne){var Ne=C.refs;ne===null?delete Ne[D]:Ne[D]=ne},f._stringRef=D,f)}if(typeof u!="string")throw Error(r(284));if(!g._owner)throw Error(r(290,u))}return u}function jn(u,f){throw u=Object.prototype.toString.call(f),Error(r(31,u==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":u))}function Zs(u){var f=u._init;return f(u._payload)}function $n(u){function f(ze,Pe){if(u){var Ve=ze.deletions;Ve===null?(ze.deletions=[Pe],ze.flags|=16):Ve.push(Pe)}}function g(ze,Pe){if(!u)return null;for(;Pe!==null;)f(ze,Pe),Pe=Pe.sibling;return null}function _(ze,Pe){for(ze=new Map;Pe!==null;)Pe.key!==null?ze.set(Pe.key,Pe):ze.set(Pe.index,Pe),Pe=Pe.sibling;return ze}function C(ze,Pe){return ze=Eu(ze,Pe),ze.index=0,ze.sibling=null,ze}function D(ze,Pe,Ve){return ze.index=Ve,u?(Ve=ze.alternate,Ve!==null?(Ve=Ve.index,Ve<Pe?(ze.flags|=2,Pe):Ve):(ze.flags|=2,Pe)):(ze.flags|=1048576,Pe)}function ne(ze){return u&&ze.alternate===null&&(ze.flags|=2),ze}function Ne(ze,Pe,Ve,_t){return Pe===null||Pe.tag!==6?(Pe=n1(Ve,ze.mode,_t),Pe.return=ze,Pe):(Pe=C(Pe,Ve),Pe.return=ze,Pe)}function Ae(ze,Pe,Ve,_t){var Xt=Ve.type;return Xt===B?ht(ze,Pe,Ve.props.children,_t,Ve.key):Pe!==null&&(Pe.elementType===Xt||typeof Xt=="object"&&Xt!==null&&Xt.$$typeof===te&&Zs(Xt)===Pe.type)?(_t=C(Pe,Ve.props),_t.ref=mr(ze,Pe,Ve),_t.return=ze,_t):(_t=lm(Ve.type,Ve.key,Ve.props,null,ze.mode,_t),_t.ref=mr(ze,Pe,Ve),_t.return=ze,_t)}function Ge(ze,Pe,Ve,_t){return Pe===null||Pe.tag!==4||Pe.stateNode.containerInfo!==Ve.containerInfo||Pe.stateNode.implementation!==Ve.implementation?(Pe=s1(Ve,ze.mode,_t),Pe.return=ze,Pe):(Pe=C(Pe,Ve.children||[]),Pe.return=ze,Pe)}function ht(ze,Pe,Ve,_t,Xt){return Pe===null||Pe.tag!==7?(Pe=Id(Ve,ze.mode,_t,Xt),Pe.return=ze,Pe):(Pe=C(Pe,Ve),Pe.return=ze,Pe)}function xt(ze,Pe,Ve){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number")return Pe=n1(""+Pe,ze.mode,Ve),Pe.return=ze,Pe;if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case H:return Ve=lm(Pe.type,Pe.key,Pe.props,null,ze.mode,Ve),Ve.ref=mr(ze,null,Pe),Ve.return=ze,Ve;case V:return Pe=s1(Pe,ze.mode,Ve),Pe.return=ze,Pe;case te:var _t=Pe._init;return xt(ze,_t(Pe._payload),Ve)}if(it(Pe)||X(Pe))return Pe=Id(Pe,ze.mode,Ve,null),Pe.return=ze,Pe;jn(ze,Pe)}return null}function ft(ze,Pe,Ve,_t){var Xt=Pe!==null?Pe.key:null;if(typeof Ve=="string"&&Ve!==""||typeof Ve=="number")return Xt!==null?null:Ne(ze,Pe,""+Ve,_t);if(typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case H:return Ve.key===Xt?Ae(ze,Pe,Ve,_t):null;case V:return Ve.key===Xt?Ge(ze,Pe,Ve,_t):null;case te:return Xt=Ve._init,ft(ze,Pe,Xt(Ve._payload),_t)}if(it(Ve)||X(Ve))return Xt!==null?null:ht(ze,Pe,Ve,_t,null);jn(ze,Ve)}return null}function Rt(ze,Pe,Ve,_t,Xt){if(typeof _t=="string"&&_t!==""||typeof _t=="number")return ze=ze.get(Ve)||null,Ne(Pe,ze,""+_t,Xt);if(typeof _t=="object"&&_t!==null){switch(_t.$$typeof){case H:return ze=ze.get(_t.key===null?Ve:_t.key)||null,Ae(Pe,ze,_t,Xt);case V:return ze=ze.get(_t.key===null?Ve:_t.key)||null,Ge(Pe,ze,_t,Xt);case te:var nr=_t._init;return Rt(ze,Pe,Ve,nr(_t._payload),Xt)}if(it(_t)||X(_t))return ze=ze.get(Ve)||null,ht(Pe,ze,_t,Xt,null);jn(Pe,_t)}return null}function zt(ze,Pe,Ve,_t){for(var Xt=null,nr=null,sr=Pe,gr=Pe=0,Bs=null;sr!==null&&gr<Ve.length;gr++){sr.index>gr?(Bs=sr,sr=null):Bs=sr.sibling;var Xr=ft(ze,sr,Ve[gr],_t);if(Xr===null){sr===null&&(sr=Bs);break}u&&sr&&Xr.alternate===null&&f(ze,sr),Pe=D(Xr,Pe,gr),nr===null?Xt=Xr:nr.sibling=Xr,nr=Xr,sr=Bs}if(gr===Ve.length)return g(ze,sr),et&&Le(ze,gr),Xt;if(sr===null){for(;gr<Ve.length;gr++)sr=xt(ze,Ve[gr],_t),sr!==null&&(Pe=D(sr,Pe,gr),nr===null?Xt=sr:nr.sibling=sr,nr=sr);return et&&Le(ze,gr),Xt}for(sr=_(ze,sr);gr<Ve.length;gr++)Bs=Rt(sr,ze,gr,Ve[gr],_t),Bs!==null&&(u&&Bs.alternate!==null&&sr.delete(Bs.key===null?gr:Bs.key),Pe=D(Bs,Pe,gr),nr===null?Xt=Bs:nr.sibling=Bs,nr=Bs);return u&&sr.forEach(function(Au){return f(ze,Au)}),et&&Le(ze,gr),Xt}function qt(ze,Pe,Ve,_t){var Xt=X(Ve);if(typeof Xt!="function")throw Error(r(150));if(Ve=Xt.call(Ve),Ve==null)throw Error(r(151));for(var nr=Xt=null,sr=Pe,gr=Pe=0,Bs=null,Xr=Ve.next();sr!==null&&!Xr.done;gr++,Xr=Ve.next()){sr.index>gr?(Bs=sr,sr=null):Bs=sr.sibling;var Au=ft(ze,sr,Xr.value,_t);if(Au===null){sr===null&&(sr=Bs);break}u&&sr&&Au.alternate===null&&f(ze,sr),Pe=D(Au,Pe,gr),nr===null?Xt=Au:nr.sibling=Au,nr=Au,sr=Bs}if(Xr.done)return g(ze,sr),et&&Le(ze,gr),Xt;if(sr===null){for(;!Xr.done;gr++,Xr=Ve.next())Xr=xt(ze,Xr.value,_t),Xr!==null&&(Pe=D(Xr,Pe,gr),nr===null?Xt=Xr:nr.sibling=Xr,nr=Xr);return et&&Le(ze,gr),Xt}for(sr=_(ze,sr);!Xr.done;gr++,Xr=Ve.next())Xr=Rt(sr,ze,gr,Xr.value,_t),Xr!==null&&(u&&Xr.alternate!==null&&sr.delete(Xr.key===null?gr:Xr.key),Pe=D(Xr,Pe,gr),nr===null?Xt=Xr:nr.sibling=Xr,nr=Xr);return u&&sr.forEach(function(kj){return f(ze,kj)}),et&&Le(ze,gr),Xt}function us(ze,Pe,Ve,_t){if(typeof Ve=="object"&&Ve!==null&&Ve.type===B&&Ve.key===null&&(Ve=Ve.props.children),typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case H:e:{for(var Xt=Ve.key,nr=Pe;nr!==null;){if(nr.key===Xt){if(Xt=Ve.type,Xt===B){if(nr.tag===7){g(ze,nr.sibling),Pe=C(nr,Ve.props.children),Pe.return=ze,ze=Pe;break e}}else if(nr.elementType===Xt||typeof Xt=="object"&&Xt!==null&&Xt.$$typeof===te&&Zs(Xt)===nr.type){g(ze,nr.sibling),Pe=C(nr,Ve.props),Pe.ref=mr(ze,nr,Ve),Pe.return=ze,ze=Pe;break e}g(ze,nr);break}else f(ze,nr);nr=nr.sibling}Ve.type===B?(Pe=Id(Ve.props.children,ze.mode,_t,Ve.key),Pe.return=ze,ze=Pe):(_t=lm(Ve.type,Ve.key,Ve.props,null,ze.mode,_t),_t.ref=mr(ze,Pe,Ve),_t.return=ze,ze=_t)}return ne(ze);case V:e:{for(nr=Ve.key;Pe!==null;){if(Pe.key===nr)if(Pe.tag===4&&Pe.stateNode.containerInfo===Ve.containerInfo&&Pe.stateNode.implementation===Ve.implementation){g(ze,Pe.sibling),Pe=C(Pe,Ve.children||[]),Pe.return=ze,ze=Pe;break e}else{g(ze,Pe);break}else f(ze,Pe);Pe=Pe.sibling}Pe=s1(Ve,ze.mode,_t),Pe.return=ze,ze=Pe}return ne(ze);case te:return nr=Ve._init,us(ze,Pe,nr(Ve._payload),_t)}if(it(Ve))return zt(ze,Pe,Ve,_t);if(X(Ve))return qt(ze,Pe,Ve,_t);jn(ze,Ve)}return typeof Ve=="string"&&Ve!==""||typeof Ve=="number"?(Ve=""+Ve,Pe!==null&&Pe.tag===6?(g(ze,Pe.sibling),Pe=C(Pe,Ve),Pe.return=ze,ze=Pe):(g(ze,Pe),Pe=n1(Ve,ze.mode,_t),Pe.return=ze,ze=Pe),ne(ze)):g(ze,Pe)}return us}var os=$n(!0),qr=$n(!1),Is=Si(null),Os=null,En=null,ls=null;function Es(){ls=En=Os=null}function ma(u){var f=Is.current;en(Is),u._currentValue=f}function ri(u,f,g){for(;u!==null;){var _=u.alternate;if((u.childLanes&f)!==f?(u.childLanes|=f,_!==null&&(_.childLanes|=f)):_!==null&&(_.childLanes&f)!==f&&(_.childLanes|=f),u===g)break;u=u.return}}function An(u,f){Os=u,ls=En=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&f)!==0&&(ii=!0),u.firstContext=null)}function Jn(u){var f=u._currentValue;if(ls!==u)if(u={context:u,memoizedValue:f,next:null},En===null){if(Os===null)throw Error(r(308));En=u,Os.dependencies={lanes:0,firstContext:u}}else En=En.next=u;return f}var Ha=null;function gl(u){Ha===null?Ha=[u]:Ha.push(u)}function To(u,f,g,_){var C=f.interleaved;return C===null?(g.next=g,gl(f)):(g.next=C.next,C.next=g),f.interleaved=g,Gr(u,_)}function Gr(u,f){u.lanes|=f;var g=u.alternate;for(g!==null&&(g.lanes|=f),g=u,u=u.return;u!==null;)u.childLanes|=f,g=u.alternate,g!==null&&(g.childLanes|=f),g=u,u=u.return;return g.tag===3?g.stateNode:null}var Ki=!1;function Rf(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function q0(u,f){u=u.updateQueue,f.updateQueue===u&&(f.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function ni(u,f){return{eventTime:u,lane:f,tag:0,payload:null,callback:null,next:null}}function si(u,f,g){var _=u.updateQueue;if(_===null)return null;if(_=_.shared,($r&2)!==0){var C=_.pending;return C===null?f.next=f:(f.next=C.next,C.next=f),_.pending=f,Gr(u,g)}return C=_.interleaved,C===null?(f.next=f,gl(_)):(f.next=C.next,C.next=f),_.interleaved=f,Gr(u,g)}function uc(u,f,g){if(f=f.updateQueue,f!==null&&(f=f.shared,(g&4194240)!==0)){var _=f.lanes;_&=u.pendingLanes,g|=_,f.lanes=g,Hc(u,g)}}function ai(u,f){var g=u.updateQueue,_=u.alternate;if(_!==null&&(_=_.updateQueue,g===_)){var C=null,D=null;if(g=g.firstBaseUpdate,g!==null){do{var ne={eventTime:g.eventTime,lane:g.lane,tag:g.tag,payload:g.payload,callback:g.callback,next:null};D===null?C=D=ne:D=D.next=ne,g=g.next}while(g!==null);D===null?C=D=f:D=D.next=f}else C=D=f;g={baseState:_.baseState,firstBaseUpdate:C,lastBaseUpdate:D,shared:_.shared,effects:_.effects},u.updateQueue=g;return}u=g.lastBaseUpdate,u===null?g.firstBaseUpdate=f:u.next=f,g.lastBaseUpdate=f}function Fo(u,f,g,_){var C=u.updateQueue;Ki=!1;var D=C.firstBaseUpdate,ne=C.lastBaseUpdate,Ne=C.shared.pending;if(Ne!==null){C.shared.pending=null;var Ae=Ne,Ge=Ae.next;Ae.next=null,ne===null?D=Ge:ne.next=Ge,ne=Ae;var ht=u.alternate;ht!==null&&(ht=ht.updateQueue,Ne=ht.lastBaseUpdate,Ne!==ne&&(Ne===null?ht.firstBaseUpdate=Ge:Ne.next=Ge,ht.lastBaseUpdate=Ae))}if(D!==null){var xt=C.baseState;ne=0,ht=Ge=Ae=null,Ne=D;do{var ft=Ne.lane,Rt=Ne.eventTime;if((_&ft)===ft){ht!==null&&(ht=ht.next={eventTime:Rt,lane:0,tag:Ne.tag,payload:Ne.payload,callback:Ne.callback,next:null});e:{var zt=u,qt=Ne;switch(ft=f,Rt=g,qt.tag){case 1:if(zt=qt.payload,typeof zt=="function"){xt=zt.call(Rt,xt,ft);break e}xt=zt;break e;case 3:zt.flags=zt.flags&-65537|128;case 0:if(zt=qt.payload,ft=typeof zt=="function"?zt.call(Rt,xt,ft):zt,ft==null)break e;xt=fe({},xt,ft);break e;case 2:Ki=!0}}Ne.callback!==null&&Ne.lane!==0&&(u.flags|=64,ft=C.effects,ft===null?C.effects=[Ne]:ft.push(Ne))}else Rt={eventTime:Rt,lane:ft,tag:Ne.tag,payload:Ne.payload,callback:Ne.callback,next:null},ht===null?(Ge=ht=Rt,Ae=xt):ht=ht.next=Rt,ne|=ft;if(Ne=Ne.next,Ne===null){if(Ne=C.shared.pending,Ne===null)break;ft=Ne,Ne=ft.next,ft.next=null,C.lastBaseUpdate=ft,C.shared.pending=null}}while(!0);if(ht===null&&(Ae=xt),C.baseState=Ae,C.firstBaseUpdate=Ge,C.lastBaseUpdate=ht,f=C.shared.interleaved,f!==null){C=f;do ne|=C.lane,C=C.next;while(C!==f)}else D===null&&(C.shared.lanes=0);Pd|=ne,u.lanes=ne,u.memoizedState=xt}}function dc(u,f,g){if(u=f.effects,f.effects=null,u!==null)for(f=0;f<u.length;f++){var _=u[f],C=_.callback;if(C!==null){if(_.callback=null,_=g,typeof C!="function")throw Error(r(191,C));C.call(_)}}}var xu={},$a=Si(xu),gu=Si(xu),vl=Si(xu);function Po(u){if(u===xu)throw Error(r(174));return u}function vu(u,f){switch(rn(vl,f),rn(gu,u),rn($a,xu),u=f.nodeType,u){case 9:case 11:f=(f=f.documentElement)?f.namespaceURI:lr(null,"");break;default:u=u===8?f.parentNode:f,f=u.namespaceURI||null,u=u.tagName,f=lr(f,u)}en($a),rn($a,f)}function Ji(){en($a),en(gu),en(vl)}function $p(u){Po(vl.current);var f=Po($a.current),g=lr(f,u.type);f!==g&&(rn(gu,u),rn($a,g))}function G0(u){gu.current===u&&(en($a),en(gu))}var xn=Si(0);function ki(u){for(var f=u;f!==null;){if(f.tag===13){var g=f.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||g.data==="$!"))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}var X0=[];function Y0(){for(var u=0;u<X0.length;u++)X0[u]._workInProgressVersionPrimary=null;X0.length=0}var If=z.ReactCurrentDispatcher,Of=z.ReactCurrentBatchConfig,Qi=0,bn=null,Qn=null,Wn=null,yu=!1,Lo=!1,bu=0,Cg=0;function cs(){throw Error(r(321))}function Mf(u,f){if(f===null)return!1;for(var g=0;g<f.length&&g<u.length;g++)if(!Hr(u[g],f[g]))return!1;return!0}function Cd(u,f,g,_,C,D){if(Qi=D,bn=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,If.current=u===null||u.memoizedState===null?J6:Q6,u=g(_,C),Lo){D=0;do{if(Lo=!1,bu=0,25<=D)throw Error(r(301));D+=1,Wn=Qn=null,f.updateQueue=null,If.current=Z6,u=g(_,C)}while(Lo)}if(If.current=Xp,f=Qn!==null&&Qn.next!==null,Qi=0,Wn=Qn=bn=null,yu=!1,f)throw Error(r(300));return u}function Zi(){var u=bu!==0;return bu=0,u}function ji(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wn===null?bn.memoizedState=Wn=u:Wn=Wn.next=u,Wn}function Wa(){if(Qn===null){var u=bn.alternate;u=u!==null?u.memoizedState:null}else u=Qn.next;var f=Wn===null?bn.memoizedState:Wn.next;if(f!==null)Wn=f,Qn=u;else{if(u===null)throw Error(r(310));Qn=u,u={memoizedState:Qn.memoizedState,baseState:Qn.baseState,baseQueue:Qn.baseQueue,queue:Qn.queue,next:null},Wn===null?bn.memoizedState=Wn=u:Wn=Wn.next=u}return Wn}function Td(u,f){return typeof f=="function"?f(u):f}function Bf(u){var f=Wa(),g=f.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=u;var _=Qn,C=_.baseQueue,D=g.pending;if(D!==null){if(C!==null){var ne=C.next;C.next=D.next,D.next=ne}_.baseQueue=C=D,g.pending=null}if(C!==null){D=C.next,_=_.baseState;var Ne=ne=null,Ae=null,Ge=D;do{var ht=Ge.lane;if((Qi&ht)===ht)Ae!==null&&(Ae=Ae.next={lane:0,action:Ge.action,hasEagerState:Ge.hasEagerState,eagerState:Ge.eagerState,next:null}),_=Ge.hasEagerState?Ge.eagerState:u(_,Ge.action);else{var xt={lane:ht,action:Ge.action,hasEagerState:Ge.hasEagerState,eagerState:Ge.eagerState,next:null};Ae===null?(Ne=Ae=xt,ne=_):Ae=Ae.next=xt,bn.lanes|=ht,Pd|=ht}Ge=Ge.next}while(Ge!==null&&Ge!==D);Ae===null?ne=_:Ae.next=Ne,Hr(_,f.memoizedState)||(ii=!0),f.memoizedState=_,f.baseState=ne,f.baseQueue=Ae,g.lastRenderedState=_}if(u=g.interleaved,u!==null){C=u;do D=C.lane,bn.lanes|=D,Pd|=D,C=C.next;while(C!==u)}else C===null&&(g.lanes=0);return[f.memoizedState,g.dispatch]}function yl(u){var f=Wa(),g=f.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=u;var _=g.dispatch,C=g.pending,D=f.memoizedState;if(C!==null){g.pending=null;var ne=C=C.next;do D=u(D,ne.action),ne=ne.next;while(ne!==C);Hr(D,f.memoizedState)||(ii=!0),f.memoizedState=D,f.baseQueue===null&&(f.baseState=D),g.lastRenderedState=D}return[D,_]}function Wp(){}function K0(u,f){var g=bn,_=Wa(),C=f(),D=!Hr(_.memoizedState,C);if(D&&(_.memoizedState=C,ii=!0),_=_.queue,Hf(qp.bind(null,g,_,u),[u]),_.getSnapshot!==f||D||Wn!==null&&Wn.memoizedState.tag&1){if(g.flags|=2048,Va(9,J0.bind(null,g,_,C,f),void 0,null),Ms===null)throw Error(r(349));(Qi&30)!==0||Vp(g,f,C)}return C}function Vp(u,f,g){u.flags|=16384,u={getSnapshot:f,value:g},f=bn.updateQueue,f===null?(f={lastEffect:null,stores:null},bn.updateQueue=f,f.stores=[u]):(g=f.stores,g===null?f.stores=[u]:g.push(u))}function J0(u,f,g,_){f.value=g,f.getSnapshot=_,wu(f)&&Uf(u)}function qp(u,f,g){return g(function(){wu(f)&&Uf(u)})}function wu(u){var f=u.getSnapshot;u=u.value;try{var g=f();return!Hr(u,g)}catch{return!0}}function Uf(u){var f=Gr(u,1);f!==null&&Mo(f,u,1,-1)}function Fd(u){var f=ji();return typeof u=="function"&&(u=u()),f.memoizedState=f.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Td,lastRenderedState:u},f.queue=u,u=u.dispatch=K6.bind(null,bn,u),[f.memoizedState,u]}function Va(u,f,g,_){return u={tag:u,create:f,destroy:g,deps:_,next:null},f=bn.updateQueue,f===null?(f={lastEffect:null,stores:null},bn.updateQueue=f,f.lastEffect=u.next=u):(g=f.lastEffect,g===null?f.lastEffect=u.next=u:(_=g.next,g.next=u,u.next=_,f.lastEffect=u)),u}function Do(){return Wa().memoizedState}function Ei(u,f,g,_){var C=ji();bn.flags|=u,C.memoizedState=Va(1|f,g,void 0,_===void 0?null:_)}function fc(u,f,g,_){var C=Wa();_=_===void 0?null:_;var D=void 0;if(Qn!==null){var ne=Qn.memoizedState;if(D=ne.destroy,_!==null&&Mf(_,ne.deps)){C.memoizedState=Va(f,g,D,_);return}}bn.flags|=u,C.memoizedState=Va(1|f,g,D,_)}function zf(u,f){return Ei(8390656,8,u,f)}function Hf(u,f){return fc(2048,8,u,f)}function Gp(u,f){return fc(4,2,u,f)}function $f(u,f){return fc(4,4,u,f)}function Wf(u,f){if(typeof f=="function")return u=u(),f(u),function(){f(null)};if(f!=null)return u=u(),f.current=u,function(){f.current=null}}function Hy(u,f,g){return g=g!=null?g.concat([u]):null,fc(4,4,Wf.bind(null,f,u),g)}function Tg(){}function $y(u,f){var g=Wa();f=f===void 0?null:f;var _=g.memoizedState;return _!==null&&f!==null&&Mf(f,_[1])?_[0]:(g.memoizedState=[u,f],u)}function Wy(u,f){var g=Wa();f=f===void 0?null:f;var _=g.memoizedState;return _!==null&&f!==null&&Mf(f,_[1])?_[0]:(u=u(),g.memoizedState=[u,f],u)}function Vy(u,f,g){return(Qi&21)===0?(u.baseState&&(u.baseState=!1,ii=!0),u.memoizedState=g):(Hr(g,f)||(g=ld(),bn.lanes|=g,Pd|=g,u.baseState=!0),f)}function X6(u,f){var g=zr;zr=g!==0&&4>g?g:4,u(!0);var _=Of.transition;Of.transition={};try{u(!1),f()}finally{zr=g,Of.transition=_}}function qy(){return Wa().memoizedState}function Y6(u,f,g){var _=ku(u);if(g={lane:_,action:g,hasEagerState:!1,eagerState:null,next:null},Gy(u))Xy(f,g);else if(g=To(u,f,g,_),g!==null){var C=Ga();Mo(g,u,_,C),Yy(g,f,_)}}function K6(u,f,g){var _=ku(u),C={lane:_,action:g,hasEagerState:!1,eagerState:null,next:null};if(Gy(u))Xy(f,C);else{var D=u.alternate;if(u.lanes===0&&(D===null||D.lanes===0)&&(D=f.lastRenderedReducer,D!==null))try{var ne=f.lastRenderedState,Ne=D(ne,g);if(C.hasEagerState=!0,C.eagerState=Ne,Hr(Ne,ne)){var Ae=f.interleaved;Ae===null?(C.next=C,gl(f)):(C.next=Ae.next,Ae.next=C),f.interleaved=C;return}}catch{}finally{}g=To(u,f,C,_),g!==null&&(C=Ga(),Mo(g,u,_,C),Yy(g,f,_))}}function Gy(u){var f=u.alternate;return u===bn||f!==null&&f===bn}function Xy(u,f){Lo=yu=!0;var g=u.pending;g===null?f.next=f:(f.next=g.next,g.next=f),u.pending=f}function Yy(u,f,g){if((g&4194240)!==0){var _=f.lanes;_&=u.pendingLanes,g|=_,f.lanes=g,Hc(u,g)}}var Xp={readContext:Jn,useCallback:cs,useContext:cs,useEffect:cs,useImperativeHandle:cs,useInsertionEffect:cs,useLayoutEffect:cs,useMemo:cs,useReducer:cs,useRef:cs,useState:cs,useDebugValue:cs,useDeferredValue:cs,useTransition:cs,useMutableSource:cs,useSyncExternalStore:cs,useId:cs,unstable_isNewReconciler:!1},J6={readContext:Jn,useCallback:function(u,f){return ji().memoizedState=[u,f===void 0?null:f],u},useContext:Jn,useEffect:zf,useImperativeHandle:function(u,f,g){return g=g!=null?g.concat([u]):null,Ei(4194308,4,Wf.bind(null,f,u),g)},useLayoutEffect:function(u,f){return Ei(4194308,4,u,f)},useInsertionEffect:function(u,f){return Ei(4,2,u,f)},useMemo:function(u,f){var g=ji();return f=f===void 0?null:f,u=u(),g.memoizedState=[u,f],u},useReducer:function(u,f,g){var _=ji();return f=g!==void 0?g(f):f,_.memoizedState=_.baseState=f,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:f},_.queue=u,u=u.dispatch=Y6.bind(null,bn,u),[_.memoizedState,u]},useRef:function(u){var f=ji();return u={current:u},f.memoizedState=u},useState:Fd,useDebugValue:Tg,useDeferredValue:function(u){return ji().memoizedState=u},useTransition:function(){var u=Fd(!1),f=u[0];return u=X6.bind(null,u[1]),ji().memoizedState=u,[f,u]},useMutableSource:function(){},useSyncExternalStore:function(u,f,g){var _=bn,C=ji();if(et){if(g===void 0)throw Error(r(407));g=g()}else{if(g=f(),Ms===null)throw Error(r(349));(Qi&30)!==0||Vp(_,f,g)}C.memoizedState=g;var D={value:g,getSnapshot:f};return C.queue=D,zf(qp.bind(null,_,D,u),[u]),_.flags|=2048,Va(9,J0.bind(null,_,D,g,f),void 0,null),g},useId:function(){var u=ji(),f=Ms.identifierPrefix;if(et){var g=Me,_=Oe;g=(_&~(1<<32-Nn(_)-1)).toString(32)+g,f=":"+f+"R"+g,g=bu++,0<g&&(f+="H"+g.toString(32)),f+=":"}else g=Cg++,f=":"+f+"r"+g.toString(32)+":";return u.memoizedState=f},unstable_isNewReconciler:!1},Q6={readContext:Jn,useCallback:$y,useContext:Jn,useEffect:Hf,useImperativeHandle:Hy,useInsertionEffect:Gp,useLayoutEffect:$f,useMemo:Wy,useReducer:Bf,useRef:Do,useState:function(){return Bf(Td)},useDebugValue:Tg,useDeferredValue:function(u){var f=Wa();return Vy(f,Qn.memoizedState,u)},useTransition:function(){var u=Bf(Td)[0],f=Wa().memoizedState;return[u,f]},useMutableSource:Wp,useSyncExternalStore:K0,useId:qy,unstable_isNewReconciler:!1},Z6={readContext:Jn,useCallback:$y,useContext:Jn,useEffect:Hf,useImperativeHandle:Hy,useInsertionEffect:Gp,useLayoutEffect:$f,useMemo:Wy,useReducer:yl,useRef:Do,useState:function(){return yl(Td)},useDebugValue:Tg,useDeferredValue:function(u){var f=Wa();return Qn===null?f.memoizedState=u:Vy(f,Qn.memoizedState,u)},useTransition:function(){var u=yl(Td)[0],f=Wa().memoizedState;return[u,f]},useMutableSource:Wp,useSyncExternalStore:K0,useId:qy,unstable_isNewReconciler:!1};function Ro(u,f){if(u&&u.defaultProps){f=fe({},f),u=u.defaultProps;for(var g in u)f[g]===void 0&&(f[g]=u[g]);return f}return f}function Fg(u,f,g,_){f=u.memoizedState,g=g(_,f),g=g==null?f:fe({},f,g),u.memoizedState=g,u.lanes===0&&(u.updateQueue.baseState=g)}var Yp={isMounted:function(u){return(u=u._reactInternals)?we(u)===u:!1},enqueueSetState:function(u,f,g){u=u._reactInternals;var _=Ga(),C=ku(u),D=ni(_,C);D.payload=f,g!=null&&(D.callback=g),f=si(u,D,C),f!==null&&(Mo(f,u,C,_),uc(f,u,C))},enqueueReplaceState:function(u,f,g){u=u._reactInternals;var _=Ga(),C=ku(u),D=ni(_,C);D.tag=1,D.payload=f,g!=null&&(D.callback=g),f=si(u,D,C),f!==null&&(Mo(f,u,C,_),uc(f,u,C))},enqueueForceUpdate:function(u,f){u=u._reactInternals;var g=Ga(),_=ku(u),C=ni(g,_);C.tag=2,f!=null&&(C.callback=f),f=si(u,C,_),f!==null&&(Mo(f,u,_,g),uc(f,u,_))}};function Ky(u,f,g,_,C,D,ne){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(_,D,ne):f.prototype&&f.prototype.isPureReactComponent?!So(g,_)||!So(C,D):!0}function Jy(u,f,g){var _=!1,C=xl,D=f.contextType;return typeof D=="object"&&D!==null?D=Jn(D):(C=pa(f)?lc:js.current,_=f.contextTypes,D=(_=_!=null)?mu(u,C):xl),f=new f(g,D),u.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=Yp,u.stateNode=f,f._reactInternals=u,_&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=C,u.__reactInternalMemoizedMaskedChildContext=D),f}function Qy(u,f,g,_){u=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(g,_),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(g,_),f.state!==u&&Yp.enqueueReplaceState(f,f.state,null)}function Pg(u,f,g,_){var C=u.stateNode;C.props=g,C.state=u.memoizedState,C.refs={},Rf(u);var D=f.contextType;typeof D=="object"&&D!==null?C.context=Jn(D):(D=pa(f)?lc:js.current,C.context=mu(u,D)),C.state=u.memoizedState,D=f.getDerivedStateFromProps,typeof D=="function"&&(Fg(u,f,D,g),C.state=u.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(f=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),f!==C.state&&Yp.enqueueReplaceState(C,C.state,null),Fo(u,g,C,_),C.state=u.memoizedState),typeof C.componentDidMount=="function"&&(u.flags|=4194308)}function Vf(u,f){try{var g="",_=f;do g+=F(_),_=_.return;while(_);var C=g}catch(D){C=`
Error generating stack: `+D.message+`
`+D.stack}return{value:u,source:f,stack:C,digest:null}}function Lg(u,f,g){return{value:u,source:null,stack:g??null,digest:f??null}}function Dg(u,f){try{console.error(f.value)}catch(g){setTimeout(function(){throw g})}}var ej=typeof WeakMap=="function"?WeakMap:Map;function Zy(u,f,g){g=ni(-1,g),g.tag=3,g.payload={element:null};var _=f.value;return g.callback=function(){rm||(rm=!0,Yg=_),Dg(u,f)},g}function eb(u,f,g){g=ni(-1,g),g.tag=3;var _=u.type.getDerivedStateFromError;if(typeof _=="function"){var C=f.value;g.payload=function(){return _(C)},g.callback=function(){Dg(u,f)}}var D=u.stateNode;return D!==null&&typeof D.componentDidCatch=="function"&&(g.callback=function(){Dg(u,f),typeof _!="function"&&(Nu===null?Nu=new Set([this]):Nu.add(this));var ne=f.stack;this.componentDidCatch(f.value,{componentStack:ne!==null?ne:""})}),g}function tb(u,f,g){var _=u.pingCache;if(_===null){_=u.pingCache=new ej;var C=new Set;_.set(f,C)}else C=_.get(f),C===void 0&&(C=new Set,_.set(f,C));C.has(g)||(C.add(g),u=pj.bind(null,u,f,g),f.then(u,u))}function rb(u){do{var f;if((f=u.tag===13)&&(f=u.memoizedState,f=f!==null?f.dehydrated!==null:!0),f)return u;u=u.return}while(u!==null);return null}function nb(u,f,g,_,C){return(u.mode&1)===0?(u===f?u.flags|=65536:(u.flags|=128,g.flags|=131072,g.flags&=-52805,g.tag===1&&(g.alternate===null?g.tag=17:(f=ni(-1,1),f.tag=2,si(g,f,1))),g.lanes|=1),u):(u.flags|=65536,u.lanes=C,u)}var tj=z.ReactCurrentOwner,ii=!1;function qa(u,f,g,_){f.child=u===null?qr(f,null,g,_):os(f,u.child,g,_)}function sb(u,f,g,_,C){g=g.render;var D=f.ref;return An(f,C),_=Cd(u,f,g,_,D,C),g=Zi(),u!==null&&!ii?(f.updateQueue=u.updateQueue,f.flags&=-2053,u.lanes&=~C,hc(u,f,C)):(et&&g&&Ye(f),f.flags|=1,qa(u,f,_,C),f.child)}function ab(u,f,g,_,C){if(u===null){var D=g.type;return typeof D=="function"&&!r1(D)&&D.defaultProps===void 0&&g.compare===null&&g.defaultProps===void 0?(f.tag=15,f.type=D,ib(u,f,D,_,C)):(u=lm(g.type,null,_,f,f.mode,C),u.ref=f.ref,u.return=f,f.child=u)}if(D=u.child,(u.lanes&C)===0){var ne=D.memoizedProps;if(g=g.compare,g=g!==null?g:So,g(ne,_)&&u.ref===f.ref)return hc(u,f,C)}return f.flags|=1,u=Eu(D,_),u.ref=f.ref,u.return=f,f.child=u}function ib(u,f,g,_,C){if(u!==null){var D=u.memoizedProps;if(So(D,_)&&u.ref===f.ref)if(ii=!1,f.pendingProps=_=D,(u.lanes&C)!==0)(u.flags&131072)!==0&&(ii=!0);else return f.lanes=u.lanes,hc(u,f,C)}return Rg(u,f,g,_,C)}function ob(u,f,g){var _=f.pendingProps,C=_.children,D=u!==null?u.memoizedState:null;if(_.mode==="hidden")if((f.mode&1)===0)f.memoizedState={baseLanes:0,cachePool:null,transitions:null},rn(Gf,Ai),Ai|=g;else{if((g&1073741824)===0)return u=D!==null?D.baseLanes|g:g,f.lanes=f.childLanes=1073741824,f.memoizedState={baseLanes:u,cachePool:null,transitions:null},f.updateQueue=null,rn(Gf,Ai),Ai|=u,null;f.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=D!==null?D.baseLanes:g,rn(Gf,Ai),Ai|=_}else D!==null?(_=D.baseLanes|g,f.memoizedState=null):_=g,rn(Gf,Ai),Ai|=_;return qa(u,f,C,g),f.child}function lb(u,f){var g=f.ref;(u===null&&g!==null||u!==null&&u.ref!==g)&&(f.flags|=512,f.flags|=2097152)}function Rg(u,f,g,_,C){var D=pa(g)?lc:js.current;return D=mu(f,D),An(f,C),g=Cd(u,f,g,_,D,C),_=Zi(),u!==null&&!ii?(f.updateQueue=u.updateQueue,f.flags&=-2053,u.lanes&=~C,hc(u,f,C)):(et&&_&&Ye(f),f.flags|=1,qa(u,f,g,C),f.child)}function cb(u,f,g,_,C){if(pa(g)){var D=!0;cc(f)}else D=!1;if(An(f,C),f.stateNode===null)Jp(u,f),Jy(f,g,_),Pg(f,g,_,C),_=!0;else if(u===null){var ne=f.stateNode,Ne=f.memoizedProps;ne.props=Ne;var Ae=ne.context,Ge=g.contextType;typeof Ge=="object"&&Ge!==null?Ge=Jn(Ge):(Ge=pa(g)?lc:js.current,Ge=mu(f,Ge));var ht=g.getDerivedStateFromProps,xt=typeof ht=="function"||typeof ne.getSnapshotBeforeUpdate=="function";xt||typeof ne.UNSAFE_componentWillReceiveProps!="function"&&typeof ne.componentWillReceiveProps!="function"||(Ne!==_||Ae!==Ge)&&Qy(f,ne,_,Ge),Ki=!1;var ft=f.memoizedState;ne.state=ft,Fo(f,_,ne,C),Ae=f.memoizedState,Ne!==_||ft!==Ae||ha.current||Ki?(typeof ht=="function"&&(Fg(f,g,ht,_),Ae=f.memoizedState),(Ne=Ki||Ky(f,g,Ne,_,ft,Ae,Ge))?(xt||typeof ne.UNSAFE_componentWillMount!="function"&&typeof ne.componentWillMount!="function"||(typeof ne.componentWillMount=="function"&&ne.componentWillMount(),typeof ne.UNSAFE_componentWillMount=="function"&&ne.UNSAFE_componentWillMount()),typeof ne.componentDidMount=="function"&&(f.flags|=4194308)):(typeof ne.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=_,f.memoizedState=Ae),ne.props=_,ne.state=Ae,ne.context=Ge,_=Ne):(typeof ne.componentDidMount=="function"&&(f.flags|=4194308),_=!1)}else{ne=f.stateNode,q0(u,f),Ne=f.memoizedProps,Ge=f.type===f.elementType?Ne:Ro(f.type,Ne),ne.props=Ge,xt=f.pendingProps,ft=ne.context,Ae=g.contextType,typeof Ae=="object"&&Ae!==null?Ae=Jn(Ae):(Ae=pa(g)?lc:js.current,Ae=mu(f,Ae));var Rt=g.getDerivedStateFromProps;(ht=typeof Rt=="function"||typeof ne.getSnapshotBeforeUpdate=="function")||typeof ne.UNSAFE_componentWillReceiveProps!="function"&&typeof ne.componentWillReceiveProps!="function"||(Ne!==xt||ft!==Ae)&&Qy(f,ne,_,Ae),Ki=!1,ft=f.memoizedState,ne.state=ft,Fo(f,_,ne,C);var zt=f.memoizedState;Ne!==xt||ft!==zt||ha.current||Ki?(typeof Rt=="function"&&(Fg(f,g,Rt,_),zt=f.memoizedState),(Ge=Ki||Ky(f,g,Ge,_,ft,zt,Ae)||!1)?(ht||typeof ne.UNSAFE_componentWillUpdate!="function"&&typeof ne.componentWillUpdate!="function"||(typeof ne.componentWillUpdate=="function"&&ne.componentWillUpdate(_,zt,Ae),typeof ne.UNSAFE_componentWillUpdate=="function"&&ne.UNSAFE_componentWillUpdate(_,zt,Ae)),typeof ne.componentDidUpdate=="function"&&(f.flags|=4),typeof ne.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof ne.componentDidUpdate!="function"||Ne===u.memoizedProps&&ft===u.memoizedState||(f.flags|=4),typeof ne.getSnapshotBeforeUpdate!="function"||Ne===u.memoizedProps&&ft===u.memoizedState||(f.flags|=1024),f.memoizedProps=_,f.memoizedState=zt),ne.props=_,ne.state=zt,ne.context=Ae,_=Ge):(typeof ne.componentDidUpdate!="function"||Ne===u.memoizedProps&&ft===u.memoizedState||(f.flags|=4),typeof ne.getSnapshotBeforeUpdate!="function"||Ne===u.memoizedProps&&ft===u.memoizedState||(f.flags|=1024),_=!1)}return Ig(u,f,g,_,D,C)}function Ig(u,f,g,_,C,D){lb(u,f);var ne=(f.flags&128)!==0;if(!_&&!ne)return C&&Hp(f,g,!1),hc(u,f,D);_=f.stateNode,tj.current=f;var Ne=ne&&typeof g.getDerivedStateFromError!="function"?null:_.render();return f.flags|=1,u!==null&&ne?(f.child=os(f,u.child,null,D),f.child=os(f,null,Ne,D)):qa(u,f,Ne,D),f.memoizedState=_.state,C&&Hp(f,g,!0),f.child}function ub(u){var f=u.stateNode;f.pendingContext?zp(u,f.pendingContext,f.pendingContext!==f.context):f.context&&zp(u,f.context,!1),vu(u,f.containerInfo)}function db(u,f,g,_,C){return wr(),tn(C),f.flags|=256,qa(u,f,g,_),f.child}var Og={dehydrated:null,treeContext:null,retryLane:0};function Mg(u){return{baseLanes:u,cachePool:null,transitions:null}}function fb(u,f,g){var _=f.pendingProps,C=xn.current,D=!1,ne=(f.flags&128)!==0,Ne;if((Ne=ne)||(Ne=u!==null&&u.memoizedState===null?!1:(C&2)!==0),Ne?(D=!0,f.flags&=-129):(u===null||u.memoizedState!==null)&&(C|=1),rn(xn,C&1),u===null)return At(f),u=f.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((f.mode&1)===0?f.lanes=1:u.data==="$!"?f.lanes=8:f.lanes=1073741824,null):(ne=_.children,u=_.fallback,D?(_=f.mode,D=f.child,ne={mode:"hidden",children:ne},(_&1)===0&&D!==null?(D.childLanes=0,D.pendingProps=ne):D=cm(ne,_,0,null),u=Id(u,_,g,null),D.return=f,u.return=f,D.sibling=u,f.child=D,f.child.memoizedState=Mg(g),f.memoizedState=Og,u):Bg(f,ne));if(C=u.memoizedState,C!==null&&(Ne=C.dehydrated,Ne!==null))return rj(u,f,ne,_,Ne,C,g);if(D){D=_.fallback,ne=f.mode,C=u.child,Ne=C.sibling;var Ae={mode:"hidden",children:_.children};return(ne&1)===0&&f.child!==C?(_=f.child,_.childLanes=0,_.pendingProps=Ae,f.deletions=null):(_=Eu(C,Ae),_.subtreeFlags=C.subtreeFlags&14680064),Ne!==null?D=Eu(Ne,D):(D=Id(D,ne,g,null),D.flags|=2),D.return=f,_.return=f,_.sibling=D,f.child=_,_=D,D=f.child,ne=u.child.memoizedState,ne=ne===null?Mg(g):{baseLanes:ne.baseLanes|g,cachePool:null,transitions:ne.transitions},D.memoizedState=ne,D.childLanes=u.childLanes&~g,f.memoizedState=Og,_}return D=u.child,u=D.sibling,_=Eu(D,{mode:"visible",children:_.children}),(f.mode&1)===0&&(_.lanes=g),_.return=f,_.sibling=null,u!==null&&(g=f.deletions,g===null?(f.deletions=[u],f.flags|=16):g.push(u)),f.child=_,f.memoizedState=null,_}function Bg(u,f){return f=cm({mode:"visible",children:f},u.mode,0,null),f.return=u,u.child=f}function Kp(u,f,g,_){return _!==null&&tn(_),os(f,u.child,null,g),u=Bg(f,f.pendingProps.children),u.flags|=2,f.memoizedState=null,u}function rj(u,f,g,_,C,D,ne){if(g)return f.flags&256?(f.flags&=-257,_=Lg(Error(r(422))),Kp(u,f,ne,_)):f.memoizedState!==null?(f.child=u.child,f.flags|=128,null):(D=_.fallback,C=f.mode,_=cm({mode:"visible",children:_.children},C,0,null),D=Id(D,C,ne,null),D.flags|=2,_.return=f,D.return=f,_.sibling=D,f.child=_,(f.mode&1)!==0&&os(f,u.child,null,ne),f.child.memoizedState=Mg(ne),f.memoizedState=Og,D);if((f.mode&1)===0)return Kp(u,f,ne,null);if(C.data==="$!"){if(_=C.nextSibling&&C.nextSibling.dataset,_)var Ne=_.dgst;return _=Ne,D=Error(r(419)),_=Lg(D,_,void 0),Kp(u,f,ne,_)}if(Ne=(ne&u.childLanes)!==0,ii||Ne){if(_=Ms,_!==null){switch(ne&-ne){case 4:C=2;break;case 16:C=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:C=32;break;case 536870912:C=268435456;break;default:C=0}C=(C&(_.suspendedLanes|ne))!==0?0:C,C!==0&&C!==D.retryLane&&(D.retryLane=C,Gr(u,C),Mo(_,u,C,-1))}return t1(),_=Lg(Error(r(421))),Kp(u,f,ne,_)}return C.data==="$?"?(f.flags|=128,f.child=u.child,f=mj.bind(null,u),C._reactRetry=f,null):(u=D.treeContext,tt=Qs(C.nextSibling),Fe=f,et=!0,at=null,u!==null&&(de[ge++]=Oe,de[ge++]=Me,de[ge++]=Ee,Oe=u.id,Me=u.overflow,Ee=f),f=Bg(f,_.children),f.flags|=4096,f)}function hb(u,f,g){u.lanes|=f;var _=u.alternate;_!==null&&(_.lanes|=f),ri(u.return,f,g)}function Ug(u,f,g,_,C){var D=u.memoizedState;D===null?u.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:_,tail:g,tailMode:C}:(D.isBackwards=f,D.rendering=null,D.renderingStartTime=0,D.last=_,D.tail=g,D.tailMode=C)}function pb(u,f,g){var _=f.pendingProps,C=_.revealOrder,D=_.tail;if(qa(u,f,_.children,g),_=xn.current,(_&2)!==0)_=_&1|2,f.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=f.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&hb(u,g,f);else if(u.tag===19)hb(u,g,f);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===f)break e;for(;u.sibling===null;){if(u.return===null||u.return===f)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}_&=1}if(rn(xn,_),(f.mode&1)===0)f.memoizedState=null;else switch(C){case"forwards":for(g=f.child,C=null;g!==null;)u=g.alternate,u!==null&&ki(u)===null&&(C=g),g=g.sibling;g=C,g===null?(C=f.child,f.child=null):(C=g.sibling,g.sibling=null),Ug(f,!1,C,g,D);break;case"backwards":for(g=null,C=f.child,f.child=null;C!==null;){if(u=C.alternate,u!==null&&ki(u)===null){f.child=C;break}u=C.sibling,C.sibling=g,g=C,C=u}Ug(f,!0,g,null,D);break;case"together":Ug(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function Jp(u,f){(f.mode&1)===0&&u!==null&&(u.alternate=null,f.alternate=null,f.flags|=2)}function hc(u,f,g){if(u!==null&&(f.dependencies=u.dependencies),Pd|=f.lanes,(g&f.childLanes)===0)return null;if(u!==null&&f.child!==u.child)throw Error(r(153));if(f.child!==null){for(u=f.child,g=Eu(u,u.pendingProps),f.child=g,g.return=f;u.sibling!==null;)u=u.sibling,g=g.sibling=Eu(u,u.pendingProps),g.return=f;g.sibling=null}return f.child}function nj(u,f,g){switch(f.tag){case 3:ub(f),wr();break;case 5:$p(f);break;case 1:pa(f.type)&&cc(f);break;case 4:vu(f,f.stateNode.containerInfo);break;case 10:var _=f.type._context,C=f.memoizedProps.value;rn(Is,_._currentValue),_._currentValue=C;break;case 13:if(_=f.memoizedState,_!==null)return _.dehydrated!==null?(rn(xn,xn.current&1),f.flags|=128,null):(g&f.child.childLanes)!==0?fb(u,f,g):(rn(xn,xn.current&1),u=hc(u,f,g),u!==null?u.sibling:null);rn(xn,xn.current&1);break;case 19:if(_=(g&f.childLanes)!==0,(u.flags&128)!==0){if(_)return pb(u,f,g);f.flags|=128}if(C=f.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),rn(xn,xn.current),_)break;return null;case 22:case 23:return f.lanes=0,ob(u,f,g)}return hc(u,f,g)}var mb,zg,xb,gb;mb=function(u,f){for(var g=f.child;g!==null;){if(g.tag===5||g.tag===6)u.appendChild(g.stateNode);else if(g.tag!==4&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===f)break;for(;g.sibling===null;){if(g.return===null||g.return===f)return;g=g.return}g.sibling.return=g.return,g=g.sibling}},zg=function(){},xb=function(u,f,g,_){var C=u.memoizedProps;if(C!==_){u=f.stateNode,Po($a.current);var D=null;switch(g){case"input":C=rt(u,C),_=rt(u,_),D=[];break;case"select":C=fe({},C,{value:void 0}),_=fe({},_,{value:void 0}),D=[];break;case"textarea":C=vt(u,C),_=vt(u,_),D=[];break;default:typeof C.onClick!="function"&&typeof _.onClick=="function"&&(u.onclick=fu)}wt(g,_);var ne;g=null;for(Ge in C)if(!_.hasOwnProperty(Ge)&&C.hasOwnProperty(Ge)&&C[Ge]!=null)if(Ge==="style"){var Ne=C[Ge];for(ne in Ne)Ne.hasOwnProperty(ne)&&(g||(g={}),g[ne]="")}else Ge!=="dangerouslySetInnerHTML"&&Ge!=="children"&&Ge!=="suppressContentEditableWarning"&&Ge!=="suppressHydrationWarning"&&Ge!=="autoFocus"&&(s.hasOwnProperty(Ge)?D||(D=[]):(D=D||[]).push(Ge,null));for(Ge in _){var Ae=_[Ge];if(Ne=C?.[Ge],_.hasOwnProperty(Ge)&&Ae!==Ne&&(Ae!=null||Ne!=null))if(Ge==="style")if(Ne){for(ne in Ne)!Ne.hasOwnProperty(ne)||Ae&&Ae.hasOwnProperty(ne)||(g||(g={}),g[ne]="");for(ne in Ae)Ae.hasOwnProperty(ne)&&Ne[ne]!==Ae[ne]&&(g||(g={}),g[ne]=Ae[ne])}else g||(D||(D=[]),D.push(Ge,g)),g=Ae;else Ge==="dangerouslySetInnerHTML"?(Ae=Ae?Ae.__html:void 0,Ne=Ne?Ne.__html:void 0,Ae!=null&&Ne!==Ae&&(D=D||[]).push(Ge,Ae)):Ge==="children"?typeof Ae!="string"&&typeof Ae!="number"||(D=D||[]).push(Ge,""+Ae):Ge!=="suppressContentEditableWarning"&&Ge!=="suppressHydrationWarning"&&(s.hasOwnProperty(Ge)?(Ae!=null&&Ge==="onScroll"&&an("scroll",u),D||Ne===Ae||(D=[])):(D=D||[]).push(Ge,Ae))}g&&(D=D||[]).push("style",g);var Ge=D;(f.updateQueue=Ge)&&(f.flags|=4)}},gb=function(u,f,g,_){g!==_&&(f.flags|=4)};function Q0(u,f){if(!et)switch(u.tailMode){case"hidden":f=u.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?u.tail=null:g.sibling=null;break;case"collapsed":g=u.tail;for(var _=null;g!==null;)g.alternate!==null&&(_=g),g=g.sibling;_===null?f||u.tail===null?u.tail=null:u.tail.sibling=null:_.sibling=null}}function xa(u){var f=u.alternate!==null&&u.alternate.child===u.child,g=0,_=0;if(f)for(var C=u.child;C!==null;)g|=C.lanes|C.childLanes,_|=C.subtreeFlags&14680064,_|=C.flags&14680064,C.return=u,C=C.sibling;else for(C=u.child;C!==null;)g|=C.lanes|C.childLanes,_|=C.subtreeFlags,_|=C.flags,C.return=u,C=C.sibling;return u.subtreeFlags|=_,u.childLanes=g,f}function sj(u,f,g){var _=f.pendingProps;switch(Ce(f),f.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xa(f),null;case 1:return pa(f.type)&&Df(),xa(f),null;case 3:return _=f.stateNode,Ji(),en(ha),en(js),Y0(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(u===null||u.child===null)&&(Mr(f)?f.flags|=4:u===null||u.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,at!==null&&(Qg(at),at=null))),zg(u,f),xa(f),null;case 5:G0(f);var C=Po(vl.current);if(g=f.type,u!==null&&f.stateNode!=null)xb(u,f,g,_,C),u.ref!==f.ref&&(f.flags|=512,f.flags|=2097152);else{if(!_){if(f.stateNode===null)throw Error(r(166));return xa(f),null}if(u=Po($a.current),Mr(f)){_=f.stateNode,g=f.type;var D=f.memoizedProps;switch(_[Yi]=f,_[hu]=D,u=(f.mode&1)!==0,g){case"dialog":an("cancel",_),an("close",_);break;case"iframe":case"object":case"embed":an("load",_);break;case"video":case"audio":for(C=0;C<pl.length;C++)an(pl[C],_);break;case"source":an("error",_);break;case"img":case"image":case"link":an("error",_),an("load",_);break;case"details":an("toggle",_);break;case"input":De(_,D),an("invalid",_);break;case"select":_._wrapperState={wasMultiple:!!D.multiple},an("invalid",_);break;case"textarea":Pt(_,D),an("invalid",_)}wt(g,D),C=null;for(var ne in D)if(D.hasOwnProperty(ne)){var Ne=D[ne];ne==="children"?typeof Ne=="string"?_.textContent!==Ne&&(D.suppressHydrationWarning!==!0&&Lf(_.textContent,Ne,u),C=["children",Ne]):typeof Ne=="number"&&_.textContent!==""+Ne&&(D.suppressHydrationWarning!==!0&&Lf(_.textContent,Ne,u),C=["children",""+Ne]):s.hasOwnProperty(ne)&&Ne!=null&&ne==="onScroll"&&an("scroll",_)}switch(g){case"input":We(_),Re(_,D,!0);break;case"textarea":We(_),Ot(_);break;case"select":case"option":break;default:typeof D.onClick=="function"&&(_.onclick=fu)}_=C,f.updateQueue=_,_!==null&&(f.flags|=4)}else{ne=C.nodeType===9?C:C.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=Yt(g)),u==="http://www.w3.org/1999/xhtml"?g==="script"?(u=ne.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof _.is=="string"?u=ne.createElement(g,{is:_.is}):(u=ne.createElement(g),g==="select"&&(ne=u,_.multiple?ne.multiple=!0:_.size&&(ne.size=_.size))):u=ne.createElementNS(u,g),u[Yi]=f,u[hu]=_,mb(u,f,!1,!1),f.stateNode=u;e:{switch(ne=Wt(g,_),g){case"dialog":an("cancel",u),an("close",u),C=_;break;case"iframe":case"object":case"embed":an("load",u),C=_;break;case"video":case"audio":for(C=0;C<pl.length;C++)an(pl[C],u);C=_;break;case"source":an("error",u),C=_;break;case"img":case"image":case"link":an("error",u),an("load",u),C=_;break;case"details":an("toggle",u),C=_;break;case"input":De(u,_),C=rt(u,_),an("invalid",u);break;case"option":C=_;break;case"select":u._wrapperState={wasMultiple:!!_.multiple},C=fe({},_,{value:void 0}),an("invalid",u);break;case"textarea":Pt(u,_),C=vt(u,_),an("invalid",u);break;default:C=_}wt(g,C),Ne=C;for(D in Ne)if(Ne.hasOwnProperty(D)){var Ae=Ne[D];D==="style"?$t(u,Ae):D==="dangerouslySetInnerHTML"?(Ae=Ae?Ae.__html:void 0,Ae!=null&&It(u,Ae)):D==="children"?typeof Ae=="string"?(g!=="textarea"||Ae!=="")&&bt(u,Ae):typeof Ae=="number"&&bt(u,""+Ae):D!=="suppressContentEditableWarning"&&D!=="suppressHydrationWarning"&&D!=="autoFocus"&&(s.hasOwnProperty(D)?Ae!=null&&D==="onScroll"&&an("scroll",u):Ae!=null&&A(u,D,Ae,ne))}switch(g){case"input":We(u),Re(u,_,!1);break;case"textarea":We(u),Ot(u);break;case"option":_.value!=null&&u.setAttribute("value",""+me(_.value));break;case"select":u.multiple=!!_.multiple,D=_.value,D!=null?pt(u,!!_.multiple,D,!1):_.defaultValue!=null&&pt(u,!!_.multiple,_.defaultValue,!0);break;default:typeof C.onClick=="function"&&(u.onclick=fu)}switch(g){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}}_&&(f.flags|=4)}f.ref!==null&&(f.flags|=512,f.flags|=2097152)}return xa(f),null;case 6:if(u&&f.stateNode!=null)gb(u,f,u.memoizedProps,_);else{if(typeof _!="string"&&f.stateNode===null)throw Error(r(166));if(g=Po(vl.current),Po($a.current),Mr(f)){if(_=f.stateNode,g=f.memoizedProps,_[Yi]=f,(D=_.nodeValue!==g)&&(u=Fe,u!==null))switch(u.tag){case 3:Lf(_.nodeValue,g,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&Lf(_.nodeValue,g,(u.mode&1)!==0)}D&&(f.flags|=4)}else _=(g.nodeType===9?g:g.ownerDocument).createTextNode(_),_[Yi]=f,f.stateNode=_}return xa(f),null;case 13:if(en(xn),_=f.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(et&&tt!==null&&(f.mode&1)!==0&&(f.flags&128)===0)Pr(),wr(),f.flags|=98560,D=!1;else if(D=Mr(f),_!==null&&_.dehydrated!==null){if(u===null){if(!D)throw Error(r(318));if(D=f.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(r(317));D[Yi]=f}else wr(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;xa(f),D=!1}else at!==null&&(Qg(at),at=null),D=!0;if(!D)return f.flags&65536?f:null}return(f.flags&128)!==0?(f.lanes=g,f):(_=_!==null,_!==(u!==null&&u.memoizedState!==null)&&_&&(f.child.flags|=8192,(f.mode&1)!==0&&(u===null||(xn.current&1)!==0?As===0&&(As=3):t1())),f.updateQueue!==null&&(f.flags|=4),xa(f),null);case 4:return Ji(),zg(u,f),u===null&&sc(f.stateNode.containerInfo),xa(f),null;case 10:return ma(f.type._context),xa(f),null;case 17:return pa(f.type)&&Df(),xa(f),null;case 19:if(en(xn),D=f.memoizedState,D===null)return xa(f),null;if(_=(f.flags&128)!==0,ne=D.rendering,ne===null)if(_)Q0(D,!1);else{if(As!==0||u!==null&&(u.flags&128)!==0)for(u=f.child;u!==null;){if(ne=ki(u),ne!==null){for(f.flags|=128,Q0(D,!1),_=ne.updateQueue,_!==null&&(f.updateQueue=_,f.flags|=4),f.subtreeFlags=0,_=g,g=f.child;g!==null;)D=g,u=_,D.flags&=14680066,ne=D.alternate,ne===null?(D.childLanes=0,D.lanes=u,D.child=null,D.subtreeFlags=0,D.memoizedProps=null,D.memoizedState=null,D.updateQueue=null,D.dependencies=null,D.stateNode=null):(D.childLanes=ne.childLanes,D.lanes=ne.lanes,D.child=ne.child,D.subtreeFlags=0,D.deletions=null,D.memoizedProps=ne.memoizedProps,D.memoizedState=ne.memoizedState,D.updateQueue=ne.updateQueue,D.type=ne.type,u=ne.dependencies,D.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),g=g.sibling;return rn(xn,xn.current&1|2),f.child}u=u.sibling}D.tail!==null&&mt()>Xf&&(f.flags|=128,_=!0,Q0(D,!1),f.lanes=4194304)}else{if(!_)if(u=ki(ne),u!==null){if(f.flags|=128,_=!0,g=u.updateQueue,g!==null&&(f.updateQueue=g,f.flags|=4),Q0(D,!0),D.tail===null&&D.tailMode==="hidden"&&!ne.alternate&&!et)return xa(f),null}else 2*mt()-D.renderingStartTime>Xf&&g!==1073741824&&(f.flags|=128,_=!0,Q0(D,!1),f.lanes=4194304);D.isBackwards?(ne.sibling=f.child,f.child=ne):(g=D.last,g!==null?g.sibling=ne:f.child=ne,D.last=ne)}return D.tail!==null?(f=D.tail,D.rendering=f,D.tail=f.sibling,D.renderingStartTime=mt(),f.sibling=null,g=xn.current,rn(xn,_?g&1|2:g&1),f):(xa(f),null);case 22:case 23:return e1(),_=f.memoizedState!==null,u!==null&&u.memoizedState!==null!==_&&(f.flags|=8192),_&&(f.mode&1)!==0?(Ai&1073741824)!==0&&(xa(f),f.subtreeFlags&6&&(f.flags|=8192)):xa(f),null;case 24:return null;case 25:return null}throw Error(r(156,f.tag))}function aj(u,f){switch(Ce(f),f.tag){case 1:return pa(f.type)&&Df(),u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 3:return Ji(),en(ha),en(js),Y0(),u=f.flags,(u&65536)!==0&&(u&128)===0?(f.flags=u&-65537|128,f):null;case 5:return G0(f),null;case 13:if(en(xn),u=f.memoizedState,u!==null&&u.dehydrated!==null){if(f.alternate===null)throw Error(r(340));wr()}return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 19:return en(xn),null;case 4:return Ji(),null;case 10:return ma(f.type._context),null;case 22:case 23:return e1(),null;case 24:return null;default:return null}}var Qp=!1,ga=!1,ij=typeof WeakSet=="function"?WeakSet:Set,Bt=null;function qf(u,f){var g=u.ref;if(g!==null)if(typeof g=="function")try{g(null)}catch(_){Zn(u,f,_)}else g.current=null}function Hg(u,f,g){try{g()}catch(_){Zn(u,f,_)}}var vb=!1;function oj(u,f){if(jd=Gc,u=yd(),ec(u)){if("selectionStart"in u)var g={start:u.selectionStart,end:u.selectionEnd};else e:{g=(g=u.ownerDocument)&&g.defaultView||window;var _=g.getSelection&&g.getSelection();if(_&&_.rangeCount!==0){g=_.anchorNode;var C=_.anchorOffset,D=_.focusNode;_=_.focusOffset;try{g.nodeType,D.nodeType}catch{g=null;break e}var ne=0,Ne=-1,Ae=-1,Ge=0,ht=0,xt=u,ft=null;t:for(;;){for(var Rt;xt!==g||C!==0&&xt.nodeType!==3||(Ne=ne+C),xt!==D||_!==0&&xt.nodeType!==3||(Ae=ne+_),xt.nodeType===3&&(ne+=xt.nodeValue.length),(Rt=xt.firstChild)!==null;)ft=xt,xt=Rt;for(;;){if(xt===u)break t;if(ft===g&&++Ge===C&&(Ne=ne),ft===D&&++ht===_&&(Ae=ne),(Rt=xt.nextSibling)!==null)break;xt=ft,ft=xt.parentNode}xt=Rt}g=Ne===-1||Ae===-1?null:{start:Ne,end:Ae}}else g=null}g=g||{start:0,end:0}}else g=null;for(ic={focusedElem:u,selectionRange:g},Gc=!1,Bt=f;Bt!==null;)if(f=Bt,u=f.child,(f.subtreeFlags&1028)!==0&&u!==null)u.return=f,Bt=u;else for(;Bt!==null;){f=Bt;try{var zt=f.alternate;if((f.flags&1024)!==0)switch(f.tag){case 0:case 11:case 15:break;case 1:if(zt!==null){var qt=zt.memoizedProps,us=zt.memoizedState,ze=f.stateNode,Pe=ze.getSnapshotBeforeUpdate(f.elementType===f.type?qt:Ro(f.type,qt),us);ze.__reactInternalSnapshotBeforeUpdate=Pe}break;case 3:var Ve=f.stateNode.containerInfo;Ve.nodeType===1?Ve.textContent="":Ve.nodeType===9&&Ve.documentElement&&Ve.removeChild(Ve.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(_t){Zn(f,f.return,_t)}if(u=f.sibling,u!==null){u.return=f.return,Bt=u;break}Bt=f.return}return zt=vb,vb=!1,zt}function Z0(u,f,g){var _=f.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var C=_=_.next;do{if((C.tag&u)===u){var D=C.destroy;C.destroy=void 0,D!==void 0&&Hg(f,g,D)}C=C.next}while(C!==_)}}function Zp(u,f){if(f=f.updateQueue,f=f!==null?f.lastEffect:null,f!==null){var g=f=f.next;do{if((g.tag&u)===u){var _=g.create;g.destroy=_()}g=g.next}while(g!==f)}}function $g(u){var f=u.ref;if(f!==null){var g=u.stateNode;switch(u.tag){case 5:u=g;break;default:u=g}typeof f=="function"?f(u):f.current=u}}function yb(u){var f=u.alternate;f!==null&&(u.alternate=null,yb(f)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(f=u.stateNode,f!==null&&(delete f[Yi],delete f[hu],delete f[fa],delete f[Eg],delete f[Ag])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function bb(u){return u.tag===5||u.tag===3||u.tag===4}function wb(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||bb(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function Wg(u,f,g){var _=u.tag;if(_===5||_===6)u=u.stateNode,f?g.nodeType===8?g.parentNode.insertBefore(u,f):g.insertBefore(u,f):(g.nodeType===8?(f=g.parentNode,f.insertBefore(u,g)):(f=g,f.appendChild(u)),g=g._reactRootContainer,g!=null||f.onclick!==null||(f.onclick=fu));else if(_!==4&&(u=u.child,u!==null))for(Wg(u,f,g),u=u.sibling;u!==null;)Wg(u,f,g),u=u.sibling}function Vg(u,f,g){var _=u.tag;if(_===5||_===6)u=u.stateNode,f?g.insertBefore(u,f):g.appendChild(u);else if(_!==4&&(u=u.child,u!==null))for(Vg(u,f,g),u=u.sibling;u!==null;)Vg(u,f,g),u=u.sibling}var ea=null,Io=!1;function _u(u,f,g){for(g=g.child;g!==null;)_b(u,f,g),g=g.sibling}function _b(u,f,g){if(Xn&&typeof Xn.onCommitFiberUnmount=="function")try{Xn.onCommitFiberUnmount(Oa,g)}catch{}switch(g.tag){case 5:ga||qf(g,f);case 6:var _=ea,C=Io;ea=null,_u(u,f,g),ea=_,Io=C,ea!==null&&(Io?(u=ea,g=g.stateNode,u.nodeType===8?u.parentNode.removeChild(g):u.removeChild(g)):ea.removeChild(g.stateNode));break;case 18:ea!==null&&(Io?(u=ea,g=g.stateNode,u.nodeType===8?$0(u.parentNode,g):u.nodeType===1&&$0(u,g),bi(u)):$0(ea,g.stateNode));break;case 4:_=ea,C=Io,ea=g.stateNode.containerInfo,Io=!0,_u(u,f,g),ea=_,Io=C;break;case 0:case 11:case 14:case 15:if(!ga&&(_=g.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){C=_=_.next;do{var D=C,ne=D.destroy;D=D.tag,ne!==void 0&&((D&2)!==0||(D&4)!==0)&&Hg(g,f,ne),C=C.next}while(C!==_)}_u(u,f,g);break;case 1:if(!ga&&(qf(g,f),_=g.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=g.memoizedProps,_.state=g.memoizedState,_.componentWillUnmount()}catch(Ne){Zn(g,f,Ne)}_u(u,f,g);break;case 21:_u(u,f,g);break;case 22:g.mode&1?(ga=(_=ga)||g.memoizedState!==null,_u(u,f,g),ga=_):_u(u,f,g);break;default:_u(u,f,g)}}function Nb(u){var f=u.updateQueue;if(f!==null){u.updateQueue=null;var g=u.stateNode;g===null&&(g=u.stateNode=new ij),f.forEach(function(_){var C=xj.bind(null,u,_);g.has(_)||(g.add(_),_.then(C,C))})}}function Oo(u,f){var g=f.deletions;if(g!==null)for(var _=0;_<g.length;_++){var C=g[_];try{var D=u,ne=f,Ne=ne;e:for(;Ne!==null;){switch(Ne.tag){case 5:ea=Ne.stateNode,Io=!1;break e;case 3:ea=Ne.stateNode.containerInfo,Io=!0;break e;case 4:ea=Ne.stateNode.containerInfo,Io=!0;break e}Ne=Ne.return}if(ea===null)throw Error(r(160));_b(D,ne,C),ea=null,Io=!1;var Ae=C.alternate;Ae!==null&&(Ae.return=null),C.return=null}catch(Ge){Zn(C,f,Ge)}}if(f.subtreeFlags&12854)for(f=f.child;f!==null;)Sb(f,u),f=f.sibling}function Sb(u,f){var g=u.alternate,_=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(Oo(f,u),bl(u),_&4){try{Z0(3,u,u.return),Zp(3,u)}catch(qt){Zn(u,u.return,qt)}try{Z0(5,u,u.return)}catch(qt){Zn(u,u.return,qt)}}break;case 1:Oo(f,u),bl(u),_&512&&g!==null&&qf(g,g.return);break;case 5:if(Oo(f,u),bl(u),_&512&&g!==null&&qf(g,g.return),u.flags&32){var C=u.stateNode;try{bt(C,"")}catch(qt){Zn(u,u.return,qt)}}if(_&4&&(C=u.stateNode,C!=null)){var D=u.memoizedProps,ne=g!==null?g.memoizedProps:D,Ne=u.type,Ae=u.updateQueue;if(u.updateQueue=null,Ae!==null)try{Ne==="input"&&D.type==="radio"&&D.name!=null&&ve(C,D),Wt(Ne,ne);var Ge=Wt(Ne,D);for(ne=0;ne<Ae.length;ne+=2){var ht=Ae[ne],xt=Ae[ne+1];ht==="style"?$t(C,xt):ht==="dangerouslySetInnerHTML"?It(C,xt):ht==="children"?bt(C,xt):A(C,ht,xt,Ge)}switch(Ne){case"input":Xe(C,D);break;case"textarea":Dt(C,D);break;case"select":var ft=C._wrapperState.wasMultiple;C._wrapperState.wasMultiple=!!D.multiple;var Rt=D.value;Rt!=null?pt(C,!!D.multiple,Rt,!1):ft!==!!D.multiple&&(D.defaultValue!=null?pt(C,!!D.multiple,D.defaultValue,!0):pt(C,!!D.multiple,D.multiple?[]:"",!1))}C[hu]=D}catch(qt){Zn(u,u.return,qt)}}break;case 6:if(Oo(f,u),bl(u),_&4){if(u.stateNode===null)throw Error(r(162));C=u.stateNode,D=u.memoizedProps;try{C.nodeValue=D}catch(qt){Zn(u,u.return,qt)}}break;case 3:if(Oo(f,u),bl(u),_&4&&g!==null&&g.memoizedState.isDehydrated)try{bi(f.containerInfo)}catch(qt){Zn(u,u.return,qt)}break;case 4:Oo(f,u),bl(u);break;case 13:Oo(f,u),bl(u),C=u.child,C.flags&8192&&(D=C.memoizedState!==null,C.stateNode.isHidden=D,!D||C.alternate!==null&&C.alternate.memoizedState!==null||(Xg=mt())),_&4&&Nb(u);break;case 22:if(ht=g!==null&&g.memoizedState!==null,u.mode&1?(ga=(Ge=ga)||ht,Oo(f,u),ga=Ge):Oo(f,u),bl(u),_&8192){if(Ge=u.memoizedState!==null,(u.stateNode.isHidden=Ge)&&!ht&&(u.mode&1)!==0)for(Bt=u,ht=u.child;ht!==null;){for(xt=Bt=ht;Bt!==null;){switch(ft=Bt,Rt=ft.child,ft.tag){case 0:case 11:case 14:case 15:Z0(4,ft,ft.return);break;case 1:qf(ft,ft.return);var zt=ft.stateNode;if(typeof zt.componentWillUnmount=="function"){_=ft,g=ft.return;try{f=_,zt.props=f.memoizedProps,zt.state=f.memoizedState,zt.componentWillUnmount()}catch(qt){Zn(_,g,qt)}}break;case 5:qf(ft,ft.return);break;case 22:if(ft.memoizedState!==null){Eb(xt);continue}}Rt!==null?(Rt.return=ft,Bt=Rt):Eb(xt)}ht=ht.sibling}e:for(ht=null,xt=u;;){if(xt.tag===5){if(ht===null){ht=xt;try{C=xt.stateNode,Ge?(D=C.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none"):(Ne=xt.stateNode,Ae=xt.memoizedProps.style,ne=Ae!=null&&Ae.hasOwnProperty("display")?Ae.display:null,Ne.style.display=ke("display",ne))}catch(qt){Zn(u,u.return,qt)}}}else if(xt.tag===6){if(ht===null)try{xt.stateNode.nodeValue=Ge?"":xt.memoizedProps}catch(qt){Zn(u,u.return,qt)}}else if((xt.tag!==22&&xt.tag!==23||xt.memoizedState===null||xt===u)&&xt.child!==null){xt.child.return=xt,xt=xt.child;continue}if(xt===u)break e;for(;xt.sibling===null;){if(xt.return===null||xt.return===u)break e;ht===xt&&(ht=null),xt=xt.return}ht===xt&&(ht=null),xt.sibling.return=xt.return,xt=xt.sibling}}break;case 19:Oo(f,u),bl(u),_&4&&Nb(u);break;case 21:break;default:Oo(f,u),bl(u)}}function bl(u){var f=u.flags;if(f&2){try{e:{for(var g=u.return;g!==null;){if(bb(g)){var _=g;break e}g=g.return}throw Error(r(160))}switch(_.tag){case 5:var C=_.stateNode;_.flags&32&&(bt(C,""),_.flags&=-33);var D=wb(u);Vg(u,D,C);break;case 3:case 4:var ne=_.stateNode.containerInfo,Ne=wb(u);Wg(u,Ne,ne);break;default:throw Error(r(161))}}catch(Ae){Zn(u,u.return,Ae)}u.flags&=-3}f&4096&&(u.flags&=-4097)}function lj(u,f,g){Bt=u,kb(u)}function kb(u,f,g){for(var _=(u.mode&1)!==0;Bt!==null;){var C=Bt,D=C.child;if(C.tag===22&&_){var ne=C.memoizedState!==null||Qp;if(!ne){var Ne=C.alternate,Ae=Ne!==null&&Ne.memoizedState!==null||ga;Ne=Qp;var Ge=ga;if(Qp=ne,(ga=Ae)&&!Ge)for(Bt=C;Bt!==null;)ne=Bt,Ae=ne.child,ne.tag===22&&ne.memoizedState!==null?Ab(C):Ae!==null?(Ae.return=ne,Bt=Ae):Ab(C);for(;D!==null;)Bt=D,kb(D),D=D.sibling;Bt=C,Qp=Ne,ga=Ge}jb(u)}else(C.subtreeFlags&8772)!==0&&D!==null?(D.return=C,Bt=D):jb(u)}}function jb(u){for(;Bt!==null;){var f=Bt;if((f.flags&8772)!==0){var g=f.alternate;try{if((f.flags&8772)!==0)switch(f.tag){case 0:case 11:case 15:ga||Zp(5,f);break;case 1:var _=f.stateNode;if(f.flags&4&&!ga)if(g===null)_.componentDidMount();else{var C=f.elementType===f.type?g.memoizedProps:Ro(f.type,g.memoizedProps);_.componentDidUpdate(C,g.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var D=f.updateQueue;D!==null&&dc(f,D,_);break;case 3:var ne=f.updateQueue;if(ne!==null){if(g=null,f.child!==null)switch(f.child.tag){case 5:g=f.child.stateNode;break;case 1:g=f.child.stateNode}dc(f,ne,g)}break;case 5:var Ne=f.stateNode;if(g===null&&f.flags&4){g=Ne;var Ae=f.memoizedProps;switch(f.type){case"button":case"input":case"select":case"textarea":Ae.autoFocus&&g.focus();break;case"img":Ae.src&&(g.src=Ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(f.memoizedState===null){var Ge=f.alternate;if(Ge!==null){var ht=Ge.memoizedState;if(ht!==null){var xt=ht.dehydrated;xt!==null&&bi(xt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}ga||f.flags&512&&$g(f)}catch(ft){Zn(f,f.return,ft)}}if(f===u){Bt=null;break}if(g=f.sibling,g!==null){g.return=f.return,Bt=g;break}Bt=f.return}}function Eb(u){for(;Bt!==null;){var f=Bt;if(f===u){Bt=null;break}var g=f.sibling;if(g!==null){g.return=f.return,Bt=g;break}Bt=f.return}}function Ab(u){for(;Bt!==null;){var f=Bt;try{switch(f.tag){case 0:case 11:case 15:var g=f.return;try{Zp(4,f)}catch(Ae){Zn(f,g,Ae)}break;case 1:var _=f.stateNode;if(typeof _.componentDidMount=="function"){var C=f.return;try{_.componentDidMount()}catch(Ae){Zn(f,C,Ae)}}var D=f.return;try{$g(f)}catch(Ae){Zn(f,D,Ae)}break;case 5:var ne=f.return;try{$g(f)}catch(Ae){Zn(f,ne,Ae)}}}catch(Ae){Zn(f,f.return,Ae)}if(f===u){Bt=null;break}var Ne=f.sibling;if(Ne!==null){Ne.return=f.return,Bt=Ne;break}Bt=f.return}}var cj=Math.ceil,em=z.ReactCurrentDispatcher,qg=z.ReactCurrentOwner,eo=z.ReactCurrentBatchConfig,$r=0,Ms=null,bs=null,ta=0,Ai=0,Gf=Si(0),As=0,eh=null,Pd=0,tm=0,Gg=0,th=null,oi=null,Xg=0,Xf=1/0,pc=null,rm=!1,Yg=null,Nu=null,nm=!1,Su=null,sm=0,rh=0,Kg=null,am=-1,im=0;function Ga(){return($r&6)!==0?mt():am!==-1?am:am=mt()}function ku(u){return(u.mode&1)===0?1:($r&2)!==0&&ta!==0?ta&-ta:nn.transition!==null?(im===0&&(im=ld()),im):(u=zr,u!==0||(u=window.event,u=u===void 0?16:hd(u.type)),u)}function Mo(u,f,g,_){if(50<rh)throw rh=0,Kg=null,Error(r(185));rl(u,g,_),(($r&2)===0||u!==Ms)&&(u===Ms&&(($r&2)===0&&(tm|=g),As===4&&ju(u,ta)),li(u,_),g===1&&$r===0&&(f.mode&1)===0&&(Xf=mt()+500,Ad&&U()))}function li(u,f){var g=u.callbackNode;la(u,f);var _=oa(u,u===Ms?ta:0);if(_===0)g!==null&&Nt(g),u.callbackNode=null,u.callbackPriority=0;else if(f=_&-_,u.callbackPriority!==f){if(g!=null&&Nt(g),f===1)u.tag===0?T(Tb.bind(null,u)):N(Tb.bind(null,u)),kg(function(){($r&6)===0&&U()}),g=null;else{switch($c(_)){case 1:g=Ir;break;case 4:g=Qr;break;case 16:g=_n;break;case 536870912:g=Mi;break;default:g=_n}g=Mb(g,Cb.bind(null,u))}u.callbackPriority=f,u.callbackNode=g}}function Cb(u,f){if(am=-1,im=0,($r&6)!==0)throw Error(r(327));var g=u.callbackNode;if(Yf()&&u.callbackNode!==g)return null;var _=oa(u,u===Ms?ta:0);if(_===0)return null;if((_&30)!==0||(_&u.expiredLanes)!==0||f)f=om(u,_);else{f=_;var C=$r;$r|=2;var D=Pb();(Ms!==u||ta!==f)&&(pc=null,Xf=mt()+500,Dd(u,f));do try{fj();break}catch(Ne){Fb(u,Ne)}while(!0);Es(),em.current=D,$r=C,bs!==null?f=0:(Ms=null,ta=0,f=As)}if(f!==0){if(f===2&&(C=Hl(u),C!==0&&(_=C,f=Jg(u,C))),f===1)throw g=eh,Dd(u,0),ju(u,_),li(u,mt()),g;if(f===6)ju(u,_);else{if(C=u.current.alternate,(_&30)===0&&!uj(C)&&(f=om(u,_),f===2&&(D=Hl(u),D!==0&&(_=D,f=Jg(u,D))),f===1))throw g=eh,Dd(u,0),ju(u,_),li(u,mt()),g;switch(u.finishedWork=C,u.finishedLanes=_,f){case 0:case 1:throw Error(r(345));case 2:Rd(u,oi,pc);break;case 3:if(ju(u,_),(_&130023424)===_&&(f=Xg+500-mt(),10<f)){if(oa(u,0)!==0)break;if(C=u.suspendedLanes,(C&_)!==_){Ga(),u.pingedLanes|=u.suspendedLanes&C;break}u.timeoutHandle=H0(Rd.bind(null,u,oi,pc),f);break}Rd(u,oi,pc);break;case 4:if(ju(u,_),(_&4194240)===_)break;for(f=u.eventTimes,C=-1;0<_;){var ne=31-Nn(_);D=1<<ne,ne=f[ne],ne>C&&(C=ne),_&=~D}if(_=C,_=mt()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*cj(_/1960))-_,10<_){u.timeoutHandle=H0(Rd.bind(null,u,oi,pc),_);break}Rd(u,oi,pc);break;case 5:Rd(u,oi,pc);break;default:throw Error(r(329))}}}return li(u,mt()),u.callbackNode===g?Cb.bind(null,u):null}function Jg(u,f){var g=th;return u.current.memoizedState.isDehydrated&&(Dd(u,f).flags|=256),u=om(u,f),u!==2&&(f=oi,oi=g,f!==null&&Qg(f)),u}function Qg(u){oi===null?oi=u:oi.push.apply(oi,u)}function uj(u){for(var f=u;;){if(f.flags&16384){var g=f.updateQueue;if(g!==null&&(g=g.stores,g!==null))for(var _=0;_<g.length;_++){var C=g[_],D=C.getSnapshot;C=C.value;try{if(!Hr(D(),C))return!1}catch{return!1}}}if(g=f.child,f.subtreeFlags&16384&&g!==null)g.return=f,f=g;else{if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function ju(u,f){for(f&=~Gg,f&=~tm,u.suspendedLanes|=f,u.pingedLanes&=~f,u=u.expirationTimes;0<f;){var g=31-Nn(f),_=1<<g;u[g]=-1,f&=~_}}function Tb(u){if(($r&6)!==0)throw Error(r(327));Yf();var f=oa(u,0);if((f&1)===0)return li(u,mt()),null;var g=om(u,f);if(u.tag!==0&&g===2){var _=Hl(u);_!==0&&(f=_,g=Jg(u,_))}if(g===1)throw g=eh,Dd(u,0),ju(u,f),li(u,mt()),g;if(g===6)throw Error(r(345));return u.finishedWork=u.current.alternate,u.finishedLanes=f,Rd(u,oi,pc),li(u,mt()),null}function Zg(u,f){var g=$r;$r|=1;try{return u(f)}finally{$r=g,$r===0&&(Xf=mt()+500,Ad&&U())}}function Ld(u){Su!==null&&Su.tag===0&&($r&6)===0&&Yf();var f=$r;$r|=1;var g=eo.transition,_=zr;try{if(eo.transition=null,zr=1,u)return u()}finally{zr=_,eo.transition=g,$r=f,($r&6)===0&&U()}}function e1(){Ai=Gf.current,en(Gf)}function Dd(u,f){u.finishedWork=null,u.finishedLanes=0;var g=u.timeoutHandle;if(g!==-1&&(u.timeoutHandle=-1,Bp(g)),bs!==null)for(g=bs.return;g!==null;){var _=g;switch(Ce(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&Df();break;case 3:Ji(),en(ha),en(js),Y0();break;case 5:G0(_);break;case 4:Ji();break;case 13:en(xn);break;case 19:en(xn);break;case 10:ma(_.type._context);break;case 22:case 23:e1()}g=g.return}if(Ms=u,bs=u=Eu(u.current,null),ta=Ai=f,As=0,eh=null,Gg=tm=Pd=0,oi=th=null,Ha!==null){for(f=0;f<Ha.length;f++)if(g=Ha[f],_=g.interleaved,_!==null){g.interleaved=null;var C=_.next,D=g.pending;if(D!==null){var ne=D.next;D.next=C,_.next=ne}g.pending=_}Ha=null}return u}function Fb(u,f){do{var g=bs;try{if(Es(),If.current=Xp,yu){for(var _=bn.memoizedState;_!==null;){var C=_.queue;C!==null&&(C.pending=null),_=_.next}yu=!1}if(Qi=0,Wn=Qn=bn=null,Lo=!1,bu=0,qg.current=null,g===null||g.return===null){As=1,eh=f,bs=null;break}e:{var D=u,ne=g.return,Ne=g,Ae=f;if(f=ta,Ne.flags|=32768,Ae!==null&&typeof Ae=="object"&&typeof Ae.then=="function"){var Ge=Ae,ht=Ne,xt=ht.tag;if((ht.mode&1)===0&&(xt===0||xt===11||xt===15)){var ft=ht.alternate;ft?(ht.updateQueue=ft.updateQueue,ht.memoizedState=ft.memoizedState,ht.lanes=ft.lanes):(ht.updateQueue=null,ht.memoizedState=null)}var Rt=rb(ne);if(Rt!==null){Rt.flags&=-257,nb(Rt,ne,Ne,D,f),Rt.mode&1&&tb(D,Ge,f),f=Rt,Ae=Ge;var zt=f.updateQueue;if(zt===null){var qt=new Set;qt.add(Ae),f.updateQueue=qt}else zt.add(Ae);break e}else{if((f&1)===0){tb(D,Ge,f),t1();break e}Ae=Error(r(426))}}else if(et&&Ne.mode&1){var us=rb(ne);if(us!==null){(us.flags&65536)===0&&(us.flags|=256),nb(us,ne,Ne,D,f),tn(Vf(Ae,Ne));break e}}D=Ae=Vf(Ae,Ne),As!==4&&(As=2),th===null?th=[D]:th.push(D),D=ne;do{switch(D.tag){case 3:D.flags|=65536,f&=-f,D.lanes|=f;var ze=Zy(D,Ae,f);ai(D,ze);break e;case 1:Ne=Ae;var Pe=D.type,Ve=D.stateNode;if((D.flags&128)===0&&(typeof Pe.getDerivedStateFromError=="function"||Ve!==null&&typeof Ve.componentDidCatch=="function"&&(Nu===null||!Nu.has(Ve)))){D.flags|=65536,f&=-f,D.lanes|=f;var _t=eb(D,Ne,f);ai(D,_t);break e}}D=D.return}while(D!==null)}Db(g)}catch(Xt){f=Xt,bs===g&&g!==null&&(bs=g=g.return);continue}break}while(!0)}function Pb(){var u=em.current;return em.current=Xp,u===null?Xp:u}function t1(){(As===0||As===3||As===2)&&(As=4),Ms===null||(Pd&268435455)===0&&(tm&268435455)===0||ju(Ms,ta)}function om(u,f){var g=$r;$r|=2;var _=Pb();(Ms!==u||ta!==f)&&(pc=null,Dd(u,f));do try{dj();break}catch(C){Fb(u,C)}while(!0);if(Es(),$r=g,em.current=_,bs!==null)throw Error(r(261));return Ms=null,ta=0,As}function dj(){for(;bs!==null;)Lb(bs)}function fj(){for(;bs!==null&&!Ct();)Lb(bs)}function Lb(u){var f=Ob(u.alternate,u,Ai);u.memoizedProps=u.pendingProps,f===null?Db(u):bs=f,qg.current=null}function Db(u){var f=u;do{var g=f.alternate;if(u=f.return,(f.flags&32768)===0){if(g=sj(g,f,Ai),g!==null){bs=g;return}}else{if(g=aj(g,f),g!==null){g.flags&=32767,bs=g;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{As=6,bs=null;return}}if(f=f.sibling,f!==null){bs=f;return}bs=f=u}while(f!==null);As===0&&(As=5)}function Rd(u,f,g){var _=zr,C=eo.transition;try{eo.transition=null,zr=1,hj(u,f,g,_)}finally{eo.transition=C,zr=_}return null}function hj(u,f,g,_){do Yf();while(Su!==null);if(($r&6)!==0)throw Error(r(327));g=u.finishedWork;var C=u.finishedLanes;if(g===null)return null;if(u.finishedWork=null,u.finishedLanes=0,g===u.current)throw Error(r(177));u.callbackNode=null,u.callbackPriority=0;var D=g.lanes|g.childLanes;if(M0(u,D),u===Ms&&(bs=Ms=null,ta=0),(g.subtreeFlags&2064)===0&&(g.flags&2064)===0||nm||(nm=!0,Mb(_n,function(){return Yf(),null})),D=(g.flags&15990)!==0,(g.subtreeFlags&15990)!==0||D){D=eo.transition,eo.transition=null;var ne=zr;zr=1;var Ne=$r;$r|=4,qg.current=null,oj(u,g),Sb(g,u),tc(ic),Gc=!!jd,ic=jd=null,u.current=g,lj(g),gt(),$r=Ne,zr=ne,eo.transition=D}else u.current=g;if(nm&&(nm=!1,Su=u,sm=C),D=u.pendingLanes,D===0&&(Nu=null),Bi(g.stateNode),li(u,mt()),f!==null)for(_=u.onRecoverableError,g=0;g<f.length;g++)C=f[g],_(C.value,{componentStack:C.stack,digest:C.digest});if(rm)throw rm=!1,u=Yg,Yg=null,u;return(sm&1)!==0&&u.tag!==0&&Yf(),D=u.pendingLanes,(D&1)!==0?u===Kg?rh++:(rh=0,Kg=u):rh=0,U(),null}function Yf(){if(Su!==null){var u=$c(sm),f=eo.transition,g=zr;try{if(eo.transition=null,zr=16>u?16:u,Su===null)var _=!1;else{if(u=Su,Su=null,sm=0,($r&6)!==0)throw Error(r(331));var C=$r;for($r|=4,Bt=u.current;Bt!==null;){var D=Bt,ne=D.child;if((Bt.flags&16)!==0){var Ne=D.deletions;if(Ne!==null){for(var Ae=0;Ae<Ne.length;Ae++){var Ge=Ne[Ae];for(Bt=Ge;Bt!==null;){var ht=Bt;switch(ht.tag){case 0:case 11:case 15:Z0(8,ht,D)}var xt=ht.child;if(xt!==null)xt.return=ht,Bt=xt;else for(;Bt!==null;){ht=Bt;var ft=ht.sibling,Rt=ht.return;if(yb(ht),ht===Ge){Bt=null;break}if(ft!==null){ft.return=Rt,Bt=ft;break}Bt=Rt}}}var zt=D.alternate;if(zt!==null){var qt=zt.child;if(qt!==null){zt.child=null;do{var us=qt.sibling;qt.sibling=null,qt=us}while(qt!==null)}}Bt=D}}if((D.subtreeFlags&2064)!==0&&ne!==null)ne.return=D,Bt=ne;else e:for(;Bt!==null;){if(D=Bt,(D.flags&2048)!==0)switch(D.tag){case 0:case 11:case 15:Z0(9,D,D.return)}var ze=D.sibling;if(ze!==null){ze.return=D.return,Bt=ze;break e}Bt=D.return}}var Pe=u.current;for(Bt=Pe;Bt!==null;){ne=Bt;var Ve=ne.child;if((ne.subtreeFlags&2064)!==0&&Ve!==null)Ve.return=ne,Bt=Ve;else e:for(ne=Pe;Bt!==null;){if(Ne=Bt,(Ne.flags&2048)!==0)try{switch(Ne.tag){case 0:case 11:case 15:Zp(9,Ne)}}catch(Xt){Zn(Ne,Ne.return,Xt)}if(Ne===ne){Bt=null;break e}var _t=Ne.sibling;if(_t!==null){_t.return=Ne.return,Bt=_t;break e}Bt=Ne.return}}if($r=C,U(),Xn&&typeof Xn.onPostCommitFiberRoot=="function")try{Xn.onPostCommitFiberRoot(Oa,u)}catch{}_=!0}return _}finally{zr=g,eo.transition=f}}return!1}function Rb(u,f,g){f=Vf(g,f),f=Zy(u,f,1),u=si(u,f,1),f=Ga(),u!==null&&(rl(u,1,f),li(u,f))}function Zn(u,f,g){if(u.tag===3)Rb(u,u,g);else for(;f!==null;){if(f.tag===3){Rb(f,u,g);break}else if(f.tag===1){var _=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(Nu===null||!Nu.has(_))){u=Vf(g,u),u=eb(f,u,1),f=si(f,u,1),u=Ga(),f!==null&&(rl(f,1,u),li(f,u));break}}f=f.return}}function pj(u,f,g){var _=u.pingCache;_!==null&&_.delete(f),f=Ga(),u.pingedLanes|=u.suspendedLanes&g,Ms===u&&(ta&g)===g&&(As===4||As===3&&(ta&130023424)===ta&&500>mt()-Xg?Dd(u,0):Gg|=g),li(u,f)}function Ib(u,f){f===0&&((u.mode&1)===0?f=1:(f=tl,tl<<=1,(tl&130023424)===0&&(tl=4194304)));var g=Ga();u=Gr(u,f),u!==null&&(rl(u,f,g),li(u,g))}function mj(u){var f=u.memoizedState,g=0;f!==null&&(g=f.retryLane),Ib(u,g)}function xj(u,f){var g=0;switch(u.tag){case 13:var _=u.stateNode,C=u.memoizedState;C!==null&&(g=C.retryLane);break;case 19:_=u.stateNode;break;default:throw Error(r(314))}_!==null&&_.delete(f),Ib(u,g)}var Ob;Ob=function(u,f,g){if(u!==null)if(u.memoizedProps!==f.pendingProps||ha.current)ii=!0;else{if((u.lanes&g)===0&&(f.flags&128)===0)return ii=!1,nj(u,f,g);ii=(u.flags&131072)!==0}else ii=!1,et&&(f.flags&1048576)!==0&&ot(f,ce,f.index);switch(f.lanes=0,f.tag){case 2:var _=f.type;Jp(u,f),u=f.pendingProps;var C=mu(f,js.current);An(f,g),C=Cd(null,f,_,u,C,g);var D=Zi();return f.flags|=1,typeof C=="object"&&C!==null&&typeof C.render=="function"&&C.$$typeof===void 0?(f.tag=1,f.memoizedState=null,f.updateQueue=null,pa(_)?(D=!0,cc(f)):D=!1,f.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,Rf(f),C.updater=Yp,f.stateNode=C,C._reactInternals=f,Pg(f,_,u,g),f=Ig(null,f,_,!0,D,g)):(f.tag=0,et&&D&&Ye(f),qa(null,f,C,g),f=f.child),f;case 16:_=f.elementType;e:{switch(Jp(u,f),u=f.pendingProps,C=_._init,_=C(_._payload),f.type=_,C=f.tag=vj(_),u=Ro(_,u),C){case 0:f=Rg(null,f,_,u,g);break e;case 1:f=cb(null,f,_,u,g);break e;case 11:f=sb(null,f,_,u,g);break e;case 14:f=ab(null,f,_,Ro(_.type,u),g);break e}throw Error(r(306,_,""))}return f;case 0:return _=f.type,C=f.pendingProps,C=f.elementType===_?C:Ro(_,C),Rg(u,f,_,C,g);case 1:return _=f.type,C=f.pendingProps,C=f.elementType===_?C:Ro(_,C),cb(u,f,_,C,g);case 3:e:{if(ub(f),u===null)throw Error(r(387));_=f.pendingProps,D=f.memoizedState,C=D.element,q0(u,f),Fo(f,_,null,g);var ne=f.memoizedState;if(_=ne.element,D.isDehydrated)if(D={element:_,isDehydrated:!1,cache:ne.cache,pendingSuspenseBoundaries:ne.pendingSuspenseBoundaries,transitions:ne.transitions},f.updateQueue.baseState=D,f.memoizedState=D,f.flags&256){C=Vf(Error(r(423)),f),f=db(u,f,_,g,C);break e}else if(_!==C){C=Vf(Error(r(424)),f),f=db(u,f,_,g,C);break e}else for(tt=Qs(f.stateNode.containerInfo.firstChild),Fe=f,et=!0,at=null,g=qr(f,null,_,g),f.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(wr(),_===C){f=hc(u,f,g);break e}qa(u,f,_,g)}f=f.child}return f;case 5:return $p(f),u===null&&At(f),_=f.type,C=f.pendingProps,D=u!==null?u.memoizedProps:null,ne=C.children,z0(_,C)?ne=null:D!==null&&z0(_,D)&&(f.flags|=32),lb(u,f),qa(u,f,ne,g),f.child;case 6:return u===null&&At(f),null;case 13:return fb(u,f,g);case 4:return vu(f,f.stateNode.containerInfo),_=f.pendingProps,u===null?f.child=os(f,null,_,g):qa(u,f,_,g),f.child;case 11:return _=f.type,C=f.pendingProps,C=f.elementType===_?C:Ro(_,C),sb(u,f,_,C,g);case 7:return qa(u,f,f.pendingProps,g),f.child;case 8:return qa(u,f,f.pendingProps.children,g),f.child;case 12:return qa(u,f,f.pendingProps.children,g),f.child;case 10:e:{if(_=f.type._context,C=f.pendingProps,D=f.memoizedProps,ne=C.value,rn(Is,_._currentValue),_._currentValue=ne,D!==null)if(Hr(D.value,ne)){if(D.children===C.children&&!ha.current){f=hc(u,f,g);break e}}else for(D=f.child,D!==null&&(D.return=f);D!==null;){var Ne=D.dependencies;if(Ne!==null){ne=D.child;for(var Ae=Ne.firstContext;Ae!==null;){if(Ae.context===_){if(D.tag===1){Ae=ni(-1,g&-g),Ae.tag=2;var Ge=D.updateQueue;if(Ge!==null){Ge=Ge.shared;var ht=Ge.pending;ht===null?Ae.next=Ae:(Ae.next=ht.next,ht.next=Ae),Ge.pending=Ae}}D.lanes|=g,Ae=D.alternate,Ae!==null&&(Ae.lanes|=g),ri(D.return,g,f),Ne.lanes|=g;break}Ae=Ae.next}}else if(D.tag===10)ne=D.type===f.type?null:D.child;else if(D.tag===18){if(ne=D.return,ne===null)throw Error(r(341));ne.lanes|=g,Ne=ne.alternate,Ne!==null&&(Ne.lanes|=g),ri(ne,g,f),ne=D.sibling}else ne=D.child;if(ne!==null)ne.return=D;else for(ne=D;ne!==null;){if(ne===f){ne=null;break}if(D=ne.sibling,D!==null){D.return=ne.return,ne=D;break}ne=ne.return}D=ne}qa(u,f,C.children,g),f=f.child}return f;case 9:return C=f.type,_=f.pendingProps.children,An(f,g),C=Jn(C),_=_(C),f.flags|=1,qa(u,f,_,g),f.child;case 14:return _=f.type,C=Ro(_,f.pendingProps),C=Ro(_.type,C),ab(u,f,_,C,g);case 15:return ib(u,f,f.type,f.pendingProps,g);case 17:return _=f.type,C=f.pendingProps,C=f.elementType===_?C:Ro(_,C),Jp(u,f),f.tag=1,pa(_)?(u=!0,cc(f)):u=!1,An(f,g),Jy(f,_,C),Pg(f,_,C,g),Ig(null,f,_,!0,u,g);case 19:return pb(u,f,g);case 22:return ob(u,f,g)}throw Error(r(156,f.tag))};function Mb(u,f){return ut(u,f)}function gj(u,f,g,_){this.tag=u,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function to(u,f,g,_){return new gj(u,f,g,_)}function r1(u){return u=u.prototype,!(!u||!u.isReactComponent)}function vj(u){if(typeof u=="function")return r1(u)?1:0;if(u!=null){if(u=u.$$typeof,u===P)return 11;if(u===M)return 14}return 2}function Eu(u,f){var g=u.alternate;return g===null?(g=to(u.tag,f,u.key,u.mode),g.elementType=u.elementType,g.type=u.type,g.stateNode=u.stateNode,g.alternate=u,u.alternate=g):(g.pendingProps=f,g.type=u.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=u.flags&14680064,g.childLanes=u.childLanes,g.lanes=u.lanes,g.child=u.child,g.memoizedProps=u.memoizedProps,g.memoizedState=u.memoizedState,g.updateQueue=u.updateQueue,f=u.dependencies,g.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},g.sibling=u.sibling,g.index=u.index,g.ref=u.ref,g}function lm(u,f,g,_,C,D){var ne=2;if(_=u,typeof u=="function")r1(u)&&(ne=1);else if(typeof u=="string")ne=5;else e:switch(u){case B:return Id(g.children,C,D,f);case R:ne=8,C|=8;break;case O:return u=to(12,g,f,C|2),u.elementType=O,u.lanes=D,u;case ae:return u=to(13,g,f,C),u.elementType=ae,u.lanes=D,u;case G:return u=to(19,g,f,C),u.elementType=G,u.lanes=D,u;case ie:return cm(g,C,D,f);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case ee:ne=10;break e;case I:ne=9;break e;case P:ne=11;break e;case M:ne=14;break e;case te:ne=16,_=null;break e}throw Error(r(130,u==null?u:typeof u,""))}return f=to(ne,g,f,C),f.elementType=u,f.type=_,f.lanes=D,f}function Id(u,f,g,_){return u=to(7,u,_,f),u.lanes=g,u}function cm(u,f,g,_){return u=to(22,u,_,f),u.elementType=ie,u.lanes=g,u.stateNode={isHidden:!1},u}function n1(u,f,g){return u=to(6,u,null,f),u.lanes=g,u}function s1(u,f,g){return f=to(4,u.children!==null?u.children:[],u.key,f),f.lanes=g,f.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},f}function yj(u,f,g,_,C){this.tag=f,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cd(0),this.expirationTimes=cd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cd(0),this.identifierPrefix=_,this.onRecoverableError=C,this.mutableSourceEagerHydrationData=null}function a1(u,f,g,_,C,D,ne,Ne,Ae){return u=new yj(u,f,g,Ne,Ae),f===1?(f=1,D===!0&&(f|=8)):f=0,D=to(3,null,null,f),u.current=D,D.stateNode=u,D.memoizedState={element:_,isDehydrated:g,cache:null,transitions:null,pendingSuspenseBoundaries:null},Rf(D),u}function bj(u,f,g){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:V,key:_==null?null:""+_,children:u,containerInfo:f,implementation:g}}function Bb(u){if(!u)return xl;u=u._reactInternals;e:{if(we(u)!==u||u.tag!==1)throw Error(r(170));var f=u;do{switch(f.tag){case 3:f=f.stateNode.context;break e;case 1:if(pa(f.type)){f=f.stateNode.__reactInternalMemoizedMergedChildContext;break e}}f=f.return}while(f!==null);throw Error(r(171))}if(u.tag===1){var g=u.type;if(pa(g))return V0(u,g,f)}return f}function Ub(u,f,g,_,C,D,ne,Ne,Ae){return u=a1(g,_,!0,u,C,D,ne,Ne,Ae),u.context=Bb(null),g=u.current,_=Ga(),C=ku(g),D=ni(_,C),D.callback=f??null,si(g,D,C),u.current.lanes=C,rl(u,C,_),li(u,_),u}function um(u,f,g,_){var C=f.current,D=Ga(),ne=ku(C);return g=Bb(g),f.context===null?f.context=g:f.pendingContext=g,f=ni(D,ne),f.payload={element:u},_=_===void 0?null:_,_!==null&&(f.callback=_),u=si(C,f,ne),u!==null&&(Mo(u,C,ne,D),uc(u,C,ne)),ne}function dm(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function zb(u,f){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var g=u.retryLane;u.retryLane=g!==0&&g<f?g:f}}function i1(u,f){zb(u,f),(u=u.alternate)&&zb(u,f)}function wj(){return null}var Hb=typeof reportError=="function"?reportError:function(u){console.error(u)};function o1(u){this._internalRoot=u}fm.prototype.render=o1.prototype.render=function(u){var f=this._internalRoot;if(f===null)throw Error(r(409));um(u,f,null,null)},fm.prototype.unmount=o1.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var f=u.containerInfo;Ld(function(){um(null,u,null,null)}),f[Rs]=null}};function fm(u){this._internalRoot=u}fm.prototype.unstable_scheduleHydration=function(u){if(u){var f=Ui();u={blockedOn:null,target:u,priority:f};for(var g=0;g<Hi.length&&f!==0&&f<Hi[g].priority;g++);Hi.splice(g,0,u),g===0&&Vc(u)}};function l1(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function hm(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function $b(){}function _j(u,f,g,_,C){if(C){if(typeof _=="function"){var D=_;_=function(){var Ge=dm(ne);D.call(Ge)}}var ne=Ub(f,_,u,0,null,!1,!1,"",$b);return u._reactRootContainer=ne,u[Rs]=ne.current,sc(u.nodeType===8?u.parentNode:u),Ld(),ne}for(;C=u.lastChild;)u.removeChild(C);if(typeof _=="function"){var Ne=_;_=function(){var Ge=dm(Ae);Ne.call(Ge)}}var Ae=a1(u,0,!1,null,null,!1,!1,"",$b);return u._reactRootContainer=Ae,u[Rs]=Ae.current,sc(u.nodeType===8?u.parentNode:u),Ld(function(){um(f,Ae,g,_)}),Ae}function pm(u,f,g,_,C){var D=g._reactRootContainer;if(D){var ne=D;if(typeof C=="function"){var Ne=C;C=function(){var Ae=dm(ne);Ne.call(Ae)}}um(f,ne,u,C)}else ne=_j(g,f,u,C,_);return dm(ne)}Sf=function(u){switch(u.tag){case 3:var f=u.stateNode;if(f.current.memoizedState.isDehydrated){var g=zl(f.pendingLanes);g!==0&&(Hc(f,g|1),li(f,mt()),($r&6)===0&&(Xf=mt()+500,U()))}break;case 13:Ld(function(){var _=Gr(u,1);if(_!==null){var C=Ga();Mo(_,u,1,C)}}),i1(u,1)}},ud=function(u){if(u.tag===13){var f=Gr(u,134217728);if(f!==null){var g=Ga();Mo(f,u,134217728,g)}i1(u,134217728)}},kf=function(u){if(u.tag===13){var f=ku(u),g=Gr(u,f);if(g!==null){var _=Ga();Mo(g,u,f,_)}i1(u,f)}},Ui=function(){return zr},$l=function(u,f){var g=zr;try{return zr=u,f()}finally{zr=g}},Vt=function(u,f,g){switch(f){case"input":if(Xe(u,g),f=g.name,g.type==="radio"&&f!=null){for(g=u;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll("input[name="+JSON.stringify(""+f)+'][type="radio"]'),f=0;f<g.length;f++){var _=g[f];if(_!==u&&_.form===u.form){var C=Ed(_);if(!C)throw Error(r(90));ue(_),Xe(_,C)}}}break;case"textarea":Dt(u,g);break;case"select":f=g.value,f!=null&&pt(u,!!g.multiple,f,!1)}},Te=Zg,yt=Ld;var Nj={usingClientEntryPoint:!1,Events:[pu,oc,Ed,Ut,cr,Zg]},nh={findFiberByHostInstance:ml,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Sj={bundleType:nh.bundleType,version:nh.version,rendererPackageName:nh.rendererPackageName,rendererConfig:nh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:z.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=He(u),u===null?null:u.stateNode},findFiberByHostInstance:nh.findFiberByHostInstance||wj,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mm.isDisabled&&mm.supportsFiber)try{Oa=mm.inject(Sj),Xn=mm}catch{}}return ci.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nj,ci.createPortal=function(u,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!l1(f))throw Error(r(200));return bj(u,f,null,g)},ci.createRoot=function(u,f){if(!l1(u))throw Error(r(299));var g=!1,_="",C=Hb;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(_=f.identifierPrefix),f.onRecoverableError!==void 0&&(C=f.onRecoverableError)),f=a1(u,1,!1,null,null,g,!1,_,C),u[Rs]=f.current,sc(u.nodeType===8?u.parentNode:u),new o1(f)},ci.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var f=u._reactInternals;if(f===void 0)throw typeof u.render=="function"?Error(r(188)):(u=Object.keys(u).join(","),Error(r(268,u)));return u=He(f),u=u===null?null:u.stateNode,u},ci.flushSync=function(u){return Ld(u)},ci.hydrate=function(u,f,g){if(!hm(f))throw Error(r(200));return pm(null,u,f,!0,g)},ci.hydrateRoot=function(u,f,g){if(!l1(u))throw Error(r(405));var _=g!=null&&g.hydratedSources||null,C=!1,D="",ne=Hb;if(g!=null&&(g.unstable_strictMode===!0&&(C=!0),g.identifierPrefix!==void 0&&(D=g.identifierPrefix),g.onRecoverableError!==void 0&&(ne=g.onRecoverableError)),f=Ub(f,null,u,1,g??null,C,!1,D,ne),u[Rs]=f.current,sc(u),_)for(u=0;u<_.length;u++)g=_[u],C=g._getVersion,C=C(g._source),f.mutableSourceEagerHydrationData==null?f.mutableSourceEagerHydrationData=[g,C]:f.mutableSourceEagerHydrationData.push(g,C);return new fm(f)},ci.render=function(u,f,g){if(!hm(f))throw Error(r(200));return pm(null,u,f,!1,g)},ci.unmountComponentAtNode=function(u){if(!hm(u))throw Error(r(40));return u._reactRootContainer?(Ld(function(){pm(null,null,u,!1,function(){u._reactRootContainer=null,u[Rs]=null})}),!0):!1},ci.unstable_batchedUpdates=Zg,ci.unstable_renderSubtreeIntoContainer=function(u,f,g,_){if(!hm(g))throw Error(r(200));if(u==null||u._reactInternals===void 0)throw Error(r(38));return pm(u,f,g,!1,_)},ci.version="18.3.1-next-f1338f8080-20240426",ci}var Jb;function P4(){if(Jb)return d1.exports;Jb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),d1.exports=Rj(),d1.exports}var Qb;function Ij(){if(Qb)return xm;Qb=1;var t=P4();return xm.createRoot=t.createRoot,xm.hydrateRoot=t.hydrateRoot,xm}var Oj=Ij();P4();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bh(){return Bh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Bh.apply(this,arguments)}var Du;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Du||(Du={}));const Zb="popstate";function Mj(t){t===void 0&&(t={});function e(n,s){let{pathname:a,search:i,hash:l}=n.location;return p2("",{pathname:a,search:i,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:ox(s)}return Uj(e,r,null,t)}function xs(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function L4(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Bj(){return Math.random().toString(36).substr(2,8)}function e5(t,e){return{usr:t.state,key:t.key,idx:e}}function p2(t,e,r,n){return r===void 0&&(r=null),Bh({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?A0(e):e,{state:r,key:e&&e.key||n||Bj()})}function ox(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function A0(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function Uj(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,l=Du.Pop,c=null,d=h();d==null&&(d=0,i.replaceState(Bh({},i.state,{idx:d}),""));function h(){return(i.state||{idx:null}).idx}function p(){l=Du.Pop;let w=h(),S=w==null?null:w-d;d=w,c&&c({action:l,location:y.location,delta:S})}function x(w,S){l=Du.Push;let k=p2(y.location,w,S);d=h()+1;let A=e5(k,d),z=y.createHref(k);try{i.pushState(A,"",z)}catch(H){if(H instanceof DOMException&&H.name==="DataCloneError")throw H;s.location.assign(z)}a&&c&&c({action:l,location:y.location,delta:1})}function m(w,S){l=Du.Replace;let k=p2(y.location,w,S);d=h();let A=e5(k,d),z=y.createHref(k);i.replaceState(A,"",z),a&&c&&c({action:l,location:y.location,delta:0})}function b(w){let S=s.location.origin!=="null"?s.location.origin:s.location.href,k=typeof w=="string"?w:ox(w);return k=k.replace(/ $/,"%20"),xs(S,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,S)}let y={get action(){return l},get location(){return t(s,i)},listen(w){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Zb,p),c=w,()=>{s.removeEventListener(Zb,p),c=null}},createHref(w){return e(s,w)},createURL:b,encodeLocation(w){let S=b(w);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:x,replace:m,go(w){return i.go(w)}};return y}var t5;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(t5||(t5={}));function zj(t,e,r){return r===void 0&&(r="/"),Hj(t,e,r)}function Hj(t,e,r,n){let s=typeof e=="string"?A0(e):e,a=mv(s.pathname||"/",r);if(a==null)return null;let i=D4(t);$j(i);let l=null;for(let c=0;l==null&&c<i.length;++c){let d=tE(a);l=Qj(i[c],d)}return l}function D4(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};c.relativePath.startsWith("/")&&(xs(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=$u([n,c.relativePath]),h=r.concat(c);a.children&&a.children.length>0&&(xs(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),D4(a.children,e,h,d)),!(a.path==null&&!a.index)&&e.push({path:d,score:Kj(d,a.index),routesMeta:h})};return t.forEach((a,i)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))s(a,i);else for(let c of R4(a.path))s(a,i,c)}),e}function R4(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=R4(n.join("/")),l=[];return l.push(...i.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...i),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function $j(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:Jj(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Wj=/^:[\w-]+$/,Vj=3,qj=2,Gj=1,Xj=10,Yj=-2,r5=t=>t==="*";function Kj(t,e){let r=t.split("/"),n=r.length;return r.some(r5)&&(n+=Yj),e&&(n+=qj),r.filter(s=>!r5(s)).reduce((s,a)=>s+(Wj.test(a)?Vj:a===""?Gj:Xj),n)}function Jj(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function Qj(t,e,r){let{routesMeta:n}=t,s={},a="/",i=[];for(let l=0;l<n.length;++l){let c=n[l],d=l===n.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=Zj({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},h),x=c.route;if(!p)return null;Object.assign(s,p.params),i.push({params:s,pathname:$u([a,p.pathname]),pathnameBase:aE($u([a,p.pathnameBase])),route:x}),p.pathnameBase!=="/"&&(a=$u([a,p.pathnameBase]))}return i}function Zj(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=eE(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((d,h,p)=>{let{paramName:x,isOptional:m}=h;if(x==="*"){let y=l[p]||"";i=a.slice(0,a.length-y.length).replace(/(.)\/+$/,"$1")}const b=l[p];return m&&!b?d[x]=void 0:d[x]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:i,pattern:t}}function eE(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),L4(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function tE(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return L4(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function mv(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function rE(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?A0(t):t;return{pathname:r?r.startsWith("/")?r:nE(r,e):e,search:iE(n),hash:oE(s)}}function nE(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function p1(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function sE(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function xv(t,e){let r=sE(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function gv(t,e,r,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=A0(t):(s=Bh({},t),xs(!s.pathname||!s.pathname.includes("?"),p1("?","pathname","search",s)),xs(!s.pathname||!s.pathname.includes("#"),p1("#","pathname","hash",s)),xs(!s.search||!s.search.includes("#"),p1("#","search","hash",s)));let a=t===""||s.pathname==="",i=a?"/":s.pathname,l;if(i==null)l=r;else{let p=e.length-1;if(!n&&i.startsWith("..")){let x=i.split("/");for(;x[0]==="..";)x.shift(),p-=1;s.pathname=x.join("/")}l=p>=0?e[p]:"/"}let c=rE(s,l),d=i&&i!=="/"&&i.endsWith("/"),h=(a||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||h)&&(c.pathname+="/"),c}const $u=t=>t.join("/").replace(/\/\/+/g,"/"),aE=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),iE=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,oE=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function lE(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const I4=["post","put","patch","delete"];new Set(I4);const cE=["get",...I4];new Set(cE);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Uh(){return Uh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Uh.apply(this,arguments)}const vv=Q.createContext(null),uE=Q.createContext(null),nd=Q.createContext(null),Bx=Q.createContext(null),Ic=Q.createContext({outlet:null,matches:[],isDataRoute:!1}),O4=Q.createContext(null);function dE(t,e){let{relative:r}=e===void 0?{}:e;C0()||xs(!1);let{basename:n,navigator:s}=Q.useContext(nd),{hash:a,pathname:i,search:l}=B4(t,{relative:r}),c=i;return n!=="/"&&(c=i==="/"?n:$u([n,i])),s.createHref({pathname:c,search:l,hash:a})}function C0(){return Q.useContext(Bx)!=null}function Jo(){return C0()||xs(!1),Q.useContext(Bx).location}function M4(t){Q.useContext(nd).static||Q.useLayoutEffect(t)}function Oi(){let{isDataRoute:t}=Q.useContext(Ic);return t?jE():fE()}function fE(){C0()||xs(!1);let t=Q.useContext(vv),{basename:e,future:r,navigator:n}=Q.useContext(nd),{matches:s}=Q.useContext(Ic),{pathname:a}=Jo(),i=JSON.stringify(xv(s,r.v7_relativeSplatPath)),l=Q.useRef(!1);return M4(()=>{l.current=!0}),Q.useCallback(function(d,h){if(h===void 0&&(h={}),!l.current)return;if(typeof d=="number"){n.go(d);return}let p=gv(d,JSON.parse(i),a,h.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:$u([e,p.pathname])),(h.replace?n.replace:n.push)(p,h.state,h)},[e,n,i,a,t])}const hE=Q.createContext(null);function pE(t){let e=Q.useContext(Ic).outlet;return e&&Q.createElement(hE.Provider,{value:t},e)}function B4(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=Q.useContext(nd),{matches:s}=Q.useContext(Ic),{pathname:a}=Jo(),i=JSON.stringify(xv(s,n.v7_relativeSplatPath));return Q.useMemo(()=>gv(t,JSON.parse(i),a,r==="path"),[t,i,a,r])}function mE(t,e){return xE(t,e)}function xE(t,e,r,n){C0()||xs(!1);let{navigator:s}=Q.useContext(nd),{matches:a}=Q.useContext(Ic),i=a[a.length-1],l=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let d=Jo(),h;if(e){var p;let w=typeof e=="string"?A0(e):e;c==="/"||(p=w.pathname)!=null&&p.startsWith(c)||xs(!1),h=w}else h=d;let x=h.pathname||"/",m=x;if(c!=="/"){let w=c.replace(/^\//,"").split("/");m="/"+x.replace(/^\//,"").split("/").slice(w.length).join("/")}let b=zj(t,{pathname:m}),y=wE(b&&b.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:$u([c,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:$u([c,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),a,r,n);return e&&y?Q.createElement(Bx.Provider,{value:{location:Uh({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Du.Pop}},y):y}function gE(){let t=kE(),e=lE(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Q.createElement(Q.Fragment,null,Q.createElement("h2",null,"Unexpected Application Error!"),Q.createElement("h3",{style:{fontStyle:"italic"}},e),r?Q.createElement("pre",{style:s},r):null,null)}const vE=Q.createElement(gE,null);class yE extends Q.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?Q.createElement(Ic.Provider,{value:this.props.routeContext},Q.createElement(O4.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function bE(t){let{routeContext:e,match:r,children:n}=t,s=Q.useContext(vv);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),Q.createElement(Ic.Provider,{value:e},n)}function wE(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var a;if(!r)return null;if(r.errors)t=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,l=(s=r)==null?void 0:s.errors;if(l!=null){let h=i.findIndex(p=>p.route.id&&l?.[p.route.id]!==void 0);h>=0||xs(!1),i=i.slice(0,Math.min(i.length,h+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let h=0;h<i.length;h++){let p=i[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=h),p.route.id){let{loaderData:x,errors:m}=r,b=p.route.loader&&x[p.route.id]===void 0&&(!m||m[p.route.id]===void 0);if(p.route.lazy||b){c=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}return i.reduceRight((h,p,x)=>{let m,b=!1,y=null,w=null;r&&(m=l&&p.route.id?l[p.route.id]:void 0,y=p.route.errorElement||vE,c&&(d<0&&x===0?(EE("route-fallback"),b=!0,w=null):d===x&&(b=!0,w=p.route.hydrateFallbackElement||null)));let S=e.concat(i.slice(0,x+1)),k=()=>{let A;return m?A=y:b?A=w:p.route.Component?A=Q.createElement(p.route.Component,null):p.route.element?A=p.route.element:A=h,Q.createElement(bE,{match:p,routeContext:{outlet:h,matches:S,isDataRoute:r!=null},children:A})};return r&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?Q.createElement(yE,{location:r.location,revalidation:r.revalidation,component:y,error:m,children:k(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):k()},null)}var U4=(function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t})(U4||{}),z4=(function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t})(z4||{});function _E(t){let e=Q.useContext(vv);return e||xs(!1),e}function NE(t){let e=Q.useContext(uE);return e||xs(!1),e}function SE(t){let e=Q.useContext(Ic);return e||xs(!1),e}function H4(t){let e=SE(),r=e.matches[e.matches.length-1];return r.route.id||xs(!1),r.route.id}function kE(){var t;let e=Q.useContext(O4),r=NE(),n=H4();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function jE(){let{router:t}=_E(U4.UseNavigateStable),e=H4(z4.UseNavigateStable),r=Q.useRef(!1);return M4(()=>{r.current=!0}),Q.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Uh({fromRouteId:e},a)))},[t,e])}const n5={};function EE(t,e,r){n5[t]||(n5[t]=!0)}function AE(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath}function Wo(t){let{to:e,replace:r,state:n,relative:s}=t;C0()||xs(!1);let{future:a,static:i}=Q.useContext(nd),{matches:l}=Q.useContext(Ic),{pathname:c}=Jo(),d=Oi(),h=gv(e,xv(l,a.v7_relativeSplatPath),c,s==="path"),p=JSON.stringify(h);return Q.useEffect(()=>d(JSON.parse(p),{replace:r,state:n,relative:s}),[d,p,s,r,n]),null}function Ux(t){return pE(t.context)}function Vn(t){xs(!1)}function CE(t){let{basename:e="/",children:r=null,location:n,navigationType:s=Du.Pop,navigator:a,static:i=!1,future:l}=t;C0()&&xs(!1);let c=e.replace(/^\/*/,"/"),d=Q.useMemo(()=>({basename:c,navigator:a,static:i,future:Uh({v7_relativeSplatPath:!1},l)}),[c,l,a,i]);typeof n=="string"&&(n=A0(n));let{pathname:h="/",search:p="",hash:x="",state:m=null,key:b="default"}=n,y=Q.useMemo(()=>{let w=mv(h,c);return w==null?null:{location:{pathname:w,search:p,hash:x,state:m,key:b},navigationType:s}},[c,h,p,x,m,b,s]);return y==null?null:Q.createElement(nd.Provider,{value:d},Q.createElement(Bx.Provider,{children:r,value:y}))}function TE(t){let{children:e,location:r}=t;return mE(m2(e),r)}new Promise(()=>{});function m2(t,e){e===void 0&&(e=[]);let r=[];return Q.Children.forEach(t,(n,s)=>{if(!Q.isValidElement(n))return;let a=[...e,s];if(n.type===Q.Fragment){r.push.apply(r,m2(n.props.children,a));return}n.type!==Vn&&xs(!1),!n.props.index||!n.props.children||xs(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=m2(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function x2(){return x2=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},x2.apply(this,arguments)}function FE(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,a;for(a=0;a<n.length;a++)s=n[a],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function PE(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function LE(t,e){return t.button===0&&(!e||e==="_self")&&!PE(t)}const DE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],RE="6";try{window.__reactRouterVersion=RE}catch{}const IE="startTransition",s5=Pj[IE];function OE(t){let{basename:e,children:r,future:n,window:s}=t,a=Q.useRef();a.current==null&&(a.current=Mj({window:s,v5Compat:!0}));let i=a.current,[l,c]=Q.useState({action:i.action,location:i.location}),{v7_startTransition:d}=n||{},h=Q.useCallback(p=>{d&&s5?s5(()=>c(p)):c(p)},[c,d]);return Q.useLayoutEffect(()=>i.listen(h),[i,h]),Q.useEffect(()=>AE(n),[n]),Q.createElement(CE,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:i,future:n})}const ME=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",BE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zh=Q.forwardRef(function(e,r){let{onClick:n,relative:s,reloadDocument:a,replace:i,state:l,target:c,to:d,preventScrollReset:h,viewTransition:p}=e,x=FE(e,DE),{basename:m}=Q.useContext(nd),b,y=!1;if(typeof d=="string"&&BE.test(d)&&(b=d,ME))try{let A=new URL(window.location.href),z=d.startsWith("//")?new URL(A.protocol+d):new URL(d),H=mv(z.pathname,m);z.origin===A.origin&&H!=null?d=H+z.search+z.hash:y=!0}catch{}let w=dE(d,{relative:s}),S=UE(d,{replace:i,state:l,target:c,preventScrollReset:h,relative:s,viewTransition:p});function k(A){n&&n(A),A.defaultPrevented||S(A)}return Q.createElement("a",x2({},x,{href:b||w,onClick:y||a?n:k,ref:r,target:c}))});var a5;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(a5||(a5={}));var i5;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(i5||(i5={}));function UE(t,e){let{target:r,replace:n,state:s,preventScrollReset:a,relative:i,viewTransition:l}=e===void 0?{}:e,c=Oi(),d=Jo(),h=B4(t,{relative:i});return Q.useCallback(p=>{if(LE(p,r)){p.preventDefault();let x=n!==void 0?n:ox(d)===ox(h);c(t,{replace:x,state:s,preventScrollReset:a,relative:i,viewTransition:l})}},[d,c,h,n,s,r,t,a,i,l])}function $4(t,e){return function(){return t.apply(e,arguments)}}const{toString:zE}=Object.prototype,{getPrototypeOf:yv}=Object,{iterator:zx,toStringTag:W4}=Symbol,Hx=(t=>e=>{const r=zE.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Qo=t=>(t=t.toLowerCase(),e=>Hx(e)===t),$x=t=>e=>typeof e===t,{isArray:T0}=Array,Hh=$x("undefined");function pp(t){return t!==null&&!Hh(t)&&t.constructor!==null&&!Hh(t.constructor)&&hi(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const V4=Qo("ArrayBuffer");function HE(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&V4(t.buffer),e}const $E=$x("string"),hi=$x("function"),q4=$x("number"),mp=t=>t!==null&&typeof t=="object",WE=t=>t===!0||t===!1,Gm=t=>{if(Hx(t)!=="object")return!1;const e=yv(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(W4 in t)&&!(zx in t)},VE=t=>{if(!mp(t)||pp(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},qE=Qo("Date"),GE=Qo("File"),XE=Qo("Blob"),YE=Qo("FileList"),KE=t=>mp(t)&&hi(t.pipe),JE=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||hi(t.append)&&((e=Hx(t))==="formdata"||e==="object"&&hi(t.toString)&&t.toString()==="[object FormData]"))},QE=Qo("URLSearchParams"),[ZE,eA,tA,rA]=["ReadableStream","Request","Response","Headers"].map(Qo),nA=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function xp(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let n,s;if(typeof t!="object"&&(t=[t]),T0(t))for(n=0,s=t.length;n<s;n++)e.call(null,t[n],n,t);else{if(pp(t))return;const a=r?Object.getOwnPropertyNames(t):Object.keys(t),i=a.length;let l;for(n=0;n<i;n++)l=a[n],e.call(null,t[l],l,t)}}function G4(t,e){if(pp(t))return null;e=e.toLowerCase();const r=Object.keys(t);let n=r.length,s;for(;n-- >0;)if(s=r[n],e===s.toLowerCase())return s;return null}const Vd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,X4=t=>!Hh(t)&&t!==Vd;function g2(){const{caseless:t}=X4(this)&&this||{},e={},r=(n,s)=>{const a=t&&G4(e,s)||s;Gm(e[a])&&Gm(n)?e[a]=g2(e[a],n):Gm(n)?e[a]=g2({},n):T0(n)?e[a]=n.slice():e[a]=n};for(let n=0,s=arguments.length;n<s;n++)arguments[n]&&xp(arguments[n],r);return e}const sA=(t,e,r,{allOwnKeys:n}={})=>(xp(e,(s,a)=>{r&&hi(s)?t[a]=$4(s,r):t[a]=s},{allOwnKeys:n}),t),aA=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),iA=(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},oA=(t,e,r,n)=>{let s,a,i;const l={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),a=s.length;a-- >0;)i=s[a],(!n||n(i,t,e))&&!l[i]&&(e[i]=t[i],l[i]=!0);t=r!==!1&&yv(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},lA=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const n=t.indexOf(e,r);return n!==-1&&n===r},cA=t=>{if(!t)return null;if(T0(t))return t;let e=t.length;if(!q4(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},uA=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&yv(Uint8Array)),dA=(t,e)=>{const n=(t&&t[zx]).call(t);let s;for(;(s=n.next())&&!s.done;){const a=s.value;e.call(t,a[0],a[1])}},fA=(t,e)=>{let r;const n=[];for(;(r=t.exec(e))!==null;)n.push(r);return n},hA=Qo("HTMLFormElement"),pA=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),o5=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),mA=Qo("RegExp"),Y4=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),n={};xp(r,(s,a)=>{let i;(i=e(s,a,t))!==!1&&(n[a]=i||s)}),Object.defineProperties(t,n)},xA=t=>{Y4(t,(e,r)=>{if(hi(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=t[r];if(hi(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},gA=(t,e)=>{const r={},n=s=>{s.forEach(a=>{r[a]=!0})};return T0(t)?n(t):n(String(t).split(e)),r},vA=()=>{},yA=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function bA(t){return!!(t&&hi(t.append)&&t[W4]==="FormData"&&t[zx])}const wA=t=>{const e=new Array(10),r=(n,s)=>{if(mp(n)){if(e.indexOf(n)>=0)return;if(pp(n))return n;if(!("toJSON"in n)){e[s]=n;const a=T0(n)?[]:{};return xp(n,(i,l)=>{const c=r(i,s+1);!Hh(c)&&(a[l]=c)}),e[s]=void 0,a}}return n};return r(t,0)},_A=Qo("AsyncFunction"),NA=t=>t&&(mp(t)||hi(t))&&hi(t.then)&&hi(t.catch),K4=((t,e)=>t?setImmediate:e?((r,n)=>(Vd.addEventListener("message",({source:s,data:a})=>{s===Vd&&a===r&&n.length&&n.shift()()},!1),s=>{n.push(s),Vd.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",hi(Vd.postMessage)),SA=typeof queueMicrotask<"u"?queueMicrotask.bind(Vd):typeof process<"u"&&process.nextTick||K4,kA=t=>t!=null&&hi(t[zx]),Qe={isArray:T0,isArrayBuffer:V4,isBuffer:pp,isFormData:JE,isArrayBufferView:HE,isString:$E,isNumber:q4,isBoolean:WE,isObject:mp,isPlainObject:Gm,isEmptyObject:VE,isReadableStream:ZE,isRequest:eA,isResponse:tA,isHeaders:rA,isUndefined:Hh,isDate:qE,isFile:GE,isBlob:XE,isRegExp:mA,isFunction:hi,isStream:KE,isURLSearchParams:QE,isTypedArray:uA,isFileList:YE,forEach:xp,merge:g2,extend:sA,trim:nA,stripBOM:aA,inherits:iA,toFlatObject:oA,kindOf:Hx,kindOfTest:Qo,endsWith:lA,toArray:cA,forEachEntry:dA,matchAll:fA,isHTMLForm:hA,hasOwnProperty:o5,hasOwnProp:o5,reduceDescriptors:Y4,freezeMethods:xA,toObjectSet:gA,toCamelCase:pA,noop:vA,toFiniteNumber:yA,findKey:G4,global:Vd,isContextDefined:X4,isSpecCompliantForm:bA,toJSONObject:wA,isAsyncFn:_A,isThenable:NA,setImmediate:K4,asap:SA,isIterable:kA};function _r(t,e,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}Qe.inherits(_r,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Qe.toJSONObject(this.config),code:this.code,status:this.status}}});const J4=_r.prototype,Q4={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Q4[t]={value:t}});Object.defineProperties(_r,Q4);Object.defineProperty(J4,"isAxiosError",{value:!0});_r.from=(t,e,r,n,s,a)=>{const i=Object.create(J4);return Qe.toFlatObject(t,i,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),_r.call(i,t.message,e,r,n,s),i.cause=t,i.name=t.name,a&&Object.assign(i,a),i};const jA=null;function v2(t){return Qe.isPlainObject(t)||Qe.isArray(t)}function Z4(t){return Qe.endsWith(t,"[]")?t.slice(0,-2):t}function l5(t,e,r){return t?t.concat(e).map(function(s,a){return s=Z4(s),!r&&a?"["+s+"]":s}).join(r?".":""):e}function EA(t){return Qe.isArray(t)&&!t.some(v2)}const AA=Qe.toFlatObject(Qe,{},null,function(e){return/^is[A-Z]/.test(e)});function Wx(t,e,r){if(!Qe.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=Qe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,w){return!Qe.isUndefined(w[y])});const n=r.metaTokens,s=r.visitor||h,a=r.dots,i=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&Qe.isSpecCompliantForm(e);if(!Qe.isFunction(s))throw new TypeError("visitor must be a function");function d(b){if(b===null)return"";if(Qe.isDate(b))return b.toISOString();if(Qe.isBoolean(b))return b.toString();if(!c&&Qe.isBlob(b))throw new _r("Blob is not supported. Use a Buffer instead.");return Qe.isArrayBuffer(b)||Qe.isTypedArray(b)?c&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function h(b,y,w){let S=b;if(b&&!w&&typeof b=="object"){if(Qe.endsWith(y,"{}"))y=n?y:y.slice(0,-2),b=JSON.stringify(b);else if(Qe.isArray(b)&&EA(b)||(Qe.isFileList(b)||Qe.endsWith(y,"[]"))&&(S=Qe.toArray(b)))return y=Z4(y),S.forEach(function(A,z){!(Qe.isUndefined(A)||A===null)&&e.append(i===!0?l5([y],z,a):i===null?y:y+"[]",d(A))}),!1}return v2(b)?!0:(e.append(l5(w,y,a),d(b)),!1)}const p=[],x=Object.assign(AA,{defaultVisitor:h,convertValue:d,isVisitable:v2});function m(b,y){if(!Qe.isUndefined(b)){if(p.indexOf(b)!==-1)throw Error("Circular reference detected in "+y.join("."));p.push(b),Qe.forEach(b,function(S,k){(!(Qe.isUndefined(S)||S===null)&&s.call(e,S,Qe.isString(k)?k.trim():k,y,x))===!0&&m(S,y?y.concat(k):[k])}),p.pop()}}if(!Qe.isObject(t))throw new TypeError("data must be an object");return m(t),e}function c5(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function bv(t,e){this._pairs=[],t&&Wx(t,this,e)}const e3=bv.prototype;e3.append=function(e,r){this._pairs.push([e,r])};e3.toString=function(e){const r=e?function(n){return e.call(this,n,c5)}:c5;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function CA(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function t3(t,e,r){if(!e)return t;const n=r&&r.encode||CA;Qe.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let a;if(s?a=s(e,r):a=Qe.isURLSearchParams(e)?e.toString():new bv(e,r).toString(n),a){const i=t.indexOf("#");i!==-1&&(t=t.slice(0,i)),t+=(t.indexOf("?")===-1?"?":"&")+a}return t}class u5{constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Qe.forEach(this.handlers,function(n){n!==null&&e(n)})}}const r3={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},TA=typeof URLSearchParams<"u"?URLSearchParams:bv,FA=typeof FormData<"u"?FormData:null,PA=typeof Blob<"u"?Blob:null,LA={isBrowser:!0,classes:{URLSearchParams:TA,FormData:FA,Blob:PA},protocols:["http","https","file","blob","url","data"]},wv=typeof window<"u"&&typeof document<"u",y2=typeof navigator=="object"&&navigator||void 0,DA=wv&&(!y2||["ReactNative","NativeScript","NS"].indexOf(y2.product)<0),RA=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",IA=wv&&window.location.href||"http://localhost",OA=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:wv,hasStandardBrowserEnv:DA,hasStandardBrowserWebWorkerEnv:RA,navigator:y2,origin:IA},Symbol.toStringTag,{value:"Module"})),Aa={...OA,...LA};function MA(t,e){return Wx(t,new Aa.classes.URLSearchParams,{visitor:function(r,n,s,a){return Aa.isNode&&Qe.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...e})}function BA(t){return Qe.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function UA(t){const e={},r=Object.keys(t);let n;const s=r.length;let a;for(n=0;n<s;n++)a=r[n],e[a]=t[a];return e}function n3(t){function e(r,n,s,a){let i=r[a++];if(i==="__proto__")return!0;const l=Number.isFinite(+i),c=a>=r.length;return i=!i&&Qe.isArray(s)?s.length:i,c?(Qe.hasOwnProp(s,i)?s[i]=[s[i],n]:s[i]=n,!l):((!s[i]||!Qe.isObject(s[i]))&&(s[i]=[]),e(r,n,s[i],a)&&Qe.isArray(s[i])&&(s[i]=UA(s[i])),!l)}if(Qe.isFormData(t)&&Qe.isFunction(t.entries)){const r={};return Qe.forEachEntry(t,(n,s)=>{e(BA(n),s,r,0)}),r}return null}function zA(t,e,r){if(Qe.isString(t))try{return(e||JSON.parse)(t),Qe.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}const gp={transitional:r3,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,a=Qe.isObject(e);if(a&&Qe.isHTMLForm(e)&&(e=new FormData(e)),Qe.isFormData(e))return s?JSON.stringify(n3(e)):e;if(Qe.isArrayBuffer(e)||Qe.isBuffer(e)||Qe.isStream(e)||Qe.isFile(e)||Qe.isBlob(e)||Qe.isReadableStream(e))return e;if(Qe.isArrayBufferView(e))return e.buffer;if(Qe.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return MA(e,this.formSerializer).toString();if((l=Qe.isFileList(e))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Wx(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return a||s?(r.setContentType("application/json",!1),zA(e)):e}],transformResponse:[function(e){const r=this.transitional||gp.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(Qe.isResponse(e)||Qe.isReadableStream(e))return e;if(e&&Qe.isString(e)&&(n&&!this.responseType||s)){const i=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(l){if(i)throw l.name==="SyntaxError"?_r.from(l,_r.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Aa.classes.FormData,Blob:Aa.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Qe.forEach(["delete","get","head","post","put","patch"],t=>{gp.headers[t]={}});const HA=Qe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),$A=t=>{const e={};let r,n,s;return t&&t.split(`
`).forEach(function(i){s=i.indexOf(":"),r=i.substring(0,s).trim().toLowerCase(),n=i.substring(s+1).trim(),!(!r||e[r]&&HA[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e},d5=Symbol("internals");function ah(t){return t&&String(t).trim().toLowerCase()}function Xm(t){return t===!1||t==null?t:Qe.isArray(t)?t.map(Xm):String(t)}function WA(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}const VA=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function m1(t,e,r,n,s){if(Qe.isFunction(n))return n.call(this,e,r);if(s&&(e=r),!!Qe.isString(e)){if(Qe.isString(n))return e.indexOf(n)!==-1;if(Qe.isRegExp(n))return n.test(e)}}function qA(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function GA(t,e){const r=Qe.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(s,a,i){return this[n].call(this,e,s,a,i)},configurable:!0})})}let pi=class{constructor(e){e&&this.set(e)}set(e,r,n){const s=this;function a(l,c,d){const h=ah(c);if(!h)throw new Error("header name must be a non-empty string");const p=Qe.findKey(s,h);(!p||s[p]===void 0||d===!0||d===void 0&&s[p]!==!1)&&(s[p||c]=Xm(l))}const i=(l,c)=>Qe.forEach(l,(d,h)=>a(d,h,c));if(Qe.isPlainObject(e)||e instanceof this.constructor)i(e,r);else if(Qe.isString(e)&&(e=e.trim())&&!VA(e))i($A(e),r);else if(Qe.isObject(e)&&Qe.isIterable(e)){let l={},c,d;for(const h of e){if(!Qe.isArray(h))throw TypeError("Object iterator must return a key-value pair");l[d=h[0]]=(c=l[d])?Qe.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}i(l,r)}else e!=null&&a(r,e,n);return this}get(e,r){if(e=ah(e),e){const n=Qe.findKey(this,e);if(n){const s=this[n];if(!r)return s;if(r===!0)return WA(s);if(Qe.isFunction(r))return r.call(this,s,n);if(Qe.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=ah(e),e){const n=Qe.findKey(this,e);return!!(n&&this[n]!==void 0&&(!r||m1(this,this[n],n,r)))}return!1}delete(e,r){const n=this;let s=!1;function a(i){if(i=ah(i),i){const l=Qe.findKey(n,i);l&&(!r||m1(n,n[l],l,r))&&(delete n[l],s=!0)}}return Qe.isArray(e)?e.forEach(a):a(e),s}clear(e){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const a=r[n];(!e||m1(this,this[a],a,e,!0))&&(delete this[a],s=!0)}return s}normalize(e){const r=this,n={};return Qe.forEach(this,(s,a)=>{const i=Qe.findKey(n,a);if(i){r[i]=Xm(s),delete r[a];return}const l=e?qA(a):String(a).trim();l!==a&&delete r[a],r[l]=Xm(s),n[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return Qe.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=e&&Qe.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const n=new this(e);return r.forEach(s=>n.set(s)),n}static accessor(e){const n=(this[d5]=this[d5]={accessors:{}}).accessors,s=this.prototype;function a(i){const l=ah(i);n[l]||(GA(s,i),n[l]=!0)}return Qe.isArray(e)?e.forEach(a):a(e),this}};pi.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Qe.reduceDescriptors(pi.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[r]=n}}});Qe.freezeMethods(pi);function x1(t,e){const r=this||gp,n=e||r,s=pi.from(n.headers);let a=n.data;return Qe.forEach(t,function(l){a=l.call(r,a,s.normalize(),e?e.status:void 0)}),s.normalize(),a}function s3(t){return!!(t&&t.__CANCEL__)}function F0(t,e,r){_r.call(this,t??"canceled",_r.ERR_CANCELED,e,r),this.name="CanceledError"}Qe.inherits(F0,_r,{__CANCEL__:!0});function a3(t,e,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):e(new _r("Request failed with status code "+r.status,[_r.ERR_BAD_REQUEST,_r.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function XA(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function YA(t,e){t=t||10;const r=new Array(t),n=new Array(t);let s=0,a=0,i;return e=e!==void 0?e:1e3,function(c){const d=Date.now(),h=n[a];i||(i=d),r[s]=c,n[s]=d;let p=a,x=0;for(;p!==s;)x+=r[p++],p=p%t;if(s=(s+1)%t,s===a&&(a=(a+1)%t),d-i<e)return;const m=h&&d-h;return m?Math.round(x*1e3/m):void 0}}function KA(t,e){let r=0,n=1e3/e,s,a;const i=(d,h=Date.now())=>{r=h,s=null,a&&(clearTimeout(a),a=null),t(...d)};return[(...d)=>{const h=Date.now(),p=h-r;p>=n?i(d,h):(s=d,a||(a=setTimeout(()=>{a=null,i(s)},n-p)))},()=>s&&i(s)]}const lx=(t,e,r=3)=>{let n=0;const s=YA(50,250);return KA(a=>{const i=a.loaded,l=a.lengthComputable?a.total:void 0,c=i-n,d=s(c),h=i<=l;n=i;const p={loaded:i,total:l,progress:l?i/l:void 0,bytes:c,rate:d||void 0,estimated:d&&l&&h?(l-i)/d:void 0,event:a,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(p)},r)},f5=(t,e)=>{const r=t!=null;return[n=>e[0]({lengthComputable:r,total:t,loaded:n}),e[1]]},h5=t=>(...e)=>Qe.asap(()=>t(...e)),JA=Aa.hasStandardBrowserEnv?((t,e)=>r=>(r=new URL(r,Aa.origin),t.protocol===r.protocol&&t.host===r.host&&(e||t.port===r.port)))(new URL(Aa.origin),Aa.navigator&&/(msie|trident)/i.test(Aa.navigator.userAgent)):()=>!0,QA=Aa.hasStandardBrowserEnv?{write(t,e,r,n,s,a){const i=[t+"="+encodeURIComponent(e)];Qe.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),Qe.isString(n)&&i.push("path="+n),Qe.isString(s)&&i.push("domain="+s),a===!0&&i.push("secure"),document.cookie=i.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function ZA(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function eC(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function i3(t,e,r){let n=!ZA(e);return t&&(n||r==!1)?eC(t,e):e}const p5=t=>t instanceof pi?{...t}:t;function nf(t,e){e=e||{};const r={};function n(d,h,p,x){return Qe.isPlainObject(d)&&Qe.isPlainObject(h)?Qe.merge.call({caseless:x},d,h):Qe.isPlainObject(h)?Qe.merge({},h):Qe.isArray(h)?h.slice():h}function s(d,h,p,x){if(Qe.isUndefined(h)){if(!Qe.isUndefined(d))return n(void 0,d,p,x)}else return n(d,h,p,x)}function a(d,h){if(!Qe.isUndefined(h))return n(void 0,h)}function i(d,h){if(Qe.isUndefined(h)){if(!Qe.isUndefined(d))return n(void 0,d)}else return n(void 0,h)}function l(d,h,p){if(p in e)return n(d,h);if(p in t)return n(void 0,d)}const c={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(d,h,p)=>s(p5(d),p5(h),p,!0)};return Qe.forEach(Object.keys({...t,...e}),function(h){const p=c[h]||s,x=p(t[h],e[h],h);Qe.isUndefined(x)&&p!==l||(r[h]=x)}),r}const o3=t=>{const e=nf({},t);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:a,headers:i,auth:l}=e;e.headers=i=pi.from(i),e.url=t3(i3(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(Qe.isFormData(r)){if(Aa.hasStandardBrowserEnv||Aa.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((c=i.getContentType())!==!1){const[d,...h]=c?c.split(";").map(p=>p.trim()).filter(Boolean):[];i.setContentType([d||"multipart/form-data",...h].join("; "))}}if(Aa.hasStandardBrowserEnv&&(n&&Qe.isFunction(n)&&(n=n(e)),n||n!==!1&&JA(e.url))){const d=s&&a&&QA.read(a);d&&i.set(s,d)}return e},tC=typeof XMLHttpRequest<"u",rC=tC&&function(t){return new Promise(function(r,n){const s=o3(t);let a=s.data;const i=pi.from(s.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:d}=s,h,p,x,m,b;function y(){m&&m(),b&&b(),s.cancelToken&&s.cancelToken.unsubscribe(h),s.signal&&s.signal.removeEventListener("abort",h)}let w=new XMLHttpRequest;w.open(s.method.toUpperCase(),s.url,!0),w.timeout=s.timeout;function S(){if(!w)return;const A=pi.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),H={data:!l||l==="text"||l==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:A,config:t,request:w};a3(function(B){r(B),y()},function(B){n(B),y()},H),w=null}"onloadend"in w?w.onloadend=S:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(S)},w.onabort=function(){w&&(n(new _r("Request aborted",_r.ECONNABORTED,t,w)),w=null)},w.onerror=function(){n(new _r("Network Error",_r.ERR_NETWORK,t,w)),w=null},w.ontimeout=function(){let z=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const H=s.transitional||r3;s.timeoutErrorMessage&&(z=s.timeoutErrorMessage),n(new _r(z,H.clarifyTimeoutError?_r.ETIMEDOUT:_r.ECONNABORTED,t,w)),w=null},a===void 0&&i.setContentType(null),"setRequestHeader"in w&&Qe.forEach(i.toJSON(),function(z,H){w.setRequestHeader(H,z)}),Qe.isUndefined(s.withCredentials)||(w.withCredentials=!!s.withCredentials),l&&l!=="json"&&(w.responseType=s.responseType),d&&([x,b]=lx(d,!0),w.addEventListener("progress",x)),c&&w.upload&&([p,m]=lx(c),w.upload.addEventListener("progress",p),w.upload.addEventListener("loadend",m)),(s.cancelToken||s.signal)&&(h=A=>{w&&(n(!A||A.type?new F0(null,t,w):A),w.abort(),w=null)},s.cancelToken&&s.cancelToken.subscribe(h),s.signal&&(s.signal.aborted?h():s.signal.addEventListener("abort",h)));const k=XA(s.url);if(k&&Aa.protocols.indexOf(k)===-1){n(new _r("Unsupported protocol "+k+":",_r.ERR_BAD_REQUEST,t));return}w.send(a||null)})},nC=(t,e)=>{const{length:r}=t=t?t.filter(Boolean):[];if(e||r){let n=new AbortController,s;const a=function(d){if(!s){s=!0,l();const h=d instanceof Error?d:this.reason;n.abort(h instanceof _r?h:new F0(h instanceof Error?h.message:h))}};let i=e&&setTimeout(()=>{i=null,a(new _r(`timeout ${e} of ms exceeded`,_r.ETIMEDOUT))},e);const l=()=>{t&&(i&&clearTimeout(i),i=null,t.forEach(d=>{d.unsubscribe?d.unsubscribe(a):d.removeEventListener("abort",a)}),t=null)};t.forEach(d=>d.addEventListener("abort",a));const{signal:c}=n;return c.unsubscribe=()=>Qe.asap(l),c}},sC=function*(t,e){let r=t.byteLength;if(r<e){yield t;return}let n=0,s;for(;n<r;)s=n+e,yield t.slice(n,s),n=s},aC=async function*(t,e){for await(const r of iC(t))yield*sC(r,e)},iC=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:r,value:n}=await e.read();if(r)break;yield n}}finally{await e.cancel()}},m5=(t,e,r,n)=>{const s=aC(t,e);let a=0,i,l=c=>{i||(i=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:d,value:h}=await s.next();if(d){l(),c.close();return}let p=h.byteLength;if(r){let x=a+=p;r(x)}c.enqueue(new Uint8Array(h))}catch(d){throw l(d),d}},cancel(c){return l(c),s.return()}},{highWaterMark:2})},Vx=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",l3=Vx&&typeof ReadableStream=="function",oC=Vx&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),c3=(t,...e)=>{try{return!!t(...e)}catch{return!1}},lC=l3&&c3(()=>{let t=!1;const e=new Request(Aa.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),x5=64*1024,b2=l3&&c3(()=>Qe.isReadableStream(new Response("").body)),cx={stream:b2&&(t=>t.body)};Vx&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!cx[e]&&(cx[e]=Qe.isFunction(t[e])?r=>r[e]():(r,n)=>{throw new _r(`Response type '${e}' is not supported`,_r.ERR_NOT_SUPPORT,n)})})})(new Response);const cC=async t=>{if(t==null)return 0;if(Qe.isBlob(t))return t.size;if(Qe.isSpecCompliantForm(t))return(await new Request(Aa.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(Qe.isArrayBufferView(t)||Qe.isArrayBuffer(t))return t.byteLength;if(Qe.isURLSearchParams(t)&&(t=t+""),Qe.isString(t))return(await oC(t)).byteLength},uC=async(t,e)=>{const r=Qe.toFiniteNumber(t.getContentLength());return r??cC(e)},dC=Vx&&(async t=>{let{url:e,method:r,data:n,signal:s,cancelToken:a,timeout:i,onDownloadProgress:l,onUploadProgress:c,responseType:d,headers:h,withCredentials:p="same-origin",fetchOptions:x}=o3(t);d=d?(d+"").toLowerCase():"text";let m=nC([s,a&&a.toAbortSignal()],i),b;const y=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let w;try{if(c&&lC&&r!=="get"&&r!=="head"&&(w=await uC(h,n))!==0){let H=new Request(e,{method:"POST",body:n,duplex:"half"}),V;if(Qe.isFormData(n)&&(V=H.headers.get("content-type"))&&h.setContentType(V),H.body){const[B,R]=f5(w,lx(h5(c)));n=m5(H.body,x5,B,R)}}Qe.isString(p)||(p=p?"include":"omit");const S="credentials"in Request.prototype;b=new Request(e,{...x,signal:m,method:r.toUpperCase(),headers:h.normalize().toJSON(),body:n,duplex:"half",credentials:S?p:void 0});let k=await fetch(b,x);const A=b2&&(d==="stream"||d==="response");if(b2&&(l||A&&y)){const H={};["status","statusText","headers"].forEach(O=>{H[O]=k[O]});const V=Qe.toFiniteNumber(k.headers.get("content-length")),[B,R]=l&&f5(V,lx(h5(l),!0))||[];k=new Response(m5(k.body,x5,B,()=>{R&&R(),y&&y()}),H)}d=d||"text";let z=await cx[Qe.findKey(cx,d)||"text"](k,t);return!A&&y&&y(),await new Promise((H,V)=>{a3(H,V,{data:z,headers:pi.from(k.headers),status:k.status,statusText:k.statusText,config:t,request:b})})}catch(S){throw y&&y(),S&&S.name==="TypeError"&&/Load failed|fetch/i.test(S.message)?Object.assign(new _r("Network Error",_r.ERR_NETWORK,t,b),{cause:S.cause||S}):_r.from(S,S&&S.code,t,b)}}),w2={http:jA,xhr:rC,fetch:dC};Qe.forEach(w2,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const g5=t=>`- ${t}`,fC=t=>Qe.isFunction(t)||t===null||t===!1,u3={getAdapter:t=>{t=Qe.isArray(t)?t:[t];const{length:e}=t;let r,n;const s={};for(let a=0;a<e;a++){r=t[a];let i;if(n=r,!fC(r)&&(n=w2[(i=String(r)).toLowerCase()],n===void 0))throw new _r(`Unknown adapter '${i}'`);if(n)break;s[i||"#"+a]=n}if(!n){const a=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let i=e?a.length>1?`since :
`+a.map(g5).join(`
`):" "+g5(a[0]):"as no adapter specified";throw new _r("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return n},adapters:w2};function g1(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new F0(null,t)}function v5(t){return g1(t),t.headers=pi.from(t.headers),t.data=x1.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),u3.getAdapter(t.adapter||gp.adapter)(t).then(function(n){return g1(t),n.data=x1.call(t,t.transformResponse,n),n.headers=pi.from(n.headers),n},function(n){return s3(n)||(g1(t),n&&n.response&&(n.response.data=x1.call(t,t.transformResponse,n.response),n.response.headers=pi.from(n.response.headers))),Promise.reject(n)})}const d3="1.11.0",qx={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{qx[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const y5={};qx.transitional=function(e,r,n){function s(a,i){return"[Axios v"+d3+"] Transitional option '"+a+"'"+i+(n?". "+n:"")}return(a,i,l)=>{if(e===!1)throw new _r(s(i," has been removed"+(r?" in "+r:"")),_r.ERR_DEPRECATED);return r&&!y5[i]&&(y5[i]=!0,console.warn(s(i," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(a,i,l):!0}};qx.spelling=function(e){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function hC(t,e,r){if(typeof t!="object")throw new _r("options must be an object",_r.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let s=n.length;for(;s-- >0;){const a=n[s],i=e[a];if(i){const l=t[a],c=l===void 0||i(l,a,t);if(c!==!0)throw new _r("option "+a+" must be "+c,_r.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new _r("Unknown option "+a,_r.ERR_BAD_OPTION)}}const Ym={assertOptions:hC,validators:qx},wl=Ym.validators;let Xd=class{constructor(e){this.defaults=e||{},this.interceptors={request:new u5,response:new u5}}async request(e,r){try{return await this._request(e,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=nf(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:a}=r;n!==void 0&&Ym.assertOptions(n,{silentJSONParsing:wl.transitional(wl.boolean),forcedJSONParsing:wl.transitional(wl.boolean),clarifyTimeoutError:wl.transitional(wl.boolean)},!1),s!=null&&(Qe.isFunction(s)?r.paramsSerializer={serialize:s}:Ym.assertOptions(s,{encode:wl.function,serialize:wl.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Ym.assertOptions(r,{baseUrl:wl.spelling("baseURL"),withXsrfToken:wl.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=a&&Qe.merge(a.common,a[r.method]);a&&Qe.forEach(["delete","get","head","post","put","patch","common"],b=>{delete a[b]}),r.headers=pi.concat(i,a);const l=[];let c=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(r)===!1||(c=c&&y.synchronous,l.unshift(y.fulfilled,y.rejected))});const d=[];this.interceptors.response.forEach(function(y){d.push(y.fulfilled,y.rejected)});let h,p=0,x;if(!c){const b=[v5.bind(this),void 0];for(b.unshift(...l),b.push(...d),x=b.length,h=Promise.resolve(r);p<x;)h=h.then(b[p++],b[p++]);return h}x=l.length;let m=r;for(p=0;p<x;){const b=l[p++],y=l[p++];try{m=b(m)}catch(w){y.call(this,w);break}}try{h=v5.call(this,m)}catch(b){return Promise.reject(b)}for(p=0,x=d.length;p<x;)h=h.then(d[p++],d[p++]);return h}getUri(e){e=nf(this.defaults,e);const r=i3(e.baseURL,e.url,e.allowAbsoluteUrls);return t3(r,e.params,e.paramsSerializer)}};Qe.forEach(["delete","get","head","options"],function(e){Xd.prototype[e]=function(r,n){return this.request(nf(n||{},{method:e,url:r,data:(n||{}).data}))}});Qe.forEach(["post","put","patch"],function(e){function r(n){return function(a,i,l){return this.request(nf(l||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}Xd.prototype[e]=r(),Xd.prototype[e+"Form"]=r(!0)});let pC=class f3{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(s=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](s);n._listeners=null}),this.promise.then=s=>{let a;const i=new Promise(l=>{n.subscribe(l),a=l}).then(s);return i.cancel=function(){n.unsubscribe(a)},i},e(function(a,i,l){n.reason||(n.reason=new F0(a,i,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=n=>{e.abort(n)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new f3(function(s){e=s}),cancel:e}}};function mC(t){return function(r){return t.apply(null,r)}}function xC(t){return Qe.isObject(t)&&t.isAxiosError===!0}const _2={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(_2).forEach(([t,e])=>{_2[e]=t});function h3(t){const e=new Xd(t),r=$4(Xd.prototype.request,e);return Qe.extend(r,Xd.prototype,e,{allOwnKeys:!0}),Qe.extend(r,e,null,{allOwnKeys:!0}),r.create=function(s){return h3(nf(t,s))},r}const Ar=h3(gp);Ar.Axios=Xd;Ar.CanceledError=F0;Ar.CancelToken=pC;Ar.isCancel=s3;Ar.VERSION=d3;Ar.toFormData=Wx;Ar.AxiosError=_r;Ar.Cancel=Ar.CanceledError;Ar.all=function(e){return Promise.all(e)};Ar.spread=mC;Ar.isAxiosError=xC;Ar.mergeConfig=nf;Ar.AxiosHeaders=pi;Ar.formToJSON=t=>n3(Qe.isHTMLForm(t)?new FormData(t):t);Ar.getAdapter=u3.getAdapter;Ar.HttpStatusCode=_2;Ar.default=Ar;const{Axios:cG,AxiosError:uG,CanceledError:dG,isCancel:fG,CancelToken:hG,VERSION:pG,all:mG,Cancel:xG,isAxiosError:gG,spread:vG,toFormData:yG,AxiosHeaders:bG,HttpStatusCode:wG,formToJSON:_G,getAdapter:NG,mergeConfig:SG}=Ar,p3=Q.createContext(),Jr=()=>{const t=Q.useContext(p3);if(!t)throw new Error("useAuth debe ser usado dentro de un AuthProvider");return t},v1="http://31.97.138.23:5001/api",gC=({children:t})=>{const[e,r]=Q.useState(null),[n,s]=Q.useState(localStorage.getItem("token")),[a,i]=Q.useState(!0);Q.useEffect(()=>{n?Ar.defaults.headers.common["x-auth-token"]=n:delete Ar.defaults.headers.common["x-auth-token"]},[n]),Q.useEffect(()=>{(async()=>{if(n)try{console.log("Verificando token...");const x=await Ar.get(`${v1}/auth/me`);console.log("Usuario verificado:",x.data),r(x.data)}catch(x){console.error("Token invlido:",x),c()}i(!1)})()},[n]);const l=async(p,x)=>{try{console.log("Iniciando login para:",p);const m=await Ar.post(`${v1}/auth/login`,{username:p,password:x}),{token:b,user:y}=m.data;return console.log("Login exitoso, datos usuario:",y),localStorage.setItem("token",b),s(b),r(y),i(!1),{success:!0}}catch(m){return console.error("Error en login:",m),console.error("Response data:",m.response?.data),console.error("Response status:",m.response?.status),i(!1),{success:!1,message:m.response?.data?.msg||"Error al iniciar sesin"}}},c=()=>{localStorage.removeItem("token"),s(null),r(null),delete Ar.defaults.headers.common["x-auth-token"]},h={user:e,token:n,loading:a,login:l,logout:c,changePassword:async(p,x)=>{try{return await Ar.put(`${v1}/auth/change-password`,{currentPassword:p,newPassword:x}),{success:!0}}catch(m){return{success:!1,message:m.response?.data?.msg||"Error al cambiar contrasea"}}},isAuthenticated:!!e,isAdmin:e?.role==="admin",isCoordinador:e?.role==="coordinador",isJefeOperaciones:e?.role==="jefe_operaciones",isAdministrativo:e?.role==="administrativo",isSupervisor:e?.role==="supervisor"||e?.role==="coordinador",isTechnician:e?.role==="technician",isAnonimo:e?.role==="anonimo",isGestorActivos:e?.role==="gestorActivos",isTecnicoInventario:e?.role==="tecnicoInventario",canSupervise:e?.role==="admin"||e?.role==="supervisor"||e?.role==="coordinador"||e?.role==="administrativo"||e?.role==="jefe_operaciones",canCreateIncidents:e?.role==="admin"||e?.role==="supervisor"||e?.role==="coordinador"||e?.role==="jefe_operaciones",canAccessAssets:e?.role==="tecnicoInventario"||e?.role==="gestorActivos"||e?.role==="admin",canViewAssetHistory:e?.role==="gestorActivos"||e?.role==="admin"};return o.jsx(p3.Provider,{value:h,children:t})};var vC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const yC=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),bC=(t,e)=>{const r=Q.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:i,children:l,...c},d)=>Q.createElement("svg",{ref:d,...vC,width:s,height:s,stroke:n,strokeWidth:i?Number(a)*24/Number(s):a,className:`lucide lucide-${yC(t)}`,...c},[...e.map(([h,p])=>Q.createElement(h,p)),...(Array.isArray(l)?l:[l])||[]]));return r.displayName=`${t}`,r};var Ft=bC;const ux=Ft("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),Di=Ft("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),mi=Ft("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Gx=Ft("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),m3=Ft("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),_v=Ft("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),vp=Ft("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),wc=Ft("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),_0=Ft("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),ia=Ft("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Ws=Ft("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),$h=Ft("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),bc=Ft("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Lu=Ft("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),wC=Ft("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),qs=Ft("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),_C=Ft("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),u0=Ft("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]),x3=Ft("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),g3=Ft("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),yp=Ft("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),v3=Ft("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Dl=Ft("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),y3=Ft("FileImage",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["circle",{cx:"10",cy:"13",r:"2",key:"6v46hv"}],["path",{d:"m20 17-1.09-1.09a2 2 0 0 0-2.82 0L10 22",key:"17vly1"}]]),qn=Ft("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),Xx=Ft("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),b5=Ft("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),dx=Ft("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),gm=Ft("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),NC=Ft("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Ec=Ft("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),SC=Ft("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),kC=Ft("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]),jC=Ft("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),EC=Ft("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),Yx=Ft("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Ac=Ft("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),AC=Ft("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),Nv=Ft("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),qu=Ft("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),CC=Ft("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),TC=Ft("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),FC=Ft("MonitorSpeaker",[["path",{d:"M5.5 20H8",key:"1k40s5"}],["path",{d:"M17 9h.01",key:"1j24nn"}],["rect",{width:"10",height:"16",x:"12",y:"4",rx:"2",key:"ixliua"}],["path",{d:"M8 6H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h4",key:"1mp6e1"}],["circle",{cx:"17",cy:"15",r:"1",key:"tqvash"}]]),Fn=Ft("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),Xo=Ft("Package",[["path",{d:"M16.5 9.4 7.55 4.24",key:"10qotr"}],["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),w5=Ft("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),Nh=Ft("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),Sh=Ft("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),b3=Ft("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),w3=Ft("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Pc=Ft("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),uo=Ft("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),bp=Ft("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Lc=Ft("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),_3=Ft("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),PC=Ft("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]),ho=Ft("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Yd=Ft("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),Dc=Ft("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),qd=Ft("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),Kx=Ft("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),LC=Ft("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),Wh=Ft("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),N3=Ft("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),DC=Ft("Truck",[["path",{d:"M10 17h4V5H2v12h3",key:"1jq12e"}],["path",{d:"M20 17h2v-3.34a4 4 0 0 0-1.17-2.83L19 9h-5",key:"1xb3ft"}],["path",{d:"M14 17h1",key:"nufu4t"}],["circle",{cx:"7.5",cy:"17.5",r:"2.5",key:"a7aife"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),S3=Ft("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Vo=Ft("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Bn=Ft("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Gu=Ft("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),k3=Ft("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]),RC=Ft("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),N2=Ft("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),Cc=Ft("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),gs=Ft("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),j3=Ft("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),IC=()=>{const[t,e]=Q.useState({username:"",password:""}),[r,n]=Q.useState(""),[s,a]=Q.useState(!1),[i,l]=Q.useState(!1),[c,d]=Q.useState(""),{login:h,isAuthenticated:p}=Jr();if(Q.useEffect(()=>{const b=document.querySelector(".particles");if(b)for(let y=0;y<50;y++){const w=document.createElement("div");w.className="particle",w.style.left=Math.random()*100+"%",w.style.animationDelay=Math.random()*20+"s",w.style.animationDuration=Math.random()*3+2+"s",b.appendChild(w)}},[]),p)return o.jsx(Wo,{to:"/dashboard",replace:!0});const x=b=>{e({...t,[b.target.name]:b.target.value}),r&&n("")},m=async b=>{b.preventDefault(),a(!0),n("");const y=await h(t.username,t.password);y.success||n(y.message),a(!1)};return o.jsxs("div",{className:"min-h-screen relative overflow-hidden bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 flex items-center justify-center px-4",children:[o.jsx("div",{className:"particles absolute inset-0 opacity-20"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/10 to-purple-600/10 animate-pulse"}),o.jsx("div",{className:"relative z-10 max-w-md w-full space-y-8",children:o.jsxs("div",{className:"bg-white/10 backdrop-blur-lg border border-white/20 rounded-2xl shadow-2xl p-8 transform hover:scale-105 transition-transform duration-300",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsxs("div",{className:"relative mx-auto h-20 w-20 mb-6",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full animate-spin-slow"}),o.jsx("div",{className:"relative h-full w-full bg-gradient-to-r from-blue-600 to-purple-700 rounded-full flex items-center justify-center",children:o.jsx(N2,{className:"h-10 w-10 text-white animate-bounce"})})]}),o.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent mb-2",children:"ASISTE ING"}),o.jsx("p",{className:"text-white/80 text-sm font-medium",children:"Sistema de Gestin Tcnica Profesional"}),o.jsxs("div",{className:"flex justify-center mt-4 space-x-6 text-white/60",children:[o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(Yd,{className:"h-4 w-4"}),o.jsx("span",{className:"text-xs",children:"Seguro"})]}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(j3,{className:"h-4 w-4"}),o.jsx("span",{className:"text-xs",children:"Rpido"})]}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(N2,{className:"h-4 w-4"}),o.jsx("span",{className:"text-xs",children:"Eficiente"})]})]})]}),o.jsxs("form",{className:"space-y-6",onSubmit:m,children:[r&&o.jsx("div",{className:"bg-red-500/20 border border-red-500/50 rounded-lg p-4 backdrop-blur-sm",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(Di,{className:"h-5 w-5 text-red-400 mr-3 animate-pulse"}),o.jsx("span",{className:"text-red-200 text-sm font-medium",children:r})]})}),o.jsxs("div",{className:"space-y-5",children:[o.jsxs("div",{className:"relative group",children:[o.jsx("label",{className:"block text-sm font-semibold text-white/90 mb-2",children:"Usuario"}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:o.jsx(Bn,{className:`h-5 w-5 transition-colors duration-200 ${c==="username"?"text-blue-400":"text-white/60"}`})}),o.jsx("input",{id:"username",name:"username",type:"text",required:!0,value:t.username,onChange:x,onFocus:()=>d("username"),onBlur:()=>d(""),className:"w-full pl-12 pr-4 py-3 bg-white/10 border border-white/30 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent backdrop-blur-sm transition-all duration-200 hover:bg-white/15",placeholder:"Ingrese su usuario"})]})]}),o.jsxs("div",{className:"relative group",children:[o.jsx("label",{className:"block text-sm font-semibold text-white/90 mb-2",children:"Contrasea"}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:o.jsx(jC,{className:`h-5 w-5 transition-colors duration-200 ${c==="password"?"text-blue-400":"text-white/60"}`})}),o.jsx("input",{id:"password",name:"password",type:i?"text":"password",required:!0,value:t.password,onChange:x,onFocus:()=>d("password"),onBlur:()=>d(""),className:"w-full pl-12 pr-12 py-3 bg-white/10 border border-white/30 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent backdrop-blur-sm transition-all duration-200 hover:bg-white/15",placeholder:"Ingrese su contrasea"}),o.jsx("button",{type:"button",onClick:()=>l(!i),className:"absolute inset-y-0 right-0 pr-4 flex items-center text-white/60 hover:text-white transition-colors duration-200",children:i?o.jsx(v3,{className:"h-5 w-5"}):o.jsx(Dl,{className:"h-5 w-5"})})]})]})]}),o.jsx("div",{className:"pt-2",children:o.jsxs("button",{type:"submit",disabled:s,className:"group relative w-full overflow-hidden rounded-lg bg-gradient-to-r from-blue-600 to-purple-600 py-3 px-4 text-white font-semibold shadow-lg transition-all duration-300 hover:from-blue-700 hover:to-purple-700 hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-transparent disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105 active:scale-95",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 -translate-x-full group-hover:translate-x-full transition-transform duration-700"}),o.jsx("div",{className:"relative flex items-center justify-center",children:s?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Iniciando sesin..."]}):o.jsxs(o.Fragment,{children:[o.jsx(EC,{className:"h-5 w-5 mr-2 group-hover:translate-x-1 transition-transform duration-200"}),"Iniciar Sesin"]})})]})})]})]})}),o.jsx("style",{jsx:!0,children:`
                .particles {
                    pointer-events: none;
                }
                .particle {
                    position: absolute;
                    width: 2px;
                    height: 2px;
                    background: rgba(255, 255, 255, 0.5);
                    animation: float linear infinite;
                }
                @keyframes float {
                    0% {
                        transform: translateY(100vh) translateX(0);
                        opacity: 1;
                    }
                    100% {
                        transform: translateY(-100px) translateX(50px);
                        opacity: 0;
                    }
                }
                @keyframes spin-slow {
                    from {
                        transform: rotate(0deg);
                    }
                    to {
                        transform: rotate(360deg);
                    }
                }
                .animate-spin-slow {
                    animation: spin-slow 8s linear infinite;
                }
            `})]})},OC="http://31.97.138.23:5001/api",Gt=Ar.create({baseURL:OC});Gt.interceptors.request.use(t=>{const e=localStorage.getItem("token");return e&&(t.headers["x-auth-token"]=e),t},t=>Promise.reject(t));Gt.interceptors.response.use(t=>t,t=>(t.response?.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(t)));const _c={getTechnicians:()=>Gt.get("/users/technicians"),getCoordinators:()=>Gt.get("/users/coordinators"),getAll:()=>Gt.get("/users"),getUsers:()=>Gt.get("/users"),getById:t=>Gt.get(`/users/${t}`),create:t=>Gt.post("/users",t),update:(t,e)=>Gt.put(`/users/${t}`,e),delete:t=>Gt.delete(`/users/${t}`)},E3={getAll:()=>Gt.get("/workstations"),getById:t=>Gt.get(`/workstations/${t}`),create:t=>Gt.post("/workstations",t),update:(t,e)=>Gt.put(`/workstations/${t}`,e),delete:t=>Gt.delete(`/workstations/${t}`)},Kt={getAll:(t={})=>Gt.get("/incidents",{params:t}),getMyIncidents:()=>Gt.get("/incidents/my-incidents"),getMyReports:()=>Gt.get("/incidents/my-reports"),getPending:(t={})=>Gt.get("/incidents/pending",{params:t}),getInSupervision:(t={})=>Gt.get("/incidents/supervision",{params:t}),getApproved:(t={})=>Gt.get("/incidents/approved",{params:t}),getReturnedIncidents:()=>Gt.get("/incidents/returned"),getById:t=>Gt.get(`/incidents/${t}`),getHistory:t=>Gt.get(`/incidents/${t}/history`),getAttachments:t=>Gt.get(`/incidents/${t}/attachments`),getStatsBySede:()=>Gt.get("/incidents/stats/by-sede"),getTechniciansStatus:()=>Gt.get("/incidents/stats/technicians"),getTechniciansRanking:()=>Gt.get("/incidents/stats/technicians-ranking"),getCoordinatorsRanking:()=>Gt.get("/incidents/stats/coordinators-ranking"),exportOldIncidents:(t=10)=>Gt.get(`/incidents/export/old-incidents?limit=${t}`),create:t=>Gt.post("/incidents",t),createWithFiles:t=>Gt.post("/incidents/with-files",t,{headers:{"Content-Type":"multipart/form-data"}}),assignTechnician:(t,e)=>Gt.put(`/incidents/${t}/assign`,{technician_id:e}),reassignTechnician:(t,e,r)=>Gt.put(`/incidents/${t}/reassign`,{technician_id:e,reason:r}),markAsResolved:(t,e)=>Gt.put(`/incidents/${t}/resolve`,{resolution_notes:e}),returnToCreator:(t,e)=>Gt.put(`/incidents/${t}/return`,{return_reason:e}),correctIncident:(t,e)=>Gt.put(`/incidents/${t}/correct`,e),approve:(t,e)=>Gt.put(`/incidents/${t}/approve`,e),reject:(t,e)=>Gt.put(`/incidents/${t}/reject`,{rejection_reason:e}),getMyRatings:()=>Gt.get("/incidents/my-ratings"),getTechnicianRatings:t=>Gt.get(`/incidents/ratings/${t}`),sendApprovalAlerts:(t,e)=>Gt.post("/incidents/send-alerts",{incident_ids:t,alert_message:e}),getMyAlerts:()=>Gt.get("/incidents/my-alerts"),markAlertAsRead:t=>Gt.put(`/incidents/alerts/${t}/read`),dismissAlert:t=>Gt.put(`/incidents/alerts/${t}/dismiss`)},ih={sendMessage:(t,e)=>Gt.post("/chat/send",{to_user_id:t,message:e}),getMessages:t=>Gt.get(`/chat/messages/${t}`),getConversations:()=>Gt.get("/chat/conversations"),getAdminInfo:()=>Gt.get("/chat/admin-info"),getUnreadCount:()=>Gt.get("/chat/unread-count")},ro={getOverview:()=>Gt.get("/analytics/overview"),getIncidentsBySede:()=>Gt.get("/analytics/by-sede"),getIncidentsByDepartment:()=>Gt.get("/analytics/by-department"),getIncidentsByFailureType:()=>Gt.get("/analytics/by-failure-type"),getTemporalTrend:(t=30)=>Gt.get(`/analytics/temporal-trend?period=${t}`),getTopFailingStations:(t=10)=>Gt.get(`/analytics/top-failing-stations?limit=${t}`),getTechnicianPerformance:()=>Gt.get("/analytics/technician-performance"),getReportsByUser:()=>Gt.get("/analytics/reports-by-user"),getHourlyDistribution:()=>Gt.get("/analytics/hourly-distribution"),getWeekdayDistribution:()=>Gt.get("/analytics/weekday-distribution"),getResolutionTimeAnalysis:()=>Gt.get("/analytics/resolution-time-analysis"),getQualityMetrics:()=>Gt.get("/analytics/quality-metrics")},MC=t=>{const[e,r]=Q.useState([]),[n,s]=Q.useState(0),a=Q.useRef(new Date),i=Q.useRef(null);Q.useEffect(()=>{if(t&&t.role==="technician"){"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission().then(k=>{k==="granted"&&console.log("Notificaciones habilitadas")});const S=async k=>{console.log(" Usuario hizo clic, habilitando audio...",k.target),h();try{c.current&&(c.current.volume=.01,await c.current.play(),c.current.pause(),c.current.currentTime=0,c.current.volume=.7,d.current=!0,console.log(" Audio habilitado correctamente"))}catch(A){console.warn(" No se pudo habilitar el audio:",A)}document.removeEventListener("click",S,!0),document.removeEventListener("touchstart",S,!0),document.removeEventListener("keydown",S,!0)};return document.addEventListener("click",S,{capture:!0,once:!0}),document.addEventListener("touchstart",S,{capture:!0,once:!0}),document.addEventListener("keydown",S,{capture:!0,once:!0}),()=>{document.removeEventListener("click",S,!0),document.removeEventListener("touchstart",S,!0),document.removeEventListener("keydown",S,!0)}}},[t]);const l=S=>{if("Notification"in window&&Notification.permission==="granted"){const k=S.status==="en_proceso"?"Nueva incidencia asignada":"Nueva incidencia pendiente",A=new Notification(k,{body:`Estacin: ${S.station_code}
Tipo: ${x(S.failure_type)}
Descripcin: ${S.description.substring(0,100)}${S.description.length>100?"...":""}`,icon:"/vite.svg",badge:"/vite.svg",tag:`incident-${S.id}`,requireInteraction:!0});A.onclick=()=>{window.focus(),A.close()},setTimeout(()=>A.close(),1e4)}},c=Q.useRef(null),d=Q.useRef(!1),h=()=>{c.current||(c.current=new Audio("/notification.mp3"),c.current.volume=.7,c.current.preload="auto",console.log(" Audio inicializado con notification.mp3"))},p=async()=>{if(console.log(" Intentando reproducir sonido de notificacin..."),console.log(" Audio habilitado:",d.current),!d.current){console.warn(" Audio no habilitado por el usuario an. Haz clic en cualquier lugar primero.");return}try{if(h(),!c.current){console.warn(" Audio no disponible");return}c.current.currentTime=0,await c.current.play(),console.log(" Sonido de notificacin reproducido correctamente")}catch(S){console.warn(" No se pudo reproducir el sonido de notificacin:",S);try{(()=>{const A=new(window.AudioContext||window.webkitAudioContext),z=A.createOscillator(),H=A.createGain();z.connect(H),H.connect(A.destination),z.frequency.value=800,H.gain.setValueAtTime(.3,A.currentTime),H.gain.exponentialRampToValueAtTime(.01,A.currentTime+.3),z.start(A.currentTime),z.stop(A.currentTime+.3)})(),console.log(" Sonido de respaldo reproducido")}catch(k){console.warn(" Mtodo de respaldo de audio tambin fall:",k)}}},x=S=>({pantalla:"Pantalla",perifericos:"Perifricos",internet:"Internet",software:"Software",otro:"Otro"})[S]||S,m=async()=>{if(!t||t.role!=="technician"){console.log("Usuario no es tcnico, saltando verificacin de notificaciones");return}console.log(" Verificando nuevas incidencias...",new Date().toLocaleTimeString());try{const[S,k]=await Promise.all([Kt.getMyIncidents(),Kt.getAll({status:"pendiente"})]),A=S.data,z=k.data,H=A.filter(R=>new Date(R.updated_at)>a.current&&R.status==="en_proceso"),V=z.filter(R=>new Date(R.created_at)>a.current),B=[...H,...V];if(console.log(` Nuevas asignadas: ${H.length}, Nuevas pendientes: ${V.length}, Total nuevas: ${B.length}`),B.length>0){console.log(" Nuevas incidencias encontradas, reproduciendo sonido y mostrando notificaciones");const R=B.map(O=>({id:`incident-${O.id}-${Date.now()}`,incidentId:O.id,title:O.status==="en_proceso"?"Nueva incidencia asignada":"Nueva incidencia pendiente",message:`${O.station_code} - ${x(O.failure_type)}`,timestamp:new Date,read:!1,incident:O}));r(O=>[...R,...O].slice(0,10)),s(O=>O+R.length),B.forEach(O=>{l(O)}),B.length>0&&p()}a.current=new Date}catch(S){console.error("Error verificando nuevas incidencias:",S)}};return Q.useEffect(()=>{if(t&&t.role==="technician")return m(),i.current=setInterval(m,3e4),()=>{i.current&&clearInterval(i.current)}},[t]),{notifications:e,unreadCount:n,markAsRead:S=>{r(k=>k.map(A=>A.id===S?{...A,read:!0}:A)),s(k=>Math.max(0,k-1))},markAllAsRead:()=>{r(S=>S.map(k=>({...k,read:!0}))),s(0)},clearNotifications:()=>{r([]),s(0)},checkForNewIncidents:m,testNotificationSound:p}},BC=()=>{const{user:t}=Jr(),[e,r]=Q.useState(0),[n,s]=Q.useState(!1),[a,i]=Q.useState(!1),l=async()=>{try{if(s(!0),t?.role==="admin"||t?.role==="coordinador"||t?.role==="supervisor"||t?.role==="jefe_operaciones"||t?.role==="administrativo"){const d=await Kt.getReturnedIncidents(),h=d.data||d||[],p=Array.isArray(h)?h:[];r(p.length)}}catch(d){console.error("Error obteniendo incidencias devueltas:",d),r(0)}finally{s(!1)}},c=()=>{i(!0),t&&localStorage.setItem(`returned_incidents_viewed_${t.id}`,"true")};return Q.useEffect(()=>{if(t){const d=localStorage.getItem(`returned_incidents_viewed_${t.id}`)==="true";i(d),l()}},[t]),{returnedCount:a?0:e,loading:n,refetch:l,markAsViewed:c}},UC=({notifications:t,unreadCount:e,markAsRead:r,markAllAsRead:n,clearNotifications:s,testNotificationSound:a})=>{const[i,l]=Q.useState(!1),c=d=>{const p=new Date-d,x=Math.floor(p/6e4),m=Math.floor(p/36e5),b=Math.floor(p/864e5);return x<1?"Ahora mismo":x<60?`Hace ${x} min`:m<24?`Hace ${m}h`:`Hace ${b}d`};return o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>l(!i),className:"relative p-2 text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 rounded-full",children:[o.jsx(wc,{className:"h-6 w-6"}),e>0&&o.jsx("span",{className:"absolute -top-1 -right-1 h-5 w-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center animate-pulse",children:e>9?"9+":e})]}),i&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>l(!1)}),o.jsx("div",{className:"absolute right-0 mt-2 w-80 sm:w-96 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-20",children:o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Notificaciones"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("button",{onClick:a,className:"text-xs text-green-600 hover:text-green-800 flex items-center",title:"Probar sonido de notificacin",children:[o.jsx(k3,{className:"h-3 w-3 mr-1"}),"Test Sonido"]}),e>0&&o.jsxs("button",{onClick:n,className:"text-xs text-blue-600 hover:text-blue-800 flex items-center",children:[o.jsx($h,{className:"h-3 w-3 mr-1"}),"Marcar todas"]}),t.length>0&&o.jsxs("button",{onClick:s,className:"text-xs text-gray-500 hover:text-gray-700 flex items-center",children:[o.jsx(Kx,{className:"h-3 w-3 mr-1"}),"Limpiar"]}),o.jsx("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-600",children:o.jsx(gs,{className:"h-4 w-4"})})]})]}),o.jsx("div",{className:"max-h-64 overflow-y-auto",children:t.length===0?o.jsxs("div",{className:"text-center py-6",children:[o.jsx(wc,{className:"h-8 w-8 text-gray-300 mx-auto mb-2"}),o.jsx("p",{className:"text-sm text-gray-500",children:"No hay notificaciones"})]}):o.jsx("div",{className:"space-y-2",children:t.map(d=>o.jsx("div",{className:`p-3 rounded-lg border cursor-pointer transition-colors ${d.read?"bg-gray-50 border-gray-200":"bg-blue-50 border-blue-200"}`,onClick:()=>{d.read||r(d.id)},children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("h4",{className:`text-sm font-medium ${d.read?"text-gray-700":"text-gray-900"}`,children:d.title}),!d.read&&o.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),o.jsx("p",{className:`text-sm mt-1 ${d.read?"text-gray-500":"text-gray-600"}`,children:d.message}),d.incident&&o.jsx("p",{className:"text-xs text-gray-400 mt-1 truncate",children:d.incident.description})]}),o.jsx("span",{className:"text-xs text-gray-400 ml-2 flex-shrink-0",children:c(d.timestamp)})]})},d.id))})}),t.length>0&&o.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:o.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Se verifican nuevas incidencias cada 30 segundos"})})]})})]})]})},zC=()=>{const[t,e]=Q.useState([]),[r,n]=Q.useState(0),[s,a]=Q.useState(!1),[i,l]=Q.useState(!1),c=Q.useRef(null);Q.useEffect(()=>{d();const y=setInterval(d,3e4);return()=>clearInterval(y)},[]),Q.useEffect(()=>{const y=w=>{c.current&&!c.current.contains(w.target)&&a(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]);const d=async()=>{try{const y=await Kt.getMyAlerts();e(y.data.alerts),n(y.data.unread_count)}catch(y){console.error("Error cargando alertas:",y)}},h=async y=>{try{await Kt.markAlertAsRead(y),await d()}catch(w){console.error("Error marcando alerta como leda:",w)}},p=async y=>{try{await Kt.dismissAlert(y),await d()}catch(w){console.error("Error descartando alerta:",w)}},x=()=>{a(!s),!s&&r>0&&t.filter(y=>y.status==="sent").forEach(y=>{h(y.id)})},m=y=>{const w=new Date,S=new Date(y),k=Math.floor((w-S)/(1e3*60*60));if(k<1)return"Hace menos de 1 hora";if(k===1)return"Hace 1 hora";if(k<24)return`Hace ${k} horas`;const A=Math.floor(k/24);return A===1?"Hace 1 da":`Hace ${A} das`},b=t.filter(y=>y.status!=="dismissed");return o.jsxs("div",{className:"relative",ref:c,children:[o.jsxs("button",{onClick:x,className:"relative p-2 text-gray-600 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-lg",children:[o.jsx(wc,{className:"h-6 w-6"}),r>0&&o.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full",children:r>9?"9+":r})]}),s&&o.jsxs("div",{className:"absolute right-0 mt-2 w-96 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Alertas ",r>0&&`(${r} sin leer)`]})}),o.jsx("div",{className:"max-h-96 overflow-y-auto",children:b.length===0?o.jsxs("div",{className:"p-4 text-center text-gray-500",children:[o.jsx(wc,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),o.jsx("p",{children:"No tienes alertas"})]}):b.map(y=>o.jsx("div",{className:`p-4 border-b border-gray-100 hover:bg-gray-50 ${y.status==="sent"?"bg-blue-50":""}`,children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx("span",{className:"text-sm font-medium text-gray-900",children:y.sent_by_name}),o.jsxs("span",{className:"text-xs text-gray-500",children:["(",y.sent_by_role,")"]}),y.status==="sent"&&o.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:"Nueva"})]}),o.jsx("p",{className:"text-sm text-gray-700 mb-2 whitespace-pre-line",children:y.message}),o.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[o.jsx(qs,{className:"h-3 w-3 mr-1"}),m(y.created_at)]})]}),o.jsxs("div",{className:"flex items-center space-x-1 ml-3",children:[y.status==="sent"&&o.jsx("button",{onClick:()=>h(y.id),className:"p-1 text-green-600 hover:text-green-800 hover:bg-green-100 rounded",title:"Marcar como leda",children:o.jsx($h,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>p(y.id),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-100 rounded",title:"Descartar",children:o.jsx(gs,{className:"h-4 w-4"})})]})]})},y.id))}),b.length>0&&o.jsx("div",{className:"p-3 border-t border-gray-200 text-center",children:o.jsx("button",{onClick:()=>a(!1),className:"text-sm text-blue-600 hover:text-blue-800",children:"Cerrar"})})]})]})},HC=()=>{const[t,e]=Q.useState([]),[r,n]=Q.useState(!1),[s,a]=Q.useState(null),[i,l]=Q.useState(!1),[c,d]=Q.useState([]),h=Q.useRef(null),p=Q.useRef(null);Q.useEffect(()=>{x(),m();const k=setInterval(()=>{x(),m()},1e4);return()=>clearInterval(k)},[]),Q.useEffect(()=>{if(t.length>0&&c.length>0&&!i){const k=t.filter(A=>A.status==="active");k.length>0&&(a(k[0]),n(!0),b(),p.current=setInterval(()=>{i||b()},18e5))}return()=>{p.current&&clearInterval(p.current)}},[t,c,i]);const x=async()=>{try{const k=await Kt.getMyAlerts();e(k.data.alerts)}catch(k){console.error("Error cargando alertas:",k)}},m=async()=>{try{const k=await Kt.getInSupervision();d(k.data)}catch(k){console.error("Error cargando incidencias en supervisin:",k),d([])}},b=()=>{h.current&&(h.current.currentTime=0,h.current.play().catch(k=>console.log("No se pudo reproducir sonido:",k)))},y=async()=>{if(s)try{await Kt.markAlertAsRead(s.id),l(!0),n(!1),p.current&&clearInterval(p.current),await x(),setTimeout(()=>{l(!1)},1e3)}catch(k){console.error("Error marcando alerta como leda:",k)}},w=()=>{y(),window.location.href="/incidents/supervision"},S=k=>{const A=new Date,z=new Date(k),H=Math.floor((A-z)/(1e3*60*60));if(H<1)return"Hace menos de 1 hora";if(H===1)return"Hace 1 hora";if(H<24)return`Hace ${H} horas`;const V=Math.floor(H/24);return V===1?"Hace 1 da":`Hace ${V} das`};return!r||!s?null:o.jsxs(o.Fragment,{children:[o.jsxs("audio",{ref:h,preload:"auto",style:{display:"none"},children:[o.jsx("source",{src:"/notification.mp3",type:"audio/mpeg"}),o.jsx("source",{src:"data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+LyvmUcBT2H0fPMcy0GMnfE8OKSQAoUXrTp66hVFApGn+LyvmUcBT2H0fPNeSsFJHfH8N2QQAoUXrTp66hVFApGn+LyvmUcBT2H0fPMcy0GMXLF8OOTRQsWYLDn7LJaEwlCm+LvuWYdBjiR1/LMeiwFJIHO8tiJOQgZZ7zs6J9OEAxPq+PztmMcBjiS2PLKC",type:"audio/wav"})]}),o.jsx("div",{className:"fixed inset-0 pointer-events-none flex items-center justify-center z-[9999]",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-2xl w-full mx-4 pointer-events-auto",children:[o.jsx("div",{className:"bg-red-600 text-white p-4 rounded-t-lg",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(mi,{className:"h-8 w-8 animate-bounce"}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-bold",children:" ALERTA CRTICA - ACCIN REQUERIDA "}),o.jsx("p",{className:"text-red-100",children:"Tienes incidencias pendientes que requieren tu atencin"})]})]})}),o.jsxs("div",{className:"p-6",children:[o.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6",children:o.jsxs("div",{className:"flex items-start",children:[o.jsx(mi,{className:"h-6 w-6 text-yellow-600 mr-3 mt-1"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"Mensaje del Administrador"}),o.jsx("div",{className:"text-yellow-700 whitespace-pre-line text-sm mb-3",children:s.message}),o.jsxs("div",{className:"flex items-center text-xs text-yellow-600 space-x-4",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Bn,{className:"h-4 w-4 mr-1"}),"Enviado por: ",s.sent_by_name]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx(qs,{className:"h-4 w-4 mr-1"}),S(s.created_at)]})]})]})]})}),o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[o.jsx("h4",{className:"text-red-800 font-semibold mb-2",children:" IMPORTANTE:"}),o.jsxs("ul",{className:"text-red-700 text-sm space-y-1",children:[o.jsxs("li",{children:[" Tienes ",o.jsx("strong",{children:c.length})," incidencia(s) pendiente(s) de supervisin"]}),o.jsx("li",{children:" Las incidencias llevan ms de 3 horas sin supervisin"}),o.jsx("li",{children:" Esto afecta los tiempos de respuesta del equipo tcnico"}),o.jsx("li",{children:" Debes revisar y aprobar/rechazar las incidencias pendientes"}),o.jsx("li",{children:" Puedes seguir trabajando mientras tanto"})]})]}),o.jsxs("div",{className:"flex space-x-4",children:[o.jsx("button",{onClick:w,className:"flex-1 bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors",children:" IR A SUPERVISIN AHORA"}),o.jsx("button",{onClick:y,className:"bg-gray-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-gray-600 transition-colors",children:" HE VISTO LA ALERTA"})]}),o.jsx("div",{className:"mt-4 text-center",children:o.jsx("p",{className:"text-xs text-gray-500",children:"Esta alerta se repetir cada 30 minutos hasta que sea atendida"})})]})]})})]})},Rl=Object.create(null);Rl.open="0";Rl.close="1";Rl.ping="2";Rl.pong="3";Rl.message="4";Rl.upgrade="5";Rl.noop="6";const Km=Object.create(null);Object.keys(Rl).forEach(t=>{Km[Rl[t]]=t});const S2={type:"error",data:"parser error"},A3=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",C3=typeof ArrayBuffer=="function",T3=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,Sv=({type:t,data:e},r,n)=>A3&&e instanceof Blob?r?n(e):_5(e,n):C3&&(e instanceof ArrayBuffer||T3(e))?r?n(e):_5(new Blob([e]),n):n(Rl[t]+(e||"")),_5=(t,e)=>{const r=new FileReader;return r.onload=function(){const n=r.result.split(",")[1];e("b"+(n||""))},r.readAsDataURL(t)};function N5(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let y1;function $C(t,e){if(A3&&t.data instanceof Blob)return t.data.arrayBuffer().then(N5).then(e);if(C3&&(t.data instanceof ArrayBuffer||T3(t.data)))return e(N5(t.data));Sv(t,!1,r=>{y1||(y1=new TextEncoder),e(y1.encode(r))})}const S5="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",xh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<S5.length;t++)xh[S5.charCodeAt(t)]=t;const WC=t=>{let e=t.length*.75,r=t.length,n,s=0,a,i,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const d=new ArrayBuffer(e),h=new Uint8Array(d);for(n=0;n<r;n+=4)a=xh[t.charCodeAt(n)],i=xh[t.charCodeAt(n+1)],l=xh[t.charCodeAt(n+2)],c=xh[t.charCodeAt(n+3)],h[s++]=a<<2|i>>4,h[s++]=(i&15)<<4|l>>2,h[s++]=(l&3)<<6|c&63;return d},VC=typeof ArrayBuffer=="function",kv=(t,e)=>{if(typeof t!="string")return{type:"message",data:F3(t,e)};const r=t.charAt(0);return r==="b"?{type:"message",data:qC(t.substring(1),e)}:Km[r]?t.length>1?{type:Km[r],data:t.substring(1)}:{type:Km[r]}:S2},qC=(t,e)=>{if(VC){const r=WC(t);return F3(r,e)}else return{base64:!0,data:t}},F3=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},P3="",GC=(t,e)=>{const r=t.length,n=new Array(r);let s=0;t.forEach((a,i)=>{Sv(a,!1,l=>{n[i]=l,++s===r&&e(n.join(P3))})})},XC=(t,e)=>{const r=t.split(P3),n=[];for(let s=0;s<r.length;s++){const a=kv(r[s],e);if(n.push(a),a.type==="error")break}return n};function YC(){return new TransformStream({transform(t,e){$C(t,r=>{const n=r.length;let s;if(n<126)s=new Uint8Array(1),new DataView(s.buffer).setUint8(0,n);else if(n<65536){s=new Uint8Array(3);const a=new DataView(s.buffer);a.setUint8(0,126),a.setUint16(1,n)}else{s=new Uint8Array(9);const a=new DataView(s.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(n))}t.data&&typeof t.data!="string"&&(s[0]|=128),e.enqueue(s),e.enqueue(r)})}})}let b1;function vm(t){return t.reduce((e,r)=>e+r.length,0)}function ym(t,e){if(t[0].length===e)return t.shift();const r=new Uint8Array(e);let n=0;for(let s=0;s<e;s++)r[s]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),r}function KC(t,e){b1||(b1=new TextDecoder);const r=[];let n=0,s=-1,a=!1;return new TransformStream({transform(i,l){for(r.push(i);;){if(n===0){if(vm(r)<1)break;const c=ym(r,1);a=(c[0]&128)===128,s=c[0]&127,s<126?n=3:s===126?n=1:n=2}else if(n===1){if(vm(r)<2)break;const c=ym(r,2);s=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),n=3}else if(n===2){if(vm(r)<8)break;const c=ym(r,8),d=new DataView(c.buffer,c.byteOffset,c.length),h=d.getUint32(0);if(h>Math.pow(2,21)-1){l.enqueue(S2);break}s=h*Math.pow(2,32)+d.getUint32(4),n=3}else{if(vm(r)<s)break;const c=ym(r,s);l.enqueue(kv(a?c:b1.decode(c),e)),n=0}if(s===0||s>t){l.enqueue(S2);break}}}})}const L3=4;function Ss(t){if(t)return JC(t)}function JC(t){for(var e in Ss.prototype)t[e]=Ss.prototype[e];return t}Ss.prototype.on=Ss.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};Ss.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};Ss.prototype.off=Ss.prototype.removeListener=Ss.prototype.removeAllListeners=Ss.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,s=0;s<r.length;s++)if(n=r[s],n===e||n.fn===e){r.splice(s,1);break}return r.length===0&&delete this._callbacks["$"+t],this};Ss.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,s=r.length;n<s;++n)r[n].apply(this,e)}return this};Ss.prototype.emitReserved=Ss.prototype.emit;Ss.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};Ss.prototype.hasListeners=function(t){return!!this.listeners(t).length};const Jx=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,r)=>r(e,0),fo=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),QC="arraybuffer";function D3(t,...e){return e.reduce((r,n)=>(t.hasOwnProperty(n)&&(r[n]=t[n]),r),{})}const ZC=fo.setTimeout,e8=fo.clearTimeout;function Qx(t,e){e.useNativeTimers?(t.setTimeoutFn=ZC.bind(fo),t.clearTimeoutFn=e8.bind(fo)):(t.setTimeoutFn=fo.setTimeout.bind(fo),t.clearTimeoutFn=fo.clearTimeout.bind(fo))}const t8=1.33;function r8(t){return typeof t=="string"?n8(t):Math.ceil((t.byteLength||t.size)*t8)}function n8(t){let e=0,r=0;for(let n=0,s=t.length;n<s;n++)e=t.charCodeAt(n),e<128?r+=1:e<2048?r+=2:e<55296||e>=57344?r+=3:(n++,r+=4);return r}function R3(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function s8(t){let e="";for(let r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e}function a8(t){let e={},r=t.split("&");for(let n=0,s=r.length;n<s;n++){let a=r[n].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}class i8 extends Error{constructor(e,r,n){super(e),this.description=r,this.context=n,this.type="TransportError"}}class jv extends Ss{constructor(e){super(),this.writable=!1,Qx(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,r,n){return super.emitReserved("error",new i8(e,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const r=kv(e,this.socket.binaryType);this.onPacket(r)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,r={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const r=s8(e);return r.length?"?"+r:""}}class o8 extends jv{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const r=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};XC(e,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,GC(e,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=R3()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(e,r)}}let I3=!1;try{I3=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const l8=I3;function c8(){}class u8 extends o8{constructor(e){if(super(e),typeof location<"u"){const r=location.protocol==="https:";let n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,r){const n=this.request({method:"POST",data:e});n.on("success",r),n.on("error",(s,a)=>{this.onError("xhr post error",s,a)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=e}}let d0=class Jm extends Ss{constructor(e,r,n){super(),this.createRequest=e,Qx(this,n),this._opts=n,this._method=n.method||"GET",this._uri=r,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const r=D3(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(r);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let s in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(s)&&n.setRequestHeader(s,this._opts.extraHeaders[s])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var s;n.readyState===3&&((s=this._opts.cookieJar)===null||s===void 0||s.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(s){this.setTimeoutFn(()=>{this._onError(s)},0);return}typeof document<"u"&&(this._index=Jm.requestsCount++,Jm.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=c8,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Jm.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};d0.requestsCount=0;d0.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",k5);else if(typeof addEventListener=="function"){const t="onpagehide"in fo?"pagehide":"unload";addEventListener(t,k5,!1)}}function k5(){for(let t in d0.requests)d0.requests.hasOwnProperty(t)&&d0.requests[t].abort()}const d8=(function(){const t=O3({xdomain:!1});return t&&t.responseType!==null})();class f8 extends u8{constructor(e){super(e);const r=e&&e.forceBase64;this.supportsBinary=d8&&!r}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new d0(O3,this.uri(),e)}}function O3(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||l8))return new XMLHttpRequest}catch{}if(!e)try{return new fo[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const M3=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class h8 extends jv{get name(){return"websocket"}doOpen(){const e=this.uri(),r=this.opts.protocols,n=M3?{}:D3(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,r,n)}catch(s){return this.emitReserved("error",s)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let r=0;r<e.length;r++){const n=e[r],s=r===e.length-1;Sv(n,this.supportsBinary,a=>{try{this.doWrite(n,a)}catch{}s&&Jx(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=R3()),this.supportsBinary||(r.b64=1),this.createUri(e,r)}}const w1=fo.WebSocket||fo.MozWebSocket;class p8 extends h8{createSocket(e,r,n){return M3?new w1(e,r,n):r?new w1(e,r):new w1(e)}doWrite(e,r){this.ws.send(r)}}class m8 extends jv{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const r=KC(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(r).getReader(),s=YC();s.readable.pipeTo(e.writable),this._writer=s.writable.getWriter();const a=()=>{n.read().then(({done:l,value:c})=>{l||(this.onPacket(c),a())}).catch(l=>{})};a();const i={type:"open"};this.query.sid&&(i.data=`{"sid":"${this.query.sid}"}`),this._writer.write(i).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let r=0;r<e.length;r++){const n=e[r],s=r===e.length-1;this._writer.write(n).then(()=>{s&&Jx(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const x8={websocket:p8,webtransport:m8,polling:f8},g8=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,v8=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function k2(t){if(t.length>8e3)throw"URI too long";const e=t,r=t.indexOf("["),n=t.indexOf("]");r!=-1&&n!=-1&&(t=t.substring(0,r)+t.substring(r,n).replace(/:/g,";")+t.substring(n,t.length));let s=g8.exec(t||""),a={},i=14;for(;i--;)a[v8[i]]=s[i]||"";return r!=-1&&n!=-1&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=y8(a,a.path),a.queryKey=b8(a,a.query),a}function y8(t,e){const r=/\/{2,9}/g,n=e.replace(r,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function b8(t,e){const r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,s,a){s&&(r[s]=a)}),r}const j2=typeof addEventListener=="function"&&typeof removeEventListener=="function",Qm=[];j2&&addEventListener("offline",()=>{Qm.forEach(t=>t())},!1);class Wu extends Ss{constructor(e,r){if(super(),this.binaryType=QC,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(r=e,e=null),e){const n=k2(e);r.hostname=n.host,r.secure=n.protocol==="https"||n.protocol==="wss",r.port=n.port,n.query&&(r.query=n.query)}else r.host&&(r.hostname=k2(r.host).host);Qx(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(n=>{const s=n.prototype.name;this.transports.push(s),this._transportsByName[s]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=a8(this.opts.query)),j2&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Qm.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const r=Object.assign({},this.opts.query);r.EIO=L3,r.transport=e,this.id&&(r.sid=this.id);const n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Wu.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(e);r.open(),this.setTransport(r)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",Wu.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=e.data,this._onError(r);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){const s=this.writeBuffer[n].data;if(s&&(r+=r8(s)),n>0&&r>this._maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Jx(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,r,n){return this._sendPacket("message",e,r,n),this}send(e,r,n){return this._sendPacket("message",e,r,n),this}_sendPacket(e,r,n,s){if(typeof r=="function"&&(s=r,r=void 0),typeof n=="function"&&(s=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const a={type:e,data:r,options:n};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),s&&this.once("flush",s),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),e()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(Wu.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),j2&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=Qm.indexOf(this._offlineEventListener);n!==-1&&Qm.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,r),this.writeBuffer=[],this._prevBufferLen=0}}}Wu.protocol=L3;class w8 extends Wu{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let r=this.createTransport(e),n=!1;Wu.priorWebsocketSuccess=!1;const s=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",p=>{if(!n)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;Wu.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(h(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const x=new Error("probe error");x.transport=r.name,this.emitReserved("upgradeError",x)}}))};function a(){n||(n=!0,h(),r.close(),r=null)}const i=p=>{const x=new Error("probe error: "+p);x.transport=r.name,a(),this.emitReserved("upgradeError",x)};function l(){i("transport closed")}function c(){i("socket closed")}function d(p){r&&p.name!==r.name&&a()}const h=()=>{r.removeListener("open",s),r.removeListener("error",i),r.removeListener("close",l),this.off("close",c),this.off("upgrading",d)};r.once("open",s),r.once("error",i),r.once("close",l),this.once("close",c),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const r=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&r.push(e[n]);return r}}let _8=class extends w8{constructor(e,r={}){const n=typeof e=="object"?e:r;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(s=>x8[s]).filter(s=>!!s)),super(e,n)}};function N8(t,e="",r){let n=t;r=r||typeof location<"u"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(typeof r<"u"?t=r.protocol+"//"+t:t="https://"+t),n=k2(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const a=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port+e,n.href=n.protocol+"://"+a+(r&&r.port===n.port?"":":"+n.port),n}const S8=typeof ArrayBuffer=="function",k8=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,B3=Object.prototype.toString,j8=typeof Blob=="function"||typeof Blob<"u"&&B3.call(Blob)==="[object BlobConstructor]",E8=typeof File=="function"||typeof File<"u"&&B3.call(File)==="[object FileConstructor]";function Ev(t){return S8&&(t instanceof ArrayBuffer||k8(t))||j8&&t instanceof Blob||E8&&t instanceof File}function Zm(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(Zm(t[r]))return!0;return!1}if(Ev(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Zm(t.toJSON(),!0);for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&Zm(t[r]))return!0;return!1}function A8(t){const e=[],r=t.data,n=t;return n.data=E2(r,e),n.attachments=e.length,{packet:n,buffers:e}}function E2(t,e){if(!t)return t;if(Ev(t)){const r={_placeholder:!0,num:e.length};return e.push(t),r}else if(Array.isArray(t)){const r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=E2(t[n],e);return r}else if(typeof t=="object"&&!(t instanceof Date)){const r={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=E2(t[n],e));return r}return t}function C8(t,e){return t.data=A2(t.data,e),delete t.attachments,t}function A2(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=A2(t[r],e);else if(typeof t=="object")for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=A2(t[r],e));return t}const T8=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],F8=5;var Rr;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(Rr||(Rr={}));class P8{constructor(e){this.replacer=e}encode(e){return(e.type===Rr.EVENT||e.type===Rr.ACK)&&Zm(e)?this.encodeAsBinary({type:e.type===Rr.EVENT?Rr.BINARY_EVENT:Rr.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let r=""+e.type;return(e.type===Rr.BINARY_EVENT||e.type===Rr.BINARY_ACK)&&(r+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(r+=e.nsp+","),e.id!=null&&(r+=e.id),e.data!=null&&(r+=JSON.stringify(e.data,this.replacer)),r}encodeAsBinary(e){const r=A8(e),n=this.encodeAsString(r.packet),s=r.buffers;return s.unshift(n),s}}function j5(t){return Object.prototype.toString.call(t)==="[object Object]"}class Av extends Ss{constructor(e){super(),this.reviver=e}add(e){let r;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(e);const n=r.type===Rr.BINARY_EVENT;n||r.type===Rr.BINARY_ACK?(r.type=n?Rr.EVENT:Rr.ACK,this.reconstructor=new L8(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(Ev(e)||e.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(e),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let r=0;const n={type:Number(e.charAt(0))};if(Rr[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===Rr.BINARY_EVENT||n.type===Rr.BINARY_ACK){const a=r+1;for(;e.charAt(++r)!=="-"&&r!=e.length;);const i=e.substring(a,r);if(i!=Number(i)||e.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(i)}if(e.charAt(r+1)==="/"){const a=r+1;for(;++r&&!(e.charAt(r)===","||r===e.length););n.nsp=e.substring(a,r)}else n.nsp="/";const s=e.charAt(r+1);if(s!==""&&Number(s)==s){const a=r+1;for(;++r;){const i=e.charAt(r);if(i==null||Number(i)!=i){--r;break}if(r===e.length)break}n.id=Number(e.substring(a,r+1))}if(e.charAt(++r)){const a=this.tryParse(e.substr(r));if(Av.isPayloadValid(n.type,a))n.data=a;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,r){switch(e){case Rr.CONNECT:return j5(r);case Rr.DISCONNECT:return r===void 0;case Rr.CONNECT_ERROR:return typeof r=="string"||j5(r);case Rr.EVENT:case Rr.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&T8.indexOf(r[0])===-1);case Rr.ACK:case Rr.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class L8{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const r=C8(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const D8=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Av,Encoder:P8,get PacketType(){return Rr},protocol:F8},Symbol.toStringTag,{value:"Module"}));function $o(t,e,r){return t.on(e,r),function(){t.off(e,r)}}const R8=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class U3 extends Ss{constructor(e,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[$o(e,"open",this.onopen.bind(this)),$o(e,"packet",this.onpacket.bind(this)),$o(e,"error",this.onerror.bind(this)),$o(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...r){var n,s,a;if(R8.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(r.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const i={type:Rr.EVENT,data:r};if(i.options={},i.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const h=this.ids++,p=r.pop();this._registerAckCallback(h,p),i.id=h}const l=(s=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||s===void 0?void 0:s.writable,c=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!l||(c?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(e,r){var n;const s=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(s===void 0){this.acks[e]=r;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);r.call(this,new Error("operation has timed out"))},s),i=(...l)=>{this.io.clearTimeoutFn(a),r.apply(this,l)};i.withError=!0,this.acks[e]=i}emitWithAck(e,...r){return new Promise((n,s)=>{const a=(i,l)=>i?s(i):n(l);a.withError=!0,r.push(a),this.emit(e,...r)})}_addToQueue(e){let r;typeof e[e.length-1]=="function"&&(r=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((s,...a)=>n!==this._queue[0]?void 0:(s!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(s)):(this._queue.shift(),r&&r(null,...a)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!e||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Rr.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Rr.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Rr.EVENT:case Rr.BINARY_EVENT:this.onevent(e);break;case Rr.ACK:case Rr.BINARY_ACK:this.onack(e);break;case Rr.DISCONNECT:this.ondisconnect();break;case Rr.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const r=e.data||[];e.id!=null&&r.push(this.ack(e.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const n of r)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const r=this;let n=!1;return function(...s){n||(n=!0,r.packet({type:Rr.ACK,id:e,data:s}))}}onack(e){const r=this.acks[e.id];typeof r=="function"&&(delete this.acks[e.id],r.withError&&e.data.unshift(null),r.apply(this,e.data))}onconnect(e,r){this.id=e,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Rr.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const r=this._anyListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const n of r)n.apply(this,e.data)}}}function P0(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}P0.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-r:t+r}return Math.min(t,this.max)|0};P0.prototype.reset=function(){this.attempts=0};P0.prototype.setMin=function(t){this.ms=t};P0.prototype.setMax=function(t){this.max=t};P0.prototype.setJitter=function(t){this.jitter=t};class C2 extends Ss{constructor(e,r){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(r=e,e=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,Qx(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new P0({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=e;const s=r.parser||D8;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var r;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(r=this.backoff)===null||r===void 0||r.setMin(e),this)}randomizationFactor(e){var r;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(r=this.backoff)===null||r===void 0||r.setJitter(e),this)}reconnectionDelayMax(e){var r;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(r=this.backoff)===null||r===void 0||r.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new _8(this.uri,this.opts);const r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const s=$o(r,"open",function(){n.onopen(),e&&e()}),a=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},i=$o(r,"error",a);if(this._timeout!==!1){const l=this._timeout,c=this.setTimeoutFn(()=>{s(),a(new Error("timeout")),r.close()},l);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(s),this.subs.push(i),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push($o(e,"ping",this.onping.bind(this)),$o(e,"data",this.ondata.bind(this)),$o(e,"error",this.onerror.bind(this)),$o(e,"close",this.onclose.bind(this)),$o(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(r){this.onclose("parse error",r)}}ondecoded(e){Jx(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,r){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new U3(this,e,r),this.nsps[e]=n),n}_destroy(e){const r=Object.keys(this.nsps);for(const n of r)if(this.nsps[n].active)return;this._close()}_packet(e){const r=this.encoder.encode(e);for(let n=0;n<r.length;n++)this.engine.write(r[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,r){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(s=>{s?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",s)):e.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const oh={};function ex(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const r=N8(t,e.path||"/socket.io"),n=r.source,s=r.id,a=r.path,i=oh[s]&&a in oh[s].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||i;let c;return l?c=new C2(n,e):(oh[s]||(oh[s]=new C2(n,e)),c=oh[s]),r.query&&!e.query&&(e.query=r.queryKey),c.socket(r.path,e)}Object.assign(ex,{Manager:C2,Socket:U3,io:ex,connect:ex});const z3=()=>{const{user:t}=Jr(),[e,r]=Q.useState(!1),[n,s]=Q.useState(!1),[a,i]=Q.useState([]),[l,c]=Q.useState(""),[d,h]=Q.useState(!1),[p,x]=Q.useState(null),[m,b]=Q.useState(0),[y,w]=Q.useState(!1),S=Q.useRef(null),k=Q.useRef(null);if(t?.role!=="anonimo")return null;Q.useEffect(()=>{if(A(),H(),t?.id){const P="http://31.97.138.23:5001";return k.current=ex(P),k.current.emit("authenticate",t.id),k.current.on("new_message",ae=>{try{console.log("Nuevo mensaje recibido:",ae),i(G=>[...G,ae.message]),e?R():(w(!0),r(!0),b(G=>G+1))}catch(G){console.error("Error procesando mensaje nuevo:",G)}}),k.current.on("connect_error",ae=>{console.error("Error de conexin WebSocket:",ae)}),()=>{k.current&&k.current.disconnect()}}},[t?.id,e]),Q.useEffect(()=>{B()},[a]),Q.useEffect(()=>{e&&!n&&setTimeout(()=>{B()},100)},[e,n]);const A=async()=>{try{const P=await ih.getAdminInfo();x(P.data.admin)}catch(P){console.error("Error cargando info del admin:",P)}},z=async()=>{if(p)try{const P=await ih.getMessages(p.id);i(P.data.messages)}catch(P){console.error("Error cargando mensajes:",P)}},H=async()=>{try{const P=await ih.getUnreadCount();b(P.data.unread_count)}catch(P){console.error("Error cargando conteo no ledos:",P)}},V=async()=>{if(!(!l.trim()||!p||d)){h(!0);try{await ih.sendMessage(p.id,l.trim()),c(""),await z(),await H()}catch(P){console.error("Error enviando mensaje:",P),alert("Error al enviar mensaje")}finally{h(!1)}}},B=()=>{S.current?.scrollIntoView({behavior:"smooth"})},R=async()=>{if(p&&m>0)try{await ih.markAsRead(p.id),b(0),w(!1)}catch(P){console.error("Error marcando como ledo:",P)}},O=()=>{r(!0),s(!1),w(!1),p&&(z(),R())},ee=P=>{P.key==="Enter"&&!P.shiftKey&&(P.preventDefault(),V())},I=P=>new Date(P).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"});return o.jsxs("div",{className:"fixed bottom-4 right-4 z-50",children:[!e&&o.jsxs("button",{onClick:O,className:`bg-purple-600 hover:bg-purple-700 text-white rounded-full p-3 shadow-lg transition-all duration-300 relative ${y?"animate-bounce":""}`,children:[o.jsx(qu,{className:"h-6 w-6"}),y&&o.jsx(wc,{className:"absolute -top-1 -left-1 h-4 w-4 text-yellow-400 animate-pulse"}),m>0&&o.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center animate-pulse",children:m>9?"9+":m})]}),e&&o.jsxs("div",{className:`bg-white rounded-lg shadow-xl border transition-all duration-300 ${n?"w-80 h-12":"w-80 h-96"}`,children:[o.jsxs("div",{className:"bg-purple-600 text-white p-3 rounded-t-lg flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),o.jsxs("span",{className:"font-medium text-sm",children:["Chat con ",p?.full_name||"Administrador"]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:()=>s(!n),className:"text-purple-200 hover:text-white",children:n?o.jsx(AC,{className:"h-4 w-4"}):o.jsx(TC,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>r(!1),className:"text-purple-200 hover:text-white",children:o.jsx(gs,{className:"h-4 w-4"})})]})]}),!n&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"h-64 overflow-y-auto p-3 space-y-2 bg-white",children:[a.length===0?o.jsxs("div",{className:"text-center text-gray-500 text-sm mt-8",children:[o.jsx(qu,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),o.jsx("p",{children:"Hola! Puedes escribir aqu para comunicarte con el administrador."})]}):a.map(P=>o.jsx("div",{className:`flex ${P.from_user_id===t.id?"justify-end":"justify-start"}`,children:o.jsxs("div",{className:`max-w-xs px-3 py-2 rounded-lg text-sm ${P.from_user_id===t.id?"bg-purple-600 text-white":"bg-gray-200 text-gray-800"}`,children:[o.jsx("p",{className:"whitespace-pre-wrap",children:P.message}),o.jsx("p",{className:`text-xs mt-1 ${P.from_user_id===t.id?"text-purple-200":"text-gray-500"}`,children:I(P.created_at)})]})},P.id)),o.jsx("div",{ref:S})]}),o.jsx("div",{className:"border-t p-3",children:o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("textarea",{value:l,onChange:P=>c(P.target.value),onKeyPress:ee,placeholder:"Escribe tu mensaje...",className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 resize-none",rows:"1",disabled:d}),o.jsx("button",{onClick:V,disabled:d||!l.trim(),className:"bg-purple-600 text-white p-2 rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed",children:o.jsx(_3,{className:"h-4 w-4"})})]})})]})]})]})},I8=()=>{const[t,e]=Q.useState(!1),[r,n]=Q.useState([]),[s,a]=Q.useState([]),{user:i,logout:l,isAdmin:c,isSupervisor:d,isCoordinador:h,isJefeOperaciones:p,isTechnician:x,canSupervise:m}=Jr(),b=Jo(),y=Oi(),w=i?.username==="hannycita10",S=i?.username==="davidlopez10",{notifications:k,unreadCount:A,markAsRead:z,markAllAsRead:H,clearNotifications:V,testNotificationSound:B}=MC(i),{returnedCount:R}=BC(),O=()=>{l(),y("/login")},ee=fe=>{if(!w)return;const K={id:Date.now()+Math.random(),x:fe.clientX,y:fe.clientY};n(E=>[...E,K]),setTimeout(()=>{n(E=>E.filter(W=>W.id!==K.id))},1e3)},I=fe=>{if(!S)return;const K=Array.from({length:3},(E,W)=>({id:Date.now()+Math.random()+W,x:fe.clientX+(Math.random()-.5)*20,y:fe.clientY+(Math.random()-.5)*20,color:W%2===0?"#00E5FF":"#E10600"}));a(E=>[...E,...K]),setTimeout(()=>{a(E=>E.filter(W=>!K.find(L=>L.id===W.id)))},800)},P=fe=>{ee(fe),I(fe)};Q.useEffect(()=>{w||n([]),S||a([])},[w,S]);const G=[{name:"Dashboard",href:"/dashboard",icon:SC,roles:["admin","supervisor","coordinador","jefe_operaciones","technician","administrativo"]},{name:"Crear Incidencia",href:"/incidents/create",icon:mi,roles:["admin","supervisor","coordinador","jefe_operaciones","administrativo"]},{name:"Mis Casos Reportados",href:"/incidents/my-reports",icon:qn,roles:["supervisor","coordinador","jefe_operaciones","administrativo"]},{name:"Incidencias Pendientes",href:"/incidents/pending",icon:qs,roles:["admin","technician","jefe_operaciones"]},{name:"Mis Incidencias",href:"/incidents/my-incidents",icon:Bn,roles:["technician"],showBadge:!0},{name:"En Supervisin",href:"/incidents/supervision",icon:ho,roles:["admin","supervisor","coordinador","jefe_operaciones","administrativo"]},{name:"Mis Incidencias en Supervisin",href:"/incidents/my-supervision",icon:Bn,roles:["jefe_operaciones"]},{name:"Incidencias Devueltas",href:"/incidents/returned",icon:uo,roles:["admin","supervisor","coordinador","jefe_operaciones","administrativo"],showBadge:!0},{name:"Historial Aprobadas",href:"/incidents/approved",icon:Ws,roles:["admin","supervisor","coordinador","jefe_operaciones","technician","administrativo"]},{name:"Usuarios",href:"/users",icon:Gu,roles:["admin"]},{name:"Estaciones",href:"/workstations",icon:Fn,roles:["admin"]},{name:"Analticas",href:"/analytics",icon:vp,roles:["admin"]}].filter(fe=>fe.roles.includes(i?.role)),M=fe=>b.pathname===fe,te=()=>w?"bg-gray-900 hanny-theme":S?"ironman-theme":"bg-gray-50",ie=()=>w?"bg-gray-800":S?"border-r border-cyan-500/20":"bg-white",le=()=>w?"text-purple-300":S?"text-cyan-400 ironman-glow":"text-gray-900",X=()=>w?" Panel de Hanny":S?"J.A.R.V.I.S.":"Soporte Asiste ING.";return o.jsxs("div",{className:`h-screen flex ${te()} relative`,style:S?{backgroundColor:"#0B0F14"}:{},children:[(h||p||i?.role==="administrativo")&&o.jsx(HC,{}),o.jsxs("div",{className:`${t?"translate-x-0":"-translate-x-full"} fixed inset-y-0 left-0 z-50 w-64 ${ie()} shadow-lg transform lg:translate-x-0 lg:static lg:inset-0 transition-transform duration-300`,style:S?{backgroundColor:"#0F172A"}:{},children:[o.jsxs("div",{className:`flex items-center justify-between p-4 ${w?"border-gray-700":S?"border-b border-cyan-500/20":"border-b"}`,children:[o.jsx("h1",{className:`text-lg sm:text-xl font-bold ${le()} truncate`,children:X()}),o.jsx("button",{onClick:()=>e(!1),className:`lg:hidden p-1 rounded-md ${w?"text-purple-400 hover:text-purple-300":S?"text-cyan-400 hover:text-cyan-300":"text-gray-400 hover:text-gray-600"}`,children:o.jsx(gs,{className:"h-6 w-6"})})]}),S&&o.jsx("div",{className:"ironman-avatar-container",children:o.jsx("img",{src:"/man.jpg",alt:"Iron Man",className:"ironman-avatar"})}),o.jsx("nav",{className:"mt-5 px-2 space-y-1",children:G.map(fe=>{const K=fe.icon,E=()=>w?"bg-purple-900 border-r-4 border-purple-500 text-purple-300":S?"bg-cyan-900/30 border-r-4 border-cyan-400 text-cyan-400":"bg-blue-50 border-r-4 border-blue-600 text-blue-700",W=()=>w?"text-gray-300 hover:bg-gray-700 hover:text-purple-300":S?"text-gray-400 hover:bg-cyan-900/20 hover:text-cyan-400":"text-gray-600 hover:bg-gray-50 hover:text-gray-900",L=()=>w?"text-purple-400":S?"text-cyan-400":"text-blue-500",F=()=>w?"text-gray-400 group-hover:text-purple-400":S?"text-gray-500 group-hover:text-cyan-400":"text-gray-400 group-hover:text-gray-500";return o.jsxs(zh,{to:fe.href,onClick:q=>{e(!1),P(q)},className:`${M(fe.href)?E():W()} group flex items-center px-2 py-2 text-sm font-medium rounded-l-md transition-colors duration-200`,children:[o.jsx(K,{className:`${M(fe.href)?L():F()} mr-3 h-5 w-5`}),o.jsx("span",{className:"flex-1",children:fe.name}),fe.showBadge&&o.jsxs(o.Fragment,{children:[x&&fe.href==="/incidents/my-incidents"&&A>0&&o.jsx("span",{className:"ml-auto bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center",children:A>9?"9+":A}),fe.href==="/incidents/returned"&&R>0&&!c&&o.jsx("span",{className:"ml-auto bg-orange-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center",children:R>9?"9+":R})]})]},fe.name)})}),o.jsx("div",{className:`absolute bottom-0 w-full p-4 ${w?"border-gray-700 bg-gray-800":S?"border-t border-cyan-500/20":"border-t bg-gray-50"}`,style:S?{backgroundColor:"#0F172A"}:{},children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:S?o.jsx("div",{className:"arc-reactor"}):o.jsx("div",{className:`h-8 w-8 rounded-full ${w?"bg-purple-600":"bg-blue-500"} flex items-center justify-center`,children:o.jsx("span",{className:"text-sm font-medium text-white",children:w?"":i?.fullName?.charAt(0)||"U"})})}),o.jsxs("div",{className:"ml-3 flex-1",children:[o.jsx("p",{className:`text-sm font-medium ${w?"text-purple-200":S?"text-cyan-400":"text-gray-700"}`,children:S?"Tony Stark":i?.fullName||"Usuario"}),o.jsx("p",{className:`text-xs ${w?"text-purple-400":S?"text-gray-400":"text-gray-500"} capitalize`,children:w?" Admin":S?" Iron Man":i?.role==="admin"?"Administrador":i?.role==="supervisor"?"Supervisor":i?.role==="coordinador"?"Coordinador":i?.role==="jefe_operaciones"?"Jefe Operaciones":i?.role==="administrativo"?"Administrativo":"Tcnico"})]}),o.jsx("button",{onClick:O,className:`ml-2 p-1 rounded-md ${w?"text-purple-400 hover:text-purple-300":S?"text-cyan-400 hover:text-cyan-300":"text-gray-400 hover:text-gray-600"}`,title:"Cerrar sesin",children:o.jsx(Yx,{className:"h-5 w-5"})})]})})]}),t&&o.jsx("div",{className:"fixed inset-0 z-40 bg-gray-600 bg-opacity-75 lg:hidden",onClick:()=>e(!1)}),o.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col",children:[o.jsx("div",{className:`${w?"bg-gray-800 shadow-sm border-gray-700":S?"shadow-sm border-b border-cyan-500/20":"bg-white shadow-sm border-b"} px-4 py-3 lg:px-6`,style:S?{backgroundColor:"#0F172A"}:{},children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("button",{onClick:fe=>{e(!0),P(fe)},className:`lg:hidden p-1 rounded-md ${w?"text-purple-400 hover:text-purple-300":S?"text-cyan-400 hover:text-cyan-300":"text-gray-400 hover:text-gray-600"}`,children:o.jsx(Nv,{className:"h-6 w-6"})}),o.jsx("h2",{className:`text-sm font-semibold ${w?"text-purple-200":S?"text-cyan-400 ironman-glow":"text-gray-900"} sm:text-lg lg:text-xl truncate flex-1 lg:text-center`,children:w?" Sistema de Soporte de Hanny ":S?"STARK INDUSTRIES - Sistema de Soporte":"Call Center - Sistema de Soporte Tcnico"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[(h||p||i?.role==="administrativo")&&o.jsx(zC,{}),x&&o.jsx(UC,{notifications:k,unreadCount:A,markAsRead:z,markAllAsRead:H,clearNotifications:V,testNotificationSound:B})]})]})}),o.jsx("main",{className:"flex-1 overflow-y-auto p-4 lg:p-6",children:o.jsx(Ux,{})})]}),w&&r.map(fe=>o.jsx("div",{className:"fixed pointer-events-none z-50",style:{left:fe.x-10,top:fe.y-10,animation:"heartFloat 1s ease-out forwards"},children:o.jsx(NC,{className:"h-5 w-5 text-pink-500 fill-current"})},fe.id)),S&&s.map(fe=>o.jsx("div",{className:"fixed pointer-events-none z-50",style:{left:fe.x-6,top:fe.y-6,animation:"techFloat 0.8s ease-out forwards"},children:o.jsx(j3,{className:"h-4 w-4",style:{color:fe.color,filter:"drop-shadow(0 0 3px "+fe.color+")"}})},fe.id)),o.jsx(z3,{})]})},H3=({children:t})=>{const{user:e,logout:r}=Jr(),n=Oi(),s=()=>{r(),n("/login")};return o.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100",children:[o.jsx("header",{className:"bg-gray-800 border-b border-gray-700 px-4 py-3",children:o.jsxs("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center",children:o.jsx(qu,{className:"h-5 w-5 text-gray-300"})}),o.jsx("h1",{className:"text-lg font-semibold text-gray-100",children:"Chat de Soporte"})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-6 h-6 bg-gray-600 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-xs font-medium text-gray-300",children:e?.full_name?.charAt(0)?.toUpperCase()||"A"})}),o.jsx("span",{className:"text-sm text-gray-300",children:e?.full_name||"Usuario Annimo"})]}),o.jsxs("button",{onClick:s,className:"flex items-center space-x-1 px-3 py-1.5 text-sm text-gray-300 hover:text-gray-100 hover:bg-gray-700 rounded-md transition-colors",title:"Cerrar sesin",children:[o.jsx(Yx,{className:"h-4 w-4"}),o.jsx("span",{children:"Salir"})]})]})]})}),o.jsxs("main",{className:"min-h-[calc(100vh-64px)] bg-gray-900",children:[t,o.jsx(Ux,{})]})]})},O8=()=>o.jsxs("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"w-24 h-24 bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-6",children:o.jsx(qu,{className:"h-12 w-12 text-gray-400"})}),o.jsx("h2",{className:"text-xl font-semibold text-gray-200 mb-2",children:"Chat de Soporte"}),o.jsx("p",{className:"text-gray-400 mb-4",children:"Haz clic en el chat para comenzar"}),o.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full mx-auto"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"En lnea"})]}),o.jsx(z3,{})]}),M8="modulepreload",B8=function(t){return"/"+t},E5={},Vh=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){let c=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=i?.nonce||i?.getAttribute("nonce");s=c(r.map(d=>{if(d=B8(d),d in E5)return;E5[d]=!0;const h=d.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const x=document.createElement("link");if(x.rel=h?"stylesheet":M8,h||(x.as="script"),x.crossOrigin="",x.href=d,l&&x.setAttribute("nonce",l),document.head.appendChild(x),h)return new Promise((m,b)=>{x.addEventListener("load",m),x.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return s.then(i=>{for(const l of i||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})},Kf={WARNING:30,CRITICAL:60,URGENT:120},U8=["internet","software"],Cv=t=>{const e=new Date,r=new Date(t),n=e-r,s=Math.floor(n/(1e3*60)),a=Math.floor(s/60);return{totalMinutes:s,hours:a,minutes:s%60}},wp=(t,e="")=>{const r=Cv(t),n=U8.includes(e),s=n?Kf.WARNING/2:Kf.WARNING,a=n?Kf.CRITICAL/2:Kf.CRITICAL,i=n?Kf.URGENT/2:Kf.URGENT;return r.totalMinutes>=i?{level:"urgent",color:"red",bgColor:"bg-red-100",textColor:"text-red-800",borderColor:"border-red-500",animate:!0}:r.totalMinutes>=a?{level:"critical",color:"red",bgColor:"bg-red-50",textColor:"text-red-700",borderColor:"border-red-400",animate:!1}:r.totalMinutes>=s?{level:"warning",color:"yellow",bgColor:"bg-yellow-50",textColor:"text-yellow-800",borderColor:"border-yellow-400",animate:!1}:null},Zx=t=>{const e=Cv(t);return e.hours>0?e.minutes>0?`${e.hours}h ${e.minutes}m`:`${e.hours}h`:`${e.minutes}m`},Tv=(t,e="")=>{const r=wp(t,e),n=Zx(t);if(!r)return null;const s=e==="internet"?"Internet":e==="software"?"Software":e==="pantalla"?"Pantalla":e==="perifericos"?"Perifricos":"Incidencia";switch(r.level){case"urgent":return` URGENTE: ${s} sin asignar por ${n}`;case"critical":return` CRTICO: ${s} sin asignar por ${n}`;case"warning":return` ATENCIN: ${s} sin asignar por ${n}`;default:return null}},z8=t=>{if(!t||t.length===0)return null;const e=t.filter(s=>s.status==="pendiente"&&!s.assigned_to_id);if(e.length===0)return null;const r=e.reduce((s,a)=>{const i=new Date(s.created_at);return new Date(a.created_at)<i?a:s}),n=wp(r.created_at,r.failure_type);return n?{incident:r,alert:n}:null},$3=t=>{if(!t||t.length===0)return[];const e=t.filter(n=>n.status==="pendiente"&&!n.assigned_to_id);return e.length===0?[]:e.map(n=>({...n,timeElapsed:Cv(n.created_at),alertLevel:wp(n.created_at,n.failure_type)})).sort((n,s)=>s.timeElapsed.totalMinutes-n.timeElapsed.totalMinutes).slice(0,3)},H8=(t,e)=>$3(e).some(n=>n.id===t.id),fx=(t,e,r=.1,n="sine")=>new Promise(s=>{try{const a=new(window.AudioContext||window.webkitAudioContext),i=a.createOscillator(),l=a.createGain();i.connect(l),l.connect(a.destination),i.frequency.setValueAtTime(t,a.currentTime),i.type=n,l.gain.setValueAtTime(0,a.currentTime),l.gain.linearRampToValueAtTime(r,a.currentTime+.1),l.gain.linearRampToValueAtTime(0,a.currentTime+e-.1),i.start(),i.stop(a.currentTime+e),setTimeout(()=>s(),e*1e3)}catch(a){console.warn("Error creating audio context:",a),s()}}),$8=async()=>{await fx(800,.3,.05)},W8=async()=>{await fx(1e3,.2,.08),await new Promise(t=>setTimeout(t,100)),await fx(1e3,.2,.08)},V8=async()=>{for(let t=0;t<3;t++)await fx(1200,.15,.1),await new Promise(e=>setTimeout(e,150))},q8=t=>{switch(t){case"warning":return $8();case"critical":return W8();case"urgent":return V8();default:return Promise.resolve()}},G8=({incidents:t,onDismiss:e,onViewIncident:r,soundEnabled:n=!0})=>{const s=Oi(),[a,i]=Q.useState(!1),[l,c]=Q.useState(null),[d,h]=Q.useState(!1),[p,x]=Q.useState(()=>{const H=localStorage.getItem("dismissedIncidents");return H?JSON.parse(H):[]}),m=t.filter(H=>!p.includes(H.id)),b=z8(m);if(Q.useEffect(()=>{const H=t.map(B=>B.id),V=p.filter(B=>H.includes(B));V.length!==p.length&&(x(V),localStorage.setItem("dismissedIncidents",JSON.stringify(V)))},[t,p]),Q.useEffect(()=>{if(!b||!n||a)return;const{incident:H,alert:V}=b,B=new Date(H.created_at).getTime();(V.level==="critical"||V.level==="urgent")&&(!l||B!==l)&&!d&&(q8(V.level),c(B),h(!0),setTimeout(()=>h(!1),3e4))},[b,n,a,l,d]),Q.useEffect(()=>{const H=setInterval(()=>{c(Date.now())},6e4);return()=>clearInterval(H)},[]),!b||a)return null;const{incident:y,alert:w}=b,S=Tv(y.created_at,y.failure_type);Zx(y.created_at);const k=()=>{if(b?.incident){const H=[...p,b.incident.id];x(H),localStorage.setItem("dismissedIncidents",JSON.stringify(H))}i(!0),e&&e()},A=()=>{r?r(y):s(`/incidents/pending?highlight=${y.id}`)},z=H=>{H.stopPropagation(),h(!0)};return o.jsx("div",{className:"fixed top-4 right-4 max-w-md z-50",children:o.jsx("div",{className:`
                    ${w.bgColor} ${w.borderColor} border-l-4 p-4 rounded-lg shadow-lg cursor-pointer
                    hover:shadow-xl transition-shadow duration-200
                `,onClick:A,children:o.jsxs("div",{className:"flex items-start",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(mi,{className:`h-5 w-5 ${w.textColor}`})}),o.jsxs("div",{className:"ml-3 flex-1",children:[o.jsx("h3",{className:`text-sm font-medium ${w.textColor}`,children:"Incidencia Sin Asignar"}),o.jsxs("div",{className:`mt-1 text-sm ${w.textColor}`,children:[o.jsx("p",{className:"font-semibold",children:S}),o.jsxs("div",{className:"mt-2 flex items-center space-x-2 text-xs",children:[o.jsx(qs,{className:"h-3 w-3"}),o.jsxs("span",{children:["Estacin: ",y.station_code]}),o.jsx("span",{children:""}),o.jsx("span",{children:y.sede?.toUpperCase()}),y.departamento&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{children:y.departamento?.toUpperCase()})]})]}),o.jsx("p",{className:"mt-1 text-xs opacity-75",children:y.description})]}),o.jsxs("div",{className:"mt-3 flex items-center space-x-2",children:[o.jsx("span",{className:`text-xs ${w.textColor} opacity-75`,children:" Hacer clic en cualquier parte para ver detalles completos"}),(w.level==="critical"||w.level==="urgent")&&o.jsx("button",{onClick:H=>{H.stopPropagation(),z(H)},className:"inline-flex items-center px-2 py-1 text-xs text-gray-600 hover:text-gray-800",title:"Silenciar alertas por 30 segundos",children:d?o.jsx(RC,{className:"h-3 w-3"}):o.jsx(k3,{className:"h-3 w-3"})})]})]}),o.jsx("div",{className:"flex-shrink-0 ml-2",children:o.jsx("button",{onClick:H=>{H.stopPropagation(),k()},className:`
                                inline-flex rounded-md p-1.5 focus:outline-none focus:ring-2 focus:ring-offset-2
                                ${w.textColor} hover:${w.bgColor}
                            `,children:o.jsx(gs,{className:"h-4 w-4"})})})]})})})},W3=({incident:t,isOpen:e,onClose:r,onAssign:n,onSelfAssign:s,isAdmin:a,isTechnician:i,technicians:l=[],selectedTechnician:c,setSelectedTechnician:d,assignLoading:h})=>{const[p,x]=Q.useState([]),[m,b]=Q.useState(!1);Q.useEffect(()=>{e&&t?.id&&y(t.id)},[e,t?.id]);const y=async O=>{try{b(!0);const ee=await Kt.getAttachments(O);x(ee.data)}catch(ee){console.error("Error cargando archivos adjuntos:",ee),x([])}finally{b(!1)}},w=O=>O.startsWith("image/")?o.jsx(y3,{className:"h-5 w-5 text-blue-500"}):O==="application/pdf"?o.jsx(qn,{className:"h-5 w-5 text-red-500"}):o.jsx(qn,{className:"h-5 w-5 text-gray-500"}),S=O=>{if(O===0)return"0 Bytes";const ee=1024,I=["Bytes","KB","MB"],P=Math.floor(Math.log(O)/Math.log(ee));return parseFloat((O/Math.pow(ee,P)).toFixed(2))+" "+I[P]},k=O=>{const I=`http://31.97.138.23:5001${O.file_url}`;window.open(I,"_blank")};if(!e||!t)return null;const A=wp(t.created_at,t.failure_type),z=Zx(t.created_at),H=Tv(t.created_at,t.failure_type),V=O=>({pantalla:"Pantalla",perifericos:"Perifricos",internet:"Internet",software:"Software",otro:"Otro"})[O]||O,B=O=>{const ee={pantalla:"bg-blue-100 text-blue-800",perifericos:"bg-purple-100 text-purple-800",internet:"bg-red-100 text-red-800",software:"bg-green-100 text-green-800",otro:"bg-gray-100 text-gray-800"};return ee[O]||ee.otro},R=O=>O==="internet"||O==="software"?o.jsx(mi,{className:"h-4 w-4 text-red-500"}):null;return o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:r,children:o.jsxs("div",{className:"relative top-10 mx-auto p-5 border max-w-2xl shadow-lg rounded-md bg-white",onClick:O=>O.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Fn,{className:"h-6 w-6 text-blue-600"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Detalles de Incidencia"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Informacin completa de la incidencia reportada"})]})]}),o.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(gs,{className:"h-6 w-6"})})]}),H&&o.jsx("div",{className:`mb-4 p-3 rounded-md ${A.bgColor} border-l-4 ${A.borderColor}`,children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(mi,{className:`h-5 w-5 mr-2 ${A.textColor}`}),o.jsx("span",{className:`text-sm font-medium ${A.textColor}`,children:H})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[o.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx(Fn,{className:"h-5 w-5 text-gray-600"}),o.jsx("span",{className:"font-semibold text-gray-900",children:"Estacin de Trabajo"})]}),o.jsx("p",{className:"text-lg font-mono text-blue-600",children:t.station_code})]}),o.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx(Ac,{className:"h-5 w-5 text-gray-600"}),o.jsx("span",{className:"font-semibold text-gray-900",children:"Ubicacin"})]}),o.jsx("div",{className:"space-y-1",children:o.jsxs("p",{className:"flex items-center text-gray-800",children:[o.jsx(_0,{className:"h-4 w-4 mr-2"}),t.sede?.toUpperCase()," - ",t.departamento?.toUpperCase()]})})]}),t.anydesk_address&&o.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx(FC,{className:"h-5 w-5 text-gray-600"}),o.jsx("span",{className:"font-semibold text-gray-900",children:"AnyDesk"})]}),o.jsx("p",{className:"text-lg font-mono text-blue-600",children:t.anydesk_address})]}),t.advisor_cedula&&o.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx(x3,{className:"h-5 w-5 text-gray-600"}),o.jsx("span",{className:"font-semibold text-gray-900",children:"Cdula del Agente"})]}),o.jsx("p",{className:"text-lg font-mono text-gray-800",children:t.advisor_cedula})]}),o.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx(ho,{className:"h-5 w-5 text-gray-600"}),o.jsx("span",{className:"font-semibold text-gray-900",children:"Tipo de Falla"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[R(t.failure_type),o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${B(t.failure_type)}`,children:V(t.failure_type)}),(t.failure_type==="internet"||t.failure_type==="software")&&o.jsx("span",{className:"text-xs text-red-600 font-medium",children:"PRIORIDAD ALTA"})]})]}),o.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx(qs,{className:"h-5 w-5 text-gray-600"}),o.jsx("span",{className:"font-semibold text-gray-900",children:"Tiempo"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Creado:"})," ",new Date(t.created_at).toLocaleDateString()," a las ",new Date(t.created_at).toLocaleTimeString()]}),o.jsxs("p",{className:`text-sm font-medium ${A?A.textColor:"text-gray-900"}`,children:[o.jsx("strong",{children:"Sin asignar:"})," ",z]})]})]})]}),o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx(Bn,{className:"h-5 w-5 text-gray-600"}),o.jsx("span",{className:"font-semibold text-gray-900",children:"Reportado por"})]}),o.jsx("p",{className:"text-gray-800 bg-gray-50 p-3 rounded-lg",children:t.reported_by_name})]}),o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx(qn,{className:"h-5 w-5 text-gray-600"}),o.jsx("span",{className:"font-semibold text-gray-900",children:"Descripcin del Problema"})]}),o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:o.jsx("p",{className:"text-gray-800 whitespace-pre-wrap leading-relaxed",children:t.description})})]}),o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx(mi,{className:"h-5 w-5 text-gray-600"}),o.jsx("span",{className:"font-semibold text-gray-900",children:"Estado Actual"})]}),o.jsx("div",{className:"flex items-center space-x-2",children:o.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${A?`${A.bgColor} ${A.textColor}`:"bg-yellow-100 text-yellow-800"}`,children:A?A.level==="urgent"?" URGENTE - SIN ASIGNAR":A.level==="critical"?" CRTICO - SIN ASIGNAR":" ATENCIN - SIN ASIGNAR":"PENDIENTE DE ASIGNACIN"})})]}),o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(w5,{className:"h-5 w-5 text-gray-600"}),o.jsx("span",{className:"font-semibold text-gray-900",children:"Archivos Adjuntos"})]}),p.length>0&&o.jsxs("span",{className:"text-sm text-gray-500",children:[p.length," archivo",p.length!==1?"s":""]})]}),m?o.jsxs("div",{className:"flex items-center justify-center py-4",children:[o.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),o.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Cargando archivos..."})]}):p.length===0?o.jsxs("div",{className:"text-center py-4 bg-gray-50 rounded-lg",children:[o.jsx(w5,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),o.jsx("p",{className:"text-sm text-gray-500",children:"No hay archivos adjuntos"})]}):o.jsx("div",{className:"space-y-2",children:p.map(O=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[w(O.file_type),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:O.original_name}),o.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[o.jsx("span",{children:S(O.file_size)}),o.jsx("span",{children:""}),o.jsx("span",{children:new Date(O.uploaded_at).toLocaleDateString()})]})]})]}),o.jsx("div",{className:"flex items-center space-x-2 ml-3",children:o.jsxs("button",{onClick:()=>k(O),className:"inline-flex items-center px-3 py-1 text-xs font-medium text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded",title:"Ver archivo",children:[o.jsx(Dl,{className:"h-3 w-3 mr-1"}),"Ver"]})})]},O.id))})]}),o.jsx("div",{className:"border-t pt-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("p",{className:"text-sm text-gray-500",children:["ID de Incidencia: #",t.id]}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx("button",{onClick:r,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:"Cerrar"}),a?o.jsxs("button",{onClick:()=>n(t),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[o.jsx(Vo,{className:"h-4 w-4 mr-2"}),"Asignar Tcnico"]}):i?o.jsxs("button",{onClick:()=>s(t),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors",children:[o.jsx(Vo,{className:"h-4 w-4 mr-2"}),"Tomar Incidencia"]}):null]})]})})]})})},Xu=({rating:t=0,onRatingChange:e,readonly:r=!1,size:n="md"})=>{const[s,a]=Q.useState(0),i={sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6"},l=p=>{!r&&e&&e(p)},c=p=>{r||a(p)},d=()=>{r||a(0)},h=s||t;return o.jsxs("div",{className:"flex items-center space-x-1",onMouseLeave:d,children:[[1,2,3,4,5].map(p=>o.jsx("button",{type:"button",onClick:()=>l(p),onMouseEnter:()=>c(p),disabled:r,className:`
                        ${r?"cursor-default":"cursor-pointer hover:scale-110"}
                        transition-all duration-150
                        ${r?"":"focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-opacity-50 rounded"}
                    `,children:o.jsx(Dc,{className:`
                            ${i[n]}
                            ${p<=h?"text-yellow-400 fill-current":"text-gray-300"}
                            transition-colors duration-150
                        `})},p)),t>0&&o.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["(",t,"/5)"]})]})},X8=({technicianId:t,isOwnRatings:e=!1})=>{const[r,n]=Q.useState(null),[s,a]=Q.useState(!0),[i,l]=Q.useState(null);Q.useEffect(()=>{c()},[t,e]);const c=async()=>{try{a(!0);let b;e?b=await Kt.getMyRatings():b=await Kt.getTechnicianRatings(t),n(b.data)}catch(b){console.error("Error cargando calificaciones:",b),l("No se pudieron cargar las calificaciones")}finally{a(!1)}},d=b=>({pantalla:"Pantalla",perifericos:"Perifricos",internet:"Internet",software:"Software",otro:"Otro"})[b]||b,h=b=>{const y={pantalla:"bg-blue-100 text-blue-800",perifericos:"bg-purple-100 text-purple-800",internet:"bg-red-100 text-red-800",software:"bg-green-100 text-green-800",otro:"bg-gray-100 text-gray-800"};return y[b]||y.otro};if(s)return o.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:o.jsx("div",{className:"px-4 py-5 sm:px-6",children:o.jsxs("div",{className:"flex items-center justify-center py-8",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),o.jsx("span",{className:"ml-3 text-gray-500",children:"Cargando calificaciones..."})]})})});if(i)return o.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:o.jsx("div",{className:"px-4 py-5 sm:px-6",children:o.jsx("div",{className:"text-center py-8 text-red-600",children:i})})});const{ratings:p=[],average_rating:x,total_ratings:m}=r||{};return o.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:[o.jsx("div",{className:"px-4 py-5 sm:px-6 bg-gradient-to-r from-yellow-50 to-orange-50 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(_v,{className:"h-6 w-6 text-yellow-600 mr-3"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:e?"Mis Calificaciones":"Calificaciones del Tcnico"}),o.jsx("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Evaluaciones de rendimiento en incidencias resueltas"})]})]}),m>0&&o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"flex items-center justify-end mb-1",children:o.jsx(Xu,{rating:parseFloat(x),readonly:!0,size:"md"})}),o.jsxs("p",{className:"text-sm text-gray-500",children:[m," calificacin",m!==1?"es":""]})]})]})}),o.jsx("div",{className:"divide-y divide-gray-200",children:p.length===0?o.jsxs("div",{className:"px-6 py-8 text-center",children:[o.jsx(Dc,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Sin calificaciones an"}),o.jsx("p",{className:"text-gray-500",children:e?"Tus incidencias an no han sido calificadas.":"Este tcnico an no tiene calificaciones."})]}):p.map(b=>o.jsx("div",{className:"px-4 py-5 sm:px-6",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[o.jsx(Fn,{className:"h-5 w-5 text-gray-400"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"font-medium text-gray-900",children:b.station_code}),o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${h(b.failure_type)}`,children:d(b.failure_type)})]})]}),o.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:b.incident_description}),o.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[o.jsx(Xu,{rating:b.rating,readonly:!0,size:"sm"}),o.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["Calificado por: ",b.rated_by_name]})]}),b.feedback&&o.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx(CC,{className:"h-4 w-4 text-gray-500"}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Comentarios:"})]}),o.jsx("p",{className:"text-sm text-gray-600 pl-6",children:b.feedback})]})]}),o.jsx("div",{className:"text-right ml-4 flex-shrink-0",children:o.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[o.jsx(ia,{className:"h-3 w-3 mr-1"}),new Date(b.created_at).toLocaleDateString()]})})]})},b.id))})]})},Y8=()=>{const[t,e]=Q.useState({}),[r,n]=Q.useState(!0),[s,a]=Q.useState(null);Q.useEffect(()=>{i()},[]);const i=async()=>{try{n(!0);const h=await Kt.getTechniciansRanking();e(h.data)}catch(h){console.error("Error cargando ranking:",h),a("No se pudo cargar el ranking de tcnicos")}finally{n(!1)}},l=h=>["","",""][h]||`${h+1}`,c=({technician:h,rank:p,isWorst:x=!1})=>o.jsx("div",{className:`p-3 rounded-lg border ${x?"bg-red-50 border-red-200":"bg-green-50 border-green-200"} transition-all duration-200 hover:shadow-md`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("span",{className:"text-lg font-bold",children:l(p)}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-900 text-sm",children:h.full_name}),o.jsx("p",{className:"text-xs text-gray-600",children:h.departamento?.toUpperCase()})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"flex items-center space-x-1",children:o.jsx(Xu,{rating:parseFloat(h.average_rating),readonly:!0,size:"sm"})}),o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[h.total_ratings," calificacion",h.total_ratings!==1?"es":""]})]})]})}),d=({cityKey:h,cityData:p})=>o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"px-6 py-4 bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Ac,{className:"h-5 w-5 text-blue-600"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:p.city})]}),o.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[o.jsx(Gu,{className:"h-4 w-4"}),o.jsxs("span",{children:[p.totalTechnicians," tcnicos calificados"]})]})]})}),o.jsx("div",{className:"p-6",children:o.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[o.jsx(N3,{className:"h-5 w-5 text-green-600"}),o.jsx("h4",{className:"font-medium text-gray-900",children:"Mejores Calificados"})]}),o.jsx("div",{className:"space-y-3",children:p.topTechnicians.length===0?o.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:"Sin datos suficientes"}):p.topTechnicians.map((x,m)=>o.jsx(c,{technician:x,rank:m,isWorst:!1},x.id))})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[o.jsx(LC,{className:"h-5 w-5 text-red-600"}),o.jsx("h4",{className:"font-medium text-gray-900",children:"Requieren Mejorar"})]}),o.jsx("div",{className:"space-y-3",children:p.worstTechnicians.length===0?o.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:"Sin datos suficientes"}):p.worstTechnicians.map((x,m)=>o.jsx(c,{technician:x,rank:m,isWorst:!0},x.id))})]})]})})]});return r?o.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:o.jsx("div",{className:"px-4 py-5 sm:px-6",children:o.jsxs("div",{className:"flex items-center justify-center py-8",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),o.jsx("span",{className:"ml-3 text-gray-500",children:"Cargando ranking..."})]})})}):s?o.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:o.jsx("div",{className:"px-4 py-5 sm:px-6",children:o.jsx("div",{className:"text-center py-8 text-red-600",children:s})})}):o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:o.jsx("div",{className:"px-4 py-5 sm:px-6 bg-gradient-to-r from-yellow-50 to-orange-50",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(_v,{className:"h-6 w-6 text-yellow-600 mr-3"}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Ranking de Tcnicos por Ciudad"}),o.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Evaluacin del desempeo basada en calificaciones de coordinadores"})]})]})})}),Object.keys(t).length===0?o.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:o.jsx("div",{className:"px-4 py-5 sm:px-6",children:o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Dc,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Sin calificaciones disponibles"}),o.jsx("p",{className:"text-gray-500",children:"Los tcnicos an no han recibido calificaciones de coordinadores."})]})})}):Object.entries(t).map(([h,p])=>o.jsx(d,{cityKey:h,cityData:p},h))]})},K8=()=>{const{user:t,isAdmin:e,isSupervisor:r,isTechnician:n,isAdministrativo:s,isJefeOperaciones:a}=Jr(),i=t?.username==="davidlopez10",l=Oi(),[c,d]=Q.useState({pending:0,inProcess:0,inSupervision:0,approved:0,returned:0,myIncidents:0}),[h,p]=Q.useState({}),[x,m]=Q.useState({}),[b,y]=Q.useState({}),[w,S]=Q.useState({}),[k,A]=Q.useState([]),[z,H]=Q.useState(!0),[V,B]=Q.useState(!1),[R,O]=Q.useState(!1),[ee,I]=Q.useState(!1),[P,ae]=Q.useState(!1),[G,M]=Q.useState([]),[te,ie]=Q.useState(!1),[le,X]=Q.useState(!1),[fe,K]=Q.useState(null),[E,W]=Q.useState([]),[L,F]=Q.useState(""),[q,he]=Q.useState(!1),[me,Z]=Q.useState(!1),[Se,We]=Q.useState(null),[ue,nt]=Q.useState([]),[rt,De]=Q.useState([]);Q.useEffect(()=>{Xe()},[]),Q.useEffect(()=>{const $e=wt=>{(V||R||ee||P)&&!wt.target.closest(".relative")&&(B(!1),O(!1),I(!1),ae(!1))};return document.addEventListener("mousedown",$e),()=>{document.removeEventListener("mousedown",$e)}},[V,R,ee,P]);const ve=$e=>$e.reduce((wt,Wt)=>{const jt=Wt.sede||"sin_sede",hr=jt==="bogota"?"Bogot":jt==="barranquilla"?"Barranquilla":jt==="villavicencio"?"Villavicencio":"Sin Sede";wt[jt]||(wt[jt]={count:0,label:hr,departamentos:{}}),wt[jt].count++;const Vt=Wt.departamento||"sin_departamento",Sr=Vt==="obama"?"Obama":Vt==="majority"?"Majority":Vt==="claro"?"Claro":Vt==="contratacion"?"Contratacin":Vt==="seleccion"?"Seleccin":Vt==="reclutamiento"?"Reclutamiento":Vt==="area_financiera"?"rea Financiera":"Sin Departamento";return wt[jt].departamentos[Vt]||(wt[jt].departamentos[Vt]={count:0,label:Sr}),wt[jt].departamentos[Vt].count++,wt},{}),Xe=async()=>{try{console.log("Cargando datos del dashboard..."),H(!0);const $e=[Kt.getAll({status:"pendiente"}),Kt.getAll({status:"aprobado"})];(t?.role==="admin"||t?.role==="coordinador"||t?.role==="supervisor"||t?.role==="jefe_operaciones"||t?.role==="administrativo")&&$e.push(Kt.getReturnedIncidents()),e&&$e.push(_c.getTechnicians());const wt=await Promise.all($e);let Wt,jt,hr,Vt;t?.role==="admin"||t?.role==="coordinador"||t?.role==="supervisor"||t?.role==="jefe_operaciones"||t?.role==="administrativo"?e?[Wt,jt,hr,Vt]=wt:[Wt,jt,hr]=wt:e?[Wt,jt,Vt]=wt:[Wt,jt]=wt,Vt&&W(Vt.data);let Sr=0,Ur=0,rr=0,Ut,cr;if(n){const yt=await Kt.getMyIncidents();rr=yt.data.length,Sr=yt.data.filter(pr=>pr.status==="en_proceso").length,[Ut,cr]=await Promise.all([Kt.getAll({status:"en_proceso"}),Kt.getAll({status:"en_supervision"})]),Ur=yt.data.filter(pr=>pr.status==="en_supervision").length}else[Ut,cr]=await Promise.all([Kt.getAll({status:"en_proceso"}),Kt.getAll({status:"en_supervision"})]),Sr=Ut.data.length,Ur=cr.data.length;M(Wt.data),(e||n)&&(p(ve(Wt.data)),S(ve(jt.data)),Ut&&m(ve(Ut.data)),cr&&y(ve(cr.data))),d({pending:Wt.data.length,inProcess:Sr,inSupervision:Ur,approved:jt.data.length,returned:hr?hr.data.length:0,myIncidents:rr});const Te=await Kt.getAll();if(A(Te.data.slice(0,5)),e){const[yt,pr]=await Promise.all([Kt.getStatsBySede(),Kt.getTechniciansStatus()]);nt(yt.data),De(pr.data)}}catch($e){console.error("Error cargando dashboard:",$e),console.error("Error details:",$e.response?.data)}finally{console.log("Dashboard carga completada"),H(!1)}},Re=$e=>{e||n?(B($e==="pending"?!V:!1),O($e==="inProcess"?!R:!1),I($e==="inSupervision"?!ee:!1),ae($e==="approved"?!P:!1)):l({pending:"/incidents/pending",inProcess:"/incidents/pending",inSupervision:"/incidents/supervision",approved:"/incidents/approved"}[$e])},Ke=($e,wt)=>{const Wt=new URLSearchParams;Wt.set("sede",$e),wt==="inProcess"&&Wt.set("status","en_proceso"),l(`${{pending:"/incidents/pending",inProcess:"/incidents/pending",inSupervision:"/incidents/supervision",approved:"/incidents/approved"}[wt]}?${Wt.toString()}`),B(!1),O(!1),I(!1),ae(!1)},it=($e,wt,Wt)=>{const jt=new URLSearchParams;jt.set("sede",$e),jt.set("departamento",wt),Wt==="inProcess"&&jt.set("status","en_proceso"),l(`${{pending:"/incidents/pending",inProcess:"/incidents/pending",inSupervision:"/incidents/supervision",approved:"/incidents/approved"}[Wt]}?${jt.toString()}`),B(!1),O(!1),I(!1),ae(!1)},pt=($e,wt,Wt,jt,hr)=>!e&&!n||!Wt?null:o.jsx("div",{className:`absolute top-full left-0 right-0 mt-2 border rounded-lg shadow-lg z-10 max-h-96 overflow-y-auto ${i?"bg-[#0F172A] border-cyan-500/30 shadow-cyan-500/20":"bg-white border-gray-200"}`,children:o.jsxs("div",{className:"p-2",children:[o.jsx("div",{className:`text-xs font-medium uppercase tracking-wide px-3 py-2 ${i?"text-[#00E5FF]":"text-gray-500"}`,children:jt}),Object.entries(wt).length===0?o.jsxs("div",{className:`px-3 py-2 text-sm ${ke}`,children:["No hay incidencias ",$e==="pending"?"pendientes":$e==="inProcess"?"en proceso":$e==="inSupervision"?"en supervisin":"aprobadas"]}):Object.entries(wt).map(([Vt,Sr])=>o.jsxs("div",{className:`border-b last:border-b-0 ${i?"border-cyan-500/10":"border-gray-100"}`,children:[o.jsxs("div",{className:`flex items-center justify-between px-3 py-2 cursor-pointer rounded transition-colors ${i?"hover:bg-[#0B0F14]":"hover:bg-gray-50"}`,onClick:Ur=>{Ur.stopPropagation(),Ke(Vt,$e)},children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Ac,{className:`h-4 w-4 mr-2 ${i?"text-[#00E5FF]":"text-blue-500"}`}),o.jsx("span",{className:`text-sm font-medium ${tr}`,children:Sr.label})]}),o.jsx("span",{className:`text-sm font-semibold px-2 py-1 rounded-full ${i?$e==="pending"?"text-[#FF6A00] bg-orange-500/20":$e==="inProcess"?"text-[#00E5FF] bg-cyan-500/20":$e==="inSupervision"?"text-[#E10600] bg-red-500/20":"text-[#00B4D8] bg-cyan-500/20":$e==="pending"?"text-yellow-600 bg-yellow-50":$e==="inProcess"?"text-blue-600 bg-blue-50":$e==="inSupervision"?"text-purple-600 bg-purple-50":"text-green-600 bg-green-50"}`,children:Sr.count})]}),Object.entries(Sr.departamentos).length>0&&o.jsx("div",{className:`ml-6 border-l ${i?"border-cyan-500/20":"border-gray-200"}`,children:Object.entries(Sr.departamentos).map(([Ur,rr])=>o.jsxs("div",{className:`flex items-center justify-between px-3 py-1 cursor-pointer rounded transition-colors text-sm ${i?"hover:bg-[#0B0F14]":"hover:bg-gray-50"}`,onClick:Ut=>{Ut.stopPropagation(),it(Vt,Ur,$e)},children:[o.jsxs("span",{className:`pl-4 ${i?"text-[#94A3B8]":"text-gray-600"}`,children:[" ",rr.label]}),o.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${i?"text-[#94A3B8] bg-[#0B0F14]":"text-gray-500 bg-gray-100"}`,children:rr.count})]},Ur))})]},Vt)),Object.entries(wt).length>0&&o.jsx("div",{className:`px-3 py-2 cursor-pointer rounded transition-colors border-t mt-2 ${i?"hover:bg-[#0B0F14] border-cyan-500/20":"hover:bg-blue-50 border-gray-200"}`,onClick:()=>{const Vt=$e==="inProcess"?`${hr}?status=en_proceso`:hr;l(Vt),B(!1),O(!1),I(!1),ae(!1)},children:o.jsx("div",{className:"flex items-center justify-center",children:o.jsxs("span",{className:`text-sm font-medium ${i?"text-[#00E5FF]":"text-blue-600"}`,children:["Ver todas las incidencias ",$e==="pending"?"pendientes":$e==="inProcess"?"en proceso":$e==="inSupervision"?"en supervisin":"aprobadas"]})})})]})}),vt=$e=>{const wt={pendiente:"bg-yellow-100 text-yellow-800",en_proceso:"bg-blue-100 text-blue-800",en_supervision:"bg-purple-100 text-purple-800",aprobado:"bg-green-100 text-green-800",rechazado:"bg-red-100 text-red-800"},Wt={pendiente:"Pendiente",en_proceso:"En Proceso",en_supervision:"En Supervisin",aprobado:"Aprobado",rechazado:"Rechazado"};return o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${wt[$e]||wt.pendiente}`,children:Wt[$e]||$e})},Pt=$e=>({pantalla:"Pantalla",perifericos:"Perifricos",internet:"Internet",software:"Software",otro:"Otro"})[$e]||$e,Dt=($e,wt)=>{const Wt=new URLSearchParams;Wt.set("sede",$e),wt==="en_proceso"&&Wt.set("status","en_proceso"),l(`${{pendientes:"/incidents/pending",en_proceso:"/incidents/pending",en_supervision:"/incidents/supervision",aprobadas:"/incidents/approved"}[wt]}?${Wt.toString()}`)},Ot=$e=>{K($e),X(!0),ie(!0)},Yt=()=>{X(!1),K(null),F(""),Xe()},lr=async $e=>{X(!1),We($e),F(""),Z(!0)},Qt=async()=>{if(!L){alert("Por favor selecciona un tcnico");return}he(!0);try{await Kt.assignTechnician(Se.id,parseInt(L)),Z(!1),We(null),F(""),await Xe()}catch($e){console.error("Error asignando tcnico:",$e),alert($e.response?.data?.msg||"Error al asignar tcnico")}finally{he(!1)}},It=async $e=>{he(!0);try{await Kt.assignTechnician($e.id,t.id),X(!1),await Xe()}catch(wt){console.error("Error auto-asignndose:",wt),alert(wt.response?.data?.msg||"Error al asignarse la incidencia")}finally{he(!1)}},bt=async()=>{if(window.confirm("Deseas exportar las 10 incidencias ms viejas sin resolver?"))try{const wt=(await Kt.exportOldIncidents(10)).data;if(wt.length===0){alert("No hay incidencias sin resolver para exportar");return}const Wt=await Vh(()=>Promise.resolve().then(()=>sk),void 0),jt=Wt.utils.book_new(),hr=Wt.utils.json_to_sheet(wt);Wt.utils.book_append_sheet(jt,hr,"Incidencias Ms Viejas");const Vt=`incidencias_mas_viejas_${new Date().toISOString().split("T")[0]}.xlsx`;Wt.writeFile(jt,Vt),alert(`Archivo ${Vt} descargado exitosamente con ${wt.length} incidencias`)}catch($e){console.error("Error exportando incidencias:",$e),alert("Error al exportar las incidencias")}},lt=i?"bg-[#0F172A] overflow-hidden shadow-lg shadow-cyan-500/10 rounded-lg border border-cyan-500/20":"bg-white overflow-hidden shadow rounded-lg",tr=i?"text-[#E5E7EB]":"text-gray-900",ke=i?"text-[#94A3B8]":"text-gray-500",$t=i?"text-[#94A3B8]":"text-gray-600";return z?o.jsx("div",{className:`flex items-center justify-center h-64 ${i?"bg-[#0B0F14] rounded-xl":""}`,children:o.jsx("div",{className:`animate-spin rounded-full h-12 w-12 border-b-2 ${i?"border-[#00E5FF]":"border-blue-600"}`})}):o.jsxs("div",{className:`space-y-6 ${i?"bg-[#0B0F14] p-6 rounded-xl":""}`,children:[o.jsxs("div",{children:[o.jsx("h1",{className:`text-xl sm:text-2xl font-bold ${tr} ${i?"ironman-glow":""}`,children:i?"Bienvenido, Sr. Stark":`Bienvenido, ${t?.fullName}`}),o.jsx("p",{className:`text-sm sm:text-base ${$t} mt-1`,children:i?"J.A.R.V.I.S. - Sistema de soporte tcnico activo":"Resumen del sistema de soporte tcnico"})]}),o.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:`${lt} ${e||n?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:()=>Re("pending"),children:o.jsx("div",{className:"p-5",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(qs,{className:`h-6 w-6 ${i?"text-[#FF6A00]":"text-yellow-400"}`})}),o.jsx("div",{className:"ml-5 w-0 flex-1",children:o.jsxs("dl",{children:[o.jsxs("dt",{className:`text-sm font-medium ${ke} truncate flex items-center`,children:["Pendientes",(e||n)&&o.jsx("span",{className:"ml-2",children:V?o.jsx(Lu,{className:`h-4 w-4 ${i?"text-[#94A3B8]":"text-gray-400"}`}):o.jsx(bc,{className:`h-4 w-4 ${i?"text-[#94A3B8]":"text-gray-400"}`})})]}),o.jsx("dd",{className:`text-lg font-medium ${tr}`,children:c.pending})]})})]})})}),pt("pending",h,V,"Seleccionar Ciudad","/incidents/pending")]}),!a&&o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:`${lt} ${e||n?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:()=>Re("inProcess"),children:o.jsx("div",{className:"p-5",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(ho,{className:`h-6 w-6 ${i?"text-[#00E5FF]":"text-blue-400"}`})}),o.jsx("div",{className:"ml-5 w-0 flex-1",children:o.jsxs("dl",{children:[o.jsxs("dt",{className:`text-sm font-medium ${ke} truncate flex items-center`,children:["En Proceso",(e||n)&&o.jsx("span",{className:"ml-2",children:R?o.jsx(Lu,{className:`h-4 w-4 ${i?"text-[#94A3B8]":"text-gray-400"}`}):o.jsx(bc,{className:`h-4 w-4 ${i?"text-[#94A3B8]":"text-gray-400"}`})})]}),o.jsx("dd",{className:`text-lg font-medium ${tr}`,children:c.inProcess})]})})]})})}),pt("inProcess",x,R,"Seleccionar Ciudad","/incidents/pending")]}),n?o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:`${lt} cursor-pointer hover:shadow-md transition-shadow`,onClick:()=>Re("inSupervision"),children:o.jsx("div",{className:"p-5",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(mi,{className:`h-6 w-6 ${i?"text-[#E10600]":"text-purple-400"}`})}),o.jsx("div",{className:"ml-5 w-0 flex-1",children:o.jsxs("dl",{children:[o.jsxs("dt",{className:`text-sm font-medium ${ke} truncate flex items-center`,children:["En Supervisin",o.jsx("span",{className:"ml-2",children:ee?o.jsx(Lu,{className:`h-4 w-4 ${i?"text-[#94A3B8]":"text-gray-400"}`}):o.jsx(bc,{className:`h-4 w-4 ${i?"text-[#94A3B8]":"text-gray-400"}`})})]}),o.jsx("dd",{className:`text-lg font-medium ${tr}`,children:c.inSupervision})]})})]})})}),pt("inSupervision",b,ee,"Seleccionar Ciudad","/incidents/supervision")]}):o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:`${lt} ${e?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:()=>Re("inSupervision"),children:o.jsx("div",{className:"p-5",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(mi,{className:`h-6 w-6 ${i?"text-[#E10600]":"text-purple-400"}`})}),o.jsx("div",{className:"ml-5 w-0 flex-1",children:o.jsxs("dl",{children:[o.jsxs("dt",{className:`text-sm font-medium ${ke} truncate flex items-center`,children:["En Supervisin",e&&o.jsx("span",{className:"ml-2",children:ee?o.jsx(Lu,{className:`h-4 w-4 ${i?"text-[#94A3B8]":"text-gray-400"}`}):o.jsx(bc,{className:`h-4 w-4 ${i?"text-[#94A3B8]":"text-gray-400"}`})})]}),o.jsx("dd",{className:`text-lg font-medium ${tr}`,children:c.inSupervision})]})})]})})}),pt("inSupervision",b,ee,"Seleccionar Ciudad","/incidents/supervision")]}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:`${lt} ${e||n?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:()=>Re("approved"),children:o.jsx("div",{className:"p-5",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(Ws,{className:`h-6 w-6 ${i?"text-[#00B4D8]":"text-green-400"}`})}),o.jsx("div",{className:"ml-5 w-0 flex-1",children:o.jsxs("dl",{children:[o.jsxs("dt",{className:`text-sm font-medium ${ke} truncate flex items-center`,children:["Aprobadas",(e||n)&&o.jsx("span",{className:"ml-2",children:P?o.jsx(Lu,{className:`h-4 w-4 ${i?"text-[#94A3B8]":"text-gray-400"}`}):o.jsx(bc,{className:`h-4 w-4 ${i?"text-[#94A3B8]":"text-gray-400"}`})})]}),o.jsx("dd",{className:`text-lg font-medium ${tr}`,children:c.approved})]})})]})})}),pt("approved",w,P,"Seleccionar Ciudad","/incidents/approved")]})]}),!e&&o.jsxs("div",{className:`shadow overflow-hidden sm:rounded-md ${i?"bg-[#0F172A] border border-cyan-500/20":"bg-white"}`,children:[o.jsxs("div",{className:"px-4 py-5 sm:px-6",children:[o.jsx("h3",{className:`text-lg leading-6 font-medium ${tr}`,children:"Incidencias Recientes"}),o.jsx("p",{className:`mt-1 max-w-2xl text-sm ${ke}`,children:"ltimas incidencias reportadas en el sistema"})]}),o.jsx("ul",{className:`divide-y ${i?"divide-cyan-500/10":"divide-gray-200"}`,children:k.length===0?o.jsx("li",{className:"px-6 py-4",children:o.jsx("p",{className:`text-sm ${ke} text-center py-2`,children:"No hay incidencias recientes"})}):k.map($e=>o.jsx("li",{className:"px-4 sm:px-6 py-3 sm:py-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-2 sm:space-y-0",children:[o.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(Fn,{className:`h-4 w-4 sm:h-5 sm:w-5 ${i?"text-[#00E5FF]":"text-gray-400"}`})}),o.jsxs("div",{className:"ml-3 sm:ml-4 min-w-0 flex-1",children:[o.jsxs("p",{className:`text-sm font-medium ${tr} truncate`,children:[$e.station_code," - ",$e.failure_type]}),o.jsx("p",{className:`text-xs sm:text-sm ${ke} truncate`,children:$e.description})]})]}),o.jsxs("div",{className:"flex items-center justify-between sm:justify-end space-x-2 sm:space-x-4 flex-shrink-0",children:[vt($e.status),o.jsx("span",{className:`text-xs sm:text-sm ${ke}`,children:new Date($e.created_at).toLocaleDateString()})]})]})},$e.id))})]}),e&&o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:`shadow overflow-hidden sm:rounded-md ${i?"bg-[#0F172A] border border-cyan-500/20":"bg-white"}`,children:[o.jsxs("div",{className:`px-4 py-5 sm:px-6 ${i?"bg-[#0B0F14]":"bg-gray-50"}`,children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(vp,{className:`h-5 w-5 mr-2 ${i?"text-[#00E5FF]":"text-blue-600"}`}),o.jsx("h3",{className:`text-lg leading-6 font-medium ${tr}`,children:"Incidencias por Sede"})]}),o.jsx("p",{className:`mt-1 max-w-2xl text-sm ${ke}`,children:"Estado de incidencias en cada ubicacin"})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-6",children:ue.map($e=>o.jsxs("div",{className:`rounded-lg p-4 ${i?"bg-[#0B0F14] border border-cyan-500/10":"bg-gray-50"}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(_0,{className:`h-5 w-5 mr-2 ${i?"text-[#00E5FF]":"text-gray-400"}`}),o.jsx("h4",{className:`text-base font-medium ${tr} capitalize`,children:$e.sede==="bogota"?"Bogot":$e.sede==="barranquilla"?"Barranquilla":$e.sede==="villavicencio"?"Villavicencio":$e.sede})]}),o.jsxs("span",{className:`text-sm ${ke}`,children:["Total: ",$e.total]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("button",{onClick:()=>Dt($e.sede,"pendientes"),className:`text-left p-2 rounded transition-colors ${i?"hover:bg-orange-500/10":"hover:bg-yellow-50"}`,children:[o.jsx("div",{className:`text-xs ${ke}`,children:"Pendientes"}),o.jsx("div",{className:`text-lg font-semibold ${i?"text-[#FF6A00]":"text-yellow-600"}`,children:$e.pendientes})]}),o.jsxs("button",{onClick:()=>Dt($e.sede,"en_proceso"),className:`text-left p-2 rounded transition-colors ${i?"hover:bg-cyan-500/10":"hover:bg-blue-50"}`,children:[o.jsx("div",{className:`text-xs ${ke}`,children:"En Proceso"}),o.jsx("div",{className:`text-lg font-semibold ${i?"text-[#00E5FF]":"text-blue-600"}`,children:$e.en_proceso})]}),o.jsxs("button",{onClick:()=>Dt($e.sede,"en_supervision"),className:`text-left p-2 rounded transition-colors ${i?"hover:bg-red-500/10":"hover:bg-purple-50"}`,children:[o.jsx("div",{className:`text-xs ${ke}`,children:"En Supervisin"}),o.jsx("div",{className:`text-lg font-semibold ${i?"text-[#E10600]":"text-purple-600"}`,children:$e.en_supervision})]}),o.jsxs("button",{onClick:()=>Dt($e.sede,"aprobadas"),className:`text-left p-2 rounded transition-colors ${i?"hover:bg-cyan-500/10":"hover:bg-green-50"}`,children:[o.jsx("div",{className:`text-xs ${ke}`,children:"Aprobadas"}),o.jsx("div",{className:`text-lg font-semibold ${i?"text-[#00B4D8]":"text-green-600"}`,children:$e.aprobadas})]})]})]},$e.sede))})]}),o.jsx(Y8,{}),o.jsxs("div",{className:`rounded-lg shadow p-6 ${i?"bg-[#0F172A] border border-cyan-500/20 shadow-cyan-500/10":"bg-white"}`,children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(ux,{className:`h-6 w-6 mr-2 ${i?"text-[#00E5FF]":"text-green-600"}`}),o.jsx("h3",{className:`text-lg font-semibold ${tr}`,children:"Exportacin de Datos"})]})}),o.jsxs("button",{onClick:bt,className:`w-full inline-flex items-center justify-center px-4 py-3 border border-transparent shadow-sm text-sm font-medium rounded-md text-white focus:outline-none focus:ring-2 focus:ring-offset-2 ${i?"bg-gradient-to-r from-[#E10600] to-[#FF6A00] hover:from-[#FF6A00] hover:to-[#E10600] focus:ring-[#FF6A00]":"bg-green-600 hover:bg-green-700 focus:ring-green-500"}`,children:[o.jsx(ux,{className:"h-5 w-5 mr-2"}),"Exportar Incidencias Ms Viejas (Excel)"]}),o.jsx("p",{className:`text-xs mt-2 text-center ${ke}`,children:"Exporta las 10 incidencias ms viejas sin resolver en formato Excel"})]})]}),e&&o.jsx(X8,{isOwnRatings:!0}),(e||t?.role==="supervisor")&&o.jsx(G8,{incidents:G,onDismiss:()=>ie(!0),onViewIncident:Ot,soundEnabled:!te}),o.jsx(W3,{incident:fe,isOpen:le,onClose:Yt,onAssign:lr,onSelfAssign:It,isAdmin:e,isTechnician:n,technicians:E,selectedTechnician:L,setSelectedTechnician:F,assignLoading:q}),me&&o.jsx("div",{className:`fixed inset-0 overflow-y-auto h-full w-full z-50 ${i?"bg-black bg-opacity-70":"bg-gray-600 bg-opacity-50"}`,children:o.jsx("div",{className:`relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md ${i?"bg-[#0F172A] border-cyan-500/30 shadow-cyan-500/20":"bg-white"}`,children:o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center mb-4",children:[o.jsx(Vo,{className:`h-6 w-6 mr-2 ${i?"text-[#00E5FF]":"text-blue-600"}`}),o.jsx("h3",{className:`text-lg font-medium ${tr}`,children:"Asignar Tcnico"})]}),o.jsxs("div",{className:`mb-4 p-3 rounded ${i?"bg-[#0B0F14] border border-cyan-500/10":"bg-gray-50"}`,children:[o.jsxs("p",{className:`text-sm ${$t}`,children:[o.jsx("strong",{className:tr,children:"Estacin:"})," ",Se?.station_code]}),o.jsxs("p",{className:`text-sm ${$t}`,children:[o.jsx("strong",{className:tr,children:"Sede:"})," ",Se?.sede?.toUpperCase()," - ",Se?.departamento?.toUpperCase()]}),o.jsxs("p",{className:`text-sm ${$t}`,children:[o.jsx("strong",{className:tr,children:"Tipo:"})," ",Pt(Se?.failure_type)]}),o.jsxs("p",{className:`text-sm ${$t}`,children:[o.jsx("strong",{className:tr,children:"Descripcin:"})," ",Se?.description]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:`block text-sm font-medium mb-2 ${i?"text-[#E5E7EB]":"text-gray-700"}`,children:"Seleccionar Tcnico *"}),o.jsxs("select",{value:L,onChange:$e=>F($e.target.value),className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 ${i?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50 focus:border-cyan-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,children:[o.jsx("option",{value:"",children:"Seleccionar tcnico..."}),E.map($e=>o.jsx("option",{value:$e.id,children:$e.full_name},$e.id))]})]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>Z(!1),className:`px-4 py-2 border rounded-md text-sm font-medium ${i?"border-cyan-500/30 text-[#94A3B8] hover:bg-[#0B0F14]":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,disabled:q,children:"Cancelar"}),o.jsx("button",{onClick:Qt,disabled:q,className:`px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 ${i?"bg-[#00E5FF] text-[#0B0F14] hover:bg-[#00B4D8] focus:ring-[#00E5FF]":"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"}`,children:q?"Asignando...":"Asignar"})]})]})})})]})},J8=()=>{const t=Oi(),{user:e,isAdministrativo:r,isJefeOperaciones:n}=Jr(),s=e?.username==="davidlopez10",[a,i]=Q.useState({sede:e?.sede||"bogota",departamento:e?.role==="admin"||e?.role==="administrativo"?"":e?.departamento||"",puesto_numero:"",failure_type:"",peripheral_type:"",description:"",anydesk_address:"",advisor_cedula:"",advisor_contact:""}),[l,c]=Q.useState([]),[d,h]=Q.useState(!1),[p,x]=Q.useState(""),[m,b]=Q.useState(""),[y,w]=Q.useState([]);Q.useEffect(()=>{e&&(e.role==="admin"||e.sede==="barranquilla")&&S()},[e]);const S=async()=>{try{const te=(await E3.getAll()).data.filter(ie=>ie.sede==="barranquilla"&&ie.anydesk_address&&ie.advisor_cedula);w(te)}catch(M){console.error("Error cargando workstations:",M)}},k=[{value:"bogota",label:"Bogot"},{value:"barranquilla",label:"Barranquilla"},{value:"villavicencio",label:"Villavicencio"}],A=[{value:"obama",label:"Obama"},{value:"majority",label:"Majority"},{value:"claro",label:"Claro"}],z=[{value:"contratacion",label:"Contratacin"},{value:"seleccion",label:"Seleccin"},{value:"reclutamiento",label:"Reclutamiento"},{value:"area_financiera",label:"rea Financiera"}],H=()=>e?.role==="admin"||e?.role==="administrativo"?!0:e?.role==="jefe_operaciones"?!1:!e?.departamento,V=M=>r?z:M==="bogota"?A:A.filter(te=>te.value!=="majority"),B=[{value:"pantalla",label:"Pantalla"},{value:"perifericos",label:"Perifricos"},{value:"internet",label:"Internet"},{value:"software",label:"Software"},{value:"otro",label:"Otro"}],R=[{value:"diadema",label:"Diadema"},{value:"mouse",label:"Mouse"},{value:"teclado",label:"Teclado"}],O=M=>{const{name:te,value:ie}=M.target;if(te==="sede")i({...a,[te]:ie,departamento:e?.role==="admin"||e?.role==="administrativo"?"":e?.departamento||"",puesto_numero:"",anydesk_address:"",advisor_cedula:"",advisor_contact:""});else if(te==="departamento")i({...a,[te]:ie,puesto_numero:"",anydesk_address:"",advisor_cedula:"",advisor_contact:""});else if(te==="failure_type"&&ie!=="perifericos")i({...a,[te]:ie,peripheral_type:""});else if(te==="puesto_numero"){const le=parseInt(ie);(ie===""||le>=1&&le<=300)&&i({...a,[te]:ie})}else if(te==="workstation_selection"&&a.sede==="barranquilla"){const le=y.find(X=>X.id==ie);le&&i({...a,anydesk_address:le.anydesk_address||"",advisor_cedula:le.advisor_cedula||"",advisor_contact:le.advisor_contact||""})}else i({...a,[te]:ie});p&&x(""),m&&b("")},ee=M=>{const te=Array.from(M.target.files),ie=[],le=10*1024*1024,X=["image/jpeg","image/png","image/gif","image/webp","application/pdf"];te.forEach(fe=>{if(!X.includes(fe.type)){x(`El archivo ${fe.name} no es un tipo vlido. Solo se permiten imgenes (JPG, PNG, GIF, WebP) y PDFs.`);return}if(fe.size>le){x(`El archivo ${fe.name} es muy grande. Mximo 10MB por archivo.`);return}ie.push(fe)}),ie.length>0&&(c(fe=>[...fe,...ie]),x("")),M.target.value=""},I=M=>{c(te=>te.filter((ie,le)=>le!==M))},P=M=>M.startsWith("image/")?o.jsx(y3,{className:"h-4 w-4 text-blue-500"}):M==="application/pdf"?o.jsx(qn,{className:"h-4 w-4 text-red-500"}):o.jsx(qn,{className:"h-4 w-4 text-gray-500"}),ae=M=>{if(M===0)return"0 Bytes";const te=1024,ie=["Bytes","KB","MB"],le=Math.floor(Math.log(M)/Math.log(te));return parseFloat((M/Math.pow(te,le)).toFixed(2))+" "+ie[le]},G=async M=>{M.preventDefault();const te=a.sede==="barranquilla";if(!a.sede||!a.departamento||!te&&!r&&!a.puesto_numero||!a.failure_type||!a.description.trim()){x("Todos los campos marcados con * son requeridos");return}if(a.failure_type==="perifericos"&&!a.peripheral_type){x("Por favor selecciona el tipo de perifrico");return}if(te){if(!a.anydesk_address){x("La direccin AnyDesk es requerida para incidencias en Barranquilla");return}if(!a.advisor_cedula){x("La cdula del asesor es requerida para incidencias en Barranquilla");return}if(!a.advisor_contact){x("El nmero de contacto del asesor es requerido para incidencias en Barranquilla");return}}if(!te){const ie=parseInt(a.puesto_numero);if(ie<1||ie>300){x("El nmero de puesto debe estar entre 1 y 300");return}}h(!0),x("");try{let ie=a.description.trim();a.failure_type==="perifericos"&&a.peripheral_type&&(ie=`[${R.find(fe=>fe.value===a.peripheral_type)?.label||a.peripheral_type}] ${ie}`);const le=new FormData;le.append("sede",a.sede),le.append("departamento",a.departamento),le.append("puesto_numero",te?1:r?0:parseInt(a.puesto_numero)),le.append("failure_type",a.failure_type),le.append("description",ie),te&&(le.append("anydesk_address",a.anydesk_address),le.append("advisor_cedula",a.advisor_cedula),le.append("advisor_contact",a.advisor_contact)),(e?.role==="coordinador"||e?.role==="administrativo")&&l.length>0&&l.forEach((X,fe)=>{le.append("attachments",X)}),await Kt.createWithFiles(le),b("Incidencia creada exitosamente"),i({sede:e?.sede||"bogota",departamento:"",puesto_numero:"",failure_type:"",peripheral_type:"",description:"",anydesk_address:"",advisor_cedula:"",advisor_contact:""}),c([]),setTimeout(()=>{t("/incidents/supervision")},2e3)}catch(ie){console.error("Error creando incidencia:",ie),x(ie.response?.data?.msg||"Error al crear la incidencia")}finally{h(!1)}};return o.jsxs("div",{className:`max-w-2xl mx-auto px-4 sm:px-0 ${s?"bg-[#0B0F14] p-6 rounded-xl":""}`,children:[o.jsxs("div",{className:"mb-4 sm:mb-6",children:[o.jsxs("button",{onClick:()=>t(-1),className:`flex items-center mb-4 ${s?"text-[#94A3B8] hover:text-[#00E5FF]":"text-gray-600 hover:text-gray-900"}`,children:[o.jsx(Gx,{className:"h-5 w-5 mr-1"}),"Volver"]}),o.jsxs("div",{className:"flex items-start sm:items-center",children:[o.jsx(mi,{className:`h-6 w-6 sm:h-8 sm:w-8 mr-3 mt-1 sm:mt-0 flex-shrink-0 ${s?"text-[#FF6A00]":"text-orange-500"}`}),o.jsxs("div",{children:[o.jsx("h1",{className:`text-xl sm:text-2xl font-bold ${s?"text-[#E5E7EB] ironman-glow":"text-gray-900"}`,children:s?"Nuevo Reporte de Incidencia":"Reportar Nueva Incidencia"}),o.jsx("p",{className:`text-sm sm:text-base mt-1 ${s?"text-[#94A3B8]":"text-gray-600"}`,children:"Registra una nueva falla tcnica en el sistema"})]})]})]}),o.jsxs("div",{className:`shadow-lg rounded-lg p-4 sm:p-6 ${s?"bg-[#0F172A] border border-cyan-500/20 shadow-cyan-500/10":"bg-white"}`,children:[p&&o.jsx("div",{className:`mb-4 rounded-md p-3 ${s?"bg-red-500/10 border border-red-500/30":"bg-red-50 border border-red-200"}`,children:o.jsx("p",{className:`text-sm ${s?"text-[#E10600]":"text-red-700"}`,children:p})}),m&&o.jsx("div",{className:`mb-4 rounded-md p-3 ${s?"bg-cyan-500/10 border border-cyan-500/30":"bg-green-50 border border-green-200"}`,children:o.jsx("p",{className:`text-sm ${s?"text-[#00E5FF]":"text-green-700"}`,children:m})}),o.jsxs("form",{onSubmit:G,className:"space-y-4 sm:space-y-6",children:[e?.role==="admin"&&o.jsxs("div",{children:[o.jsx("label",{htmlFor:"sede",className:`block text-sm font-medium mb-2 ${s?"text-[#E5E7EB]":"text-gray-700"}`,children:"Sede *"}),o.jsx("select",{id:"sede",name:"sede",required:!0,value:a.sede,onChange:O,className:`w-full border rounded-md px-3 py-3 sm:py-2 focus:outline-none focus:ring-2 text-base sm:text-sm ${s?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50 focus:border-cyan-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,children:k.map(M=>o.jsx("option",{value:M.value,children:M.label},M.value))})]}),(e?.role==="coordinador"||e?.role==="jefe_operaciones")&&o.jsxs("div",{children:[o.jsx("label",{className:`block text-sm font-medium mb-2 ${s?"text-[#E5E7EB]":"text-gray-700"}`,children:"Sede"}),o.jsx("div",{className:`w-full border rounded-md px-3 py-3 sm:py-2 ${s?"bg-[#0B0F14] text-[#E5E7EB] border-cyan-500/20":"bg-gray-50 text-gray-700 border-gray-200"}`,children:k.find(M=>M.value===a.sede)?.label||a.sede})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"departamento",className:`block text-sm font-medium mb-2 ${s?"text-[#E5E7EB]":"text-gray-700"}`,children:"Departamento *"}),H()?o.jsxs("select",{id:"departamento",name:"departamento",required:!0,value:a.departamento,onChange:O,className:`w-full border rounded-md px-3 py-3 sm:py-2 focus:outline-none focus:ring-2 text-base sm:text-sm ${s?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50 focus:border-cyan-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,children:[o.jsx("option",{value:"",children:"Seleccionar departamento..."}),V(a.sede).map(M=>o.jsx("option",{value:M.value,children:M.label},M.value))]}):o.jsx("div",{className:`w-full border rounded-md px-3 py-3 sm:py-2 text-base sm:text-sm ${s?"bg-[#0B0F14] text-[#E5E7EB] border-cyan-500/20":"bg-gray-50 text-gray-900 border-gray-200"}`,children:V(a.sede).find(M=>M.value===a.departamento)?.label||A.find(M=>M.value===a.departamento)?.label||z.find(M=>M.value===a.departamento)?.label||a.departamento})]}),a.sede!=="barranquilla"&&!r&&o.jsxs("div",{children:[o.jsx("label",{htmlFor:"puesto_numero",className:`block text-sm font-medium mb-2 ${s?"text-[#E5E7EB]":"text-gray-700"}`,children:"Nmero de Puesto *"}),o.jsx("input",{id:"puesto_numero",name:"puesto_numero",type:"number",min:"1",max:"300",required:!0,value:a.puesto_numero,onChange:O,placeholder:"Ingrese nmero del 1 al 300",className:`w-full border rounded-md px-3 py-3 sm:py-2 focus:outline-none focus:ring-2 text-base sm:text-sm ${s?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50 focus:border-cyan-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`}),o.jsxs("p",{className:`mt-1 text-sm ${s?"text-[#94A3B8]":"text-gray-500"}`,children:[a.departamento==="obama"&&`${k.find(M=>M.value===a.sede)?.label}: Obama - Puestos 1-300`,a.departamento==="majority"&&`${k.find(M=>M.value===a.sede)?.label}: Majority - Puestos 1-300`,a.departamento==="claro"&&`${k.find(M=>M.value===a.sede)?.label}: Claro - Puestos 1-300`,!a.departamento&&"Selecciona un departamento primero"]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"failure_type",className:`block text-sm font-medium mb-2 ${s?"text-[#E5E7EB]":"text-gray-700"}`,children:"Tipo de Falla *"}),o.jsxs("select",{id:"failure_type",name:"failure_type",required:!0,value:a.failure_type,onChange:O,className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 ${s?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50 focus:border-cyan-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,children:[o.jsx("option",{value:"",children:"Seleccionar tipo de falla..."}),B.map(M=>o.jsx("option",{value:M.value,children:M.label},M.value))]})]}),a.failure_type==="perifericos"&&o.jsxs("div",{children:[o.jsx("label",{htmlFor:"peripheral_type",className:`block text-sm font-medium mb-2 ${s?"text-[#E5E7EB]":"text-gray-700"}`,children:"Tipo de Perifrico *"}),o.jsxs("select",{id:"peripheral_type",name:"peripheral_type",required:!0,value:a.peripheral_type,onChange:O,className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 ${s?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50 focus:border-cyan-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,children:[o.jsx("option",{value:"",children:"Seleccionar perifrico..."}),R.map(M=>o.jsx("option",{value:M.value,children:M.label},M.value))]})]}),a.sede==="barranquilla"&&o.jsxs("div",{className:`rounded-lg p-4 space-y-4 ${s?"bg-cyan-500/10 border border-cyan-500/30":"bg-blue-50 border border-blue-200"}`,children:[o.jsxs("h4",{className:`text-sm font-semibold flex items-center ${s?"text-[#00E5FF]":"text-blue-900"}`,children:[o.jsx(Fn,{className:"h-4 w-4 mr-2"}),"Informacin de Trabajo Remoto"]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"anydesk_address",className:`block text-sm font-medium mb-2 ${s?"text-[#E5E7EB]":"text-gray-700"}`,children:"Direccin AnyDesk *"}),o.jsx("input",{id:"anydesk_address",name:"anydesk_address",type:"text",required:!0,value:a.anydesk_address,onChange:O,placeholder:"ej: 900123456",className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 ${s?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50 focus:border-cyan-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"advisor_cedula",className:`block text-sm font-medium mb-2 ${s?"text-[#E5E7EB]":"text-gray-700"}`,children:"Cdula del Asesor *"}),o.jsx("input",{id:"advisor_cedula",name:"advisor_cedula",type:"text",required:!0,value:a.advisor_cedula,onChange:O,placeholder:"ej: 12345678",className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 ${s?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50 focus:border-cyan-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"advisor_contact",className:`block text-sm font-medium mb-2 ${s?"text-[#E5E7EB]":"text-gray-700"}`,children:"Nmero de Contacto del Asesor *"}),o.jsx("input",{id:"advisor_contact",name:"advisor_contact",type:"text",required:!0,value:a.advisor_contact,onChange:O,placeholder:"ej: 3001234567",className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 ${s?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50 focus:border-cyan-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`})]})]}),(e?.role==="coordinador"||e?.role==="administrativo")&&o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"attachments",className:`block text-sm font-medium mb-2 ${s?"text-[#E5E7EB]":"text-gray-700"}`,children:["Archivos Adjuntos ",o.jsx("span",{className:`text-sm ${s?"text-[#94A3B8]":"text-gray-500"}`,children:"(Opcional)"})]}),o.jsx("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("svg",{className:"h-5 w-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm text-yellow-800",children:o.jsx("strong",{children:"La seccin de adjuntos est en mantenimiento."})}),o.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"Temporalmente no se pueden subir archivos. Puedes crear la incidencia sin adjuntos."})]})]})}),o.jsxs("div",{className:"mb-3",children:[o.jsxs("label",{className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-400 bg-gray-100 cursor-not-allowed opacity-50",children:[o.jsx(S3,{className:"h-4 w-4 mr-2"}),"Seleccionar Archivos (Deshabilitado)"]}),o.jsx("input",{id:"file-upload",name:"file-upload",type:"file",multiple:!0,accept:"image/*,.pdf",onChange:ee,className:"sr-only",disabled:!0})]}),o.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Puedes subir imgenes (JPG, PNG, GIF, WebP) y archivos PDF. Mximo 10MB por archivo."}),l.length>0&&o.jsxs("div",{className:"space-y-2 mb-3",children:[o.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["Archivos seleccionados (",l.length,"):"]}),o.jsx("div",{className:"space-y-2",children:l.map((M,te)=>o.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[P(M.type),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-900 truncate max-w-xs",children:M.name}),o.jsx("p",{className:"text-xs text-gray-500",children:ae(M.size)})]})]}),o.jsx("button",{type:"button",onClick:()=>I(te),className:"text-red-500 hover:text-red-700 p-1",children:o.jsx(gs,{className:"h-4 w-4"})})]},te))})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"description",className:`block text-sm font-medium mb-2 ${s?"text-[#E5E7EB]":"text-gray-700"}`,children:"Descripcin de la Falla *"}),o.jsx("textarea",{id:"description",name:"description",required:!0,rows:4,value:a.description,onChange:O,placeholder:"Describe detalladamente la falla tcnica que se est reportando...",className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 resize-vertical ${s?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50 focus:border-cyan-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`}),o.jsx("p",{className:`mt-1 text-sm ${s?"text-[#94A3B8]":"text-gray-500"}`,children:"Proporciona todos los detalles necesarios para que el tcnico pueda entender y solucionar el problema"})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o.jsx("button",{type:"button",onClick:()=>t(-1),className:`px-4 py-2 border rounded-md text-sm font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${s?"border-cyan-500/30 text-[#94A3B8] hover:bg-[#0B0F14]":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Cancelar"}),o.jsxs("button",{type:"submit",disabled:d,className:`flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed ${s?"bg-[#00E5FF] text-[#0B0F14] hover:bg-[#00B4D8]":"text-white bg-blue-600 hover:bg-blue-700"}`,children:[o.jsx(bp,{className:"h-4 w-4 mr-2"}),d?"Guardando...":"Crear Incidencia"]})]})]})]})]})},Q8=()=>{const{user:t,isAdmin:e}=Jr(),r=Jo(),n=Oi(),[s,a]=Q.useState([]),[i,l]=Q.useState(!0),[c,d]=Q.useState(null),[h,p]=Q.useState(!1),[x,m]=Q.useState(""),[b,y]=Q.useState(""),[w,S]=Q.useState(!1),[k,A]=Q.useState(0),[z,H]=Q.useState(""),[V,B]=Q.useState(!1),[R,O]=Q.useState([]),[ee,I]=Q.useState(!1),[P,ae]=Q.useState({departamento:"",sede:"",creador:"",tiempo_supervision:""}),[G,M]=Q.useState(!1),[te,ie]=Q.useState([]),[le,X]=Q.useState(!1),[fe,K]=Q.useState(null),[E,W]=Q.useState(""),[L,F]=Q.useState(""),[q,he]=Q.useState(!1),[me,Z]=Q.useState([]),[Se,We]=Q.useState(!1),[ue,nt]=Q.useState([]),[rt,De]=Q.useState(""),[ve,Xe]=Q.useState(!1),[Re,Ke]=Q.useState(!1),[it,pt]=Q.useState([]),[vt,Pt]=Q.useState(!1),[Dt,Ot]=Q.useState({});Q.useEffect(()=>{const Te=new URLSearchParams(r.search),yt=Te.get("sede"),pr=Te.get("departamento");if(yt||pr){M(!0);const hn={sede:yt||"",departamento:pr||""};ae(hn),bt(hn)}else Yt();t?.role==="admin"&&(lr(),Qt(),It())},[r.search,t]);const Yt=async()=>{try{l(!0);const Te={};P.departamento&&(Te.departamento=P.departamento),P.sede&&e&&(Te.sede=P.sede),P.creador&&(Te.creador=P.creador),P.tiempo_supervision&&(Te.tiempo_supervision=P.tiempo_supervision);let pr=(await Kt.getInSupervision(Te)).data;pr=pr.map(hn=>{const Mt=new Date(hn.resolved_at||hn.updated_at),yn=Math.floor((new Date-Mt)/(1e3*60*60));return{...hn,hoursInSupervision:yn,daysInSupervision:Math.floor(yn/24),isOverdue:yn>3,isUrgent:yn>168}}),a(pr)}catch(Te){console.error("Error cargando incidencias:",Te)}finally{l(!1)}},lr=async()=>{try{const Te=await _c.getTechnicians();ie(Te.data)}catch(Te){console.error("Error cargando tcnicos:",Te)}},Qt=async()=>{try{const yt=(await _c.getUsers()).data.filter(pr=>["coordinador","jefe_operaciones","administrativo"].includes(pr.role));Z(yt)}catch(Te){console.error("Error cargando creadores:",Te)}},It=async()=>{try{const Te=await Kt.getCoordinatorsRanking();pt(Te.data)}catch(Te){console.error("Error cargando ranking de coordinadores:",Te)}},bt=async Te=>{try{l(!0);const yt={};Te.departamento&&(yt.departamento=Te.departamento),Te.sede&&e&&(yt.sede=Te.sede),Te.creador&&(yt.creador=Te.creador),Te.tiempo_supervision&&(yt.tiempo_supervision=Te.tiempo_supervision);let hn=(await Kt.getInSupervision(yt)).data.map(Mt=>{const Un=new Date(Mt.resolved_at||Mt.updated_at),zn=Math.floor((new Date-Un)/(1e3*60*60));return{...Mt,hoursInSupervision:zn,daysInSupervision:Math.floor(zn/24),isOverdue:zn>3,isUrgent:zn>168}});a(hn)}catch(yt){console.error("Error cargando incidencias:",yt)}finally{l(!1)}},lt=()=>{n("/dashboard")},tr=()=>{if(!G)return"";const Te=[];if(P.sede){const yt=P.sede==="bogota"?"Bogot":P.sede==="barranquilla"?"Barranquilla":P.sede==="villavicencio"?"Villavicencio":P.sede;Te.push(`Ciudad: ${yt}`)}if(P.departamento){const yt=P.departamento==="obama"?"Obama":P.departamento==="majority"?"Majority":P.departamento==="claro"?"Claro":P.departamento==="contratacion"?"Contratacin":P.departamento==="seleccion"?"Seleccin":P.departamento==="reclutamiento"?"Reclutamiento":P.departamento==="area_financiera"?"rea Financiera":P.departamento==="administrativo"?"Administrativo":P.departamento;Te.push(`Departamento: ${yt}`)}return Te.length>0?` (Filtrado por: ${Te.join(", ")})`:""},ke=(Te,yt)=>{d(Te),m(yt),y(""),A(0),H(""),p(!0)},$t=async()=>{if(x==="reject"&&!b.trim()){alert("El motivo del rechazo es requerido");return}if(x==="approve"&&(t?.role==="coordinador"||t?.role==="administrativo")&&k===0){alert("Debes calificar al tcnico antes de aprobar la incidencia");return}S(!0);try{if(x==="approve"){const Te={approval_notes:b,technician_rating:k>0?k:void 0,rating_feedback:z.trim()||void 0};await Kt.approve(c.id,Te)}else await Kt.reject(c.id,b);p(!1),await Yt()}catch(Te){console.error("Error en la accin:",Te),alert(Te.response?.data?.msg||"Error al procesar la accin")}finally{S(!1)}},$e=async Te=>{d(Te),I(!0),B(!0);try{const yt=await Kt.getHistory(Te.id);O(yt.data)}catch(yt){console.error("Error cargando historial:",yt),alert("Error al cargar el historial")}finally{I(!1)}},wt=Te=>{K(Te),W(""),F(""),X(!0)},Wt=async()=>{if(!E){alert("Por favor selecciona un tcnico");return}he(!0);try{await Kt.reassignTechnician(fe.id,parseInt(E),L),X(!1),await Yt(),alert("Tcnico reasignado exitosamente")}catch(Te){console.error("Error reasignando tcnico:",Te),alert(Te.response?.data?.msg||"Error al reasignar tcnico")}finally{he(!1)}},jt=(Te,yt)=>{const pr={...P,[Te]:yt};ae(pr),bt(pr)},hr=Te=>{nt([Te]),De(""),We(!0)},Vt=()=>{const Te=s.filter(yt=>yt.isOverdue);if(Te.length===0){alert("No hay incidencias atrasadas para alertar");return}nt(Te),De(""),We(!0)},Sr=async()=>{if(!rt.trim()){alert("Debes escribir un mensaje de alerta");return}Xe(!0);try{const Te=ue.map(pr=>pr.id),yt=await Kt.sendApprovalAlerts(Te,rt);alert(yt.data.msg),We(!1),nt([]),De("")}catch(Te){console.error("Error enviando alerta:",Te),alert(Te.response?.data?.msg||"Error al enviar la alerta")}finally{Xe(!1)}},Ur=()=>{const Te={departamento:"",sede:"",creador:"",tiempo_supervision:""};ae(Te),bt(Te)},rr=async()=>{if(window.confirm("Deseas exportar las 10 incidencias ms viejas sin resolver?"))try{const yt=(await Kt.exportOldIncidents(10)).data;if(yt.length===0){alert("No hay incidencias sin resolver para exportar");return}const pr=await Vh(()=>Promise.resolve().then(()=>sk),void 0),hn=pr.utils.book_new(),Mt=pr.utils.json_to_sheet(yt);pr.utils.book_append_sheet(hn,Mt,"Incidencias Ms Viejas");const Un=`incidencias_mas_viejas_${new Date().toISOString().split("T")[0]}.xlsx`;pr.writeFile(hn,Un),alert(`Archivo ${Un} descargado exitosamente con ${yt.length} incidencias`)}catch(Te){console.error("Error exportando incidencias:",Te),alert("Error al exportar las incidencias")}},Ut=Te=>{const yt={en_supervision:"bg-purple-100 text-purple-800"},pr={en_supervision:"En Supervisin"};return o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${yt[Te]}`,children:pr[Te]})},cr=Te=>({pantalla:"Pantalla",perifericos:"Perifricos",internet:"Internet",software:"Software",otro:"Otro"})[Te]||Te;return i?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{children:o.jsxs("div",{className:"flex items-center space-x-3",children:[G&&o.jsxs("button",{onClick:lt,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[o.jsx(Gx,{className:"h-4 w-4 mr-1"}),"Volver al Dashboard"]}),o.jsxs("div",{children:[o.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Incidencias en Supervisin",tr()]}),o.jsx("p",{className:"text-gray-600",children:"Revisa y aprueba las incidencias resueltas por los tcnicos"})]})]})}),o.jsx("div",{className:"bg-purple-50 px-4 py-2 rounded-lg",children:o.jsxs("span",{className:"text-purple-700 font-medium",children:[s.length," incidencia(s) pendiente(s)"]})}),t.role==="admin"&&o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs("button",{onClick:()=>Ke(!Re),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[o.jsx(Xx,{className:"h-4 w-4 mr-2"}),"Filtros Avanzados",Re?o.jsx(Lu,{className:"h-4 w-4 ml-1"}):o.jsx(bc,{className:"h-4 w-4 ml-1"})]}),o.jsxs("button",{onClick:Vt,className:"inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[o.jsx(wc,{className:"h-4 w-4 mr-2"}),"Alertar Atrasadas +3h (",s.filter(Te=>Te.isOverdue).length,")"]}),o.jsxs("button",{onClick:()=>Pt(!vt),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[o.jsx(Gu,{className:"h-4 w-4 mr-2"}),"Top 10 Coordinadores",vt?o.jsx(Lu,{className:"h-4 w-4 ml-1"}):o.jsx(bc,{className:"h-4 w-4 ml-1"})]}),o.jsxs("button",{onClick:rr,className:"inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[o.jsx(ux,{className:"h-4 w-4 mr-2"}),"Exportar Excel"]})]})]}),Re&&t.role==="admin"&&o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sede"}),o.jsxs("select",{value:P.sede,onChange:Te=>jt("sede",Te.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Todas las sedes"}),o.jsx("option",{value:"bogota",children:"Bogot"}),o.jsx("option",{value:"barranquilla",children:"Barranquilla"}),o.jsx("option",{value:"villavicencio",children:"Villavicencio"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Departamento"}),o.jsxs("select",{value:P.departamento,onChange:Te=>jt("departamento",Te.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Todos los departamentos"}),o.jsx("option",{value:"obama",children:"Obama"}),o.jsx("option",{value:"majority",children:"Majority"}),o.jsx("option",{value:"claro",children:"Claro"}),o.jsx("option",{value:"contratacion",children:"Contratacin"}),o.jsx("option",{value:"seleccion",children:"Seleccin"}),o.jsx("option",{value:"reclutamiento",children:"Reclutamiento"}),o.jsx("option",{value:"area_financiera",children:"rea Financiera"}),o.jsx("option",{value:"administrativo",children:"Administrativo (General)"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Creado por"}),o.jsxs("select",{value:P.creador,onChange:Te=>jt("creador",Te.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Todos los creadores"}),o.jsx("option",{value:"coordinador",children:"Coordinadores"}),o.jsx("option",{value:"jefe_operaciones",children:"Jefes de Operaciones"}),o.jsx("option",{value:"administrativo",children:"Administrativos"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tiempo en supervisin"}),o.jsxs("select",{value:P.tiempo_supervision,onChange:Te=>jt("tiempo_supervision",Te.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Todo el tiempo"}),o.jsx("option",{value:"hoy",children:"Resueltas hoy"}),o.jsx("option",{value:"3horas",children:"Ms de 3 horas"}),o.jsx("option",{value:"semana",children:"Ms de 7 das"}),o.jsx("option",{value:"mes",children:"Ms de 30 das"})]})]})]}),o.jsx("div",{className:"mt-4 flex justify-end",children:o.jsx("button",{onClick:Ur,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Limpiar Filtros"})})]}),vt&&t.role==="admin"&&o.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(Gu,{className:"h-6 w-6 text-orange-600 mr-2"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top 10 Coordinadores - Incidencias Sin Cerrar"})]})}),it.length===0?o.jsx("p",{className:"text-gray-500 text-center py-4",children:"No hay coordinadores con incidencias sin cerrar"}):o.jsx("div",{className:"space-y-3",children:it.map((Te,yt)=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${yt===0?"bg-yellow-100 text-yellow-800":yt===1?"bg-gray-100 text-gray-800":yt===2?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"}`,children:yt+1}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-900",children:Te.full_name}),o.jsxs("p",{className:"text-sm text-gray-500",children:[Te.role," - ",Te.sede?.toUpperCase(),Te.departamento&&` - ${Te.departamento.toUpperCase()}`]})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("p",{className:"text-lg font-bold text-red-600",children:Te.incidencias_sin_cerrar}),o.jsxs("p",{className:"text-xs text-gray-500",children:["P:",Te.pendientes," | EP:",Te.en_proceso," | ES:",Te.en_supervision]})]})]},Te.id))})]}),s.length===0?o.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow",children:[o.jsx(Ws,{className:"h-12 w-12 text-green-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Todo al da!"}),o.jsx("p",{className:"text-gray-500",children:"No hay incidencias esperando supervisin en este momento."})]}):o.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsx("div",{className:"space-y-4",children:s.map(Te=>o.jsx("div",{className:"border border-gray-200 rounded-lg p-6 sm:p-4 hover:bg-gray-50 transition-colors w-full overflow-x-auto",children:o.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 lg:gap-0 min-w-full",children:[o.jsxs("div",{className:"flex-1 min-w-0 w-full lg:w-auto",children:[o.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[o.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[o.jsx(Fn,{className:"h-4 w-4 mr-1"}),o.jsx("span",{className:"font-medium",children:Te.station_code}),o.jsxs("span",{className:"ml-2 text-xs bg-gray-100 px-2 py-1 rounded",children:[Te.sede?.toUpperCase()," - ",Te.departamento?.toUpperCase()]})]}),o.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[o.jsx(Di,{className:"h-4 w-4 mr-1"}),o.jsx("span",{className:"capitalize",children:Te.failure_type})]}),o.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[o.jsx(Bn,{className:"h-4 w-4 mr-1 text-blue-600"}),o.jsxs("span",{children:[o.jsx("strong",{children:"Tcnico:"})," ",Te.assigned_to_name]})]}),o.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[o.jsx(Bn,{className:"h-4 w-4 mr-1 text-green-600"}),o.jsxs("span",{children:[o.jsx("strong",{children:"Reportado por:"})," ",Te.reported_by_name]})]})]}),o.jsx("p",{className:"text-gray-900 font-medium mb-1",children:Te.description}),o.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(qs,{className:"h-4 w-4 mr-1"}),o.jsxs("span",{children:["En supervisin: ",Te.hoursInSupervision,"h",Te.daysInSupervision>0&&` (${Te.daysInSupervision}d)`]}),Te.isUrgent&&o.jsx("span",{className:"ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"URGENTE! +7 das"}),Te.isOverdue&&!Te.isUrgent&&o.jsx("span",{className:"ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-orange-100 text-orange-800",children:"Atrasado +3 horas"})]}),Ut(Te.status)]})]}),o.jsxs("div",{className:"mt-4 lg:mt-0 lg:ml-4 w-full lg:w-auto flex-shrink-0",children:[o.jsxs("div",{className:"hidden lg:flex items-center space-x-2",children:[o.jsxs("button",{onClick:()=>$e(Te),className:"inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 shadow-sm transition-all duration-200",children:[o.jsx(Dl,{className:"h-4 w-4 mr-2"}),"Ver Historial"]}),t.role==="admin"&&Te.assigned_to_name&&o.jsxs("button",{onClick:()=>wt(Te),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 shadow-lg transition-all duration-200",children:[o.jsx(Vo,{className:"h-4 w-4 mr-2"}),"Reasignar"]}),(t.role!=="jefe_operaciones"||Te.reported_by_name===t.full_name)&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:()=>ke(Te,"approve"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 shadow-lg transition-all duration-200",children:[o.jsx($h,{className:"h-4 w-4 mr-2"}),"Aprobar"]}),o.jsxs("button",{onClick:()=>ke(Te,"reject"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 shadow-lg transition-all duration-200",children:[o.jsx(gs,{className:"h-4 w-4 mr-2"}),"Rechazar"]})]}),t.role==="admin"&&Te.isOverdue&&o.jsxs("button",{onClick:()=>hr(Te),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 shadow-lg transition-all duration-200",children:[o.jsx(wc,{className:"h-4 w-4 mr-2"}),"Alertar"]})]}),o.jsx("div",{className:"lg:hidden w-full",children:o.jsx("div",{className:"flex justify-start",children:o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>Ot(yt=>({...yt,[Te.id]:!yt[Te.id]})),className:"inline-flex items-center justify-center px-4 py-2 border border-blue-500 rounded-lg text-blue-700 bg-blue-50 hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 shadow-md transition-all duration-200",children:[o.jsx("span",{className:"text-sm font-medium mr-2",children:"Acciones"}),o.jsx(bc,{className:`h-4 w-4 transition-transform duration-200 ${Dt[Te.id]?"transform rotate-180":""}`})]}),Dt[Te.id]&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>Ot(yt=>({...yt,[Te.id]:!1}))}),o.jsx("div",{className:"absolute left-0 bottom-full mb-2 w-52 bg-white rounded-lg shadow-xl border border-gray-200 z-30",children:o.jsxs("div",{className:"py-2",children:[o.jsxs("button",{onClick:()=>{$e(Te),Ot(yt=>({...yt,[Te.id]:!1}))},className:"flex items-center w-full px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-150",children:[o.jsx(Dl,{className:"h-4 w-4 mr-3 text-blue-600"}),"Ver Historial"]}),t.role==="admin"&&Te.assigned_to_name&&o.jsxs("button",{onClick:()=>{wt(Te),Ot(yt=>({...yt,[Te.id]:!1}))},className:"flex items-center w-full px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-150",children:[o.jsx(Vo,{className:"h-4 w-4 mr-3 text-orange-600"}),"Reasignar Tcnico"]}),(t.role!=="jefe_operaciones"||Te.reported_by_name===t.full_name)&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:()=>{ke(Te,"approve"),Ot(yt=>({...yt,[Te.id]:!1}))},className:"flex items-center w-full px-4 py-3 text-sm text-gray-700 hover:bg-green-50 transition-colors duration-150",children:[o.jsx($h,{className:"h-4 w-4 mr-3 text-green-600"}),"Aprobar"]}),o.jsxs("button",{onClick:()=>{ke(Te,"reject"),Ot(yt=>({...yt,[Te.id]:!1}))},className:"flex items-center w-full px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors duration-150",children:[o.jsx(gs,{className:"h-4 w-4 mr-3 text-red-600"}),"Rechazar"]})]}),t.role==="admin"&&Te.isOverdue&&o.jsxs("button",{onClick:()=>{hr(Te),Ot(yt=>({...yt,[Te.id]:!1}))},className:"flex items-center w-full px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors duration-150",children:[o.jsx(wc,{className:"h-4 w-4 mr-3 text-red-600"}),"Enviar Alerta"]})]})})]})]})})}),t.role==="jefe_operaciones"&&Te.reported_by_name!==t.full_name&&o.jsx("div",{className:"text-sm text-gray-500 italic px-3 py-2 bg-gray-50 rounded-lg",children:"Solo supervisin - no puedes aprobar incidencias de otros"})]})]})},Te.id))})})}),h&&o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:o.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center mb-4",children:[x==="approve"?o.jsx(Ws,{className:"h-6 w-6 text-green-600 mr-2"}):o.jsx(Cc,{className:"h-6 w-6 text-red-600 mr-2"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:x==="approve"?"Aprobar Incidencia":"Rechazar Incidencia"})]}),o.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded",children:[o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Estacin:"})," ",c?.station_code]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Sede:"})," ",c?.sede?.toUpperCase()," - ",c?.departamento?.toUpperCase()]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Tcnico:"})," ",c?.assigned_to_name]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Descripcin:"})," ",c?.description]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:x==="approve"?"Comentarios (opcional)":"Motivo del rechazo *"}),o.jsx("textarea",{value:b,onChange:Te=>y(Te.target.value),rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:x==="approve"?"Comentarios adicionales...":"Explica por qu se rechaza esta solucin..."})]}),x==="approve"&&(t?.role==="coordinador"||t?.role==="administrativo")&&o.jsxs("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[o.jsxs("div",{className:"flex items-center mb-3",children:[o.jsx(Dc,{className:"h-5 w-5 text-yellow-600 mr-2"}),o.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Calificar al Tcnico *"})]}),o.jsxs("p",{className:"text-xs text-gray-600 mb-3",children:["Cmo calificas el trabajo realizado por ",o.jsx("strong",{children:c?.assigned_to_name}),"?"]}),o.jsx("div",{className:"mb-3",children:o.jsx(Xu,{rating:k,onRatingChange:A,size:"lg"})}),k>0&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Comentarios sobre el desempeo (opcional)"}),o.jsx("textarea",{value:z,onChange:Te=>H(Te.target.value),rows:2,className:"w-full text-sm border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500",placeholder:"Describe qu aspectos destacas del trabajo del tcnico..."})]})]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",disabled:w,children:"Cancelar"}),o.jsx("button",{onClick:$t,disabled:w,className:`px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white ${x==="approve"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"} focus:outline-none focus:ring-2 focus:ring-offset-2 ${x==="approve"?"focus:ring-green-500":"focus:ring-red-500"} disabled:opacity-50`,children:w?"Procesando...":x==="approve"?"Aprobar":"Rechazar"})]})]})})}),V&&o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:o.jsx("div",{className:"relative top-10 mx-auto p-5 border max-w-2xl shadow-lg rounded-md bg-white",children:o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Ec,{className:"h-6 w-6 text-blue-600 mr-2"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Historial de Incidencia"})]}),o.jsx("button",{onClick:()=>B(!1),className:"text-gray-400 hover:text-gray-600",children:o.jsx(Cc,{className:"h-6 w-6"})})]}),o.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded",children:[o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Estacin:"})," ",c?.station_code]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Sede:"})," ",c?.sede?.toUpperCase()," - ",c?.departamento?.toUpperCase()]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Tipo:"})," ",cr(c?.failure_type)]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Descripcin:"})," ",c?.description]}),c?.anydesk_address&&o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"AnyDesk:"})," ",o.jsx("span",{className:"font-mono text-blue-600",children:c.anydesk_address})]}),c?.advisor_cedula&&o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Cdula del Agente:"})," ",o.jsx("span",{className:"font-mono",children:c.advisor_cedula})]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Tcnico Asignado:"})," ",c?.assigned_to_name]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Historial de Acciones:"}),ee?o.jsx("div",{className:"flex items-center justify-center py-4",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):R.length===0?o.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No hay historial disponible"}):o.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:R.map((Te,yt)=>o.jsx("div",{className:"border-l-4 border-blue-200 pl-4",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[Te.action.includes("Rechazado")?o.jsx(Cc,{className:"h-4 w-4 text-red-500"}):Te.action.includes("Aprobado")?o.jsx(Ws,{className:"h-4 w-4 text-green-500"}):Te.action.includes("resuelto")||Te.action.includes("Marcado")?o.jsx(ho,{className:"h-4 w-4 text-blue-500"}):Te.action.includes("Asignacin")?o.jsx(Bn,{className:"h-4 w-4 text-purple-500"}):o.jsx(qu,{className:"h-4 w-4 text-gray-500"}),o.jsx("span",{className:"text-sm font-medium text-gray-900",children:Te.action})]}),o.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["Por: ",o.jsx("strong",{children:Te.user_name})]}),Te.details&&o.jsxs("div",{className:`text-sm p-2 rounded mt-2 ${Te.action.includes("Rechazado")?"bg-red-50 text-red-700 border border-red-200":Te.action.includes("resuelto")||Te.action.includes("Marcado")?"bg-blue-50 text-blue-700 border border-blue-200":"bg-gray-50 text-gray-700"}`,children:[o.jsx("strong",{children:Te.action.includes("Rechazado")?"Motivo del rechazo: ":Te.action.includes("resuelto")||Te.action.includes("Marcado")?"Notas del tcnico: ":"Detalles: "}),Te.details]}),Te.action.includes("Aprobado")&&Te.technician_rating&&o.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mt-2",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx(Dc,{className:"h-4 w-4 text-yellow-600"}),o.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Calificacin del Tcnico"})]}),o.jsx("div",{className:"flex items-center space-x-2 mb-1",children:o.jsx(Xu,{rating:Te.technician_rating,readonly:!0,size:"sm"})}),o.jsxs("p",{className:"text-xs text-gray-600",children:["Calificado por: ",o.jsx("strong",{children:Te.rated_by_name})]}),Te.rating_feedback&&o.jsxs("p",{className:"text-sm text-gray-700 mt-2",children:[o.jsx("strong",{children:"Comentarios:"})," ",Te.rating_feedback]})]})]}),o.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[new Date(Te.timestamp).toLocaleDateString()," ",o.jsx("br",{}),new Date(Te.timestamp).toLocaleTimeString()]})]})},Te.id||yt))})]}),o.jsx("div",{className:"flex justify-end",children:o.jsx("button",{onClick:()=>B(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cerrar"})})]})})}),Se&&o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:o.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center mb-4",children:[o.jsx(wc,{className:"h-6 w-6 text-red-600 mr-2"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Enviar Alerta"})]}),o.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded",children:[o.jsxs("p",{className:"text-sm text-red-700 mb-2",children:[o.jsx("strong",{children:"Incidencias a alertar:"})," ",ue.length]}),o.jsx("div",{className:"max-h-32 overflow-y-auto",children:ue.map(Te=>o.jsxs("div",{className:"text-xs text-red-600 mb-1",children:[" ",Te.station_code," - ",Te.reported_by_name," (",Te.hoursInSupervision,"h)"]},Te.id))}),o.jsxs("p",{className:"text-xs text-red-600 mt-2",children:["Responsables que recibirn la alerta: ",[...new Set(ue.map(Te=>Te.reported_by_name))].join(", ")]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje de Alerta *"}),o.jsx("textarea",{value:rt,onChange:Te=>De(Te.target.value),rows:4,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500",placeholder:"Estimado/a [nombre], tienes incidencias pendientes de aprobacin que requieren tu atencin urgente. Por favor procede con la revisin y aprobacin en el sistema..."})]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>We(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",disabled:ve,children:"Cancelar"}),o.jsx("button",{onClick:Sr,disabled:ve||!rt.trim(),className:"px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:ve?"Enviando...":"Enviar Alerta"})]})]})})}),le&&o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:o.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center mb-4",children:[o.jsx(Vo,{className:"h-6 w-6 text-orange-600 mr-2"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Reasignar Tcnico"})]}),o.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded",children:[o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Estacin:"})," ",fe?.station_code]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Estado:"})," En Supervisin"]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Tcnico actual:"})," ",fe?.assigned_to_name]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Descripcin:"})," ",fe?.description]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nuevo Tcnico *"}),o.jsxs("select",{value:E,onChange:Te=>W(Te.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[o.jsx("option",{value:"",children:"Seleccionar nuevo tcnico..."}),te.filter(Te=>Te.id!==fe?.assigned_to_id).map(Te=>o.jsx("option",{value:Te.id,children:Te.full_name},Te.id))]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo de la reasignacin"}),o.jsx("textarea",{value:L,onChange:Te=>F(Te.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",rows:"3",placeholder:"Ej: Necesita revisin adicional, tcnico especializado requerido, correccin de errores..."})]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>X(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",disabled:q,children:"Cancelar"}),o.jsx("button",{onClick:Wt,disabled:q,className:"px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50",children:q?"Reasignando...":"Reasignar"})]})]})})})]})},Z8=()=>{const{user:t,isAdmin:e,isTechnician:r,isJefeOperaciones:n,canSupervise:s}=Jr(),a=t?.username==="davidlopez10",i=Jo(),l=Oi(),[c,d]=Q.useState([]),[h,p]=Q.useState([]),[x,m]=Q.useState([]),[b,y]=Q.useState(!0),[w,S]=Q.useState(!1),[k,A]=Q.useState(!1),[z,H]=Q.useState(null),[V,B]=Q.useState(""),[R,O]=Q.useState(!1),[ee,I]=Q.useState(""),[P,ae]=Q.useState({departamento:"",sede:"",coordinador:"",fecha:""}),[G,M]=Q.useState(!1),[te,ie]=Q.useState(null),[le,X]=Q.useState(!1),[fe,K]=Q.useState(null),[E,W]=Q.useState(!1),[L,F]=Q.useState([]),[q,he]=Q.useState({}),[me,Z]=Q.useState("pendiente"),[Se,We]=Q.useState([]),ue=[{value:"obama",label:"Obama"},{value:"majority",label:"Majority"},{value:"claro",label:"Claro"}],nt=[{value:"bogota",label:"Bogot"},{value:"barranquilla",label:"Barranquilla"},{value:"villavicencio",label:"Villavicencio"}],rt=[{value:"hoy",label:"Hoy"},{value:"ayer",label:"Ayer"},{value:"3dias",label:"ltimos 3 das"},{value:"semana",label:"ltima semana"}],De=()=>e?nt:r?t?.sede==="bogota"?nt.filter(ke=>ke.value==="bogota"||ke.value==="barranquilla"):t?.sede==="villavicencio"?nt.filter(ke=>ke.value==="villavicencio"||ke.value==="barranquilla"):nt.filter(ke=>ke.value===t?.sede):n?nt.filter(ke=>ke.value===t?.sede):nt,ve=ke=>ke==="bogota"||!ke?ue:ue.filter($t=>$t.value!=="majority");Q.useEffect(()=>{const ke=new URLSearchParams(i.search),$t=ke.get("sede"),$e=ke.get("departamento"),wt=ke.get("status"),Wt=ke.get("highlight"),jt=wt||"pendiente";if(Z(jt),$t||$e||wt){M(!0);const hr={sede:$t||"",departamento:$e||""};ae(hr);const Vt={};hr.departamento&&(Vt.departamento=hr.departamento),hr.sede&&e&&(Vt.sede=hr.sede),wt&&(Vt.status=wt),Xe(Vt,jt)}else Xe({},jt);Wt&&(ie(parseInt(Wt)),setTimeout(()=>ie(null),5e3))},[i.search,e]),Q.useEffect(()=>{const ke=setInterval(()=>{const $t={};P.departamento&&($t.departamento=P.departamento),P.sede&&e&&($t.sede=P.sede),Xe($t,me)},6e4);return()=>clearInterval(ke)},[P,e,me]),Q.useEffect(()=>{if(E){const ke=$3(L);d(ke)}else d(L)},[E,L]);const Xe=async(ke={},$t="pendiente")=>{try{y(!0);let $e;if($t==="en_proceso"){const rr={...ke,status:"en_proceso"};$e=Kt.getAll(rr)}else $e=Kt.getPending(ke);const wt=[$e];e&&wt.push(_c.getTechnicians()),n&&wt.push(_c.getCoordinators());const Wt=await Promise.all(wt),jt=Wt[0],hr=e?Wt[1]:{data:[]},Vt=n?Wt[Wt.length-1]:{data:[]};let Sr=jt.data;if(ke.coordinador&&(Sr=Sr.filter(rr=>rr.reported_by_name?.toLowerCase().includes(ke.coordinador.toLowerCase()))),ke.fecha){const rr=new Date;rr.setHours(0,0,0,0),Sr=Sr.filter(Ut=>{const cr=new Date(Ut.created_at);switch(cr.setHours(0,0,0,0),ke.fecha){case"hoy":return cr.getTime()===rr.getTime();case"ayer":const Te=new Date(rr);return Te.setDate(Te.getDate()-1),cr.getTime()===Te.getTime();case"3dias":const yt=new Date(rr);return yt.setDate(yt.getDate()-3),cr>=yt;case"semana":const pr=new Date(rr);return pr.setDate(pr.getDate()-7),cr>=pr;default:return!0}})}d(Sr),p(Sr),F(Sr),m(hr.data),We(Vt.data);const Ur={};for(const rr of jt.data)try{const Ut=await Kt.getAttachments(rr.id);Ur[rr.id]=Ut.data.length}catch{Ur[rr.id]=0}he(Ur)}catch($e){console.error("Error cargando datos:",$e)}finally{y(!1)}},Re=(ke,$t)=>{let $e={...P,[ke]:$t};if(ke==="sede"&&(ve($t).some(hr=>hr.value===$e.departamento)||($e.departamento="")),ke==="sede"&&$t&&!De().some(hr=>hr.value===$t))return;ae($e);const wt={};$e.departamento&&(wt.departamento=$e.departamento),$e.sede&&e&&(wt.sede=$e.sede),$e.coordinador&&(wt.coordinador=$e.coordinador),$e.fecha&&(wt.fecha=$e.fecha),Xe(wt,me)},Ke=()=>{ae({departamento:"",sede:"",coordinador:"",fecha:""}),W(!1),M(!1),l("/incidents/pending",{replace:!0}),Xe({},"pendiente")},it=()=>{l("/dashboard")},pt=()=>{const ke=[];if(G){if(P.sede){const $t=P.sede==="bogota"?"Bogot":P.sede==="barranquilla"?"Barranquilla":P.sede==="villavicencio"?"Villavicencio":P.sede;ke.push(`Ciudad: ${$t}`)}if(P.departamento){const $t=P.departamento==="obama"?"Obama":P.departamento==="majority"?"Majority":P.departamento==="claro"?"Claro":P.departamento;ke.push(`Departamento: ${$t}`)}}if(P.coordinador&&ke.push(`Coordinador: ${P.coordinador}`),P.fecha){const $t=rt.find($e=>$e.value===P.fecha)?.label||P.fecha;ke.push(`Fecha: ${$t}`)}return E&&ke.push("Top 3 con ms retraso"),ke.length>0?` (${ke.join(", ")})`:""},vt=ke=>{K(ke),X(!0)},Pt=()=>{X(!1),K(null)},Dt=ke=>{X(!1),Yt(ke)},Ot=ke=>{X(!1),Qt(ke)},Yt=ke=>{H(ke),B(""),S(!0)},lr=async()=>{const ke=e?V:t.id;if(e&&!V){alert("Por favor selecciona un tcnico");return}O(!0);try{await Kt.assignTechnician(z.id,parseInt(ke)),S(!1),await Xe({},me)}catch($t){console.error("Error asignando tcnico:",$t),alert($t.response?.data?.msg||"Error al asignar tcnico")}finally{O(!1)}},Qt=async ke=>{if(window.confirm(`Ests seguro de que quieres tomar la incidencia de ${ke.station_code}?`))try{await Kt.assignTechnician(ke.id,t.id),await Xe({},me)}catch($t){console.error("Error auto-asignndose:",$t),alert($t.response?.data?.msg||"Error al asignarse la incidencia")}},It=ke=>{H(ke),B(""),I(""),A(!0)},bt=async()=>{if(!V){alert("Por favor selecciona un tcnico");return}O(!0);try{await Kt.reassignTechnician(z.id,parseInt(V),ee),A(!1),await Xe({},me),alert("Tcnico reasignado exitosamente")}catch(ke){console.error("Error reasignando tcnico:",ke),alert(ke.response?.data?.msg||"Error al reasignar tcnico")}finally{O(!1)}},lt=ke=>({pantalla:"Pantalla",perifericos:"Perifricos",internet:"Internet",software:"Software",otro:"Otro"})[ke]||ke,tr=ke=>{const $t={pantalla:"bg-blue-100 text-blue-800",perifericos:"bg-purple-100 text-purple-800",internet:"bg-red-100 text-red-800",software:"bg-green-100 text-green-800",otro:"bg-gray-100 text-gray-800"};return $t[ke]||$t.otro};return b?o.jsx("div",{className:`flex items-center justify-center h-64 ${a?"bg-[#0B0F14] rounded-xl":""}`,children:o.jsx("div",{className:`animate-spin rounded-full h-12 w-12 border-b-2 ${a?"border-[#00E5FF]":"border-blue-600"}`})}):o.jsxs("div",{className:`space-y-4 md:space-y-6 ${a?"bg-[#0B0F14] p-6 rounded-xl":""}`,children:[o.jsxs("div",{className:"flex flex-col space-y-4 lg:flex-row lg:items-center lg:justify-between lg:space-y-0",children:[o.jsx("div",{className:"space-y-3",children:o.jsxs("div",{className:"flex flex-col space-y-3 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-3",children:[G&&o.jsxs("button",{onClick:it,className:`inline-flex items-center px-3 py-2 border shadow-sm text-sm leading-4 font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 self-start ${a?"text-[#94A3B8] bg-[#0F172A] hover:bg-[#0B0F14] border-cyan-500/30":"text-gray-700 bg-white hover:bg-gray-50 border-gray-300"}`,children:[o.jsx(Gx,{className:"h-4 w-4 mr-1"}),o.jsx("span",{className:"hidden sm:inline",children:"Volver al Dashboard"}),o.jsx("span",{className:"sm:hidden",children:"Volver"})]}),o.jsxs("div",{children:[o.jsxs("h1",{className:`text-xl md:text-2xl font-bold break-words ${a?"text-[#E5E7EB] ironman-glow":"text-gray-900"}`,children:[me==="en_proceso"?"Incidencias En Proceso":"Incidencias Pendientes",pt()]}),o.jsx("p",{className:`text-sm md:text-base mt-1 ${a?"text-[#94A3B8]":"text-gray-600"}`,children:me==="en_proceso"?"Incidencias que estn siendo trabajadas por tcnicos":e?"Asigna tcnicos a las incidencias reportadas":"Incidencias disponibles para auto-asignarse"})]})]})}),o.jsx("div",{className:`px-3 py-2 md:px-4 rounded-lg self-start lg:self-auto ${a?me==="en_proceso"?"bg-cyan-500/10":"bg-orange-500/10":me==="en_proceso"?"bg-blue-50":"bg-yellow-50"}`,children:o.jsxs("span",{className:`font-medium text-sm md:text-base ${a?me==="en_proceso"?"text-[#00E5FF]":"text-[#FF6A00]":me==="en_proceso"?"text-blue-700":"text-yellow-700"}`,children:[c.length," incidencia(s) ",me==="en_proceso"?"en proceso":"pendiente(s)"]})})]}),(e||r||n)&&o.jsx("div",{className:`p-3 md:p-4 rounded-lg shadow ${a?"bg-[#0F172A] border border-cyan-500/20":"bg-white"}`,children:o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Xx,{className:`h-4 w-4 ${a?"text-[#00E5FF]":"text-gray-500"}`}),o.jsx("span",{className:`text-sm font-medium ${a?"text-[#E5E7EB]":"text-gray-700"}`,children:"Filtros:"})]}),o.jsxs("div",{className:"flex flex-col space-y-3 sm:flex-row sm:flex-wrap sm:items-center sm:gap-3 sm:space-y-0",children:[n&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsxs("select",{value:P.coordinador,onChange:ke=>Re("coordinador",ke.target.value),className:`w-full sm:w-auto text-xs sm:text-sm border rounded-md px-2 sm:px-3 py-1 focus:outline-none focus:ring-1 ${a?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,children:[o.jsx("option",{value:"",children:"Todos los coordinadores"}),Se.map(ke=>o.jsx("option",{value:ke.full_name,children:ke.full_name},ke.id))]})}),o.jsx("div",{className:"flex-shrink-0",children:o.jsxs("select",{value:P.fecha,onChange:ke=>Re("fecha",ke.target.value),className:`w-full sm:w-auto text-xs sm:text-sm border rounded-md px-2 sm:px-3 py-1 focus:outline-none focus:ring-1 ${a?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,children:[o.jsx("option",{value:"",children:"Todas las fechas"}),rt.map(ke=>o.jsx("option",{value:ke.value,children:ke.label},ke.value))]})})]}),!n&&o.jsx("div",{className:"flex-shrink-0",children:o.jsxs("select",{value:P.departamento,onChange:ke=>Re("departamento",ke.target.value),className:`w-full sm:w-auto text-xs sm:text-sm border rounded-md px-2 sm:px-3 py-1 focus:outline-none focus:ring-1 ${a?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,children:[o.jsx("option",{value:"",children:"Todas las campaas"}),ve(P.sede).map(ke=>o.jsx("option",{value:ke.value,children:ke.label},ke.value))]})}),e&&o.jsx("div",{className:"flex-shrink-0",children:o.jsxs("select",{value:P.sede,onChange:ke=>Re("sede",ke.target.value),className:`w-full sm:w-auto text-xs sm:text-sm border rounded-md px-2 sm:px-3 py-1 focus:outline-none focus:ring-1 ${a?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,children:[o.jsx("option",{value:"",children:"Todas las sedes"}),De().map(ke=>o.jsx("option",{value:ke.value,children:ke.label},ke.value))]})}),o.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[o.jsx("input",{type:"checkbox",id:"showTop3Only",checked:E,onChange:ke=>W(ke.target.checked),className:`h-4 w-4 border-gray-300 rounded ${a?"text-[#E10600] focus:ring-red-500":"text-red-600 focus:ring-red-500"}`}),o.jsxs("label",{htmlFor:"showTop3Only",className:`flex items-center text-xs sm:text-sm font-medium cursor-pointer ${a?"text-[#E5E7EB]":"text-gray-700"}`,children:[o.jsx(N3,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 text-yellow-500"}),o.jsx("span",{className:"hidden sm:inline",children:"Top 3 con ms retraso"}),o.jsx("span",{className:"sm:hidden",children:"Top 3"})]})]}),(P.departamento||P.sede||P.coordinador||P.fecha||E)&&o.jsxs("button",{onClick:Ke,className:`text-xs sm:text-sm flex items-center space-x-1 px-2 py-1 rounded flex-shrink-0 ${a?"text-[#94A3B8] hover:text-[#E5E7EB] hover:bg-[#0B0F14]":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[o.jsx(gs,{className:"h-3 w-3"}),o.jsx("span",{children:"Limpiar"})]})]}),o.jsxs("div",{className:"flex flex-col space-y-1 sm:flex-row sm:items-center sm:justify-between sm:space-y-0",children:[o.jsxs("div",{className:`text-xs sm:text-sm ${a?"text-[#94A3B8]":"text-gray-500"}`,children:[o.jsx("strong",{children:c.length})," de ",o.jsx("strong",{children:h.length})," incidencia(s)"]}),o.jsxs("div",{className:`text-xs ${a?"text-[#94A3B8]":"text-gray-500"}`,children:[r&&o.jsxs("span",{children:["Visible: ",t?.sede==="bogota"?"Bogot + Barranquilla":t?.sede==="villavicencio"?"Villavicencio + Barranquilla":t?.sede?.toUpperCase()]}),n&&o.jsxs("span",{children:[t?.sede?.toUpperCase()," - ",t?.departamento?.toUpperCase()]})]})]})]})}),c.length===0?o.jsxs("div",{className:`text-center py-12 rounded-lg shadow ${a?"bg-[#0F172A] border border-cyan-500/20":"bg-white"}`,children:[o.jsx(qs,{className:`h-12 w-12 mx-auto mb-4 ${a?"text-[#94A3B8]":"text-gray-400"}`}),o.jsx("h3",{className:`text-lg font-medium mb-2 ${a?"text-[#E5E7EB]":"text-gray-900"}`,children:"No hay incidencias pendientes"}),o.jsx("p",{className:a?"text-[#94A3B8]":"text-gray-500",children:"Todas las incidencias han sido asignadas o estn en proceso."})]}):o.jsx("div",{className:`shadow overflow-hidden sm:rounded-lg ${a?"bg-[#0F172A] border border-cyan-500/20":"bg-white"}`,children:o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsx("div",{className:"space-y-6",children:c.map((ke,$t)=>{const $e=wp(ke.created_at,ke.failure_type),wt=Zx(ke.created_at),Wt=Tv(ke.created_at,ke.failure_type),jt=te===ke.id;return E||H8(ke,L),o.jsxs("div",{className:`
                                        border rounded p-3 sm:p-4 transition-colors relative cursor-pointer
                                        ${jt?"border-blue-500 bg-blue-50 border-2 ring-2 ring-blue-300 ring-opacity-50":$e?`${$e.borderColor} ${$e.bgColor} border-l-4 hover:shadow-md`:a?"border-cyan-500/20 hover:bg-[#0B0F14] hover:shadow-md":"border-gray-200 hover:bg-gray-50 hover:shadow-md"}
                                        ${jt?"animate-pulse":""}
                                    `,onClick:()=>vt(ke),children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Fn,{className:"h-5 w-5 text-blue-600"}),o.jsx("span",{className:`font-bold text-lg ${a?"text-[#E5E7EB]":""}`,children:ke.station_code}),o.jsxs("span",{className:`text-sm px-2 py-1 rounded ${a?"bg-[#0B0F14] text-[#94A3B8]":"bg-gray-100"}`,children:[ke.sede?.toUpperCase()," - ",ke.departamento?.toUpperCase()]}),o.jsx("span",{className:`px-2 py-1 text-sm rounded ${tr(ke.failure_type)}`,children:lt(ke.failure_type)}),ke.is_recently_reassigned&&o.jsx("span",{className:"px-2 py-1 text-sm bg-orange-100 text-orange-800 rounded",children:"Reasignado"}),q[ke.id]>0&&o.jsxs("span",{className:"px-2 py-1 text-sm text-blue-700 bg-blue-100 rounded",children:[" ",q[ke.id]," archivo(s)"]})]}),o.jsxs("div",{className:"flex items-center space-x-3 text-sm text-gray-600",children:[o.jsxs("span",{children:[o.jsx(ia,{className:"h-4 w-4 inline mr-1"}),new Date(ke.created_at).toLocaleDateString()]}),o.jsxs("span",{className:$e?$e.textColor:"text-yellow-600",children:[o.jsx(qs,{className:"h-4 w-4 inline mr-1"}),wt]}),o.jsx("span",{className:$e?$e.textColor:"text-green-600",children:$e?$e.level==="urgent"?"":$e.level==="critical"?"":"":""})]})]}),o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Bn,{className:"h-4 w-4 text-green-600"}),o.jsxs("span",{className:"text-gray-700",children:[o.jsx("strong",{children:"Reportado por:"})," ",ke.reported_by_name]})]}),me==="en_proceso"&&ke.assigned_to_name&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Bn,{className:"h-4 w-4 text-blue-600"}),o.jsxs("span",{className:"text-gray-700",children:[o.jsx("strong",{children:"Tcnico:"})," ",ke.assigned_to_name]})]})]})})]}),o.jsxs("div",{className:`text-sm mt-2 p-2 rounded ${a?"bg-[#0B0F14] text-[#E5E7EB]":"bg-gray-50 text-gray-700"}`,children:[o.jsx("strong",{children:"Descripcin:"})," ",ke.description]}),Wt&&o.jsxs("div",{className:`text-xs p-1 rounded ${$e.bgColor} ${$e.textColor}`,children:[o.jsx(mi,{className:"h-3 w-3 inline mr-1"}),Wt]}),o.jsxs("div",{className:`flex items-center justify-between pt-3 mt-3 border-t ${a?"border-cyan-500/20":"border-gray-200"}`,children:[o.jsx("span",{className:"text-sm text-gray-500",children:" Clic para ver detalles completos"}),o.jsxs("div",{className:"flex space-x-2",children:[me==="pendiente"&&(e||r)&&o.jsx(o.Fragment,{children:e?o.jsxs("button",{onClick:hr=>{hr.stopPropagation(),Yt(ke)},className:`px-3 py-1.5 text-sm font-medium rounded ${a?"bg-[#00E5FF] text-[#0B0F14] hover:bg-[#00B4D8]":"text-white bg-blue-600 hover:bg-blue-700"}`,children:[o.jsx(Vo,{className:"h-3 w-3 mr-1 inline"}),"Asignar"]}):o.jsxs("button",{onClick:hr=>{hr.stopPropagation(),Qt(ke)},className:"px-3 py-1.5 text-sm font-medium rounded text-white bg-green-600 hover:bg-green-700",children:[o.jsx(Vo,{className:"h-3 w-3 mr-1 inline"}),"Tomar"]})}),me==="en_proceso"&&ke.assigned_to_name&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"px-3 py-1.5 text-sm bg-gray-100 rounded",children:ke.assigned_to_name}),e&&o.jsx("button",{onClick:hr=>{hr.stopPropagation(),It(ke)},className:"px-3 py-1.5 text-sm font-medium rounded text-white bg-orange-600 hover:bg-orange-700",children:"Reasignar"})]})]})]})]},ke.id)})})})}),o.jsx(W3,{incident:fe,isOpen:le,onClose:Pt,onAssign:Dt,onSelfAssign:Ot,isAdmin:e,isTechnician:r,technicians:x,selectedTechnician:V,setSelectedTechnician:B,assignLoading:R}),w&&o.jsx("div",{className:`fixed inset-0 overflow-y-auto h-full w-full z-50 ${a?"bg-black bg-opacity-70":"bg-gray-600 bg-opacity-50"}`,children:o.jsx("div",{className:`relative top-20 mx-auto p-5 border w-11/12 max-w-md shadow-lg rounded-md ${a?"bg-[#0F172A] border-cyan-500/30 shadow-cyan-500/20":"bg-white"}`,children:o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center mb-4",children:[o.jsx(Vo,{className:`h-6 w-6 mr-2 ${a?"text-[#00E5FF]":"text-blue-600"}`}),o.jsx("h3",{className:`text-lg font-medium ${a?"text-[#E5E7EB]":"text-gray-900"}`,children:e?"Asignar Tcnico":"Confirmar Auto-asignacin"})]}),o.jsxs("div",{className:`mb-4 p-3 rounded ${a?"bg-[#0B0F14] border border-cyan-500/10":"bg-gray-50"}`,children:[o.jsxs("p",{className:`text-sm ${a?"text-[#94A3B8]":"text-gray-600"}`,children:[o.jsx("strong",{children:"Estacin:"})," ",z?.station_code]}),o.jsxs("p",{className:`text-sm ${a?"text-[#94A3B8]":"text-gray-600"}`,children:[o.jsx("strong",{children:"Sede:"})," ",z?.sede?.toUpperCase()," - ",z?.departamento?.toUpperCase()]}),o.jsxs("p",{className:`text-sm ${a?"text-[#94A3B8]":"text-gray-600"}`,children:[o.jsx("strong",{children:"Tipo:"})," ",lt(z?.failure_type)]}),o.jsxs("p",{className:`text-sm ${a?"text-[#94A3B8]":"text-gray-600"}`,children:[o.jsx("strong",{children:"Descripcin:"})," ",z?.description]})]}),e?o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:`block text-sm font-medium mb-2 ${a?"text-[#E5E7EB]":"text-gray-700"}`,children:"Seleccionar Tcnico *"}),o.jsxs("select",{value:V,onChange:ke=>B(ke.target.value),className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 ${a?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,children:[o.jsx("option",{value:"",children:"Seleccionar tcnico..."}),x.map(ke=>o.jsx("option",{value:ke.id,children:ke.full_name},ke.id))]})]}):o.jsx("div",{className:`mb-4 p-3 rounded ${a?"bg-[#0B0F14] border border-cyan-500/10":"bg-blue-50"}`,children:o.jsxs("p",{className:`text-sm ${a?"text-[#00E5FF]":"text-blue-700"}`,children:[o.jsx("strong",{children:"Te asignars esta incidencia a:"})," ",t.fullName]})}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>S(!1),className:`px-4 py-2 border rounded-md text-sm font-medium ${a?"border-cyan-500/30 text-[#94A3B8] hover:bg-[#0B0F14]":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,disabled:R,children:"Cancelar"}),o.jsx("button",{onClick:lr,disabled:R,className:`px-4 py-2 border border-transparent rounded-md text-sm font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 ${a?"bg-[#00E5FF] text-[#0B0F14] hover:bg-[#00B4D8] focus:ring-cyan-500":"text-white bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"}`,children:R?e?"Asignando...":"Tomando...":e?"Asignar":"Tomar Incidencia"})]})]})})}),k&&o.jsx("div",{className:`fixed inset-0 overflow-y-auto h-full w-full z-50 ${a?"bg-black bg-opacity-70":"bg-gray-600 bg-opacity-50"}`,children:o.jsx("div",{className:`relative top-20 mx-auto p-5 border w-11/12 max-w-md shadow-lg rounded-md ${a?"bg-[#0F172A] border-cyan-500/30 shadow-cyan-500/20":"bg-white"}`,children:o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center mb-4",children:[o.jsx(Vo,{className:`h-6 w-6 mr-2 ${a?"text-[#FF6A00]":"text-orange-600"}`}),o.jsx("h3",{className:`text-lg font-medium ${a?"text-[#E5E7EB]":"text-gray-900"}`,children:"Reasignar Tcnico"})]}),o.jsxs("div",{className:`mb-4 p-3 rounded ${a?"bg-[#0B0F14] border border-cyan-500/10":"bg-gray-50"}`,children:[o.jsxs("p",{className:`text-sm ${a?"text-[#94A3B8]":"text-gray-600"}`,children:[o.jsx("strong",{children:"Estacin:"})," ",z?.station_code]}),o.jsxs("p",{className:`text-sm ${a?"text-[#94A3B8]":"text-gray-600"}`,children:[o.jsx("strong",{children:"Tcnico actual:"})," ",z?.assigned_to_name]}),o.jsxs("p",{className:`text-sm ${a?"text-[#94A3B8]":"text-gray-600"}`,children:[o.jsx("strong",{children:"Tipo:"})," ",lt(z?.failure_type)]}),o.jsxs("p",{className:`text-sm ${a?"text-[#94A3B8]":"text-gray-600"}`,children:[o.jsx("strong",{children:"Descripcin:"})," ",z?.description]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:`block text-sm font-medium mb-2 ${a?"text-[#E5E7EB]":"text-gray-700"}`,children:"Nuevo Tcnico *"}),o.jsxs("select",{value:V,onChange:ke=>B(ke.target.value),className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 ${a?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50":"border-gray-300 focus:ring-orange-500 focus:border-orange-500"}`,children:[o.jsx("option",{value:"",children:"Seleccionar nuevo tcnico..."}),x.filter(ke=>ke.id!==z?.assigned_to_id).map(ke=>o.jsx("option",{value:ke.id,children:ke.full_name},ke.id))]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:`block text-sm font-medium mb-2 ${a?"text-[#E5E7EB]":"text-gray-700"}`,children:"Motivo de la reasignacin (opcional)"}),o.jsx("textarea",{value:ee,onChange:ke=>I(ke.target.value),className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 ${a?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50":"border-gray-300 focus:ring-orange-500 focus:border-orange-500"}`,rows:"3",placeholder:"Ej: Cambio de turno, tcnico no disponible, especializacin requerida..."})]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>A(!1),className:`px-4 py-2 border rounded-md text-sm font-medium ${a?"border-cyan-500/30 text-[#94A3B8] hover:bg-[#0B0F14]":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,disabled:R,children:"Cancelar"}),o.jsx("button",{onClick:bt,disabled:R,className:`px-4 py-2 border border-transparent rounded-md text-sm font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 ${a?"bg-[#FF6A00] text-[#0B0F14] hover:bg-[#E10600] focus:ring-orange-500":"text-white bg-orange-600 hover:bg-orange-700 focus:ring-orange-500"}`,children:R?"Reasignando...":"Reasignar"})]})]})})})]})},eT=()=>{const{user:t,isAdmin:e}=Jr(),[r,n]=Q.useState([]),[s,a]=Q.useState(!0),[i,l]=Q.useState(!1),[c,d]=Q.useState(null),[h,p]=Q.useState(""),[x,m]=Q.useState(!1),[b,y]=Q.useState(!1),[w,S]=Q.useState([]),[k,A]=Q.useState(!1),[z,H]=Q.useState(!1),[V,B]=Q.useState(""),[R,O]=Q.useState(!1);Q.useEffect(()=>{ee()},[]);const ee=async()=>{try{a(!0);const K=await Kt.getMyIncidents();n(K.data)}catch(K){console.error("Error cargando mis incidencias:",K)}finally{a(!1)}},I=K=>{d(K),p(""),l(!0)},P=async()=>{m(!0);try{await Kt.markAsResolved(c.id,h.trim()),l(!1),await ee()}catch(K){console.error("Error marcando como resuelto:",K),alert(K.response?.data?.msg||"Error al marcar como resuelto")}finally{m(!1)}},ae=K=>{d(K),B(""),H(!0)},G=async()=>{if(!V.trim()){alert("Por favor ingresa el motivo de la devolucin");return}O(!0);try{await Kt.returnToCreator(c.id,V.trim()),H(!1),alert("Incidencia devuelta exitosamente al creador"),await ee()}catch(K){console.error("Error devolviendo incidencia:",K),alert(K.response?.data?.msg||"Error al devolver la incidencia")}finally{O(!1)}},M=async K=>{d(K),A(!0),y(!0);try{const E=await Kt.getHistory(K.id);S(E.data)}catch(E){console.error("Error cargando historial:",E),alert("Error al cargar el historial")}finally{A(!1)}},te=K=>{const E={en_proceso:{label:"En Proceso",color:"bg-blue-100 text-blue-800",icon:ho},en_supervision:{label:"En Supervisin",color:"bg-purple-100 text-purple-800",icon:qs},aprobado:{label:"Aprobado",color:"bg-green-100 text-green-800",icon:Ws},rechazado:{label:"Rechazado",color:"bg-red-100 text-red-800",icon:Di},devuelto:{label:"Devuelto",color:"bg-orange-100 text-orange-800",icon:uo}};return E[K]||E.en_proceso},ie=K=>({pantalla:"Pantalla",perifericos:"Perifricos",internet:"Internet",software:"Software",otro:"Otro"})[K]||K,le=K=>{const E={pantalla:"bg-blue-100 text-blue-800",perifericos:"bg-purple-100 text-purple-800",internet:"bg-red-100 text-red-800",software:"bg-green-100 text-green-800",otro:"bg-gray-100 text-gray-800"};return E[K]||E.otro};if(s)return o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});const X=r.filter(K=>K.status==="en_proceso"),fe=r.filter(K=>K.status!=="en_proceso");return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Mis Incidencias"}),o.jsxs("p",{className:"text-gray-600",children:["Incidencias asignadas a ",t?.fullName]})]}),o.jsx("div",{className:"bg-blue-50 px-4 py-2 rounded-lg",children:o.jsxs("span",{className:"text-blue-700 font-medium",children:[r.length," incidencia(s) asignada(s)"]})})]}),r.length===0?o.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow",children:[o.jsx(N2,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes incidencias asignadas"}),o.jsx("p",{className:"text-gray-500",children:"Las nuevas incidencias aparecern aqu cuando sean asignadas por el administrador."})]}):o.jsxs("div",{className:"space-y-6",children:[X.length>0&&o.jsxs("div",{children:[o.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[o.jsx(ho,{className:"h-5 w-5 text-blue-600 mr-2"}),"Para Trabajar (",X.length,")"]}),o.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsx("div",{className:"space-y-1",children:X.map(K=>{const E=te(K.status).icon,W=K.status==="rechazado";return o.jsx("div",{className:`border rounded p-1 sm:p-2 ${W?"border-red-300 bg-red-50":"border-blue-200 bg-blue-50"}`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(Fn,{className:"h-4 w-4 mr-1"}),o.jsx("span",{className:"font-medium",children:K.station_code}),o.jsxs("span",{className:"ml-2 text-xs bg-gray-100 px-2 py-1 rounded",children:[K.sede?.toUpperCase()," - ",K.departamento?.toUpperCase()]})]}),o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${le(K.failure_type)}`,children:ie(K.failure_type)}),K.is_recently_reassigned&&o.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-orange-100 text-orange-800 border border-orange-200",children:[o.jsx(ho,{className:"h-3 w-3 mr-1"}),"Reasignado"]}),o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(Bn,{className:"h-4 w-4 mr-1"}),o.jsxs("span",{children:["Reportado por: ",K.reported_by_name]})]})]}),o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(qn,{className:"h-4 w-4 text-gray-400 mt-0.5 flex-shrink-0"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-gray-900 font-medium",children:K.description}),W&&o.jsxs("div",{className:"mt-2 p-2 bg-red-100 border border-red-300 rounded text-sm text-red-700",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Di,{className:"h-4 w-4 mr-1"}),o.jsx("strong",{children:"Incidencia rechazada"})]}),o.jsx("p",{className:"mt-1",children:"Revisa el historial para ver los comentarios del supervisor."})]})]})]}),o.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(ia,{className:"h-4 w-4 mr-1"}),o.jsxs("span",{children:["Asignado: ",new Date(K.updated_at).toLocaleDateString()]})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx(E,{className:"h-4 w-4 mr-1"}),o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${te(K.status).color}`,children:te(K.status).label})]})]})]}),o.jsxs("div",{className:"ml-4 flex space-x-2",children:[o.jsxs("button",{onClick:()=>M(K),className:"inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[o.jsx(Ec,{className:"h-4 w-4 mr-1"}),"Ver Historial"]}),o.jsxs("button",{onClick:()=>ae(K),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500",children:[o.jsx(uo,{className:"h-4 w-4 mr-1"}),"Devolver Caso"]}),o.jsxs("button",{onClick:()=>I(K),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[o.jsx(Ws,{className:"h-4 w-4 mr-1"}),"Marcar como Resuelto"]})]})]})},K.id)})})})})]}),fe.length>0&&o.jsxs("div",{children:[o.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[o.jsx(qs,{className:"h-5 w-5 text-gray-600 mr-2"}),"Historial (",fe.length,")"]}),o.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsx("div",{className:"space-y-1",children:fe.map(K=>{const E=te(K.status).icon;return o.jsx("div",{className:"border border-gray-200 rounded p-1 sm:p-2",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(Fn,{className:"h-4 w-4 mr-1"}),o.jsx("span",{className:"font-medium",children:K.station_code}),o.jsxs("span",{className:"ml-2 text-xs bg-gray-100 px-2 py-1 rounded",children:[K.sede?.toUpperCase()," - ",K.departamento?.toUpperCase()]})]}),o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${le(K.failure_type)}`,children:ie(K.failure_type)}),K.is_recently_reassigned&&o.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-orange-100 text-orange-800 border border-orange-200",children:[o.jsx(ho,{className:"h-3 w-3 mr-1"}),"Reasignado"]})]}),o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(qn,{className:"h-4 w-4 text-gray-400 mt-0.5 flex-shrink-0"}),o.jsx("p",{className:"text-gray-900 font-medium",children:K.description})]}),o.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(ia,{className:"h-4 w-4 mr-1"}),o.jsxs("span",{children:["Actualizado: ",new Date(K.updated_at).toLocaleDateString()]})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx(E,{className:"h-4 w-4 mr-1"}),o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${te(K.status).color}`,children:te(K.status).label})]})]})]}),o.jsx("div",{className:"ml-4",children:o.jsxs("button",{onClick:()=>M(K),className:"inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[o.jsx(Ec,{className:"h-4 w-4 mr-1"}),"Ver Historial"]})})]})},K.id)})})})})]})]}),i&&o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:o.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center mb-4",children:[o.jsx(Ws,{className:"h-6 w-6 text-green-600 mr-2"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Marcar como Resuelto"})]}),o.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded",children:[o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Estacin:"})," ",c?.station_code]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Sede:"})," ",c?.sede?.toUpperCase()," - ",c?.departamento?.toUpperCase()]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Tipo:"})," ",ie(c?.failure_type)]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Descripcin:"})," ",c?.description]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notas de Resolucin (opcional)"}),o.jsx("textarea",{value:h,onChange:K=>p(K.target.value),rows:4,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Describe brevemente cmo se solucion el problema..."}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Estas notas ayudarn al supervisor a entender la solucin aplicada."})]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",disabled:x,children:"Cancelar"}),o.jsx("button",{onClick:P,disabled:x,className:"px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50",children:x?"Enviando...":"Marcar como Resuelto"})]})]})})}),z&&o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:o.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center mb-4",children:[o.jsx(uo,{className:"h-6 w-6 text-orange-600 mr-2"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Devolver Caso al Creador"})]}),o.jsxs("div",{className:"mb-4 p-3 bg-orange-50 rounded border border-orange-200",children:[o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Estacin:"})," ",c?.station_code]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Sede:"})," ",c?.sede?.toUpperCase()," - ",c?.departamento?.toUpperCase()]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Tipo:"})," ",ie(c?.failure_type)]}),o.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[o.jsx("strong",{children:"Descripcin:"})," ",c?.description]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Motivo de la Devolucin ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("textarea",{value:V,onChange:K=>B(K.target.value),rows:4,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Ej: AnyDesk incorrecto, falta informacin del puesto, descripcin insuficiente...",required:!0}),o.jsx("p",{className:"mt-1 text-sm text-orange-600",children:"Explica qu informacin est incorrecta o falta para poder resolver el caso."})]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>H(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",disabled:R,children:"Cancelar"}),o.jsx("button",{onClick:G,disabled:R||!V.trim(),className:"px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50",children:R?"Devolviendo...":"Devolver Caso"})]})]})})}),b&&o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:o.jsx("div",{className:"relative top-10 mx-auto p-5 border max-w-2xl shadow-lg rounded-md bg-white",children:o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Ec,{className:"h-6 w-6 text-blue-600 mr-2"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Historial de Incidencia"})]}),o.jsx("button",{onClick:()=>y(!1),className:"text-gray-400 hover:text-gray-600",children:o.jsx(Cc,{className:"h-6 w-6"})})]}),o.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded",children:[o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Estacin:"})," ",c?.station_code]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Sede:"})," ",c?.sede?.toUpperCase()," - ",c?.departamento?.toUpperCase()]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Tipo:"})," ",ie(c?.failure_type)]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Descripcin:"})," ",c?.description]}),c?.anydesk_address&&o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"AnyDesk:"})," ",o.jsx("span",{className:"font-mono text-blue-600",children:c.anydesk_address})]}),c?.advisor_cedula&&o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Cdula del Agente:"})," ",o.jsx("span",{className:"font-mono",children:c.advisor_cedula})]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Historial de Acciones:"}),k?o.jsx("div",{className:"flex items-center justify-center py-4",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):w.length===0?o.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No hay historial disponible"}):o.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:w.map((K,E)=>o.jsx("div",{className:"border-l-4 border-blue-200 pl-4",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[K.action.includes("Rechazado")?o.jsx(Cc,{className:"h-4 w-4 text-red-500"}):K.action.includes("Aprobado")?o.jsx(Ws,{className:"h-4 w-4 text-green-500"}):K.action.includes("resuelto")?o.jsx(ho,{className:"h-4 w-4 text-blue-500"}):o.jsx(qu,{className:"h-4 w-4 text-gray-500"}),o.jsx("span",{className:"text-sm font-medium text-gray-900",children:K.action})]}),o.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["Por: ",o.jsx("strong",{children:K.user_name})]}),K.details&&o.jsx("div",{className:`text-sm p-2 rounded mt-2 ${K.action.includes("Rechazado")?"bg-red-50 text-red-700 border border-red-200":"bg-gray-50 text-gray-700"}`,children:K.details}),e&&K.action.includes("Aprobado")&&K.technician_rating&&o.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mt-2",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx(Dc,{className:"h-4 w-4 text-yellow-600"}),o.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Calificacin Recibida"})]}),o.jsx("div",{className:"flex items-center space-x-2 mb-1",children:o.jsx(Xu,{rating:K.technician_rating,readonly:!0,size:"sm"})}),o.jsxs("p",{className:"text-xs text-gray-600",children:["Calificado por: ",o.jsx("strong",{children:K.rated_by_name})]}),K.rating_feedback&&o.jsxs("p",{className:"text-sm text-gray-700 mt-2",children:[o.jsx("strong",{children:"Comentarios:"})," ",K.rating_feedback]})]})]}),o.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[new Date(K.timestamp).toLocaleDateString()," ",o.jsx("br",{}),new Date(K.timestamp).toLocaleTimeString()]})]})},K.id||E))})]}),o.jsx("div",{className:"flex justify-end",children:o.jsx("button",{onClick:()=>y(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cerrar"})})]})})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var qh={};qh.version="0.18.5";var Li=1200,sf=1252,tT=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Fv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},eg=function(t){tT.indexOf(t)!=-1&&(sf=Fv[0]=t)};function rT(){eg(1252)}var po=function(t){Li=t,eg(t)};function tg(){po(1200),rT()}function hx(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function nT(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function V3(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var o0=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?nT(t.slice(2)):e==254&&r==255?V3(t.slice(2)):e==65279?t.slice(1):t},gh=function(e){return String.fromCharCode(e)},T2=function(e){return String.fromCharCode(e)},Br;function sT(t){Br=t,po=function(e){Li=e,eg(e)},o0=function(e){return e.charCodeAt(0)===255&&e.charCodeAt(1)===254?Br.utils.decode(1200,hx(e.slice(2))):e},gh=function(r){return Li===1200?String.fromCharCode(r):Br.utils.decode(Li,[r&255,r>>8])[0]},T2=function(r){return Br.utils.decode(sf,[r])[0]},bN()}var Ru="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Gh(t){for(var e="",r=0,n=0,s=0,a=0,i=0,l=0,c=0,d=0;d<t.length;)r=t.charCodeAt(d++),a=r>>2,n=t.charCodeAt(d++),i=(r&3)<<4|n>>4,s=t.charCodeAt(d++),l=(n&15)<<2|s>>6,c=s&63,isNaN(n)?l=c=64:isNaN(s)&&(c=64),e+=Ru.charAt(a)+Ru.charAt(i)+Ru.charAt(l)+Ru.charAt(c);return e}function Ri(t){var e="",r=0,n=0,s=0,a=0,i=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)a=Ru.indexOf(t.charAt(d++)),i=Ru.indexOf(t.charAt(d++)),r=a<<2|i>>4,e+=String.fromCharCode(r),l=Ru.indexOf(t.charAt(d++)),n=(i&15)<<4|l>>2,l!==64&&(e+=String.fromCharCode(n)),c=Ru.indexOf(t.charAt(d++)),s=(l&3)<<6|c,c!==64&&(e+=String.fromCharCode(s));return e}var Er=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Oc=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Yu(t){return Er?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function A5(t){return Er?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ti=function(e){return Er?Oc(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function _p(t){if(typeof ArrayBuffer>"u")return Ti(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function sd(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function aT(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Pv(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Pv(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var $s=Er?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Oc(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function iT(t){for(var e=[],r=0,n=t.length+250,s=Yu(t.length+255),a=0;a<t.length;++a){var i=t.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var l=t.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|l>>6&15|(i&3)<<4,s[r++]=128|l&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(e.push(s.slice(0,r)),r=0,s=Yu(65535),n=65530)}return e.push(s.slice(0,r)),$s(e)}var Pa=/\u0000/g,vh=/[\u0001-\u0006]/g;function f0(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function qo(t,e){var r=""+t;return r.length>=e?r:ts("0",e-r.length)+r}function Lv(t,e){var r=""+t;return r.length>=e?r:ts(" ",e-r.length)+r}function px(t,e){var r=""+t;return r.length>=e?r:r+ts(" ",e-r.length)}function oT(t,e){var r=""+Math.round(t);return r.length>=e?r:ts("0",e-r.length)+r}function lT(t,e){var r=""+t;return r.length>=e?r:ts("0",e-r.length)+r}var C5=Math.pow(2,32);function Jf(t,e){if(t>C5||t<-C5)return oT(t,e);var r=Math.round(t);return lT(r,e)}function mx(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var T5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],_1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function cT(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ar={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},F5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},uT={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function xx(t,e,r){for(var n=t<0?-1:1,s=t*n,a=0,i=1,l=0,c=1,d=0,h=0,p=Math.floor(s);d<e&&(p=Math.floor(s),l=p*i+a,h=p*d+c,!(s-p<5e-8));)s=1/(s-p),a=i,i=l,c=d,d=h;if(h>e&&(d>e?(h=c,l=a):(h=d,l=i)),!r)return[0,n*l,h];var x=Math.floor(n*l/h);return[x,n*l-x*h,h]}function Iu(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),a=0,i=[],l={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),e&&e.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=xT(c,i))}return l.y=i[0],l.m=i[1],l.d=i[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=a,l}var q3=new Date(1899,11,31,0,0,0),dT=q3.getTime(),fT=new Date(1900,2,1,0,0,0);function G3(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=fT&&(r+=1440*60*1e3),(r-(dT+(t.getTimezoneOffset()-q3.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Dv(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function hT(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function pT(t){var e=t<0?12:11,r=Dv(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function mT(t){var e=Dv(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Xh(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=pT(t):e===10?r=t.toFixed(10).substr(0,12):r=mT(t),Dv(hT(r.toUpperCase()))}function af(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Xh(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ii(14,G3(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function xT(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function gT(t,e,r,n){var s="",a=0,i=0,l=r.y,c,d=0;switch(t){case 98:l=r.y+543;case 121:switch(e.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,d=e.length;break;case 3:return _1[r.m-1][1];case 5:return _1[r.m-1][0];default:return _1[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,d=e.length;break;case 3:return T5[r.q][0];default:return T5[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?qo(r.S,e.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),e==="s"?a===0?"0":""+a/i:(s=qo(a,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:c=l,d=1;break}var h=d>0?qo(c,d):"";return h}function Ou(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var X3=/%/g;function vT(t,e,r){var n=e.replace(X3,""),s=e.length-n.length;return Tc(t,n,r*Math.pow(10,2*s))+ts("%",s)}function yT(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Tc(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Y3(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Y3(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,h){return c+d+h.substr(0,(s+a)%s)+"."+h.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var K3=/# (\?+)( ?)\/( ?)(\d+)/;function bT(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),a=Math.floor(s/n),i=s-a*n,l=n;return r+(a===0?"":""+a)+" "+(i===0?ts(" ",t[1].length+1+t[4].length):Lv(i,t[1].length)+t[2]+"/"+t[3]+qo(l,t[4].length))}function wT(t,e,r){return r+(e===0?"":""+e)+ts(" ",t[1].length+2+t[4].length)}var J3=/^#*0*\.([0#]+)/,Q3=/\).*[0#]/,Z3=/\(###\) ###\\?-####/;function Xa(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function P5(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function L5(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function _T(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function NT(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ao(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Q3)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ao("n",n,r):"("+ao("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return yT(t,e,r);if(e.indexOf("%")!==-1)return vT(t,e,r);if(e.indexOf("E")!==-1)return Y3(e,r);if(e.charCodeAt(0)===36)return"$"+ao(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,l,c=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Jf(c,e.length);if(e.match(/^[#?]+$/))return s=Jf(r,0),s==="0"&&(s=""),s.length>e.length?s:Xa(e.substr(0,e.length-s.length))+s;if(a=e.match(K3))return bT(a,c,d);if(e.match(/^#+0+$/))return d+Jf(c,e.length-e.indexOf("0"));if(a=e.match(J3))return s=P5(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Xa(a[1])).replace(/\.$/,"."+Xa(a[1])).replace(/\.(\d*)$/,function(b,y){return"."+y+ts("0",Xa(a[1]).length-y.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return d+P5(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return d+Ou(Jf(c,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ao(t,e,-r):Ou(""+(Math.floor(r)+_T(r,a[1].length)))+"."+qo(L5(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return ao(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=f0(ao(t,e.replace(/[\\-]/g,""),r)),i=0,f0(f0(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return i<s.length?s.charAt(i++):b==="0"?"0":""}));if(e.match(Z3))return s=ao(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var h="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),l=xx(c,Math.pow(10,i)-1,!1),s=""+d,h=Tc("n",a[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),s+=h+a[2]+"/"+a[3],h=px(l[2],i),h.length<a[4].length&&(h=Xa(a[4].substr(a[4].length-h.length))+h),s+=h,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),l=xx(c,Math.pow(10,i)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Lv(l[1],i)+a[2]+"/"+a[3]+px(l[2],i):ts(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=Jf(r,0),e.length<=s.length?s:Xa(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var p=e.indexOf(".")-i,x=e.length-s.length-p;return Xa(e.substr(0,p)+s+e.substr(e.length-x))}if(a=e.match(/^00,000\.([#0]*0)$/))return i=L5(r,a[1].length),r<0?"-"+ao(t,e,-r):Ou(NT(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?qo(0,3-b.length):"")+b})+"."+qo(i,a[1].length);switch(e){case"###,##0.00":return ao(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Ou(Jf(c,0));return m!=="0"?d+m:"";case"###,###.00":return ao(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ao(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function ST(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Tc(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function kT(t,e,r){var n=e.replace(X3,""),s=e.length-n.length;return Tc(t,n,r*Math.pow(10,2*s))+ts("%",s)}function eN(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+eN(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,h){return c+d+h.substr(0,(s+a)%s)+"."+h.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Sl(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Q3)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Sl("n",n,r):"("+Sl("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return ST(t,e,r);if(e.indexOf("%")!==-1)return kT(t,e,r);if(e.indexOf("E")!==-1)return eN(e,r);if(e.charCodeAt(0)===36)return"$"+Sl(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,l,c=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+qo(c,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:Xa(e.substr(0,e.length-s.length))+s;if(a=e.match(K3))return wT(a,c,d);if(e.match(/^#+0+$/))return d+qo(c,e.length-e.indexOf("0"));if(a=e.match(J3))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Xa(a[1])).replace(/\.$/,"."+Xa(a[1])),s=s.replace(/\.(\d*)$/,function(b,y){return"."+y+ts("0",Xa(a[1]).length-y.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return d+Ou(""+c);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Sl(t,e,-r):Ou(""+r)+"."+ts("0",a[1].length);if(a=e.match(/^#,#*,#0/))return Sl(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=f0(Sl(t,e.replace(/[\\-]/g,""),r)),i=0,f0(f0(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return i<s.length?s.charAt(i++):b==="0"?"0":""}));if(e.match(Z3))return s=Sl(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var h="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),l=xx(c,Math.pow(10,i)-1,!1),s=""+d,h=Tc("n",a[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),s+=h+a[2]+"/"+a[3],h=px(l[2],i),h.length<a[4].length&&(h=Xa(a[4].substr(a[4].length-h.length))+h),s+=h,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),l=xx(c,Math.pow(10,i)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Lv(l[1],i)+a[2]+"/"+a[3]+px(l[2],i):ts(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:Xa(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var p=e.indexOf(".")-i,x=e.length-s.length-p;return Xa(e.substr(0,p)+s+e.substr(e.length-x))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Sl(t,e,-r):Ou(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?qo(0,3-b.length):"")+b})+"."+qo(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=Ou(""+c);return m!=="0"?d+m:"";default:if(e.match(/\.[0#?]*$/))return Sl(t,e.slice(0,e.lastIndexOf(".")),r)+Xa(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Tc(t,e,r){return(r|0)===r?Sl(t,e,r):ao(t,e,r)}function jT(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var tN=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function pf(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":mx(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(tN))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function ET(t,e,r,n){for(var s=[],a="",i=0,l="",c="t",d,h,p,x="H";i<t.length;)switch(l=t.charAt(i)){case"G":if(!mx(t,i))throw new Error("unrecognized character "+l+" in "+t);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(p=t.charCodeAt(++i))!==34&&i<t.length;)a+=String.fromCharCode(p);s[s.length]={t:"t",v:a},++i;break;case"\\":var m=t.charAt(++i),b=m==="("||m===")"?m:"t";s[s.length]={t:b,v:m},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:e},++i;break;case"B":case"b":if(t.charAt(i+1)==="1"||t.charAt(i+1)==="2"){if(d==null&&(d=Iu(e,r,t.charAt(i+1)==="2"),d==null))return"";s[s.length]={t:"X",v:t.substr(i,2)},c=l,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=Iu(e,r),d==null))return"";for(a=l;++i<t.length&&t.charAt(i).toLowerCase()===l;)a+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=x),s[s.length]={t:l,v:a},c=l;break;case"A":case"a":case"":var y={t:l,v:l};if(d==null&&(d=Iu(e,r)),t.substr(i,3).toUpperCase()==="A/P"?(d!=null&&(y.v=d.H>=12?"P":"A"),y.t="T",x="h",i+=3):t.substr(i,5).toUpperCase()==="AM/PM"?(d!=null&&(y.v=d.H>=12?"PM":"AM"),y.t="T",i+=5,x="h"):t.substr(i,5).toUpperCase()==="/"?(d!=null&&(y.v=d.H>=12?"":""),y.t="T",i+=5,x="h"):(y.t="t",++i),d==null&&y.t==="T")return"";s[s.length]=y,c=l;break;case"[":for(a=l;t.charAt(i++)!=="]"&&i<t.length;)a+=t.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(tN)){if(d==null&&(d=Iu(e,r),d==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",pf(t)||(s[s.length]={t:"t",v:a}));break;case".":if(d!=null){for(a=l;++i<t.length&&(l=t.charAt(i))==="0";)a+=l;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++i<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(i))>-1;)a+=l;s[s.length]={t:"n",v:a};break;case"?":for(a=l;t.charAt(++i)===l;)a+=l;s[s.length]={t:l,v:a},c=l;break;case"*":++i,(t.charAt(i)==" "||t.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;i<t.length&&"0123456789".indexOf(t.charAt(++i))>-1;)a+=t.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:l,v:l},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);s[s.length]={t:"t",v:l},++i;break}var w=0,S=0,k;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=x,c="h",w<1&&(w=1);break;case"s":(k=s[i].v.match(/\.0+$/))&&(S=Math.max(S,k[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[i].v.match(/[Hh]/)&&(w=1),w<2&&s[i].v.match(/[Mm]/)&&(w=2),w<3&&s[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var A="",z;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=gT(s[i].t.charCodeAt(0),s[i].v,d,S),s[i].t="t";break;case"n":case"?":for(z=i+1;s[z]!=null&&((l=s[z].t)==="?"||l==="D"||(l===" "||l==="t")&&s[z+1]!=null&&(s[z+1].t==="?"||s[z+1].t==="t"&&s[z+1].v==="/")||s[i].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[z].v==="/"||s[z].v===" "&&s[z+1]!=null&&s[z+1].t=="?"));)s[i].v+=s[z].v,s[z]={v:"",t:";"},++z;A+=s[i].v,i=z-1;break;case"G":s[i].t="t",s[i].v=af(e,r);break}var H="",V,B;if(A.length>0){A.charCodeAt(0)==40?(V=e<0&&A.charCodeAt(0)===45?-e:e,B=Tc("n",A,V)):(V=e<0&&n>1?-e:e,B=Tc("n",A,V),V<0&&s[0]&&s[0].t=="t"&&(B=B.substr(1),s[0].v="-"+s[0].v)),z=B.length-1;var R=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){R=i;break}var O=s.length;if(R===s.length&&B.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(z>=s[i].v.length-1?(z-=s[i].v.length,s[i].v=B.substr(z+1,s[i].v.length)):z<0?s[i].v="":(s[i].v=B.substr(0,z+1),z=-1),s[i].t="t",O=i);z>=0&&O<s.length&&(s[O].v=B.substr(0,z+1)+s[O].v)}else if(R!==s.length&&B.indexOf("E")===-1){for(z=B.indexOf(".")-1,i=R;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(h=s[i].v.indexOf(".")>-1&&i===R?s[i].v.indexOf(".")-1:s[i].v.length-1,H=s[i].v.substr(h+1);h>=0;--h)z>=0&&(s[i].v.charAt(h)==="0"||s[i].v.charAt(h)==="#")&&(H=B.charAt(z--)+H);s[i].v=H,s[i].t="t",O=i}for(z>=0&&O<s.length&&(s[O].v=B.substr(0,z+1)+s[O].v),z=B.indexOf(".")+1,i=R;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==R)){for(h=s[i].v.indexOf(".")>-1&&i===R?s[i].v.indexOf(".")+1:0,H=s[i].v.substr(0,h);h<s[i].v.length;++h)z<B.length&&(H+=B.charAt(z++));s[i].v=H,s[i].t="t",O=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(V=n>1&&e<0&&i>0&&s[i-1].v==="-"?-e:e,s[i].v=Tc(s[i].t,s[i].v,V),s[i].t="t");var ee="";for(i=0;i!==s.length;++i)s[i]!=null&&(ee+=s[i].v);return ee}var D5=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function R5(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function AT(t,e){var r=jT(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(D5),l=r[1].match(D5);return R5(e,i)?[n,r[0]]:R5(e,l)?[n,r[1]]:[n,r[i!=null&&l!=null?2:1]]}return[n,a]}function Ii(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ar)[t],n==null&&(n=r.table&&r.table[F5[t]]||ar[F5[t]]),n==null&&(n=uT[t]||"General");break}if(mx(n,0))return af(e,r);e instanceof Date&&(e=G3(e,r.date1904));var s=AT(n,e);if(mx(s[1]))return af(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return ET(s[1],e,r,s[0])}function Fl(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ar[r]==null){e<0&&(e=r);continue}if(ar[r]==t){e=r;break}}e<0&&(e=391)}return ar[e]=t,e}function Np(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Fl(t[e],e)}function L0(){ar=cT()}var rN={format:Ii,load:Fl,_table:ar,load_table:Np,parse_date_code:Iu,is_date:pf,get_table:function(){return rN._table=ar}},CT={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},nN=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function TT(t){var e=typeof t=="number"?ar[t]:t;return e=e.replace(nN,"(\\d+)"),new RegExp("^"+e+"$")}function FT(t,e,r){var n=-1,s=-1,a=-1,i=-1,l=-1,c=-1;(e.match(nN)||[]).forEach(function(p,x){var m=parseInt(r[x+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=m;break;case"d":a=m;break;case"h":i=m;break;case"s":c=m;break;case"m":i>=0?l=m:s=m;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var h=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&l==-1&&c==-1?d:n==-1&&s==-1&&a==-1?h:d+"T"+h}var PT=(function(){var t={};t.version="1.2.0";function e(){for(var B=0,R=new Array(256),O=0;O!=256;++O)B=O,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,R[O]=B;return typeof Int32Array<"u"?new Int32Array(R):R}var r=e();function n(B){var R=0,O=0,ee=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ee=0;ee!=256;++ee)I[ee]=B[ee];for(ee=0;ee!=256;++ee)for(O=B[ee],R=256+ee;R<4096;R+=256)O=I[R]=O>>>8^B[O&255];var P=[];for(ee=1;ee!=16;++ee)P[ee-1]=typeof Int32Array<"u"?I.subarray(ee*256,ee*256+256):I.slice(ee*256,ee*256+256);return P}var s=n(r),a=s[0],i=s[1],l=s[2],c=s[3],d=s[4],h=s[5],p=s[6],x=s[7],m=s[8],b=s[9],y=s[10],w=s[11],S=s[12],k=s[13],A=s[14];function z(B,R){for(var O=R^-1,ee=0,I=B.length;ee<I;)O=O>>>8^r[(O^B.charCodeAt(ee++))&255];return~O}function H(B,R){for(var O=R^-1,ee=B.length-15,I=0;I<ee;)O=A[B[I++]^O&255]^k[B[I++]^O>>8&255]^S[B[I++]^O>>16&255]^w[B[I++]^O>>>24]^y[B[I++]]^b[B[I++]]^m[B[I++]]^x[B[I++]]^p[B[I++]]^h[B[I++]]^d[B[I++]]^c[B[I++]]^l[B[I++]]^i[B[I++]]^a[B[I++]]^r[B[I++]];for(ee+=15;I<ee;)O=O>>>8^r[(O^B[I++])&255];return~O}function V(B,R){for(var O=R^-1,ee=0,I=B.length,P=0,ae=0;ee<I;)P=B.charCodeAt(ee++),P<128?O=O>>>8^r[(O^P)&255]:P<2048?(O=O>>>8^r[(O^(192|P>>6&31))&255],O=O>>>8^r[(O^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,ae=B.charCodeAt(ee++)&1023,O=O>>>8^r[(O^(240|P>>8&7))&255],O=O>>>8^r[(O^(128|P>>2&63))&255],O=O>>>8^r[(O^(128|ae>>6&15|(P&3)<<4))&255],O=O>>>8^r[(O^(128|ae&63))&255]):(O=O>>>8^r[(O^(224|P>>12&15))&255],O=O>>>8^r[(O^(128|P>>6&63))&255],O=O>>>8^r[(O^(128|P&63))&255]);return~O}return t.table=r,t.bstr=z,t.buf=H,t.str=V,t})(),er=(function(){var e={};e.version="1.2.1";function r(se,ye){for(var pe=se.split("/"),xe=ye.split("/"),be=0,we=0,Ue=Math.min(pe.length,xe.length);be<Ue;++be){if(we=pe[be].length-xe[be].length)return we;if(pe[be]!=xe[be])return pe[be]<xe[be]?-1:1}return pe.length-xe.length}function n(se){if(se.charAt(se.length-1)=="/")return se.slice(0,-1).indexOf("/")===-1?se:n(se.slice(0,-1));var ye=se.lastIndexOf("/");return ye===-1?se:se.slice(0,ye+1)}function s(se){if(se.charAt(se.length-1)=="/")return s(se.slice(0,-1));var ye=se.lastIndexOf("/");return ye===-1?se:se.slice(ye+1)}function a(se,ye){typeof ye=="string"&&(ye=new Date(ye));var pe=ye.getHours();pe=pe<<6|ye.getMinutes(),pe=pe<<5|ye.getSeconds()>>>1,se.write_shift(2,pe);var xe=ye.getFullYear()-1980;xe=xe<<4|ye.getMonth()+1,xe=xe<<5|ye.getDate(),se.write_shift(2,xe)}function i(se){var ye=se.read_shift(2)&65535,pe=se.read_shift(2)&65535,xe=new Date,be=pe&31;pe>>>=5;var we=pe&15;pe>>>=4,xe.setMilliseconds(0),xe.setFullYear(pe+1980),xe.setMonth(we-1),xe.setDate(be);var Ue=ye&31;ye>>>=5;var Je=ye&63;return ye>>>=6,xe.setHours(ye),xe.setMinutes(Je),xe.setSeconds(Ue<<1),xe}function l(se){sa(se,0);for(var ye={},pe=0;se.l<=se.length-4;){var xe=se.read_shift(2),be=se.read_shift(2),we=se.l+be,Ue={};switch(xe){case 21589:pe=se.read_shift(1),pe&1&&(Ue.mtime=se.read_shift(4)),be>5&&(pe&2&&(Ue.atime=se.read_shift(4)),pe&4&&(Ue.ctime=se.read_shift(4))),Ue.mtime&&(Ue.mt=new Date(Ue.mtime*1e3));break}se.l=we,ye[xe]=Ue}return ye}var c;function d(){return c||(c={})}function h(se,ye){if(se[0]==80&&se[1]==75)return Vt(se,ye);if((se[0]|32)==109&&(se[1]|32)==105)return hn(se,ye);if(se.length<512)throw new Error("CFB file size "+se.length+" < 512");var pe=3,xe=512,be=0,we=0,Ue=0,Je=0,Be=0,He=[],qe=se.slice(0,512);sa(qe,0);var ut=p(qe);switch(pe=ut[0],pe){case 3:xe=512;break;case 4:xe=4096;break;case 0:if(ut[1]==0)return Vt(se,ye);default:throw new Error("Major Version: Expected 3 or 4 saw "+pe)}xe!==512&&(qe=se.slice(0,xe),sa(qe,28));var Nt=se.slice(0,xe);x(qe,pe);var Ct=qe.read_shift(4,"i");if(pe===3&&Ct!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ct);qe.l+=4,Ue=qe.read_shift(4,"i"),qe.l+=4,qe.chk("00100000","Mini Stream Cutoff Size: "),Je=qe.read_shift(4,"i"),be=qe.read_shift(4,"i"),Be=qe.read_shift(4,"i"),we=qe.read_shift(4,"i");for(var gt=-1,mt=0;mt<109&&(gt=qe.read_shift(4,"i"),!(gt<0));++mt)He[mt]=gt;var ur=m(se,xe);w(Be,we,ur,xe,He);var Ir=k(ur,Ue,He,xe);Ir[Ue].name="!Directory",be>0&&Je!==ae&&(Ir[Je].name="!MiniFAT"),Ir[He[0]].name="!FAT",Ir.fat_addrs=He,Ir.ssz=xe;var Qr={},_n=[],vi=[],Mi=[];A(Ue,Ir,ur,_n,be,Qr,vi,Je),b(vi,Mi,_n),_n.shift();var Oa={FileIndex:vi,FullPaths:Mi};return ye&&ye.raw&&(Oa.raw={header:Nt,sectors:ur}),Oa}function p(se){if(se[se.l]==80&&se[se.l+1]==75)return[0,0];se.chk(G,"Header Signature: "),se.l+=16;var ye=se.read_shift(2,"u");return[se.read_shift(2,"u"),ye]}function x(se,ye){var pe=9;switch(se.l+=2,pe=se.read_shift(2)){case 9:if(ye!=3)throw new Error("Sector Shift: Expected 9 saw "+pe);break;case 12:if(ye!=4)throw new Error("Sector Shift: Expected 12 saw "+pe);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+pe)}se.chk("0600","Mini Sector Shift: "),se.chk("000000000000","Reserved: ")}function m(se,ye){for(var pe=Math.ceil(se.length/ye)-1,xe=[],be=1;be<pe;++be)xe[be-1]=se.slice(be*ye,(be+1)*ye);return xe[pe-1]=se.slice(pe*ye),xe}function b(se,ye,pe){for(var xe=0,be=0,we=0,Ue=0,Je=0,Be=pe.length,He=[],qe=[];xe<Be;++xe)He[xe]=qe[xe]=xe,ye[xe]=pe[xe];for(;Je<qe.length;++Je)xe=qe[Je],be=se[xe].L,we=se[xe].R,Ue=se[xe].C,He[xe]===xe&&(be!==-1&&He[be]!==be&&(He[xe]=He[be]),we!==-1&&He[we]!==we&&(He[xe]=He[we])),Ue!==-1&&(He[Ue]=xe),be!==-1&&xe!=He[xe]&&(He[be]=He[xe],qe.lastIndexOf(be)<Je&&qe.push(be)),we!==-1&&xe!=He[xe]&&(He[we]=He[xe],qe.lastIndexOf(we)<Je&&qe.push(we));for(xe=1;xe<Be;++xe)He[xe]===xe&&(we!==-1&&He[we]!==we?He[xe]=He[we]:be!==-1&&He[be]!==be&&(He[xe]=He[be]));for(xe=1;xe<Be;++xe)if(se[xe].type!==0){if(Je=xe,Je!=He[Je])do Je=He[Je],ye[xe]=ye[Je]+"/"+ye[xe];while(Je!==0&&He[Je]!==-1&&Je!=He[Je]);He[xe]=-1}for(ye[0]+="/",xe=1;xe<Be;++xe)se[xe].type!==2&&(ye[xe]+="/")}function y(se,ye,pe){for(var xe=se.start,be=se.size,we=[],Ue=xe;pe&&be>0&&Ue>=0;)we.push(ye.slice(Ue*P,Ue*P+P)),be-=P,Ue=$d(pe,Ue*4);return we.length===0?st(0):$s(we).slice(0,se.size)}function w(se,ye,pe,xe,be){var we=ae;if(se===ae){if(ye!==0)throw new Error("DIFAT chain shorter than expected")}else if(se!==-1){var Ue=pe[se],Je=(xe>>>2)-1;if(!Ue)return;for(var Be=0;Be<Je&&(we=$d(Ue,Be*4))!==ae;++Be)be.push(we);w($d(Ue,xe-4),ye-1,pe,xe,be)}}function S(se,ye,pe,xe,be){var we=[],Ue=[];be||(be=[]);var Je=xe-1,Be=0,He=0;for(Be=ye;Be>=0;){be[Be]=!0,we[we.length]=Be,Ue.push(se[Be]);var qe=pe[Math.floor(Be*4/xe)];if(He=Be*4&Je,xe<4+He)throw new Error("FAT boundary crossed: "+Be+" 4 "+xe);if(!se[qe])break;Be=$d(se[qe],He)}return{nodes:we,data:G5([Ue])}}function k(se,ye,pe,xe){var be=se.length,we=[],Ue=[],Je=[],Be=[],He=xe-1,qe=0,ut=0,Nt=0,Ct=0;for(qe=0;qe<be;++qe)if(Je=[],Nt=qe+ye,Nt>=be&&(Nt-=be),!Ue[Nt]){Be=[];var gt=[];for(ut=Nt;ut>=0;){gt[ut]=!0,Ue[ut]=!0,Je[Je.length]=ut,Be.push(se[ut]);var mt=pe[Math.floor(ut*4/xe)];if(Ct=ut*4&He,xe<4+Ct)throw new Error("FAT boundary crossed: "+ut+" 4 "+xe);if(!se[mt]||(ut=$d(se[mt],Ct),gt[ut]))break}we[Nt]={nodes:Je,data:G5([Be])}}return we}function A(se,ye,pe,xe,be,we,Ue,Je){for(var Be=0,He=xe.length?2:0,qe=ye[se].data,ut=0,Nt=0,Ct;ut<qe.length;ut+=128){var gt=qe.slice(ut,ut+128);sa(gt,64),Nt=gt.read_shift(2),Ct=ag(gt,0,Nt-He),xe.push(Ct);var mt={name:Ct,type:gt.read_shift(1),color:gt.read_shift(1),L:gt.read_shift(4,"i"),R:gt.read_shift(4,"i"),C:gt.read_shift(4,"i"),clsid:gt.read_shift(16),state:gt.read_shift(4,"i"),start:0,size:0},ur=gt.read_shift(2)+gt.read_shift(2)+gt.read_shift(2)+gt.read_shift(2);ur!==0&&(mt.ct=z(gt,gt.l-8));var Ir=gt.read_shift(2)+gt.read_shift(2)+gt.read_shift(2)+gt.read_shift(2);Ir!==0&&(mt.mt=z(gt,gt.l-8)),mt.start=gt.read_shift(4,"i"),mt.size=gt.read_shift(4,"i"),mt.size<0&&mt.start<0&&(mt.size=mt.type=0,mt.start=ae,mt.name=""),mt.type===5?(Be=mt.start,be>0&&Be!==ae&&(ye[Be].name="!StreamData")):mt.size>=4096?(mt.storage="fat",ye[mt.start]===void 0&&(ye[mt.start]=S(pe,mt.start,ye.fat_addrs,ye.ssz)),ye[mt.start].name=mt.name,mt.content=ye[mt.start].data.slice(0,mt.size)):(mt.storage="minifat",mt.size<0?mt.size=0:Be!==ae&&mt.start!==ae&&ye[Be]&&(mt.content=y(mt,ye[Be].data,(ye[Je]||{}).data))),mt.content&&sa(mt.content,0),we[Ct]=mt,Ue.push(mt)}}function z(se,ye){return new Date((Hs(se,ye+4)/1e7*Math.pow(2,32)+Hs(se,ye)/1e7-11644473600)*1e3)}function H(se,ye){return d(),h(c.readFileSync(se),ye)}function V(se,ye){var pe=ye&&ye.type;switch(pe||Er&&Buffer.isBuffer(se)&&(pe="buffer"),pe||"base64"){case"file":return H(se,ye);case"base64":return h(Ti(Ri(se)),ye);case"binary":return h(Ti(se),ye)}return h(se,ye)}function B(se,ye){var pe=ye||{},xe=pe.root||"Root Entry";if(se.FullPaths||(se.FullPaths=[]),se.FileIndex||(se.FileIndex=[]),se.FullPaths.length!==se.FileIndex.length)throw new Error("inconsistent CFB structure");se.FullPaths.length===0&&(se.FullPaths[0]=xe+"/",se.FileIndex[0]={name:xe,type:5}),pe.CLSID&&(se.FileIndex[0].clsid=pe.CLSID),R(se)}function R(se){var ye="Sh33tJ5";if(!er.find(se,"/"+ye)){var pe=st(4);pe[0]=55,pe[1]=pe[3]=50,pe[2]=54,se.FileIndex.push({name:ye,type:2,content:pe,size:4,L:69,R:69,C:69}),se.FullPaths.push(se.FullPaths[0]+ye),O(se)}}function O(se,ye){B(se);for(var pe=!1,xe=!1,be=se.FullPaths.length-1;be>=0;--be){var we=se.FileIndex[be];switch(we.type){case 0:xe?pe=!0:(se.FileIndex.pop(),se.FullPaths.pop());break;case 1:case 2:case 5:xe=!0,isNaN(we.R*we.L*we.C)&&(pe=!0),we.R>-1&&we.L>-1&&we.R==we.L&&(pe=!0);break;default:pe=!0;break}}if(!(!pe&&!ye)){var Ue=new Date(1987,1,19),Je=0,Be=Object.create?Object.create(null):{},He=[];for(be=0;be<se.FullPaths.length;++be)Be[se.FullPaths[be]]=!0,se.FileIndex[be].type!==0&&He.push([se.FullPaths[be],se.FileIndex[be]]);for(be=0;be<He.length;++be){var qe=n(He[be][0]);xe=Be[qe],xe||(He.push([qe,{name:s(qe).replace("/",""),type:1,clsid:te,ct:Ue,mt:Ue,content:null}]),Be[qe]=!0)}for(He.sort(function(Ct,gt){return r(Ct[0],gt[0])}),se.FullPaths=[],se.FileIndex=[],be=0;be<He.length;++be)se.FullPaths[be]=He[be][0],se.FileIndex[be]=He[be][1];for(be=0;be<He.length;++be){var ut=se.FileIndex[be],Nt=se.FullPaths[be];if(ut.name=s(Nt).replace("/",""),ut.L=ut.R=ut.C=-(ut.color=1),ut.size=ut.content?ut.content.length:0,ut.start=0,ut.clsid=ut.clsid||te,be===0)ut.C=He.length>1?1:-1,ut.size=0,ut.type=5;else if(Nt.slice(-1)=="/"){for(Je=be+1;Je<He.length&&n(se.FullPaths[Je])!=Nt;++Je);for(ut.C=Je>=He.length?-1:Je,Je=be+1;Je<He.length&&n(se.FullPaths[Je])!=n(Nt);++Je);ut.R=Je>=He.length?-1:Je,ut.type=1}else n(se.FullPaths[be+1]||"")==n(Nt)&&(ut.R=be+1),ut.type=2}}}function ee(se,ye){var pe=ye||{};if(pe.fileType=="mad")return Mt(se,pe);switch(O(se),pe.fileType){case"zip":return Ur(se,pe)}var xe=(function(Ct){for(var gt=0,mt=0,ur=0;ur<Ct.FileIndex.length;++ur){var Ir=Ct.FileIndex[ur];if(Ir.content){var Qr=Ir.content.length;Qr>0&&(Qr<4096?gt+=Qr+63>>6:mt+=Qr+511>>9)}}for(var _n=Ct.FullPaths.length+3>>2,vi=gt+7>>3,Mi=gt+127>>7,Oa=vi+mt+_n+Mi,Xn=Oa+127>>7,Bi=Xn<=109?0:Math.ceil((Xn-109)/127);Oa+Xn+Bi+127>>7>Xn;)Bi=++Xn<=109?0:Math.ceil((Xn-109)/127);var Nn=[1,Bi,Xn,Mi,_n,mt,gt,0];return Ct.FileIndex[0].size=gt<<6,Nn[7]=(Ct.FileIndex[0].start=Nn[0]+Nn[1]+Nn[2]+Nn[3]+Nn[4]+Nn[5])+(Nn[6]+7>>3),Nn})(se),be=st(xe[7]<<9),we=0,Ue=0;{for(we=0;we<8;++we)be.write_shift(1,M[we]);for(we=0;we<8;++we)be.write_shift(2,0);for(be.write_shift(2,62),be.write_shift(2,3),be.write_shift(2,65534),be.write_shift(2,9),be.write_shift(2,6),we=0;we<3;++we)be.write_shift(2,0);for(be.write_shift(4,0),be.write_shift(4,xe[2]),be.write_shift(4,xe[0]+xe[1]+xe[2]+xe[3]-1),be.write_shift(4,0),be.write_shift(4,4096),be.write_shift(4,xe[3]?xe[0]+xe[1]+xe[2]-1:ae),be.write_shift(4,xe[3]),be.write_shift(-4,xe[1]?xe[0]-1:ae),be.write_shift(4,xe[1]),we=0;we<109;++we)be.write_shift(-4,we<xe[2]?xe[1]+we:-1)}if(xe[1])for(Ue=0;Ue<xe[1];++Ue){for(;we<236+Ue*127;++we)be.write_shift(-4,we<xe[2]?xe[1]+we:-1);be.write_shift(-4,Ue===xe[1]-1?ae:Ue+1)}var Je=function(Ct){for(Ue+=Ct;we<Ue-1;++we)be.write_shift(-4,we+1);Ct&&(++we,be.write_shift(-4,ae))};for(Ue=we=0,Ue+=xe[1];we<Ue;++we)be.write_shift(-4,ie.DIFSECT);for(Ue+=xe[2];we<Ue;++we)be.write_shift(-4,ie.FATSECT);Je(xe[3]),Je(xe[4]);for(var Be=0,He=0,qe=se.FileIndex[0];Be<se.FileIndex.length;++Be)qe=se.FileIndex[Be],qe.content&&(He=qe.content.length,!(He<4096)&&(qe.start=Ue,Je(He+511>>9)));for(Je(xe[6]+7>>3);be.l&511;)be.write_shift(-4,ie.ENDOFCHAIN);for(Ue=we=0,Be=0;Be<se.FileIndex.length;++Be)qe=se.FileIndex[Be],qe.content&&(He=qe.content.length,!(!He||He>=4096)&&(qe.start=Ue,Je(He+63>>6)));for(;be.l&511;)be.write_shift(-4,ie.ENDOFCHAIN);for(we=0;we<xe[4]<<2;++we){var ut=se.FullPaths[we];if(!ut||ut.length===0){for(Be=0;Be<17;++Be)be.write_shift(4,0);for(Be=0;Be<3;++Be)be.write_shift(4,-1);for(Be=0;Be<12;++Be)be.write_shift(4,0);continue}qe=se.FileIndex[we],we===0&&(qe.start=qe.size?qe.start-1:ae);var Nt=we===0&&pe.root||qe.name;if(He=2*(Nt.length+1),be.write_shift(64,Nt,"utf16le"),be.write_shift(2,He),be.write_shift(1,qe.type),be.write_shift(1,qe.color),be.write_shift(-4,qe.L),be.write_shift(-4,qe.R),be.write_shift(-4,qe.C),qe.clsid)be.write_shift(16,qe.clsid,"hex");else for(Be=0;Be<4;++Be)be.write_shift(4,0);be.write_shift(4,qe.state||0),be.write_shift(4,0),be.write_shift(4,0),be.write_shift(4,0),be.write_shift(4,0),be.write_shift(4,qe.start),be.write_shift(4,qe.size),be.write_shift(4,0)}for(we=1;we<se.FileIndex.length;++we)if(qe=se.FileIndex[we],qe.size>=4096)if(be.l=qe.start+1<<9,Er&&Buffer.isBuffer(qe.content))qe.content.copy(be,be.l,0,qe.size),be.l+=qe.size+511&-512;else{for(Be=0;Be<qe.size;++Be)be.write_shift(1,qe.content[Be]);for(;Be&511;++Be)be.write_shift(1,0)}for(we=1;we<se.FileIndex.length;++we)if(qe=se.FileIndex[we],qe.size>0&&qe.size<4096)if(Er&&Buffer.isBuffer(qe.content))qe.content.copy(be,be.l,0,qe.size),be.l+=qe.size+63&-64;else{for(Be=0;Be<qe.size;++Be)be.write_shift(1,qe.content[Be]);for(;Be&63;++Be)be.write_shift(1,0)}if(Er)be.l=be.length;else for(;be.l<be.length;)be.write_shift(1,0);return be}function I(se,ye){var pe=se.FullPaths.map(function(Be){return Be.toUpperCase()}),xe=pe.map(function(Be){var He=Be.split("/");return He[He.length-(Be.slice(-1)=="/"?2:1)]}),be=!1;ye.charCodeAt(0)===47?(be=!0,ye=pe[0].slice(0,-1)+ye):be=ye.indexOf("/")!==-1;var we=ye.toUpperCase(),Ue=be===!0?pe.indexOf(we):xe.indexOf(we);if(Ue!==-1)return se.FileIndex[Ue];var Je=!we.match(vh);for(we=we.replace(Pa,""),Je&&(we=we.replace(vh,"!")),Ue=0;Ue<pe.length;++Ue)if((Je?pe[Ue].replace(vh,"!"):pe[Ue]).replace(Pa,"")==we||(Je?xe[Ue].replace(vh,"!"):xe[Ue]).replace(Pa,"")==we)return se.FileIndex[Ue];return null}var P=64,ae=-2,G="d0cf11e0a1b11ae1",M=[208,207,17,224,161,177,26,225],te="00000000000000000000000000000000",ie={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ae,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:te,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function le(se,ye,pe){d();var xe=ee(se,pe);c.writeFileSync(ye,xe)}function X(se){for(var ye=new Array(se.length),pe=0;pe<se.length;++pe)ye[pe]=String.fromCharCode(se[pe]);return ye.join("")}function fe(se,ye){var pe=ee(se,ye);switch(ye&&ye.type||"buffer"){case"file":return d(),c.writeFileSync(ye.filename,pe),pe;case"binary":return typeof pe=="string"?pe:X(pe);case"base64":return Gh(typeof pe=="string"?pe:X(pe));case"buffer":if(Er)return Buffer.isBuffer(pe)?pe:Oc(pe);case"array":return typeof pe=="string"?Ti(pe):pe}return pe}var K;function E(se){try{var ye=se.InflateRaw,pe=new ye;if(pe._processChunk(new Uint8Array([3,0]),pe._finishFlushFlag),pe.bytesRead)K=se;else throw new Error("zlib does not expose bytesRead")}catch(xe){console.error("cannot use native zlib: "+(xe.message||xe))}}function W(se,ye){if(!K)return jt(se,ye);var pe=K.InflateRaw,xe=new pe,be=xe._processChunk(se.slice(se.l),xe._finishFlushFlag);return se.l+=xe.bytesRead,be}function L(se){return K?K.deflateRawSync(se):bt(se)}var F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],he=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function me(se){var ye=(se<<1|se<<11)&139536|(se<<5|se<<15)&558144;return(ye>>16|ye>>8|ye)&255}for(var Z=typeof Uint8Array<"u",Se=Z?new Uint8Array(256):[],We=0;We<256;++We)Se[We]=me(We);function ue(se,ye){var pe=Se[se&255];return ye<=8?pe>>>8-ye:(pe=pe<<8|Se[se>>8&255],ye<=16?pe>>>16-ye:(pe=pe<<8|Se[se>>16&255],pe>>>24-ye))}function nt(se,ye){var pe=ye&7,xe=ye>>>3;return(se[xe]|(pe<=6?0:se[xe+1]<<8))>>>pe&3}function rt(se,ye){var pe=ye&7,xe=ye>>>3;return(se[xe]|(pe<=5?0:se[xe+1]<<8))>>>pe&7}function De(se,ye){var pe=ye&7,xe=ye>>>3;return(se[xe]|(pe<=4?0:se[xe+1]<<8))>>>pe&15}function ve(se,ye){var pe=ye&7,xe=ye>>>3;return(se[xe]|(pe<=3?0:se[xe+1]<<8))>>>pe&31}function Xe(se,ye){var pe=ye&7,xe=ye>>>3;return(se[xe]|(pe<=1?0:se[xe+1]<<8))>>>pe&127}function Re(se,ye,pe){var xe=ye&7,be=ye>>>3,we=(1<<pe)-1,Ue=se[be]>>>xe;return pe<8-xe||(Ue|=se[be+1]<<8-xe,pe<16-xe)||(Ue|=se[be+2]<<16-xe,pe<24-xe)||(Ue|=se[be+3]<<24-xe),Ue&we}function Ke(se,ye,pe){var xe=ye&7,be=ye>>>3;return xe<=5?se[be]|=(pe&7)<<xe:(se[be]|=pe<<xe&255,se[be+1]=(pe&7)>>8-xe),ye+3}function it(se,ye,pe){var xe=ye&7,be=ye>>>3;return pe=(pe&1)<<xe,se[be]|=pe,ye+1}function pt(se,ye,pe){var xe=ye&7,be=ye>>>3;return pe<<=xe,se[be]|=pe&255,pe>>>=8,se[be+1]=pe,ye+8}function vt(se,ye,pe){var xe=ye&7,be=ye>>>3;return pe<<=xe,se[be]|=pe&255,pe>>>=8,se[be+1]=pe&255,se[be+2]=pe>>>8,ye+16}function Pt(se,ye){var pe=se.length,xe=2*pe>ye?2*pe:ye+5,be=0;if(pe>=ye)return se;if(Er){var we=A5(xe);if(se.copy)se.copy(we);else for(;be<se.length;++be)we[be]=se[be];return we}else if(Z){var Ue=new Uint8Array(xe);if(Ue.set)Ue.set(se);else for(;be<pe;++be)Ue[be]=se[be];return Ue}return se.length=xe,se}function Dt(se){for(var ye=new Array(se),pe=0;pe<se;++pe)ye[pe]=0;return ye}function Ot(se,ye,pe){var xe=1,be=0,we=0,Ue=0,Je=0,Be=se.length,He=Z?new Uint16Array(32):Dt(32);for(we=0;we<32;++we)He[we]=0;for(we=Be;we<pe;++we)se[we]=0;Be=se.length;var qe=Z?new Uint16Array(Be):Dt(Be);for(we=0;we<Be;++we)He[be=se[we]]++,xe<be&&(xe=be),qe[we]=0;for(He[0]=0,we=1;we<=xe;++we)He[we+16]=Je=Je+He[we-1]<<1;for(we=0;we<Be;++we)Je=se[we],Je!=0&&(qe[we]=He[Je+16]++);var ut=0;for(we=0;we<Be;++we)if(ut=se[we],ut!=0)for(Je=ue(qe[we],xe)>>xe-ut,Ue=(1<<xe+4-ut)-1;Ue>=0;--Ue)ye[Je|Ue<<ut]=ut&15|we<<4;return xe}var Yt=Z?new Uint16Array(512):Dt(512),lr=Z?new Uint16Array(32):Dt(32);if(!Z){for(var Qt=0;Qt<512;++Qt)Yt[Qt]=0;for(Qt=0;Qt<32;++Qt)lr[Qt]=0}(function(){for(var se=[],ye=0;ye<32;ye++)se.push(5);Ot(se,lr,32);var pe=[];for(ye=0;ye<=143;ye++)pe.push(8);for(;ye<=255;ye++)pe.push(9);for(;ye<=279;ye++)pe.push(7);for(;ye<=287;ye++)pe.push(8);Ot(pe,Yt,288)})();var It=(function(){for(var ye=Z?new Uint8Array(32768):[],pe=0,xe=0;pe<he.length-1;++pe)for(;xe<he[pe+1];++xe)ye[xe]=pe;for(;xe<32768;++xe)ye[xe]=29;var be=Z?new Uint8Array(259):[];for(pe=0,xe=0;pe<q.length-1;++pe)for(;xe<q[pe+1];++xe)be[xe]=pe;function we(Je,Be){for(var He=0;He<Je.length;){var qe=Math.min(65535,Je.length-He),ut=He+qe==Je.length;for(Be.write_shift(1,+ut),Be.write_shift(2,qe),Be.write_shift(2,~qe&65535);qe-- >0;)Be[Be.l++]=Je[He++]}return Be.l}function Ue(Je,Be){for(var He=0,qe=0,ut=Z?new Uint16Array(32768):[];qe<Je.length;){var Nt=Math.min(65535,Je.length-qe);if(Nt<10){for(He=Ke(Be,He,+(qe+Nt==Je.length)),He&7&&(He+=8-(He&7)),Be.l=He/8|0,Be.write_shift(2,Nt),Be.write_shift(2,~Nt&65535);Nt-- >0;)Be[Be.l++]=Je[qe++];He=Be.l*8;continue}He=Ke(Be,He,+(qe+Nt==Je.length)+2);for(var Ct=0;Nt-- >0;){var gt=Je[qe];Ct=(Ct<<5^gt)&32767;var mt=-1,ur=0;if((mt=ut[Ct])&&(mt|=qe&-32768,mt>qe&&(mt-=32768),mt<qe))for(;Je[mt+ur]==Je[qe+ur]&&ur<250;)++ur;if(ur>2){gt=be[ur],gt<=22?He=pt(Be,He,Se[gt+1]>>1)-1:(pt(Be,He,3),He+=5,pt(Be,He,Se[gt-23]>>5),He+=3);var Ir=gt<8?0:gt-4>>2;Ir>0&&(vt(Be,He,ur-q[gt]),He+=Ir),gt=ye[qe-mt],He=pt(Be,He,Se[gt]>>3),He-=3;var Qr=gt<4?0:gt-2>>1;Qr>0&&(vt(Be,He,qe-mt-he[gt]),He+=Qr);for(var _n=0;_n<ur;++_n)ut[Ct]=qe&32767,Ct=(Ct<<5^Je[qe])&32767,++qe;Nt-=ur-1}else gt<=143?gt=gt+48:He=it(Be,He,1),He=pt(Be,He,Se[gt]),ut[Ct]=qe&32767,++qe}He=pt(Be,He,0)-1}return Be.l=(He+7)/8|0,Be.l}return function(Be,He){return Be.length<8?we(Be,He):Ue(Be,He)}})();function bt(se){var ye=st(50+Math.floor(se.length*1.1)),pe=It(se,ye);return ye.slice(0,pe)}var lt=Z?new Uint16Array(32768):Dt(32768),tr=Z?new Uint16Array(32768):Dt(32768),ke=Z?new Uint16Array(128):Dt(128),$t=1,$e=1;function wt(se,ye){var pe=ve(se,ye)+257;ye+=5;var xe=ve(se,ye)+1;ye+=5;var be=De(se,ye)+4;ye+=4;for(var we=0,Ue=Z?new Uint8Array(19):Dt(19),Je=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Be=1,He=Z?new Uint8Array(8):Dt(8),qe=Z?new Uint8Array(8):Dt(8),ut=Ue.length,Nt=0;Nt<be;++Nt)Ue[F[Nt]]=we=rt(se,ye),Be<we&&(Be=we),He[we]++,ye+=3;var Ct=0;for(He[0]=0,Nt=1;Nt<=Be;++Nt)qe[Nt]=Ct=Ct+He[Nt-1]<<1;for(Nt=0;Nt<ut;++Nt)(Ct=Ue[Nt])!=0&&(Je[Nt]=qe[Ct]++);var gt=0;for(Nt=0;Nt<ut;++Nt)if(gt=Ue[Nt],gt!=0){Ct=Se[Je[Nt]]>>8-gt;for(var mt=(1<<7-gt)-1;mt>=0;--mt)ke[Ct|mt<<gt]=gt&7|Nt<<3}var ur=[];for(Be=1;ur.length<pe+xe;)switch(Ct=ke[Xe(se,ye)],ye+=Ct&7,Ct>>>=3){case 16:for(we=3+nt(se,ye),ye+=2,Ct=ur[ur.length-1];we-- >0;)ur.push(Ct);break;case 17:for(we=3+rt(se,ye),ye+=3;we-- >0;)ur.push(0);break;case 18:for(we=11+Xe(se,ye),ye+=7;we-- >0;)ur.push(0);break;default:ur.push(Ct),Be<Ct&&(Be=Ct);break}var Ir=ur.slice(0,pe),Qr=ur.slice(pe);for(Nt=pe;Nt<286;++Nt)Ir[Nt]=0;for(Nt=xe;Nt<30;++Nt)Qr[Nt]=0;return $t=Ot(Ir,lt,286),$e=Ot(Qr,tr,30),ye}function Wt(se,ye){if(se[0]==3&&!(se[1]&3))return[Yu(ye),2];for(var pe=0,xe=0,be=A5(ye||1<<18),we=0,Ue=be.length>>>0,Je=0,Be=0;(xe&1)==0;){if(xe=rt(se,pe),pe+=3,xe>>>1)xe>>1==1?(Je=9,Be=5):(pe=wt(se,pe),Je=$t,Be=$e);else{pe&7&&(pe+=8-(pe&7));var He=se[pe>>>3]|se[(pe>>>3)+1]<<8;if(pe+=32,He>0)for(!ye&&Ue<we+He&&(be=Pt(be,we+He),Ue=be.length);He-- >0;)be[we++]=se[pe>>>3],pe+=8;continue}for(;;){!ye&&Ue<we+32767&&(be=Pt(be,we+32767),Ue=be.length);var qe=Re(se,pe,Je),ut=xe>>>1==1?Yt[qe]:lt[qe];if(pe+=ut&15,ut>>>=4,(ut>>>8&255)===0)be[we++]=ut;else{if(ut==256)break;ut-=257;var Nt=ut<8?0:ut-4>>2;Nt>5&&(Nt=0);var Ct=we+q[ut];Nt>0&&(Ct+=Re(se,pe,Nt),pe+=Nt),qe=Re(se,pe,Be),ut=xe>>>1==1?lr[qe]:tr[qe],pe+=ut&15,ut>>>=4;var gt=ut<4?0:ut-2>>1,mt=he[ut];for(gt>0&&(mt+=Re(se,pe,gt),pe+=gt),!ye&&Ue<Ct&&(be=Pt(be,Ct+100),Ue=be.length);we<Ct;)be[we]=be[we-mt],++we}}}return ye?[be,pe+7>>>3]:[be.slice(0,we),pe+7>>>3]}function jt(se,ye){var pe=se.slice(se.l||0),xe=Wt(pe,ye);return se.l+=xe[1],xe[0]}function hr(se,ye){if(se)typeof console<"u"&&console.error(ye);else throw new Error(ye)}function Vt(se,ye){var pe=se;sa(pe,0);var xe=[],be=[],we={FileIndex:xe,FullPaths:be};B(we,{root:ye.root});for(var Ue=pe.length-4;(pe[Ue]!=80||pe[Ue+1]!=75||pe[Ue+2]!=5||pe[Ue+3]!=6)&&Ue>=0;)--Ue;pe.l=Ue+4,pe.l+=4;var Je=pe.read_shift(2);pe.l+=6;var Be=pe.read_shift(4);for(pe.l=Be,Ue=0;Ue<Je;++Ue){pe.l+=20;var He=pe.read_shift(4),qe=pe.read_shift(4),ut=pe.read_shift(2),Nt=pe.read_shift(2),Ct=pe.read_shift(2);pe.l+=8;var gt=pe.read_shift(4),mt=l(pe.slice(pe.l+ut,pe.l+ut+Nt));pe.l+=ut+Nt+Ct;var ur=pe.l;pe.l=gt+4,Sr(pe,He,qe,we,mt),pe.l=ur}return we}function Sr(se,ye,pe,xe,be){se.l+=2;var we=se.read_shift(2),Ue=se.read_shift(2),Je=i(se);if(we&8257)throw new Error("Unsupported ZIP encryption");for(var Be=se.read_shift(4),He=se.read_shift(4),qe=se.read_shift(4),ut=se.read_shift(2),Nt=se.read_shift(2),Ct="",gt=0;gt<ut;++gt)Ct+=String.fromCharCode(se[se.l++]);if(Nt){var mt=l(se.slice(se.l,se.l+Nt));(mt[21589]||{}).mt&&(Je=mt[21589].mt),((be||{})[21589]||{}).mt&&(Je=be[21589].mt)}se.l+=Nt;var ur=se.slice(se.l,se.l+He);switch(Ue){case 8:ur=W(se,qe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ue)}var Ir=!1;we&8&&(Be=se.read_shift(4),Be==134695760&&(Be=se.read_shift(4),Ir=!0),He=se.read_shift(4),qe=se.read_shift(4)),He!=ye&&hr(Ir,"Bad compressed size: "+ye+" != "+He),qe!=pe&&hr(Ir,"Bad uncompressed size: "+pe+" != "+qe),yn(xe,Ct,ur,{unsafe:!0,mt:Je})}function Ur(se,ye){var pe=ye||{},xe=[],be=[],we=st(1),Ue=pe.compression?8:0,Je=0,Be=0,He=0,qe=0,ut=0,Nt=se.FullPaths[0],Ct=Nt,gt=se.FileIndex[0],mt=[],ur=0;for(Be=1;Be<se.FullPaths.length;++Be)if(Ct=se.FullPaths[Be].slice(Nt.length),gt=se.FileIndex[Be],!(!gt.size||!gt.content||Ct=="Sh33tJ5")){var Ir=qe,Qr=st(Ct.length);for(He=0;He<Ct.length;++He)Qr.write_shift(1,Ct.charCodeAt(He)&127);Qr=Qr.slice(0,Qr.l),mt[ut]=PT.buf(gt.content,0);var _n=gt.content;Ue==8&&(_n=L(_n)),we=st(30),we.write_shift(4,67324752),we.write_shift(2,20),we.write_shift(2,Je),we.write_shift(2,Ue),gt.mt?a(we,gt.mt):we.write_shift(4,0),we.write_shift(-4,mt[ut]),we.write_shift(4,_n.length),we.write_shift(4,gt.content.length),we.write_shift(2,Qr.length),we.write_shift(2,0),qe+=we.length,xe.push(we),qe+=Qr.length,xe.push(Qr),qe+=_n.length,xe.push(_n),we=st(46),we.write_shift(4,33639248),we.write_shift(2,0),we.write_shift(2,20),we.write_shift(2,Je),we.write_shift(2,Ue),we.write_shift(4,0),we.write_shift(-4,mt[ut]),we.write_shift(4,_n.length),we.write_shift(4,gt.content.length),we.write_shift(2,Qr.length),we.write_shift(2,0),we.write_shift(2,0),we.write_shift(2,0),we.write_shift(2,0),we.write_shift(4,0),we.write_shift(4,Ir),ur+=we.l,be.push(we),ur+=Qr.length,be.push(Qr),++ut}return we=st(22),we.write_shift(4,101010256),we.write_shift(2,0),we.write_shift(2,0),we.write_shift(2,ut),we.write_shift(2,ut),we.write_shift(4,ur),we.write_shift(4,qe),we.write_shift(2,0),$s([$s(xe),$s(be),we])}var rr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ut(se,ye){if(se.ctype)return se.ctype;var pe=se.name||"",xe=pe.match(/\.([^\.]+)$/);return xe&&rr[xe[1]]||ye&&(xe=(pe=ye).match(/[\.\\]([^\.\\])+$/),xe&&rr[xe[1]])?rr[xe[1]]:"application/octet-stream"}function cr(se){for(var ye=Gh(se),pe=[],xe=0;xe<ye.length;xe+=76)pe.push(ye.slice(xe,xe+76));return pe.join(`\r
`)+`\r
`}function Te(se){var ye=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(He){var qe=He.charCodeAt(0).toString(16).toUpperCase();return"="+(qe.length==1?"0"+qe:qe)});ye=ye.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ye.charAt(0)==`
`&&(ye="=0D"+ye.slice(1)),ye=ye.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var pe=[],xe=ye.split(`\r
`),be=0;be<xe.length;++be){var we=xe[be];if(we.length==0){pe.push("");continue}for(var Ue=0;Ue<we.length;){var Je=76,Be=we.slice(Ue,Ue+Je);Be.charAt(Je-1)=="="?Je--:Be.charAt(Je-2)=="="?Je-=2:Be.charAt(Je-3)=="="&&(Je-=3),Be=we.slice(Ue,Ue+Je),Ue+=Je,Ue<we.length&&(Be+="="),pe.push(Be)}}return pe.join(`\r
`)}function yt(se){for(var ye=[],pe=0;pe<se.length;++pe){for(var xe=se[pe];pe<=se.length&&xe.charAt(xe.length-1)=="=";)xe=xe.slice(0,xe.length-1)+se[++pe];ye.push(xe)}for(var be=0;be<ye.length;++be)ye[be]=ye[be].replace(/[=][0-9A-Fa-f]{2}/g,function(we){return String.fromCharCode(parseInt(we.slice(1),16))});return Ti(ye.join(`\r
`))}function pr(se,ye,pe){for(var xe="",be="",we="",Ue,Je=0;Je<10;++Je){var Be=ye[Je];if(!Be||Be.match(/^\s*$/))break;var He=Be.match(/^(.*?):\s*([^\s].*)$/);if(He)switch(He[1].toLowerCase()){case"content-location":xe=He[2].trim();break;case"content-type":we=He[2].trim();break;case"content-transfer-encoding":be=He[2].trim();break}}switch(++Je,be.toLowerCase()){case"base64":Ue=Ti(Ri(ye.slice(Je).join("")));break;case"quoted-printable":Ue=yt(ye.slice(Je));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+be)}var qe=yn(se,xe.slice(pe.length),Ue,{unsafe:!0});we&&(qe.ctype=we)}function hn(se,ye){if(X(se.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var pe=ye&&ye.root||"",xe=(Er&&Buffer.isBuffer(se)?se.toString("binary"):X(se)).split(`\r
`),be=0,we="";for(be=0;be<xe.length;++be)if(we=xe[be],!!/^Content-Location:/i.test(we)&&(we=we.slice(we.indexOf("file")),pe||(pe=we.slice(0,we.lastIndexOf("/")+1)),we.slice(0,pe.length)!=pe))for(;pe.length>0&&(pe=pe.slice(0,pe.length-1),pe=pe.slice(0,pe.lastIndexOf("/")+1),we.slice(0,pe.length)!=pe););var Ue=(xe[1]||"").match(/boundary="(.*?)"/);if(!Ue)throw new Error("MAD cannot find boundary");var Je="--"+(Ue[1]||""),Be=[],He=[],qe={FileIndex:Be,FullPaths:He};B(qe);var ut,Nt=0;for(be=0;be<xe.length;++be){var Ct=xe[be];Ct!==Je&&Ct!==Je+"--"||(Nt++&&pr(qe,xe.slice(ut,be),pe),ut=be)}return qe}function Mt(se,ye){var pe=ye||{},xe=pe.boundary||"SheetJS";xe="------="+xe;for(var be=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+xe.slice(2)+'"',"","",""],we=se.FullPaths[0],Ue=we,Je=se.FileIndex[0],Be=1;Be<se.FullPaths.length;++Be)if(Ue=se.FullPaths[Be].slice(we.length),Je=se.FileIndex[Be],!(!Je.size||!Je.content||Ue=="Sh33tJ5")){Ue=Ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ur){return"_x"+ur.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ur){return"_u"+ur.charCodeAt(0).toString(16)+"_"});for(var He=Je.content,qe=Er&&Buffer.isBuffer(He)?He.toString("binary"):X(He),ut=0,Nt=Math.min(1024,qe.length),Ct=0,gt=0;gt<=Nt;++gt)(Ct=qe.charCodeAt(gt))>=32&&Ct<128&&++ut;var mt=ut>=Nt*4/5;be.push(xe),be.push("Content-Location: "+(pe.root||"file:///C:/SheetJS/")+Ue),be.push("Content-Transfer-Encoding: "+(mt?"quoted-printable":"base64")),be.push("Content-Type: "+Ut(Je,Ue)),be.push(""),be.push(mt?Te(qe):cr(qe))}return be.push(xe+`--\r
`),be.join(`\r
`)}function Un(se){var ye={};return B(ye,se),ye}function yn(se,ye,pe,xe){var be=xe&&xe.unsafe;be||B(se);var we=!be&&er.find(se,ye);if(!we){var Ue=se.FullPaths[0];ye.slice(0,Ue.length)==Ue?Ue=ye:(Ue.slice(-1)!="/"&&(Ue+="/"),Ue=(Ue+ye).replace("//","/")),we={name:s(ye),type:2},se.FileIndex.push(we),se.FullPaths.push(Ue),be||er.utils.cfb_gc(se)}return we.content=pe,we.size=pe?pe.length:0,xe&&(xe.CLSID&&(we.clsid=xe.CLSID),xe.mt&&(we.mt=xe.mt),xe.ct&&(we.ct=xe.ct)),we}function zn(se,ye){B(se);var pe=er.find(se,ye);if(pe){for(var xe=0;xe<se.FileIndex.length;++xe)if(se.FileIndex[xe]==pe)return se.FileIndex.splice(xe,1),se.FullPaths.splice(xe,1),!0}return!1}function pn(se,ye,pe){B(se);var xe=er.find(se,ye);if(xe){for(var be=0;be<se.FileIndex.length;++be)if(se.FileIndex[be]==xe)return se.FileIndex[be].name=s(pe),se.FullPaths[be]=pe,!0}return!1}function mn(se){O(se,!0)}return e.find=I,e.read=V,e.parse=h,e.write=fe,e.writeFile=le,e.utils={cfb_new:Un,cfb_add:yn,cfb_del:zn,cfb_mov:pn,cfb_gc:mn,ReadShift:kh,CheckField:wN,prep_blob:sa,bconcat:$s,use_zlib:E,_deflateRaw:bt,_inflateRaw:jt,consts:ie},e})();let Mu;function LT(t){Mu=t}function DT(t){return typeof t=="string"?_p(t):Array.isArray(t)?aT(t):t}function Sp(t,e,r){if(typeof Mu<"u"&&Mu.writeFileSync)return r?Mu.writeFileSync(t,e,r):Mu.writeFileSync(t,e);if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=_p(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Cl(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var s=new Blob([DT(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:t,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=t,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=sd(e)),l.write(e),l.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function RT(t){if(typeof Mu<"u")return Mu.readFileSync(t);if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function as(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function I5(t,e){for(var r=[],n=as(t),s=0;s!==n.length;++s)r[t[n[s]][e]]==null&&(r[t[n[s]][e]]=n[s]);return r}function rg(t){for(var e=[],r=as(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function ng(t){for(var e=[],r=as(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function IT(t){for(var e=[],r=as(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var gx=new Date(1899,11,30,0,0,0);function Fs(t,e){var r=t.getTime(),n=gx.getTime()+(t.getTimezoneOffset()-gx.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var sN=new Date,OT=gx.getTime()+(sN.getTimezoneOffset()-gx.getTimezoneOffset())*6e4,O5=sN.getTimezoneOffset();function sg(t){var e=new Date;return e.setTime(t*24*60*60*1e3+OT),e.getTimezoneOffset()!==O5&&e.setTime(e.getTime()+(e.getTimezoneOffset()-O5)*6e4),e}function MT(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[a],10)}return e}var M5=new Date("2017-02-19T19:06:09.000Z"),aN=isNaN(M5.getFullYear())?new Date("2/19/17"):M5,BT=aN.getFullYear()==2017;function Dn(t,e){var r=new Date(t);if(BT)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(aN.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function of(t,e){if(Er&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Cl(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Cl(V3(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Cl(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Cl(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function vn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=vn(t[r]));return e}function ts(t,e){for(var r="";r.length<e;)r+=t;return r}function Yo(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var UT=["january","february","march","april","may","june","july","august","september","october","november","december"];function N0(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var i=t.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&UT.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var zT=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],l=1;l<a.length;++l)i.push(s),i.push(a[l]);return i}})();function iN(t){return t?t.content&&t.type?of(t.content,!0):t.data?o0(t.data):t.asNodeBuffer&&Er?o0(t.asNodeBuffer().toString("binary")):t.asBinary?o0(t.asBinary()):t._data&&t._data.getContent?o0(of(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function oN(t){if(!t)return null;if(t.data)return hx(t.data);if(t.asNodeBuffer&&Er)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?hx(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function HT(t){return t&&t.name.slice(-4)===".bin"?oN(t):iN(t)}function lo(t,e){for(var r=t.FullPaths||as(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return t.files?t.files[r[a]]:t.FileIndex[a]}return null}function Rv(t,e){var r=lo(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function _s(t,e,r){if(!r)return HT(Rv(t,e));if(!e)return null;try{return _s(t,e)}catch{return null}}function Fi(t,e,r){if(!r)return iN(Rv(t,e));if(!e)return null;try{return Fi(t,e)}catch{return null}}function $T(t,e,r){return oN(Rv(t,e))}function B5(t){for(var e=t.FullPaths||as(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function kr(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Er?n=Oc(r):n=iT(r),er.utils.cfb_add(t,e,n)}er.utils.cfb_add(t,e,r)}else t.file(e,r)}function Iv(){return er.utils.cfb_new()}function lN(t,e){switch(e.type){case"base64":return er.read(t,{type:"base64"});case"binary":return er.read(t,{type:"binary"});case"buffer":case"array":return er.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function yh(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var vs=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,WT=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,U5=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,VT=/<[^>]*>/g,Ia=vs.match(U5)?U5:VT,qT=/<\w*:/,GT=/<(\/?)\w+:/;function xr(t,e,r){for(var n={},s=0,a=0;s!==t.length&&!((a=t.charCodeAt(s))===32||a===10||a===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var i=t.match(WT),l=0,c="",d=0,h="",p="",x=1;if(i)for(d=0;d!=i.length;++d){for(p=i[d],a=0;a!=p.length&&p.charCodeAt(a)!==61;++a);for(h=p.slice(0,a).trim();p.charCodeAt(a+1)==32;)++a;for(x=(s=p.charCodeAt(a+1))==34||s==39?1:0,c=p.slice(a+1+x,p.length-x),l=0;l!=h.length&&h.charCodeAt(l)!==58;++l);if(l===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=c,n[h.toLowerCase()]=c;else{var m=(l===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(l+1);if(n[m]&&h.slice(l-3,l)=="ext")continue;n[m]=c,n[m.toLowerCase()]=c}}return n}function Ol(t){return t.replace(GT,"<$1")}var cN={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ov=rg(cN),Wr=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(t,function(l,c){return cN[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(e,function(l,c){return String.fromCharCode(parseInt(c,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}})(),Mv=/[&<>'"]/g,XT=/[\u0000-\u0008\u000b-\u001f]/g;function un(t){var e=t+"";return e.replace(Mv,function(r){return Ov[r]}).replace(XT,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function z5(t){return un(t).replace(/ /g,"_x0020_")}var uN=/[\u0000-\u001f]/g;function Bv(t){var e=t+"";return e.replace(Mv,function(r){return Ov[r]}).replace(/\n/g,"<br/>").replace(uN,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function YT(t){var e=t+"";return e.replace(Mv,function(r){return Ov[r]}).replace(uN,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var H5=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function KT(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Cn(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function N1(t){for(var e="",r=0,n=0,s=0,a=0,i=0,l=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,e+=String.fromCharCode(i);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=t.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,e+=String.fromCharCode(55296+(l>>>10&1023)),e+=String.fromCharCode(56320+(l&1023))}return e}function $5(t){var e=Yu(2*t.length),r,n,s=1,a=0,i=0,l;for(n=0;n<t.length;n+=s)s=1,(l=t.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(t.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(e[a++]=i&255,e[a++]=i>>>8,i=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function W5(t){return Oc(t,"binary").toString("utf8")}var bm="foo bar baz",fn=Er&&(W5(bm)==N1(bm)&&W5||$5(bm)==N1(bm)&&$5)||N1,Cl=Er?function(t){return Oc(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Yh=(function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),dN=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}})(),JT=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),QT=/<\/?(?:vt:)?variant>/g,ZT=/<(?:vt:)([^>]*)>([\s\S]*)</;function V5(t,e){var r=xr(t),n=t.match(JT(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(QT,"").match(ZT);i&&s.push({v:fn(i[2]),t:i[1]})}),s}var fN=/(^\s|\s$|\n)/;function aa(t,e){return"<"+t+(e.match(fN)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Kh(t){return as(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function St(t,e,r){return"<"+t+(r!=null?Kh(r):"")+(e!=null?(e.match(fN)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function F2(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function eF(t,e){switch(typeof t){case"string":var r=St("vt:lpwstr",un(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return St((t|0)==t?"vt:i4":"vt:r8",un(String(t)));case"boolean":return St("vt:bool",t?"true":"false")}if(t instanceof Date)return St("vt:filetime",F2(t));throw new Error("Unable to serialize "+t)}function Uv(t){if(Er&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return fn(sd(Pv(t)));throw new Error("Bad input format: expected Buffer or string")}var Jh=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Cs={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},mf=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ci={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function tF(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,a=5;a>=0;--a)s=s*256+t[e+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function rF(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,a=0,i=n?-e:e;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(e)?26985:0);for(var l=0;l<=5;++l,a/=256)t[r+l]=a&255;t[r+6]=(s&15)<<4|a&15,t[r+7]=s>>4|n}var q5=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,a=t[0][n].length;s<a;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},G5=Er?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Oc(e)})):q5(t)}:q5,X5=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(Nc(t,s)));return n.join("").replace(Pa,"")},ag=Er?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Pa,""):X5(t,e,r)}:X5,Y5=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},hN=Er?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Y5(t,e,r)}:Y5,K5=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(s0(t,s)));return n.join("")},D0=Er?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):K5(e,r,n)}:K5,pN=function(t,e){var r=Hs(t,e);return r>0?D0(t,e+4,e+4+r-1):""},zv=pN,mN=function(t,e){var r=Hs(t,e);return r>0?D0(t,e+4,e+4+r-1):""},Hv=mN,xN=function(t,e){var r=2*Hs(t,e);return r>0?D0(t,e+4,e+4+r-1):""},$v=xN,gN=function(e,r){var n=Hs(e,r);return n>0?ag(e,r+4,r+4+n):""},Wv=gN,vN=function(t,e){var r=Hs(t,e);return r>0?D0(t,e+4,e+4+r):""},Vv=vN,yN=function(t,e){return tF(t,e)},vx=yN,qv=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Er&&(zv=function(e,r){if(!Buffer.isBuffer(e))return pN(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Hv=function(e,r){if(!Buffer.isBuffer(e))return mN(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},$v=function(e,r){if(!Buffer.isBuffer(e))return xN(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Wv=function(e,r){if(!Buffer.isBuffer(e))return gN(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Vv=function(e,r){if(!Buffer.isBuffer(e))return vN(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},vx=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):yN(e,r)},qv=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function bN(){ag=function(t,e,r){return Br.utils.decode(1200,t.slice(e,r)).replace(Pa,"")},D0=function(t,e,r){return Br.utils.decode(65001,t.slice(e,r))},zv=function(t,e){var r=Hs(t,e);return r>0?Br.utils.decode(sf,t.slice(e+4,e+4+r-1)):""},Hv=function(t,e){var r=Hs(t,e);return r>0?Br.utils.decode(Li,t.slice(e+4,e+4+r-1)):""},$v=function(t,e){var r=2*Hs(t,e);return r>0?Br.utils.decode(1200,t.slice(e+4,e+4+r-1)):""},Wv=function(t,e){var r=Hs(t,e);return r>0?Br.utils.decode(1200,t.slice(e+4,e+4+r)):""},Vv=function(t,e){var r=Hs(t,e);return r>0?Br.utils.decode(65001,t.slice(e+4,e+4+r)):""}}typeof Br<"u"&&bN();var s0=function(t,e){return t[e]},Nc=function(t,e){return t[e+1]*256+t[e]},nF=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Hs=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},$d=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},sF=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function kh(t,e){var r="",n,s,a=[],i,l,c,d;switch(e){case"dbcs":if(d=this.l,Er&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(Nc(this,d)),d+=2;t*=2;break;case"utf8":r=D0(this,this.l,this.l+t);break;case"utf16le":t*=2,r=ag(this,this.l,this.l+t);break;case"wstr":if(typeof Br<"u")r=Br.utils.decode(Li,this.slice(this.l,this.l+2*t));else return kh.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":r=zv(this,this.l),t=4+Hs(this,this.l);break;case"lpstr-cp":r=Hv(this,this.l),t=4+Hs(this,this.l);break;case"lpwstr":r=$v(this,this.l),t=4+2*Hs(this,this.l);break;case"lpp4":t=4+Hs(this,this.l),r=Wv(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Hs(this,this.l),r=Vv(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(i=s0(this,this.l+t++))!==0;)a.push(gh(i));r=a.join("");break;case"_wstr":for(t=0,r="";(i=Nc(this,this.l+t))!==0;)a.push(gh(i)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return i=s0(this,d),this.l=d+1,l=kh.call(this,t-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(gh(Nc(this,d))),d+=2}r=a.join(""),t*=2;break;case"cpstr":if(typeof Br<"u"){r=Br.utils.decode(Li,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(r="",d=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return i=s0(this,d),this.l=d+1,l=kh.call(this,t-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(gh(s0(this,d))),d+=1}r=a.join("");break;default:switch(t){case 1:return n=s0(this,this.l),this.l++,n;case 2:return n=(e==="i"?nF:Nc)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?$d:sF)(this,this.l),this.l+=4,n):(s=Hs(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=vx(this,this.l):s=vx([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=hN(this,this.l,t);break}}return this.l+=t,r}var aF=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},iF=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},oF=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function lF(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)oF(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){if(typeof Br<"u"&&sf==874)for(s=0;s!=e.length;++s){var a=Br.utils.encode(sf,e.charAt(s));this[this.l+s]=a[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var l=e.charCodeAt(s);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,aF(this,e,this.l);break;case 8:if(n=8,r==="f"){rF(this,e,this.l);break}case 16:break;case-4:n=4,iF(this,e,this.l);break}return this.l+=n,this}function wN(t,e){var r=hN(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function sa(t,e){t.l=e,t.read_shift=kh,t.chk=wN,t.write_shift=lF}function Da(t,e){t.l+=e}function st(t){var e=Yu(t);return sa(e,0),e}function Mc(t,e,r){if(t){var n,s,a;sa(t,t.l||0);for(var i=t.length,l=0,c=0;t.l<i;){l=t.read_shift(1),l&128&&(l=(l&127)+((t.read_shift(1)&127)<<7));var d=np[l]||np[65535];for(n=t.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=t.read_shift(1))&127)<<7*s;c=t.l+a;var h=d.f&&d.f(t,a,r);if(t.l=c,e(h,d,l))return}}}function xi(){var t=[],e=Er?256:2048,r=function(d){var h=st(d);return sa(h,0),h},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(d){return n&&d<n.length-n.l?n:(s(),n=r(Math.max(d+1,e)))},i=function(){return s(),$s(t)},l=function(d){s(),n=d,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:l,end:i,_bufs:t}}function ct(t,e,r,n){var s=+e,a;if(!isNaN(s)){n||(n=np[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=t.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&qv(r)&&t.push(r)}}function jh(t,e,r){var n=vn(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function J5(t,e,r){var n=vn(t);return n.s=jh(n.s,e.s,r),n.e=jh(n.e,e.s,r),n}function Eh(t,e){if(t.cRel&&t.c<0)for(t=vn(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=vn(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=fr(t);return!t.cRel&&t.cRel!=null&&(r=dF(r)),!t.rRel&&t.rRel!=null&&(r=cF(r)),r}function S1(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Pn(t.s.c)+":"+(t.e.cRel?"":"$")+Pn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+ns(t.s.r)+":"+(t.e.rRel?"":"$")+ns(t.e.r):Eh(t.s,e.biff)+":"+Eh(t.e,e.biff)}function Gv(t){return parseInt(uF(t),10)-1}function ns(t){return""+(t+1)}function cF(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function uF(t){return t.replace(/\$(\d+)$/,"$1")}function Xv(t){for(var e=fF(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Pn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function dF(t){return t.replace(/^([A-Z])/,"$$$1")}function fF(t){return t.replace(/^\$([A-Z])/,"$1")}function hF(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Gn(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function fr(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Ka(t){var e=t.indexOf(":");return e==-1?{s:Gn(t),e:Gn(t)}:{s:Gn(t.slice(0,e)),e:Gn(t.slice(e+1))}}function Nr(t,e){return typeof e>"u"||typeof e=="number"?Nr(t.s,t.e):(typeof t!="string"&&(t=fr(t)),typeof e!="string"&&(e=fr(e)),t==e?t:t+":"+e)}function Dr(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=t.length;for(r=0;n<a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===a||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function Q5(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Ii(t.z,r?Fs(e):e)}catch{}try{return t.w=Ii((t.XF||{}).numFmtId||(r?14:0),r?Fs(e):e)}catch{return""+e}}function Il(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Bc[t.v]||t.v:e==null?Q5(t,t.v):Q5(t,e))}function ad(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function _N(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,a=t||(s?[]:{}),i=0,l=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Gn(n.origin):n.origin;i=c.r,l=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var h=Dr(a["!ref"]);d.s.c=h.s.c,d.s.r=h.s.r,d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),i==-1&&(d.e.r=i=h.e.r+1)}for(var p=0;p!=e.length;++p)if(e[p]){if(!Array.isArray(e[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=e[p].length;++x)if(!(typeof e[p][x]>"u")){var m={v:e[p][x]},b=i+p,y=l+x;if(d.s.r>b&&(d.s.r=b),d.s.c>y&&(d.s.c=y),d.e.r<b&&(d.e.r=b),d.e.c<y&&(d.e.c=y),e[p][x]&&typeof e[p][x]=="object"&&!Array.isArray(e[p][x])&&!(e[p][x]instanceof Date))m=e[p][x];else if(Array.isArray(m.v)&&(m.f=e[p][x][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||ar[14],n.cellDates?(m.t="d",m.w=Ii(m.z,Fs(m.v))):(m.t="n",m.v=Fs(m.v),m.w=Ii(m.z,m.v))):m.t="s";if(s)a[b]||(a[b]=[]),a[b][y]&&a[b][y].z&&(m.z=a[b][y].z),a[b][y]=m;else{var w=fr({c:y,r:b});a[w]&&a[w].z&&(m.z=a[w].z),a[w]=m}}}return d.s.c<1e7&&(a["!ref"]=Nr(d)),a}function R0(t,e){return _N(null,t,e)}function pF(t){return t.read_shift(4,"i")}function Ko(t,e){return e||(e=st(4)),e.write_shift(4,t),e}function La(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Vs(t,e){var r=!1;return e==null&&(r=!0,e=st(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function mF(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function xF(t,e){return e||(e=st(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Yv(t,e){var r=t.l,n=t.read_shift(1),s=La(t),a=[],i={t:s,h:s};if((n&1)!==0){for(var l=t.read_shift(4),c=0;c!=l;++c)a.push(mF(t));i.r=a}else i.r=[{ich:0,ifnt:0}];return t.l=r+e,i}function gF(t,e){var r=!1;return e==null&&(r=!0,e=st(15+4*t.t.length)),e.write_shift(1,0),Vs(t.t,e),r?e.slice(0,e.l):e}var vF=Yv;function yF(t,e){var r=!1;return e==null&&(r=!0,e=st(23+4*t.t.length)),e.write_shift(1,1),Vs(t.t,e),e.write_shift(4,1),xF({},e),r?e.slice(0,e.l):e}function go(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function xf(t,e){return e==null&&(e=st(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function gf(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function vf(t,e){return e==null&&(e=st(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var bF=La,NN=Vs;function Kv(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function yx(t,e){var r=!1;return e==null&&(r=!0,e=st(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var wF=La,P2=Kv,Jv=yx;function Qv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?vx([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):$d(e,0)>>2;return r?s/100:s}function SN(t,e){e==null&&(e=st(4));var r=0,n=0,s=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function kN(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function _F(t,e){return e||(e=st(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var yf=kN,I0=_F;function Ca(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function lf(t,e){return(e||st(8)).write_shift(8,t,"f")}function NF(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),a=t.read_shift(2,"i"),i=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var d=Kd[s];d&&(e.rgb=Zh(d));break;case 2:e.rgb=Zh([i,l,c]);break;case 3:e.theme=s;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function bx(t,e){if(e||(e=st(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function SF(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function kF(t,e){e||(e=st(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function jN(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function jF(t){return jN(t,1)}function EF(t){return jN(t,2)}var Zv=2,di=3,wm=11,Z5=12,wx=19,_m=64,AF=65,CF=71,TF=4108,FF=4126,Us=80,EN=81,PF=[Us,EN],L2={1:{n:"CodePage",t:Zv},2:{n:"Category",t:Us},3:{n:"PresentationFormat",t:Us},4:{n:"ByteCount",t:di},5:{n:"LineCount",t:di},6:{n:"ParagraphCount",t:di},7:{n:"SlideCount",t:di},8:{n:"NoteCount",t:di},9:{n:"HiddenCount",t:di},10:{n:"MultimediaClipCount",t:di},11:{n:"ScaleCrop",t:wm},12:{n:"HeadingPairs",t:TF},13:{n:"TitlesOfParts",t:FF},14:{n:"Manager",t:Us},15:{n:"Company",t:Us},16:{n:"LinksUpToDate",t:wm},17:{n:"CharacterCount",t:di},19:{n:"SharedDoc",t:wm},22:{n:"HyperlinksChanged",t:wm},23:{n:"AppVersion",t:di,p:"version"},24:{n:"DigSig",t:AF},26:{n:"ContentType",t:Us},27:{n:"ContentStatus",t:Us},28:{n:"Language",t:Us},29:{n:"Version",t:Us},255:{},2147483648:{n:"Locale",t:wx},2147483651:{n:"Behavior",t:wx},1919054434:{}},D2={1:{n:"CodePage",t:Zv},2:{n:"Title",t:Us},3:{n:"Subject",t:Us},4:{n:"Author",t:Us},5:{n:"Keywords",t:Us},6:{n:"Comments",t:Us},7:{n:"Template",t:Us},8:{n:"LastAuthor",t:Us},9:{n:"RevNumber",t:Us},10:{n:"EditTime",t:_m},11:{n:"LastPrinted",t:_m},12:{n:"CreatedDate",t:_m},13:{n:"ModifiedDate",t:_m},14:{n:"PageCount",t:di},15:{n:"WordCount",t:di},16:{n:"CharCount",t:di},17:{n:"Thumbnail",t:CF},18:{n:"Application",t:Us},19:{n:"DocSecurity",t:di},255:{},2147483648:{n:"Locale",t:wx},2147483651:{n:"Behavior",t:wx},1919054434:{}},ew={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},LF=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function DF(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var RF=DF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Kd=vn(RF),Bc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},AN={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},R2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Nm={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ey(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function IF(t){var e=ey();if(!t||!t.match)return e;var r={};if((t.match(Ia)||[]).forEach(function(n){var s=xr(n);switch(s[0].replace(qT,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[R2[s.ContentType]]!==void 0&&e[R2[s.ContentType]].push(s.PartName);break}}),e.xmlns!==Cs.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function CN(t,e){var r=IT(R2),n=[],s;n[n.length]=vs,n[n.length]=St("Types",null,{xmlns:Cs.CT,"xmlns:xsd":Cs.xsd,"xmlns:xsi":Cs.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return St("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){t[c]&&t[c].length>0&&(s=t[c][0],n[n.length]=St("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Nm[c][e.bookType]||Nm[c].xlsx}))},i=function(c){(t[c]||[]).forEach(function(d){n[n.length]=St("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Nm[c][e.bookType]||Nm[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(d){n[n.length]=St("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),i("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Tr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Qh(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Ah(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Ia)||[]).forEach(function(s){var a=xr(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var l=a.TargetMode==="External"?a.Target:yh(a.Target,e);r[l]=i,n[a.Id]=i}}),r["!id"]=n,r}function h0(t){var e=[vs,St("Relationships",null,{xmlns:Cs.RELS})];return as(t["!id"]).forEach(function(r){e[e.length]=St("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function ln(t,e,r,n,s,a){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=n,s.Target=r,[Tr.HLINK,Tr.XPATH,Tr.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}var OF="application/vnd.oasis.opendocument.spreadsheet";function MF(t,e){for(var r=Uv(t),n,s;n=Jh.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=xr(n[0],!1),s.path=="/"&&s.type!==OF)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function BF(t){var e=[vs];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function tw(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function UF(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function zF(t){var e=[vs];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(tw(t[r][0],t[r][1])),e.push(UF("",t[r][0]));return e.push(tw("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function TN(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+qh.version+"</meta:generator></office:meta></office:document-meta>"}var xo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],HF=(function(){for(var t=new Array(xo.length),e=0;e<xo.length;++e){var r=xo[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function FN(t){var e={};t=fn(t);for(var r=0;r<xo.length;++r){var n=xo[r],s=t.match(HF[r]);s!=null&&s.length>0&&(e[n[1]]=Wr(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Dn(e[n[1]]))}return e}function k1(t,e,r,n,s){s[t]!=null||e==null||e===""||(s[t]=e,e=un(e),n[n.length]=r?St(t,e,r):aa(t,e))}function PN(t,e){var r=e||{},n=[vs,St("cp:coreProperties",null,{"xmlns:cp":Cs.CORE_PROPS,"xmlns:dc":Cs.dc,"xmlns:dcterms":Cs.dcterms,"xmlns:dcmitype":Cs.dcmitype,"xmlns:xsi":Cs.xsi})],s={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&k1("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:F2(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),t.ModifiedDate!=null&&k1("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:F2(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=xo.length;++a){var i=xo[a],l=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:t?t[i[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&k1(i[0],l,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Jd=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],LN=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function DN(t,e,r,n){var s=[];if(typeof t=="string")s=V5(t,n);else for(var a=0;a<t.length;++a)s=s.concat(t[a].map(function(h){return{v:h}}));var i=typeof e=="string"?V5(e,n).map(function(h){return h.v}):e,l=0,c=0;if(i.length>0)for(var d=0;d!==s.length;d+=2){switch(c=+s[d+1].v,s[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(l,l+c);break}l+=c}}function $F(t,e,r){var n={};return e||(e={}),t=fn(t),Jd.forEach(function(s){var a=(t.match(Yh(s[0]))||[])[1];switch(s[2]){case"string":a&&(e[s[1]]=Wr(a));break;case"bool":e[s[1]]=a==="true";break;case"raw":var i=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&DN(n.HeadingPairs,n.TitlesOfParts,e,r),e}function RN(t){var e=[],r=St;return t||(t={}),t.Application="SheetJS",e[e.length]=vs,e[e.length]=St("Properties",null,{xmlns:Cs.EXT_PROPS,"xmlns:vt":Cs.vt}),Jd.forEach(function(n){if(t[n[1]]!==void 0){var s;switch(n[2]){case"string":s=un(String(t[n[1]]));break;case"bool":s=t[n[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(n[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+un(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var WF=/<[^>]+>[^<]*/g;function VF(t,e){var r={},n="",s=t.match(WF);if(s)for(var a=0;a!=s.length;++a){var i=s[a],l=xr(i);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Wr(l.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),d=c[0].slice(4),h=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Wr(h);break;case"bool":r[n]=Cn(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=Dn(h);break;case"cy":case"error":r[n]=Wr(h);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",i,d,c)}}else if(i.slice(0,2)!=="</"){if(e.WTF)throw new Error(i)}}}return r}function IN(t){var e=[vs,St("Properties",null,{xmlns:Cs.CUST_PROPS,"xmlns:vt":Cs.vt})];if(!t)return e.join("");var r=1;return as(t).forEach(function(s){++r,e[e.length]=St("property",eF(t[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:un(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var I2={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},j1;function qF(t,e,r){j1||(j1=rg(I2)),e=j1[e]||e,t[e]=r}function GF(t,e){var r=[];return as(I2).map(function(n){for(var s=0;s<xo.length;++s)if(xo[s][1]==n)return xo[s];for(s=0;s<Jd.length;++s)if(Jd[s][1]==n)return Jd[s];throw n}).forEach(function(n){if(t[n[1]]!=null){var s=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(aa(I2[n[1]]||n[1],s))}}),St("DocumentProperties",r.join(""),{xmlns:Ci.o})}function XF(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return t&&as(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)){for(var i=0;i<xo.length;++i)if(a==xo[i][1])return;for(i=0;i<Jd.length;++i)if(a==Jd[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var l=t[a],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(St(z5(a),l,{"dt:dt":c}))}}),e&&as(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)&&!(t&&Object.prototype.hasOwnProperty.call(t,a))){var i=e[a],l="string";typeof i=="number"?(l="float",i=String(i)):i===!0||i===!1?(l="boolean",i=i?"1":"0"):i instanceof Date?(l="dateTime.tz",i=i.toISOString()):i=String(i),s.push(St(z5(a),i,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Ci.o+'">'+s.join("")+"</"+n+">"}function ty(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function YF(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=st(8);return i.write_shift(4,n),i.write_shift(4,s),i}function ON(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function MN(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function BN(t,e,r){return e===31?MN(t):ON(t,e,r)}function O2(t,e,r){return BN(t,e,r===!1?0:4)}function KF(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return BN(t,e,0)}function JF(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Pa,""),t.l-s&2&&(t.l+=2)}return r}function QF(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Pa,"");return r}function ZF(t){var e=t.l,r=_x(t,EN);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=_x(t,di);return[r,n]}function e7(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(ZF(t));return r}function rw(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var a=t.read_shift(4),i=t.read_shift(4);n[a]=t.read_shift(i,e===1200?"utf16le":"utf8").replace(Pa,"").replace(vh,"!"),e===1200&&i%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function UN(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function t7(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function _x(t,e,r){var n=t.read_shift(2),s,a=r||{};if(t.l+=2,e!==Z5&&n!==e&&PF.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===Z5?n:e){case 2:return s=t.read_shift(2,"i"),a.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return ON(t,n,4).replace(Pa,"");case 31:return MN(t);case 64:return ty(t);case 65:return UN(t);case 71:return t7(t);case 80:return O2(t,n,!a.raw).replace(Pa,"");case 81:return KF(t,n).replace(Pa,"");case 4108:return e7(t);case 4126:case 4127:return n==4127?JF(t):QF(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function nw(t,e){var r=st(4),n=st(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=st(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=YF(e);break;case 31:case 80:for(n=st(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return $s([r,n])}function sw(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0,l=0,c=-1,d={};for(i=0;i!=s;++i){var h=t.read_shift(4),p=t.read_shift(4);a[i]=[h,p+r]}a.sort(function(k,A){return k[1]-A[1]});var x={};for(i=0;i!=s;++i){if(t.l!==a[i][1]){var m=!0;if(i>0&&e)switch(e[a[i-1][0]].t){case 2:t.l+2===a[i][1]&&(t.l+=2,m=!1);break;case 80:t.l<=a[i][1]&&(t.l=a[i][1],m=!1);break;case 4108:t.l<=a[i][1]&&(t.l=a[i][1],m=!1);break}if((!e||i==0)&&t.l<=a[i][1]&&(m=!1,t.l=a[i][1]),m)throw new Error("Read Error: Expected address "+a[i][1]+" at "+t.l+" :"+i)}if(e){var b=e[a[i][0]];if(x[b.n]=_x(t,b.t,{raw:!0}),b.p==="version"&&(x[b.n]=String(x[b.n]>>16)+"."+("0000"+String(x[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(x[b.n]){case 0:x[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:po(l=x[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[b.n])}}else if(a[i][0]===1){if(l=x.CodePage=_x(t,Zv),po(l),c!==-1){var y=t.l;t.l=a[c][1],d=rw(t,l),t.l=y}}else if(a[i][0]===0){if(l===0){c=i,t.l=a[i+1][1];continue}d=rw(t,l)}else{var w=d[a[i][0]],S;switch(t[t.l]){case 65:t.l+=4,S=UN(t);break;case 30:t.l+=4,S=O2(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,S=O2(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,S=t.read_shift(4,"i");break;case 19:t.l+=4,S=t.read_shift(4);break;case 5:t.l+=4,S=t.read_shift(8,"f");break;case 11:t.l+=4,S=ds(t,4);break;case 64:t.l+=4,S=Dn(ty(t));break;default:throw new Error("unparsed value: "+t[t.l])}x[w]=S}}return t.l=r+n,x}var zN=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function r7(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function aw(t,e,r){var n=st(8),s=[],a=[],i=8,l=0,c=st(8),d=st(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),a.push(c),s.push(d),i+=8+c.length,!e){d=st(8),d.write_shift(4,0),s.unshift(d);var h=[st(4)];for(h[0].write_shift(4,t.length),l=0;l<t.length;++l){var p=t[l][0];for(c=st(8+2*(p.length+1)+(p.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,p.length+1),c.write_shift(0,p,"dbcs");c.l!=c.length;)c.write_shift(1,0);h.push(c)}c=$s(h),a.unshift(c),i+=8+c.length}for(l=0;l<t.length;++l)if(!(e&&!e[t[l][0]])&&!(zN.indexOf(t[l][0])>-1||LN.indexOf(t[l][0])>-1)&&t[l][1]!=null){var x=t[l][1],m=0;if(e){m=+e[t[l][0]];var b=r[m];if(b.p=="version"&&typeof x=="string"){var y=x.split(".");x=(+y[0]<<16)+(+y[1]||0)}c=nw(b.t,x)}else{var w=r7(x);w==-1&&(w=31,x=String(x)),c=nw(w,x)}a.push(c),d=st(8),d.write_shift(4,e?m:2+l),s.push(d),i+=8+c.length}var S=8*(a.length+1);for(l=0;l<a.length;++l)s[l].write_shift(4,S),S+=a[l].length;return n.write_shift(4,i),n.write_shift(4,a.length),$s([n].concat(s).concat(a))}function iw(t,e,r){var n=t.content;if(!n)return{};sa(n,0);var s,a,i,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),h=n.read_shift(16);if(h!==er.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),l=n.read_shift(4),s===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);s===2&&(i=n.read_shift(16),c=n.read_shift(4));var p=sw(n,e),x={SystemIdentifier:d};for(var m in p)x[m]=p[m];if(x.FMTID=a,s===1)return x;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var b;try{b=sw(n,null)}catch{}for(m in b)x[m]=b[m];return x.FMTID=[a,i],x}function ow(t,e,r,n,s,a){var i=st(s?68:48),l=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,er.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,e,"hex"),i.write_shift(4,s?68:48);var c=aw(t,r,n);if(l.push(c),s){var d=aw(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),l.push(d)}return $s(l)}function Cu(t,e){return t.read_shift(e),null}function n7(t,e){e||(e=st(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function s7(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function ds(t,e){return t.read_shift(e)===1}function Ya(t,e){return e||(e=st(2)),e.write_shift(2,+!!t),e}function Ns(t){return t.read_shift(2,"u")}function co(t,e){return e||(e=st(2)),e.write_shift(2,t),e}function HN(t,e){return s7(t,e,Ns)}function a7(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function $N(t,e,r){return r||(r=st(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function kp(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont",a=Li;if(r&&r.biff>=8&&(Li=1200),!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var l=n?t.read_shift(n,s):"";return Li=a,l}function i7(t){var e=Li;Li=1200;var r=t.read_shift(2),n=t.read_shift(1),s=n&4,a=n&8,i=1+(n&1),l=0,c,d={};a&&(l=t.read_shift(2)),s&&(c=t.read_shift(4));var h=i==2?"dbcs-cont":"sbcs-cont",p=r===0?"":t.read_shift(r,h);return a&&(t.l+=4*l),s&&(t.l+=c),d.t=p,a||(d.raw="<t>"+d.t+"</t>",d.r=d.t),Li=e,d}function o7(t){var e=t.t||"",r=st(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=st(2*e.length);n.write_shift(2*e.length,e,"utf16le");var s=[r,n];return $s(s)}function cf(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function jp(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):cf(t,n,r)}function bf(t,e,r){if(r.biff>5)return jp(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function WN(t,e,r){return r||(r=st(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function l7(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function c7(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Pa,"");return n&&(t.l+=24),s}function u7(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=t.read_shift(a>>1,"utf16le").replace(Pa,"");return r+i}function d7(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return c7(t);case"0303000000000000c000000000000046":return u7(t);default:throw new Error("Unsupported Moniker "+r)}}function Sm(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Pa,""):"";return r}function lw(t,e){e||(e=st(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function f7(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var a,i,l,c,d="",h,p;s&16&&(a=Sm(t,r-t.l)),s&128&&(i=Sm(t,r-t.l)),(s&257)===257&&(l=Sm(t,r-t.l)),(s&257)===1&&(c=d7(t,r-t.l)),s&8&&(d=Sm(t,r-t.l)),s&32&&(h=t.read_shift(16)),s&64&&(p=ty(t)),t.l=r;var x=i||l||c||"";x&&d&&(x+="#"+d),x||(x="#"+d),s&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var m={Target:x};return h&&(m.guid=h),p&&(m.time=p),a&&(m.Tooltip=a),m}function h7(t){var e=st(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}e.write_shift(4,2),e.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)e.write_shift(4,i[r]);if(a==28)n=n.slice(1),lw(n,e);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)e.write_shift(1,parseInt(i[r],16));var l=s>-1?n.slice(0,s):n;for(e.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)e.write_shift(2,l.charCodeAt(r));e.write_shift(2,0),a&8&&lw(s>-1?n.slice(s+1):"",e)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)e.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function VN(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function qN(t,e){var r=VN(t);return r[3]=0,r}function Ml(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function uf(t,e,r,n){return n||(n=st(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function p7(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function m7(t,e,r){return e===0?"":bf(t,e,r)}function x7(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),a=t.read_shift(n,"i"),i=t.read_shift(n,"i");return[s,a,i]}function GN(t){var e=t.read_shift(2),r=Qv(t);return[e,r]}function g7(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=kp(t,e,r),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,s}function ig(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function XN(t,e){return e||(e=st(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function YN(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var v7=YN;function KN(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function y7(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function b7(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function va(t){t.l+=2,t.l+=t.read_shift(2)}var w7={0:va,4:va,5:va,6:va,7:b7,8:va,9:va,10:va,11:va,12:va,13:y7,14:va,15:va,16:va,17:va,18:va,19:va,20:va,21:KN};function _7(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(w7[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function km(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function ry(t,e,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=st(s);return a.write_shift(2,n),a.write_shift(2,e),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function N7(t,e){return e===0||t.read_shift(2),1200}function S7(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=bf(t,0,r);return t.read_shift(e+n-t.l),s}function k7(t,e){var r=!e||e.biff==8,n=st(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function j7(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function E7(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=kp(t,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function A7(t,e){var r=!e||e.biff>=8?2:1,n=st(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function C7(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0;i!=s&&t.l<r;++i)a.push(i7(t));return a.Count=n,a.Unique=s,a}function T7(t,e){var r=st(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],s=0;s<t.length;++s)n[s]=o7(t[s]);var a=$s([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function F7(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function P7(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function L7(t){var e=p7(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function D7(t){return t.read_shift(2),t.read_shift(4)}function cw(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function R7(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:l,Selected:c,TabRatio:d}}function I7(){var t=st(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function O7(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function M7(t){var e=st(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function B7(){}function U7(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=kp(t,0,r),n}function z7(t,e){var r=t.name||"Arial",n=e&&e.biff==5,s=n?15+r.length:16+2*r.length,a=st(s);return a.write_shift(2,t.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function H7(t){var e=Ml(t);return e.isst=t.read_shift(4),e}function $7(t,e,r,n){var s=st(10);return uf(t,e,n,s),s.write_shift(4,r),s}function W7(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=Ml(t);r.biff==2&&t.l++;var a=jp(t,n-t.l,r);return s.val=a,s}function V7(t,e,r,n,s){var a=!s||s.biff==8,i=st(8+ +a+(1+a)*r.length);return uf(t,e,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function q7(t,e,r){var n=t.read_shift(2),s=bf(t,0,r);return[n,s]}function G7(t,e,r,n){var s=r&&r.biff==5;n||(n=st(s?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(s?1:2,e.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var X7=bf;function uw(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,a=t.read_shift(s),i=t.read_shift(s),l=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:a,c:l},e:{r:i,c}}}function Y7(t,e){var r=e.biff==8||!e.biff?4:2,n=st(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function K7(t){var e=t.read_shift(2),r=t.read_shift(2),n=GN(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function J7(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(GN(t));if(t.l!==r)throw new Error("MulRK read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function Q7(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function Z7(t,e,r,n){var s={},a=t.read_shift(4),i=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(2);return s.patternType=LF[l>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function eP(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=Z7(t,e,n.fStyle,r),n}function dw(t,e,r,n){var s=r&&r.biff==5;n||(n=st(s?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var a=0;return t.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function tP(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function rP(t){var e=st(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function fw(t,e,r){var n=Ml(t);(r.biff==2||e==9)&&++t.l;var s=a7(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function nP(t,e,r,n,s,a){var i=st(8);return uf(t,e,n,i),$N(r,a,i),i}function sP(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ml(t),s=Ca(t);return n.val=s,n}function aP(t,e,r,n){var s=st(14);return uf(t,e,n,s),lf(r,s),s}var hw=m7;function iP(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=cf(t,a),l=[];n>t.l;)l.push(jp(t));return[a,s,i,l]}function pw(t,e,r){var n=t.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=g7(t,e-2,r)),a.body=s||t.read_shift(e-2),typeof s=="string"&&(a.Name=s),a}var oP=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function mw(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(1),i=t.read_shift(1),l=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=cf(t,i,r);s&32&&(d=oP[d.charCodeAt(0)]);var h=n-t.l;r&&r.biff==2&&--h;var p=n==t.l||l===0||!(h>0)?[]:_I(t,h,r,l);return{chKey:a,Name:d,itab:c,rgce:p}}function JN(t,e,r){if(r.biff<8)return lP(t,e,r);for(var n=[],s=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(x7(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function lP(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=kp(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function cP(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),a=cf(t,n,r),i=cf(t,s,r);return[a,i]}function uP(t,e,r){var n=YN(t);t.l++;var s=t.read_shift(1);return e-=8,[NI(t,e,r),s,n]}function xw(t,e,r){var n=v7(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,bI(t,e,r)]}function dP(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function fP(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),l=bf(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},l,i,a]}}function hP(t,e,r){return fP(t,e,r)}function pP(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(ig(t));return r}function mP(t){var e=st(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)XN(t[r],e);return e}function xP(t,e,r){if(r&&r.biff<8)return vP(t,e,r);var n=KN(t),s=_7(t,e-22,n[1]);return{cmo:n,ft:s}}var gP={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function vP(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var i=[];return i.push((gP[n]||Da)(t,e,r)),{cmo:[s,n,a],ft:i}}function yP(t,e,r){var n=t.l,s="";try{t.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:i=l7(t,6,r);var l=t.read_shift(2);t.read_shift(2),Ns(t,2);var c=t.read_shift(2);t.l+=c;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var h=t[t.l],p=cf(t,t.lens[d+1]-t.lens[d]-1);if(s+=p,s.length>=(h?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function bP(t,e){var r=ig(t);t.l+=16;var n=f7(t,e-24);return[r,n]}function wP(t){var e=st(24),r=Gn(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(n[s],16));return $s([e,h7(t[1])])}function _P(t,e){t.read_shift(2);var r=ig(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Pa,""),[r,n]}function NP(t){var e=t[1].Tooltip,r=st(10+2*(e.length+1));r.write_shift(2,2048);var n=Gn(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function SP(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=ew[r]||r,r=t.read_shift(2),e[1]=ew[r]||r,e}function kP(t){return t||(t=st(4)),t.write_shift(2,1),t.write_shift(2,1),t}function jP(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(qN(t));return r}function EP(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(qN(t));return r}function AP(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function QN(t,e,r){if(!r.cellStyles)return Da(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),a=t.read_shift(n),i=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var d={s,e:a,w:i,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function CP(t,e){var r=st(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function TP(t,e){var r={};return e<32||(t.l+=16,r.header=Ca(t),r.footer=Ca(t),t.l+=2),r}function FP(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}function PP(t){for(var e=st(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var LP=Ml,DP=HN,RP=jp;function IP(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function OP(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ml(t);++t.l;var s=bf(t,e-7,r);return n.t="str",n.val=s,n}function MP(t){var e=Ml(t);++t.l;var r=Ca(t);return e.t="n",e.val=r,e}function BP(t,e,r){var n=st(15);return Tp(n,t,e),n.write_shift(8,r,"f"),n}function UP(t){var e=Ml(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function zP(t,e,r){var n=st(9);return Tp(n,t,e),n.write_shift(2,r),n}function HP(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function $P(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function WP(t,e,r){var n=t.l+e,s=Ml(t),a=t.read_shift(2),i=cf(t,a,r);return t.l=n,s.t="str",s.val=i,s}var VP=[2,3,48,49,131,139,140,245],M2=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=rg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var d=[],h=Yu(1);switch(c.type){case"base64":h=Ti(Ri(l));break;case"binary":h=Ti(l);break;case"buffer":case"array":h=l;break}sa(h,0);var p=h.read_shift(1),x=!!(p&136),m=!1,b=!1;switch(p){case 2:break;case 3:break;case 48:m=!0,x=!0;break;case 49:m=!0,x=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var y=0,w=521;p==2&&(y=h.read_shift(2)),h.l+=3,p!=2&&(y=h.read_shift(4)),y>1048576&&(y=1e6),p!=2&&(w=h.read_shift(2));var S=h.read_shift(2),k=c.codepage||1252;p!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(k=t[h[h.l]]),h.l+=1,h.l+=2),b&&(h.l+=36);for(var A=[],z={},H=Math.min(h.length,p==2?521:w-10-(m?264:0)),V=b?32:11;h.l<H&&h[h.l]!=13;)switch(z={},z.name=Br.utils.decode(k,h.slice(h.l,h.l+V)).replace(/[\u0000\r\n].*$/g,""),h.l+=V,z.type=String.fromCharCode(h.read_shift(1)),p!=2&&!b&&(z.offset=h.read_shift(4)),z.len=h.read_shift(1),p==2&&(z.offset=h.read_shift(2)),z.dec=h.read_shift(1),z.name.length&&A.push(z),p!=2&&(h.l+=b?13:14),z.type){case"B":(!m||z.len!=8)&&c.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+z.type)}if(h[h.l]!==13&&(h.l=w-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=w;var B=0,R=0;for(d[0]=[],R=0;R!=A.length;++R)d[0][R]=A[R].name;for(;y-- >0;){if(h[h.l]===42){h.l+=S;continue}for(++h.l,d[++B]=[],R=0,R=0;R!=A.length;++R){var O=h.slice(h.l,h.l+A[R].len);h.l+=A[R].len,sa(O,0);var ee=Br.utils.decode(k,O);switch(A[R].type){case"C":ee.trim().length&&(d[B][R]=ee.replace(/\s+$/,""));break;case"D":ee.length===8?d[B][R]=new Date(+ee.slice(0,4),+ee.slice(4,6)-1,+ee.slice(6,8)):d[B][R]=ee;break;case"F":d[B][R]=parseFloat(ee.trim());break;case"+":case"I":d[B][R]=b?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(ee.trim().toUpperCase()){case"Y":case"T":d[B][R]=!0;break;case"N":case"F":d[B][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ee+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));d[B][R]="##MEMO##"+(b?parseInt(ee.trim(),10):O.read_shift(4));break;case"N":ee=ee.replace(/\u0000/g,"").trim(),ee&&ee!="."&&(d[B][R]=+ee||0);break;case"@":d[B][R]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":d[B][R]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":d[B][R]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[B][R]=-O.read_shift(-8,"f");break;case"B":if(m&&A[R].len==8){d[B][R]=O.read_shift(8,"f");break}case"G":case"P":O.l+=A[R].len;break;case"0":if(A[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[R].type)}}}if(p!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=A,d}function n(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var h=R0(r(l,d),d);return h["!cols"]=d.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete d.DBF,h}function s(l,c){try{return ad(n(l,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(l,c){var d=c||{};if(+d.codepage>=0&&po(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var h=xi(),p=Ex(l,{header:1,raw:!0,cellDates:!0}),x=p[0],m=p.slice(1),b=l["!cols"]||[],y=0,w=0,S=0,k=1;for(y=0;y<x.length;++y){if(((b[y]||{}).DBF||{}).name){x[y]=b[y].DBF.name,++S;continue}if(x[y]!=null){if(++S,typeof x[y]=="number"&&(x[y]=x[y].toString(10)),typeof x[y]!="string")throw new Error("DBF Invalid column name "+x[y]+" |"+typeof x[y]+"|");if(x.indexOf(x[y])!==y){for(w=0;w<1024;++w)if(x.indexOf(x[y]+"_"+w)==-1){x[y]+="_"+w;break}}}}var A=Dr(l["!ref"]),z=[],H=[],V=[];for(y=0;y<=A.e.c-A.s.c;++y){var B="",R="",O=0,ee=[];for(w=0;w<m.length;++w)m[w][y]!=null&&ee.push(m[w][y]);if(ee.length==0||x[y]==null){z[y]="?";continue}for(w=0;w<ee.length;++w){switch(typeof ee[w]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=ee[w]instanceof Date?"D":"C";break;default:R="C"}O=Math.max(O,String(ee[w]).length),B=B&&B!=R?"C":R}O>250&&(O=250),R=((b[y]||{}).DBF||{}).type,R=="C"&&b[y].DBF.len>O&&(O=b[y].DBF.len),B=="B"&&R=="N"&&(B="N",V[y]=b[y].DBF.dec,O=b[y].DBF.len),H[y]=B=="C"||R=="N"?O:a[B]||0,k+=H[y],z[y]=B}var I=h.next(32);for(I.write_shift(4,318902576),I.write_shift(4,m.length),I.write_shift(2,296+32*S),I.write_shift(2,k),y=0;y<4;++y)I.write_shift(4,0);for(I.write_shift(4,0|(+e[sf]||3)<<8),y=0,w=0;y<x.length;++y)if(x[y]!=null){var P=h.next(32),ae=(x[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,ae,"sbcs"),P.write_shift(1,z[y]=="?"?"C":z[y],"sbcs"),P.write_shift(4,w),P.write_shift(1,H[y]||a[z[y]]||0),P.write_shift(1,V[y]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),w+=H[y]||a[z[y]]||0}var G=h.next(264);for(G.write_shift(4,13),y=0;y<65;++y)G.write_shift(4,0);for(y=0;y<m.length;++y){var M=h.next(k);for(M.write_shift(1,0),w=0;w<x.length;++w)if(x[w]!=null)switch(z[w]){case"L":M.write_shift(1,m[y][w]==null?63:m[y][w]?84:70);break;case"B":M.write_shift(8,m[y][w]||0,"f");break;case"N":var te="0";for(typeof m[y][w]=="number"&&(te=m[y][w].toFixed(V[w]||0)),S=0;S<H[w]-te.length;++S)M.write_shift(1,32);M.write_shift(1,te,"sbcs");break;case"D":m[y][w]?(M.write_shift(4,("0000"+m[y][w].getFullYear()).slice(-4),"sbcs"),M.write_shift(2,("00"+(m[y][w].getMonth()+1)).slice(-2),"sbcs"),M.write_shift(2,("00"+m[y][w].getDate()).slice(-2),"sbcs")):M.write_shift(8,"00000000","sbcs");break;case"C":var ie=String(m[y][w]!=null?m[y][w]:"").slice(0,H[w]);for(M.write_shift(1,ie,"sbcs"),S=0;S<H[w]-ie.length;++S)M.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}})(),ZN=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+as(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,m){var b=t[m];return typeof b=="number"?T2(b):b},n=function(x,m,b){var y=m.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return y==59?x:T2(y)};t["|"]=254;function s(x,m){switch(m.type){case"base64":return a(Ri(x),m);case"binary":return a(x,m);case"buffer":return a(Er&&Buffer.isBuffer(x)?x.toString("binary"):sd(x),m);case"array":return a(of(x),m)}throw new Error("Unrecognized type "+m.type)}function a(x,m){var b=x.split(/[\n\r]+/),y=-1,w=-1,S=0,k=0,A=[],z=[],H=null,V={},B=[],R=[],O=[],ee=0,I;for(+m.codepage>=0&&po(+m.codepage);S!==b.length;++S){ee=0;var P=b[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),ae=P.replace(/;;/g,"\0").split(";").map(function(F){return F.replace(/\u0000/g,";")}),G=ae[0],M;if(P.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ae[1].charAt(0)=="P"&&z.push(P.slice(3).replace(/;;/g,";"));break;case"C":var te=!1,ie=!1,le=!1,X=!1,fe=-1,K=-1;for(k=1;k<ae.length;++k)switch(ae[k].charAt(0)){case"A":break;case"X":w=parseInt(ae[k].slice(1))-1,ie=!0;break;case"Y":for(y=parseInt(ae[k].slice(1))-1,ie||(w=0),I=A.length;I<=y;++I)A[I]=[];break;case"K":M=ae[k].slice(1),M.charAt(0)==='"'?M=M.slice(1,M.length-1):M==="TRUE"?M=!0:M==="FALSE"?M=!1:isNaN(Yo(M))?isNaN(N0(M).getDate())||(M=Dn(M)):(M=Yo(M),H!==null&&pf(H)&&(M=sg(M))),typeof Br<"u"&&typeof M=="string"&&(m||{}).type!="string"&&(m||{}).codepage&&(M=Br.utils.decode(m.codepage,M)),te=!0;break;case"E":X=!0;var E=p0(ae[k].slice(1),{r:y,c:w});A[y][w]=[A[y][w],E];break;case"S":le=!0,A[y][w]=[A[y][w],"S5S"];break;case"G":break;case"R":fe=parseInt(ae[k].slice(1))-1;break;case"C":K=parseInt(ae[k].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+P)}if(te&&(A[y][w]&&A[y][w].length==2?A[y][w][0]=M:A[y][w]=M,H=null),le){if(X)throw new Error("SYLK shared formula cannot have own formula");var W=fe>-1&&A[fe][K];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");A[y][w][1]=gS(W[1],{r:y-fe,c:w-K})}break;case"F":var L=0;for(k=1;k<ae.length;++k)switch(ae[k].charAt(0)){case"X":w=parseInt(ae[k].slice(1))-1,++L;break;case"Y":for(y=parseInt(ae[k].slice(1))-1,I=A.length;I<=y;++I)A[I]=[];break;case"M":ee=parseInt(ae[k].slice(1))/20;break;case"F":break;case"G":break;case"P":H=z[parseInt(ae[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=ae[k].slice(1).split(" "),I=parseInt(O[0],10);I<=parseInt(O[1],10);++I)ee=parseInt(O[2],10),R[I-1]=ee===0?{hidden:!0}:{wch:ee},Ku(R[I-1]);break;case"C":w=parseInt(ae[k].slice(1))-1,R[w]||(R[w]={});break;case"R":y=parseInt(ae[k].slice(1))-1,B[y]||(B[y]={}),ee>0?(B[y].hpt=ee,B[y].hpx=k0(ee)):ee===0&&(B[y].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+P)}L<1&&(H=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+P)}}return B.length>0&&(V["!rows"]=B),R.length>0&&(V["!cols"]=R),m&&m.sheetRows&&(A=A.slice(0,m.sheetRows)),[A,V]}function i(x,m){var b=s(x,m),y=b[0],w=b[1],S=R0(y,m);return as(w).forEach(function(k){S[k]=w[k]}),S}function l(x,m){return ad(i(x,m),m)}function c(x,m,b,y){var w="C;Y"+(b+1)+";X"+(y+1)+";K";switch(x.t){case"n":w+=x.v||0,x.f&&!x.F&&(w+=";E"+ly(x.f,{r:b,c:y}));break;case"b":w+=x.v?"TRUE":"FALSE";break;case"e":w+=x.w||x.v;break;case"d":w+='"'+(x.w||x.v)+'"';break;case"s":w+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function d(x,m){m.forEach(function(b,y){var w="F;W"+(y+1)+" "+(y+1)+" ";b.hidden?w+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=ep(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=tp(b.wpx)),typeof b.wch=="number"&&(w+=Math.round(b.wch))),w.charAt(w.length-1)!=" "&&x.push(w)})}function h(x,m){m.forEach(function(b,y){var w="F;";b.hidden?w+="M0;":b.hpt?w+="M"+20*b.hpt+";":b.hpx&&(w+="M"+20*rp(b.hpx)+";"),w.length>2&&x.push(w+"R"+(y+1))})}function p(x,m){var b=["ID;PWXL;N;E"],y=[],w=Dr(x["!ref"]),S,k=Array.isArray(x),A=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),x["!cols"]&&d(b,x["!cols"]),x["!rows"]&&h(b,x["!rows"]),b.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var z=w.s.r;z<=w.e.r;++z)for(var H=w.s.c;H<=w.e.c;++H){var V=fr({r:z,c:H});S=k?(x[z]||[])[H]:x[V],!(!S||S.v==null&&(!S.f||S.F))&&y.push(c(S,x,z,H))}return b.join(A)+A+y.join(A)+A+"E"+A}return{to_workbook:l,to_sheet:i,from_sheet:p}})(),eS=(function(){function t(a,i){switch(i.type){case"base64":return e(Ri(a),i);case"binary":return e(a,i);case"buffer":return e(Er&&Buffer.isBuffer(a)?a.toString("binary"):sd(a),i);case"array":return e(of(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){for(var l=a.split(`
`),c=-1,d=-1,h=0,p=[];h!==l.length;++h){if(l[h].trim()==="BOT"){p[++c]=[],d=0;continue}if(!(c<0)){var x=l[h].trim().split(","),m=x[0],b=x[1];++h;for(var y=l[h]||"";(y.match(/["]/g)||[]).length&1&&h<l.length-1;)y+=`
`+l[++h];switch(y=y.trim(),+m){case-1:if(y==="BOT"){p[++c]=[],d=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?p[c][d]=!0:y==="FALSE"?p[c][d]=!1:isNaN(Yo(b))?isNaN(N0(b).getDate())?p[c][d]=b:p[c][d]=Dn(b):p[c][d]=Yo(b),++d;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),p[c][d++]=y!==""?y:null;break}if(y==="EOD")break}}return i&&i.sheetRows&&(p=p.slice(0,i.sheetRows)),p}function r(a,i){return R0(t(a,i),i)}function n(a,i){return ad(r(a,i),i)}var s=(function(){var a=function(c,d,h,p,x){c.push(d),c.push(h+","+p),c.push('"'+x.replace(/"/g,'""')+'"')},i=function(c,d,h,p){c.push(d+","+h),c.push(d==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(c){var d=[],h=Dr(c["!ref"]),p,x=Array.isArray(c);a(d,"TABLE",0,1,"sheetjs"),a(d,"VECTORS",0,h.e.r-h.s.r+1,""),a(d,"TUPLES",0,h.e.c-h.s.c+1,""),a(d,"DATA",0,0,"");for(var m=h.s.r;m<=h.e.r;++m){i(d,-1,0,"BOT");for(var b=h.s.c;b<=h.e.c;++b){var y=fr({r:m,c:b});if(p=x?(c[m]||[])[b]:c[y],!p){i(d,1,0,"");continue}switch(p.t){case"n":var w=p.w;!w&&p.v!=null&&(w=p.v),w==null?p.f&&!p.F?i(d,1,0,"="+p.f):i(d,1,0,""):i(d,0,w,"V");break;case"b":i(d,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":i(d,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Ii(p.z||ar[14],Fs(Dn(p.v)))),i(d,0,p.w,"V");break;default:i(d,1,0,"")}}}i(d,-1,0,"EOD");var S=`\r
`,k=d.join(S);return k}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),tS=(function(){function t(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,x){for(var m=p.split(`
`),b=-1,y=-1,w=0,S=[];w!==m.length;++w){var k=m[w].trim().split(":");if(k[0]==="cell"){var A=Gn(k[1]);if(S.length<=A.r)for(b=S.length;b<=A.r;++b)S[b]||(S[b]=[]);switch(b=A.r,y=A.c,k[2]){case"t":S[b][y]=t(k[3]);break;case"v":S[b][y]=+k[3];break;case"vtf":var z=k[k.length-1];case"vtc":switch(k[3]){case"nl":S[b][y]=!!+k[4];break;default:S[b][y]=+k[4];break}k[2]=="vtf"&&(S[b][y]=[S[b][y],z])}}}return x&&x.sheetRows&&(S=S.slice(0,x.sheetRows)),S}function n(p,x){return R0(r(p,x),x)}function s(p,x){return ad(n(p,x),x)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(p){if(!p||!p["!ref"])return"";for(var x=[],m=[],b,y="",w=Ka(p["!ref"]),S=Array.isArray(p),k=w.s.r;k<=w.e.r;++k)for(var A=w.s.c;A<=w.e.c;++A)if(y=fr({r:k,c:A}),b=S?(p[k]||[])[A]:p[y],!(!b||b.v==null||b.t==="z")){switch(m=["cell",y,"t"],b.t){case"s":case"str":m.push(e(b.v));break;case"n":b.f?(m[2]="vtf",m[3]="n",m[4]=b.v,m[5]=e(b.f)):(m[2]="v",m[3]=b.v);break;case"b":m[2]="vt"+(b.f?"f":"c"),m[3]="nl",m[4]=b.v?"1":"0",m[5]=e(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var z=Fs(Dn(b.v));m[2]="vtc",m[3]="nd",m[4]=""+z,m[5]=b.w||Ii(b.z||ar[14],z);break;case"e":continue}x.push(m.join(":"))}return x.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function h(p){return[a,i,l,i,d(p),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:h}})(),S0=(function(){function t(h,p,x,m,b){b.raw?p[x][m]=h:h===""||(h==="TRUE"?p[x][m]=!0:h==="FALSE"?p[x][m]=!1:isNaN(Yo(h))?isNaN(N0(h).getDate())?p[x][m]=h:p[x][m]=Dn(h):p[x][m]=Yo(h))}function e(h,p){var x=p||{},m=[];if(!h||h.length===0)return m;for(var b=h.split(/[\r\n]/),y=b.length-1;y>=0&&b[y].length===0;)--y;for(var w=10,S=0,k=0;k<=y;++k)S=b[k].indexOf(" "),S==-1?S=b[k].length:S++,w=Math.max(w,S);for(k=0;k<=y;++k){m[k]=[];var A=0;for(t(b[k].slice(0,w).trim(),m,k,A,x),A=1;A<=(b[k].length-w)/10+1;++A)t(b[k].slice(w+(A-1)*10,w+A*10).trim(),m,k,A,x)}return x.sheetRows&&(m=m.slice(0,x.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(h){for(var p={},x=!1,m=0,b=0;m<h.length;++m)(b=h.charCodeAt(m))==34?x=!x:!x&&b in r&&(p[b]=(p[b]||0)+1);b=[];for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&b.push([p[m],m]);if(!b.length){p=n;for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&b.push([p[m],m])}return b.sort(function(y,w){return y[0]-w[0]||n[y[1]]-n[w[1]]}),r[b.pop()[1]]||44}function a(h,p){var x=p||{},m="",b=x.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(m=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(m=h.charAt(4),h=h.slice(6)):m=s(h.slice(0,1024)):x&&x.FS?m=x.FS:m=s(h.slice(0,1024));var w=0,S=0,k=0,A=0,z=0,H=m.charCodeAt(0),V=!1,B=0,R=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var O=x.dateNF!=null?TT(x.dateNF):null;function ee(){var I=h.slice(A,z),P={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)P.t="z";else if(x.raw)P.t="s",P.v=I;else if(I.trim().length===0)P.t="s",P.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(P.t="s",P.v=I.slice(2,-1).replace(/""/g,'"')):iR(I)?(P.t="n",P.f=I.slice(1)):(P.t="s",P.v=I);else if(I=="TRUE")P.t="b",P.v=!0;else if(I=="FALSE")P.t="b",P.v=!1;else if(!isNaN(k=Yo(I)))P.t="n",x.cellText!==!1&&(P.w=I),P.v=k;else if(!isNaN(N0(I).getDate())||O&&I.match(O)){P.z=x.dateNF||ar[14];var ae=0;O&&I.match(O)&&(I=FT(I,x.dateNF,I.match(O)||[]),ae=1),x.cellDates?(P.t="d",P.v=Dn(I,ae)):(P.t="n",P.v=Fs(Dn(I,ae))),x.cellText!==!1&&(P.w=Ii(P.z,P.v instanceof Date?Fs(P.v):P.v)),x.cellNF||delete P.z}else P.t="s",P.v=I;if(P.t=="z"||(x.dense?(b[w]||(b[w]=[]),b[w][S]=P):b[fr({c:S,r:w})]=P),A=z+1,R=h.charCodeAt(A),y.e.c<S&&(y.e.c=S),y.e.r<w&&(y.e.r=w),B==H)++S;else if(S=0,++w,x.sheetRows&&x.sheetRows<=w)return!0}e:for(;z<h.length;++z)switch(B=h.charCodeAt(z)){case 34:R===34&&(V=!V);break;case H:case 10:case 13:if(!V&&ee())break e;break}return z-A>0&&ee(),b["!ref"]=Nr(y),b}function i(h,p){return!(p&&p.PRN)||p.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?a(h,p):R0(e(h,p),p)}function l(h,p){var x="",m=p.type=="string"?[0,0,0,0]:gy(h,p);switch(p.type){case"base64":x=Ri(h);break;case"binary":x=h;break;case"buffer":p.codepage==65001?x=h.toString("utf8"):p.codepage&&typeof Br<"u"?x=Br.utils.decode(p.codepage,h):x=Er&&Buffer.isBuffer(h)?h.toString("binary"):sd(h);break;case"array":x=of(h);break;case"string":x=h;break;default:throw new Error("Unrecognized type "+p.type)}return m[0]==239&&m[1]==187&&m[2]==191?x=fn(x.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?x=fn(x):p.type=="binary"&&typeof Br<"u"&&p.codepage&&(x=Br.utils.decode(p.codepage,Br.utils.encode(28591,x))),x.slice(0,19)=="socialcalc:version:"?tS.to_sheet(p.type=="string"?x:fn(x),p):i(x,p)}function c(h,p){return ad(l(h,p),p)}function d(h){for(var p=[],x=Dr(h["!ref"]),m,b=Array.isArray(h),y=x.s.r;y<=x.e.r;++y){for(var w=[],S=x.s.c;S<=x.e.c;++S){var k=fr({r:y,c:S});if(m=b?(h[y]||[])[S]:h[k],!m||m.v==null){w.push("          ");continue}for(var A=(m.w||(Il(m),m.w)||"").slice(0,10);A.length<10;)A+=" ";w.push(A+(S===0?" ":""))}p.push(w.join(""))}return p.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}})();function qP(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=ZN.to_workbook(t,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return S0.to_workbook(t,e)}}var Qd=(function(){function t(E,W,L){if(E){sa(E,E.l||0);for(var F=L.Enum||fe;E.l<E.length;){var q=E.read_shift(2),he=F[q]||F[65535],me=E.read_shift(2),Z=E.l+me,Se=he.f&&he.f(E,me,L);if(E.l=Z,W(Se,he,q))return}}}function e(E,W){switch(W.type){case"base64":return r(Ti(Ri(E)),W);case"binary":return r(Ti(E),W);case"buffer":case"array":return r(E,W)}throw"Unsupported type "+W.type}function r(E,W){if(!E)return E;var L=W||{},F=L.dense?[]:{},q="Sheet1",he="",me=0,Z={},Se=[],We=[],ue={s:{r:0,c:0},e:{r:0,c:0}},nt=L.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)L.Enum=fe,t(E,function(Xe,Re,Ke){switch(Ke){case 0:L.vers=Xe,Xe>=4096&&(L.qpro=!0);break;case 6:ue=Xe;break;case 204:Xe&&(he=Xe);break;case 222:he=Xe;break;case 15:case 51:L.qpro||(Xe[1].v=Xe[1].v.slice(1));case 13:case 14:case 16:Ke==14&&(Xe[2]&112)==112&&(Xe[2]&15)>1&&(Xe[2]&15)<15&&(Xe[1].z=L.dateNF||ar[14],L.cellDates&&(Xe[1].t="d",Xe[1].v=sg(Xe[1].v))),L.qpro&&Xe[3]>me&&(F["!ref"]=Nr(ue),Z[q]=F,Se.push(q),F=L.dense?[]:{},ue={s:{r:0,c:0},e:{r:0,c:0}},me=Xe[3],q=he||"Sheet"+(me+1),he="");var it=L.dense?(F[Xe[0].r]||[])[Xe[0].c]:F[fr(Xe[0])];if(it){it.t=Xe[1].t,it.v=Xe[1].v,Xe[1].z!=null&&(it.z=Xe[1].z),Xe[1].f!=null&&(it.f=Xe[1].f);break}L.dense?(F[Xe[0].r]||(F[Xe[0].r]=[]),F[Xe[0].r][Xe[0].c]=Xe[1]):F[fr(Xe[0])]=Xe[1];break}},L);else if(E[2]==26||E[2]==14)L.Enum=K,E[2]==14&&(L.qpro=!0,E.l=0),t(E,function(Xe,Re,Ke){switch(Ke){case 204:q=Xe;break;case 22:Xe[1].v=Xe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Xe[3]>me&&(F["!ref"]=Nr(ue),Z[q]=F,Se.push(q),F=L.dense?[]:{},ue={s:{r:0,c:0},e:{r:0,c:0}},me=Xe[3],q="Sheet"+(me+1)),nt>0&&Xe[0].r>=nt)break;L.dense?(F[Xe[0].r]||(F[Xe[0].r]=[]),F[Xe[0].r][Xe[0].c]=Xe[1]):F[fr(Xe[0])]=Xe[1],ue.e.c<Xe[0].c&&(ue.e.c=Xe[0].c),ue.e.r<Xe[0].r&&(ue.e.r=Xe[0].r);break;case 27:Xe[14e3]&&(We[Xe[14e3][0]]=Xe[14e3][1]);break;case 1537:We[Xe[0]]=Xe[1],Xe[0]==me&&(q=Xe[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(F["!ref"]=Nr(ue),Z[he||q]=F,Se.push(he||q),!We.length)return{SheetNames:Se,Sheets:Z};for(var rt={},De=[],ve=0;ve<We.length;++ve)Z[Se[ve]]?(De.push(We[ve]||Se[ve]),rt[We[ve]]=Z[We[ve]]||Z[Se[ve]]):(De.push(We[ve]),rt[We[ve]]={"!ref":"A1"});return{SheetNames:De,Sheets:rt}}function n(E,W){var L=W||{};if(+L.codepage>=0&&po(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var F=xi(),q=Dr(E["!ref"]),he=Array.isArray(E),me=[];kt(F,0,a(1030)),kt(F,6,c(q));for(var Z=Math.min(q.e.r,8191),Se=q.s.r;Se<=Z;++Se)for(var We=ns(Se),ue=q.s.c;ue<=q.e.c;++ue){Se===q.s.r&&(me[ue]=Pn(ue));var nt=me[ue]+We,rt=he?(E[Se]||[])[ue]:E[nt];if(!(!rt||rt.t=="z"))if(rt.t=="n")(rt.v|0)==rt.v&&rt.v>=-32768&&rt.v<=32767?kt(F,13,m(Se,ue,rt.v)):kt(F,14,y(Se,ue,rt.v));else{var De=Il(rt);kt(F,15,p(Se,ue,De.slice(0,239)))}}return kt(F,1),F.end()}function s(E,W){var L=W||{};if(+L.codepage>=0&&po(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var F=xi();kt(F,0,i(E));for(var q=0,he=0;q<E.SheetNames.length;++q)(E.Sheets[E.SheetNames[q]]||{})["!ref"]&&kt(F,27,X(E.SheetNames[q],he++));var me=0;for(q=0;q<E.SheetNames.length;++q){var Z=E.Sheets[E.SheetNames[q]];if(!(!Z||!Z["!ref"])){for(var Se=Dr(Z["!ref"]),We=Array.isArray(Z),ue=[],nt=Math.min(Se.e.r,8191),rt=Se.s.r;rt<=nt;++rt)for(var De=ns(rt),ve=Se.s.c;ve<=Se.e.c;++ve){rt===Se.s.r&&(ue[ve]=Pn(ve));var Xe=ue[ve]+De,Re=We?(Z[rt]||[])[ve]:Z[Xe];if(!(!Re||Re.t=="z"))if(Re.t=="n")kt(F,23,ee(rt,ve,me,Re.v));else{var Ke=Il(Re);kt(F,22,B(rt,ve,me,Ke.slice(0,239)))}}++me}}return kt(F,1),F.end()}function a(E){var W=st(2);return W.write_shift(2,E),W}function i(E){var W=st(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var L=0,F=0,q=0,he=0;he<E.SheetNames.length;++he){var me=E.SheetNames[he],Z=E.Sheets[me];if(!(!Z||!Z["!ref"])){++q;var Se=Ka(Z["!ref"]);L<Se.e.r&&(L=Se.e.r),F<Se.e.c&&(F=Se.e.c)}}return L>8191&&(L=8191),W.write_shift(2,L),W.write_shift(1,q),W.write_shift(1,F),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function l(E,W,L){var F={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&L.qpro?(F.s.c=E.read_shift(1),E.l++,F.s.r=E.read_shift(2),F.e.c=E.read_shift(1),E.l++,F.e.r=E.read_shift(2),F):(F.s.c=E.read_shift(2),F.s.r=E.read_shift(2),W==12&&L.qpro&&(E.l+=2),F.e.c=E.read_shift(2),F.e.r=E.read_shift(2),W==12&&L.qpro&&(E.l+=2),F.s.c==65535&&(F.s.c=F.e.c=F.s.r=F.e.r=0),F)}function c(E){var W=st(8);return W.write_shift(2,E.s.c),W.write_shift(2,E.s.r),W.write_shift(2,E.e.c),W.write_shift(2,E.e.r),W}function d(E,W,L){var F=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(F[0].c=E.read_shift(1),F[3]=E.read_shift(1),F[0].r=E.read_shift(2),E.l+=2):(F[2]=E.read_shift(1),F[0].c=E.read_shift(2),F[0].r=E.read_shift(2)),F}function h(E,W,L){var F=E.l+W,q=d(E,W,L);if(q[1].t="s",L.vers==20768){E.l++;var he=E.read_shift(1);return q[1].v=E.read_shift(he,"utf8"),q}return L.qpro&&E.l++,q[1].v=E.read_shift(F-E.l,"cstr"),q}function p(E,W,L){var F=st(7+L.length);F.write_shift(1,255),F.write_shift(2,W),F.write_shift(2,E),F.write_shift(1,39);for(var q=0;q<F.length;++q){var he=L.charCodeAt(q);F.write_shift(1,he>=128?95:he)}return F.write_shift(1,0),F}function x(E,W,L){var F=d(E,W,L);return F[1].v=E.read_shift(2,"i"),F}function m(E,W,L){var F=st(7);return F.write_shift(1,255),F.write_shift(2,W),F.write_shift(2,E),F.write_shift(2,L,"i"),F}function b(E,W,L){var F=d(E,W,L);return F[1].v=E.read_shift(8,"f"),F}function y(E,W,L){var F=st(13);return F.write_shift(1,255),F.write_shift(2,W),F.write_shift(2,E),F.write_shift(8,L,"f"),F}function w(E,W,L){var F=E.l+W,q=d(E,W,L);if(q[1].v=E.read_shift(8,"f"),L.qpro)E.l=F;else{var he=E.read_shift(2);z(E.slice(E.l,E.l+he),q),E.l+=he}return q}function S(E,W,L){var F=W&32768;return W&=-32769,W=(F?E:0)+(W>=8192?W-16384:W),(F?"":"$")+(L?Pn(W):ns(W))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function z(E,W){sa(E,0);for(var L=[],F=0,q="",he="",me="",Z="";E.l<E.length;){var Se=E[E.l++];switch(Se){case 0:L.push(E.read_shift(8,"f"));break;case 1:he=S(W[0].c,E.read_shift(2),!0),q=S(W[0].r,E.read_shift(2),!1),L.push(he+q);break;case 2:{var We=S(W[0].c,E.read_shift(2),!0),ue=S(W[0].r,E.read_shift(2),!1);he=S(W[0].c,E.read_shift(2),!0),q=S(W[0].r,E.read_shift(2),!1),L.push(We+ue+":"+he+q)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(E.read_shift(2));break;case 6:{for(var nt="";Se=E[E.l++];)nt+=String.fromCharCode(Se);L.push('"'+nt.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:Z=L.pop(),me=L.pop(),L.push(["AND","OR"][Se-20]+"("+me+","+Z+")");break;default:if(Se<32&&A[Se])Z=L.pop(),me=L.pop(),L.push(me+A[Se]+Z);else if(k[Se]){if(F=k[Se][1],F==69&&(F=E[E.l++]),F>L.length){console.error("WK1 bad formula parse 0x"+Se.toString(16)+":|"+L.join("|")+"|");return}var rt=L.slice(-F);L.length-=F,L.push(k[Se][0]+"("+rt.join(",")+")")}else return Se<=7?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=24?console.error("WK1 unsupported op "+Se.toString(16)):Se<=30?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=115?console.error("WK1 unsupported function opcode "+Se.toString(16)):console.error("WK1 unrecognized opcode "+Se.toString(16))}}L.length==1?W[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function H(E){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=E.read_shift(2),W[3]=E[E.l++],W[0].c=E[E.l++],W}function V(E,W){var L=H(E);return L[1].t="s",L[1].v=E.read_shift(W-4,"cstr"),L}function B(E,W,L,F){var q=st(6+F.length);q.write_shift(2,E),q.write_shift(1,L),q.write_shift(1,W),q.write_shift(1,39);for(var he=0;he<F.length;++he){var me=F.charCodeAt(he);q.write_shift(1,me>=128?95:me)}return q.write_shift(1,0),q}function R(E,W){var L=H(E);L[1].v=E.read_shift(2);var F=L[1].v>>1;if(L[1].v&1)switch(F&7){case 0:F=(F>>3)*5e3;break;case 1:F=(F>>3)*500;break;case 2:F=(F>>3)/20;break;case 3:F=(F>>3)/200;break;case 4:F=(F>>3)/2e3;break;case 5:F=(F>>3)/2e4;break;case 6:F=(F>>3)/16;break;case 7:F=(F>>3)/64;break}return L[1].v=F,L}function O(E,W){var L=H(E),F=E.read_shift(4),q=E.read_shift(4),he=E.read_shift(2);if(he==65535)return F===0&&q===3221225472?(L[1].t="e",L[1].v=15):F===0&&q===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var me=he&32768;return he=(he&32767)-16446,L[1].v=(1-me*2)*(q*Math.pow(2,he+32)+F*Math.pow(2,he)),L}function ee(E,W,L,F){var q=st(14);if(q.write_shift(2,E),q.write_shift(1,L),q.write_shift(1,W),F==0)return q.write_shift(4,0),q.write_shift(4,0),q.write_shift(2,65535),q;var he=0,me=0,Z=0,Se=0;return F<0&&(he=1,F=-F),me=Math.log2(F)|0,F/=Math.pow(2,me-31),Se=F>>>0,(Se&2147483648)==0&&(F/=2,++me,Se=F>>>0),F-=Se,Se|=2147483648,Se>>>=0,F*=Math.pow(2,32),Z=F>>>0,q.write_shift(4,Z),q.write_shift(4,Se),me+=16383+(he?32768:0),q.write_shift(2,me),q}function I(E,W){var L=O(E);return E.l+=W-14,L}function P(E,W){var L=H(E),F=E.read_shift(4);return L[1].v=F>>6,L}function ae(E,W){var L=H(E),F=E.read_shift(8,"f");return L[1].v=F,L}function G(E,W){var L=ae(E);return E.l+=W-10,L}function M(E,W){return E[E.l+W-1]==0?E.read_shift(W,"cstr"):""}function te(E,W){var L=E[E.l++];L>W-1&&(L=W-1);for(var F="";F.length<L;)F+=String.fromCharCode(E[E.l++]);return F}function ie(E,W,L){if(!(!L.qpro||W<21)){var F=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var q=E.read_shift(W-21,"cstr");return[F,q]}}function le(E,W){for(var L={},F=E.l+W;E.l<F;){var q=E.read_shift(2);if(q==14e3){for(L[q]=[0,""],L[q][0]=E.read_shift(2);E[E.l];)L[q][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return L}function X(E,W){var L=st(5+E.length);L.write_shift(2,14e3),L.write_shift(2,W);for(var F=0;F<E.length;++F){var q=E.charCodeAt(F);L[L.l++]=q>127?95:q}return L[L.l++]=0,L}var fe={0:{n:"BOF",f:Ns},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:M},222:{n:"SHEETNAMELP",f:te},65535:{n:""}},K={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:V},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:ae},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:M},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ie},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}})();function GP(t){var e={},r=t.match(Ia),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=xr(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;e.cp=Fv[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=a.val;break;case"<sz":e.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":a.rgb&&(e.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return e}var XP=(function(){var t=Yh("t"),e=Yh("rPr");function r(a){var i=a.match(t);if(!i)return{t:"s",v:""};var l={t:"s",v:Wr(i[1])},c=a.match(e);return c&&(l.s=GP(c[1])),l}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(l){return l.v})}})(),YP=(function(){var e=/(\r\n|\n)/g;function r(s,a,i){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),a.push('<span style="'+l.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}})(),KP=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,JP=/<(?:\w+:)?r>/,QP=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ny(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Wr(fn(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=fn(t),r&&(n.h=Bv(n.t))):t.match(JP)&&(n.r=fn(t),n.t=Wr(fn((t.replace(QP,"").match(KP)||[]).join("").replace(Ia,""))),r&&(n.h=YP(XP(n.r)))),n):{t:""}}var ZP=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,eL=/<(?:\w+:)?(?:si|sstItem)>/g,tL=/<\/(?:\w+:)?(?:si|sstItem)>/;function rL(t,e){var r=[],n="";if(!t)return r;var s=t.match(ZP);if(s){n=s[2].replace(eL,"").split(tL);for(var a=0;a!=n.length;++a){var i=ny(n[a].trim(),e);i!=null&&(r[r.length]=i)}s=xr(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var nL=/^\s|\s$|[\t\n\r]/;function rS(t,e){if(!e.bookSST)return"";var r=[vs];r[r.length]=St("sst",null,{xmlns:mf[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var s=t[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(nL)&&(a+=' xml:space="preserve"'),a+=">"+un(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function sL(t){return[t.read_shift(4),t.read_shift(4)]}function aL(t,e){var r=[],n=!1;return Mc(t,function(a,i,l){switch(l){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function iL(t,e){return e||(e=st(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var oL=gF;function lL(t){var e=xi();ct(e,159,iL(t));for(var r=0;r<t.length;++r)ct(e,19,oL(t[r]));return ct(e,160),e.end()}function nS(t){if(typeof Br<"u")return Br.utils.encode(sf,t);for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Fc(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function cL(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Fc(t,4),e.U=Fc(t,4),e.W=Fc(t,4),e}function uL(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),a=[];s-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function dL(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(uL(t));return e}function fL(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function hL(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Fc(t,4),e.U=Fc(t,4),e.W=Fc(t,4),e}function pL(t){var e=hL(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function sS(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function aS(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function mL(t){var e=Fc(t);switch(e.Minor){case 2:return[e.Minor,xL(t)];case 3:return[e.Minor,gL()];case 4:return[e.Minor,vL(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function xL(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=sS(t,r),s=aS(t,t.length-t.l);return{t:"Std",h:n,v:s}}function gL(){throw new Error("File is password-protected: ECMA-376 Extensible")}function vL(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Ia,function(a){var i=xr(a);switch(Ol(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(l){n[l]=i[l]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function yL(t,e){var r={},n=r.EncryptionVersionInfo=Fc(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=sS(t,s),e-=s,r.EncryptionVerifier=aS(t,e),r}function bL(t){var e={},r=e.EncryptionVersionInfo=Fc(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function sy(t){var e=0,r,n=nS(t),s=n.length+1,a,i,l,c,d;for(r=Yu(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],l=(e&16384)===0?0:1,c=e<<1&32767,d=l|c,e=d^i;return e^52811}var iS=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,l){return n(i^l)},a=function(i){for(var l=e[i.length-1],c=104,d=i.length-1;d>=0;--d)for(var h=i[d],p=0;p!=7;++p)h&64&&(l^=r[c]),h*=2,--c;return l};return function(i){for(var l=nS(i),c=a(l),d=l.length,h=Yu(16),p=0;p!=16;++p)h[p]=0;var x,m,b;for((d&1)===1&&(x=c>>8,h[d]=s(t[0],x),--d,x=c&255,m=l[l.length-1],h[d]=s(m,x));d>0;)--d,x=c>>8,h[d]=s(l[d],x),--d,x=c&255,h[d]=s(l[d],x);for(d=15,b=15-l.length;b>0;)x=c>>8,h[d]=s(t[b],x),--d,--b,x=c&255,h[d]=s(l[d],x),--d,--b;return h}})(),wL=function(t,e,r,n,s){s||(s=e),n||(n=iS(t));var a,i;for(a=0;a!=e.length;++a)i=e[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},_L=function(t){var e=0,r=iS(t);return function(n){var s=wL("",n,e,r);return e=s[1],s[0]}};function NL(t,e,r,n){var s={key:Ns(t),verificationBytes:Ns(t)};return r.password&&(s.verifier=sy(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=_L(r.password)),s}function SL(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=bL(t):n.Data=yL(t,e),n}function kL(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?SL(t,e-2,n):NL(t,r.biff>=8?e:e-2,r,n),n}var oS=(function(){function t(s,a){switch(a.type){case"base64":return e(Ri(s),a);case"binary":return e(s,a);case"buffer":return e(Er&&Buffer.isBuffer(s)?s.toString("binary"):sd(s),a);case"array":return e(of(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){var i=a||{},l=i.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,p){Array.isArray(l)&&(l[p]=[]);for(var x=/\\\w+\b/g,m=0,b,y=-1;b=x.exec(h);){switch(b[0]){case"\\cell":var w=h.slice(m,x.lastIndex-b[0].length);if(w[0]==" "&&(w=w.slice(1)),++y,w.length){var S={v:w,t:"s"};Array.isArray(l)?l[p][y]=S:l[fr({r:p,c:y})]=S}break}m=x.lastIndex}y>d.e.c&&(d.e.c=y)}),l["!ref"]=Nr(d),l}function r(s,a){return ad(t(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=Dr(s["!ref"]),l,c=Array.isArray(s),d=i.s.r;d<=i.e.r;++d){a.push("\\trowd\\trautofit1");for(var h=i.s.c;h<=i.e.c;++h)a.push("\\cellx"+(h+1));for(a.push("\\pard\\intbl"),h=i.s.c;h<=i.e.c;++h){var p=fr({r:d,c:h});l=c?(s[d]||[])[h]:s[p],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(Il(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function jL(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Zh(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function EL(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),a=Math.min(e,r,n),i=s-a;if(i===0)return[0,0,e];var l=0,c=0,d=s+a;switch(c=i/(d>1?2-d:d),s){case e:l=((r-n)/i+6)%6;break;case r:l=(n-e)/i+2;break;case n:l=(e-r)/i+4;break}return[l/6,c,d/2]}function AL(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],l=6*e,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,i[0]+=s,i[1]+=c;break;case 1:c=s*(2-l),i[0]+=c,i[1]+=s;break;case 2:c=s*(l-2),i[1]+=s,i[2]+=c;break;case 3:c=s*(4-l),i[1]+=c,i[2]+=s;break;case 4:c=s*(l-4),i[2]+=s,i[0]+=c;break;case 5:c=s*(6-l),i[2]+=c,i[0]+=s;break}for(var d=0;d!=3;++d)i[d]=Math.round(i[d]*255);return i}function Nx(t,e){if(e===0)return t;var r=EL(jL(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Zh(AL(r))}var lS=6,CL=15,TL=1,Ea=lS;function ep(t){return Math.floor((t+Math.round(128/Ea)/256)*Ea)}function tp(t){return Math.floor((t-5)/Ea*100+.5)/100}function Sx(t){return Math.round((t*Ea+5)/Ea*256)/256}function E1(t){return Sx(tp(ep(t)))}function ay(t){var e=Math.abs(t-E1(t)),r=Ea;if(e>.005)for(Ea=TL;Ea<CL;++Ea)Math.abs(t-E1(t))<=e&&(e=Math.abs(t-E1(t)),r=Ea);Ea=r}function Ku(t){t.width?(t.wpx=ep(t.width),t.wch=tp(t.wpx),t.MDW=Ea):t.wpx?(t.wch=tp(t.wpx),t.width=Sx(t.wch),t.MDW=Ea):typeof t.wch=="number"&&(t.width=Sx(t.wch),t.wpx=ep(t.width),t.MDW=Ea),t.customWidth&&delete t.customWidth}var FL=96,cS=FL;function rp(t){return t*96/cS}function k0(t){return t*cS/96}var PL={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function LL(t,e,r,n){e.Borders=[];var s={},a=!1;(t[0].match(Ia)||[]).forEach(function(i){var l=xr(i);switch(Ol(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=Cn(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=Cn(l.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in borders")}})}function DL(t,e,r,n){e.Fills=[];var s={},a=!1;(t[0].match(Ia)||[]).forEach(function(i){var l=xr(i);switch(Ol(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fills")}})}function RL(t,e,r,n){e.Fonts=[];var s={},a=!1;(t[0].match(Ia)||[]).forEach(function(i){var l=xr(i);switch(Ol(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=fn(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?Cn(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?Cn(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?Cn(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?Cn(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?Cn(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?Cn(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?Cn(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Fv[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=Cn(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=Kd[s.color.index];s.color.index==81&&(c=Kd[1]),c||(c=Kd[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Nx(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fonts")}})}function IL(t,e,r){e.NumberFmt=[];for(var n=as(ar),s=0;s<n.length;++s)e.NumberFmt[n[s]]=ar[n[s]];var a=t[0].match(Ia);if(a)for(s=0;s<a.length;++s){var i=xr(a[s]);switch(Ol(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Wr(fn(i.formatCode)),c=parseInt(i.numFmtId,10);if(e.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=l}Fl(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function OL(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=St("numFmt",null,{numFmtId:n,formatCode:un(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=St("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var jm=["numFmtId","fillId","fontId","borderId","xfId"],Em=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function ML(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(Ia)||[]).forEach(function(a){var i=xr(a),l=0;switch(Ol(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],l=0;l<jm.length;++l)n[jm[l]]&&(n[jm[l]]=parseInt(n[jm[l]],10));for(l=0;l<Em.length;++l)n[Em[l]]&&(n[Em[l]]=Cn(n[Em[l]]));if(e.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[l]){n.numFmtId=l;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=Cn(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function BL(t){var e=[];return e[e.length]=St("cellXfs",null),t.forEach(function(r){e[e.length]=St("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=St("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var UL=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,d){var h={};if(!l)return h;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=l.match(e))&&IL(p,h,d),(p=l.match(s))&&RL(p,h,c,d),(p=l.match(n))&&DL(p,h,c,d),(p=l.match(a))&&LL(p,h,c,d),(p=l.match(r))&&ML(p,h,d),h}})();function uS(t,e){var r=[vs,St("styleSheet",null,{xmlns:mf[0],"xmlns:vt":Cs.vt})],n;return t.SSF&&(n=OL(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=BL(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function zL(t,e){var r=t.read_shift(2),n=La(t);return[r,n]}function HL(t,e,r){r||(r=st(6+4*e.length)),r.write_shift(2,t),Vs(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function $L(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=SF(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=t.read_shift(1);i!=0&&(n.underline=i);var l=t.read_shift(1);l>0&&(n.family=l);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=NF(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=La(t),n}function WL(t,e){e||(e=st(153)),e.write_shift(2,t.sz*20),kF(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),bx(t.color,e);var n=0;return n=2,e.write_shift(1,n),Vs(t.name,e),e.length>e.l?e.slice(0,e.l):e}var VL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],A1,qL=Da;function gw(t,e){e||(e=st(84)),A1||(A1=rg(VL));var r=A1[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(bx({auto:1},e),bx({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function GL(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}function dS(t,e,r){r||(r=st(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function lh(t,e){return e||(e=st(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var XL=Da;function YL(t,e){return e||(e=st(51)),e.write_shift(1,0),lh(null,e),lh(null,e),lh(null,e),lh(null,e),lh(null,e),e.length>e.l?e.slice(0,e.l):e}function KL(t,e){return e||(e=st(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),yx(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function JL(t,e,r){var n=st(2052);return n.write_shift(4,t),yx(e,n),yx(r,n),n.length>n.l?n.slice(0,n.l):n}function QL(t,e,r){var n={};n.NumberFmt=[];for(var s in ar)n.NumberFmt[s]=ar[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return Mc(t,function(c,d,h){switch(h){case 44:n.NumberFmt[c[0]]=c[1],Fl(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=Nx(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(h),i=!0;break;case 38:a.pop(),i=!1;break;default:if(d.T>0)a.push(h);else if(d.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function ZL(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&++r}),r!=0&&(ct(t,615,Ko(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&ct(t,44,HL(s,e[s]))}),ct(t,616))}}function eD(t){var e=1;ct(t,611,Ko(e)),ct(t,43,WL({sz:12,color:{theme:1},name:"Calibri",family:2})),ct(t,612)}function tD(t){var e=2;ct(t,603,Ko(e)),ct(t,45,gw({patternType:"none"})),ct(t,45,gw({patternType:"gray125"})),ct(t,604)}function rD(t){var e=1;ct(t,613,Ko(e)),ct(t,46,YL()),ct(t,614)}function nD(t){var e=1;ct(t,626,Ko(e)),ct(t,47,dS({numFmtId:0},65535)),ct(t,627)}function sD(t,e){ct(t,617,Ko(e.length)),e.forEach(function(r){ct(t,47,dS(r,0))}),ct(t,618)}function aD(t){var e=1;ct(t,619,Ko(e)),ct(t,48,KL({xfId:0,name:"Normal"})),ct(t,620)}function iD(t){var e=0;ct(t,505,Ko(e)),ct(t,506)}function oD(t){var e=0;ct(t,508,JL(e,"TableStyleMedium9","PivotStyleMedium4")),ct(t,509)}function lD(t,e){var r=xi();return ct(r,278),ZL(r,t.SSF),eD(r),tD(r),rD(r),nD(r),sD(r,e.cellXfs),aD(r),iD(r),oD(r),ct(r,279),r.end()}var cD=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function uD(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Ia)||[]).forEach(function(s){var a=xr(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(e.themeElements.clrScheme[cD.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function dD(){}function fD(){}var hD=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,pD=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,mD=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function xD(t,e,r){e.themeElements={};var n;[["clrScheme",hD,uD],["fontScheme",pD,dD],["fmtScheme",mD,fD]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var gD=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function fS(t,e){(!t||t.length===0)&&(t=iy());var r,n={};if(!(r=t.match(gD)))throw new Error("themeElements not found in theme");return xD(r[0],n,e),n.raw=t,n}function iy(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[vs];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function vD(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var i;try{i=lN(a,{type:"array"})}catch{return}var l=Fi(i,"theme/theme/theme1.xml",!0);if(l)return fS(l,r)}}function yD(t){return t.read_shift(4)}function bD(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=wD(t,4);break;case 2:e.xclrValue=VN(t);break;case 3:e.xclrValue=yD(t);break;case 4:t.l+=4;break}return t.l+=8,e}function wD(t,e){return Da(t,e)}function _D(t,e){return Da(t,e)}function ND(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=bD(t);break;case 6:n[1]=_D(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function SD(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),a=[];s-- >0;)a.push(ND(t,r-t.l));return{ixfe:n,ext:a}}function kD(t,e){e.forEach(function(r){r[0]})}function jD(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:La(t)}}function ED(t){var e=st(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Vs(t.name,e),e.slice(0,e.l)}function AD(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function CD(t){var e=st(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function TD(t,e){var r=st(8+2*e.length);return r.write_shift(4,t),Vs(e,r),r.slice(0,r.l)}function FD(t){return t.l+=4,t.read_shift(4)!=0}function PD(t,e){var r=st(8);return r.write_shift(4,t),r.write_shift(4,1),r}function LD(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,l=2;return Mc(t,function(c,d,h){switch(h){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(p){l==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):l==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:a.push(h),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!d.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function DD(){var t=xi();return ct(t,332),ct(t,334,Ko(1)),ct(t,335,ED({name:"XLDAPR",version:12e4,flags:3496657072})),ct(t,336),ct(t,339,TD(1,"XLDAPR")),ct(t,52),ct(t,35,Ko(514)),ct(t,4096,Ko(0)),ct(t,4097,co(1)),ct(t,36),ct(t,53),ct(t,340),ct(t,337,PD(1)),ct(t,51,CD([[1,0]])),ct(t,338),ct(t,333),t.end()}function RD(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,a=2,i;return t.replace(Ia,function(l){var c=xr(l);switch(Ol(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==c.name&&(i=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function hS(){var t=[vs];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function ID(t){var e=[];if(!t)return e;var r=1;return(t.match(Ia)||[]).forEach(function(n){var s=xr(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function OD(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=fr(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function MD(t,e,r){var n=[];return Mc(t,function(a,i,l){switch(l){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function BD(t,e,r,n){if(!t)return t;var s=n||{},a=!1;Mc(t,function(l,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function UD(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var l0=1024;function pS(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[St("xml",null,{"xmlns:v":Ci.v,"xmlns:o":Ci.o,"xmlns:x":Ci.x,"xmlns:mv":Ci.mv}).replace(/\/>/,">"),St("o:shapelayout",St("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),St("v:shapetype",[St("v:stroke",null,{joinstyle:"miter"}),St("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];l0<t*1e3;)l0+=1e3;return e.forEach(function(a){var i=Gn(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?St("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=St("v:fill",c,l),h={on:"t",obscured:"t"};++l0,s=s.concat(["<v:shape"+Kh({id:"_x0000_s"+l0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,St("v:shadow",null,h),St("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",aa("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),aa("x:AutoFill","False"),aa("x:Row",String(i.r)),aa("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function vw(t,e,r,n){var s=Array.isArray(t),a;e.forEach(function(i){var l=Gn(i.ref);if(s?(t[l.r]||(t[l.r]=[]),a=t[l.r][l.c]):a=t[i.ref],!a){a={t:"z"},s?t[l.r][l.c]=a:t[i.ref]=a;var c=Dr(t["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var d=Nr(c);d!==t["!ref"]&&(t["!ref"]=d)}a.c||(a.c=[]);var h={a:i.author,t:i.t,r:i.r,T:r};i.h&&(h.h=i.h);for(var p=a.c.length-1;p>=0;--p){if(!r&&a.c[p].T)return;r&&!a.c[p].T&&a.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(h.a==n[p].id){h.a=n[p].name||h.a;break}}a.c.push(h)})}function zD(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=xr(l[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},h=Gn(c.ref);if(!(e.sheetRows&&e.sheetRows<=h.r)){var p=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!p&&!!p[1]&&ny(p[1])||{r:"",t:"",h:""};d.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),d.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=x.h),n.push(d)}}}}),n}function mS(t){var e=[vs,St("comments",null,{xmlns:mf[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(s){var a=un(s.a);r.indexOf(a)==-1&&(r.push(a),e.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(un(c.a))),a.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)e.push(aa("t",un(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)i+=`Reply:
    `+a[l]+`
`;e.push(aa("t",un(i)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function HD(t,e){var r=[],n=!1,s={},a=0;return t.replace(Ia,function(l,c){var d=xr(l);switch(Ol(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+l.length;break;case"</text>":s.t=t.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),r}function $D(t,e,r){var n=[vs,St("ThreadedComments",null,{xmlns:Cs.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,l){if(!i.T){delete i.ID;return}i.a&&e.indexOf(i.a)==-1&&e.push(i.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(i.a)).slice(-12)+"}"),n.push(St("threadedComment",aa("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function WD(t,e){var r=[],n=!1;return t.replace(Ia,function(a){var i=xr(a);switch(Ol(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function VD(t){var e=[vs,St("personList",null,{xmlns:Cs.TCMNT,"xmlns:x":mf[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(St("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function qD(t){var e={};e.iauthor=t.read_shift(4);var r=yf(t);return e.rfx=r.s,e.ref=fr(r.s),t.l+=16,e}function GD(t,e){return e==null&&(e=st(36)),e.write_shift(4,t[1].iauthor),I0(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var XD=La;function YD(t){return Vs(t.slice(0,54))}function KD(t,e){var r=[],n=[],s={},a=!1;return Mc(t,function(l,c,d){switch(d){case 632:n.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function JD(t){var e=xi(),r=[];return ct(e,628),ct(e,630),t.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),ct(e,632,YD(s.a)))})}),ct(e,631),ct(e,633),t.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:Gn(n[0]),e:Gn(n[0])};ct(e,635,GD([a,s])),s.t&&s.t.length>0&&ct(e,637,yF(s)),ct(e,636),delete s.iauthor})}),ct(e,634),ct(e,629),e.end()}var QD="application/vnd.ms-office.vbaProject";function ZD(t){var e=er.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");er.utils.cfb_add(e,s,t.FileIndex[n].content)}}),er.write(e)}function eR(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&er.utils.cfb_add(t,s,e.FileIndex[n].content)}})}var xS=["xlsb","xlsm","xlam","biff8","xla"];function tR(){return{"!type":"dialog"}}function rR(){return{"!type":"dialog"}}function nR(){return{"!type":"macro"}}function sR(){return{"!type":"macro"}}var p0=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,a,i){var l=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1));var d=a.length>0?parseInt(a,10)|0:0,h=i.length>0?parseInt(i,10)|0:0;return l?h+=e.c:--h,c?d+=e.r:--d,s+(l?"":"$")+Pn(h)+(c?"":"$")+ns(d)}return function(s,a){return e=a,s.replace(t,r)}})(),oy=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ly=(function(){return function(e,r){return e.replace(oy,function(n,s,a,i,l,c){var d=Xv(i)-(a?0:r.c),h=Gv(c)-(l?0:r.r),p=h==0?"":l?h+1:"["+h+"]",x=d==0?"":a?d+1:"["+d+"]";return s+"R"+p+"C"+x})}})();function gS(t,e){return t.replace(oy,function(r,n,s,a,i,l){return n+(s=="$"?s+a:Pn(Xv(a)+e.c))+(i=="$"?i+l:ns(Gv(l)+e.r))})}function aR(t,e,r){var n=Ka(e),s=n.s,a=Gn(r),i={r:a.r-s.r,c:a.c-s.c};return gS(t,i)}function iR(t){return t.length!=1}function yw(t){return t.replace(/_xlfn\./g,"")}function ws(t){t.l+=1}function Ju(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function vS(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return yS(t);r.biff==12&&(n=4)}var s=t.read_shift(n),a=t.read_shift(n),i=Ju(t),l=Ju(t);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function yS(t){var e=Ju(t),r=Ju(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function oR(t,e,r){if(r.biff<8)return yS(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),a=Ju(t),i=Ju(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function bS(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return lR(t);var n=t.read_shift(r&&r.biff==12?4:2),s=Ju(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function lR(t){var e=Ju(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function cR(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function uR(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return dR(t);var s=t.read_shift(n>=12?4:2),a=t.read_shift(2),i=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:l}}function dR(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function fR(t,e,r){var n=(t[t.l++]&96)>>5,s=vS(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function hR(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var i=vS(t,a,r);return[n,s,i]}function pR(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function mR(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,s]}function xR(t,e,r){var n=(t[t.l++]&96)>>5,s=oR(t,e-1,r);return[n,s]}function gR(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function bw(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function vR(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function yR(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function bR(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function wR(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function _R(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function wS(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function NR(t){return t.read_shift(2),wS(t)}function SR(t){return t.read_shift(2),wS(t)}function kR(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=bS(t,0,r);return[n,s]}function jR(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=uR(t,0,r);return[n,s]}function ER(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=bS(t,0,r);return[n,s,a]}function AR(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[FI[s],SS[s],n]}function CR(t,e,r){var n=t[t.l++],s=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:TR(t);return[s,(a[0]===0?SS:TI)[a[1]]]}function TR(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function FR(t,e,r){t.l+=r&&r.biff==2?3:4}function PR(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function LR(t){return t.l++,Bc[t.read_shift(1)]}function DR(t){return t.l++,t.read_shift(2)}function RR(t){return t.l++,t.read_shift(1)!==0}function IR(t){return t.l++,Ca(t)}function OR(t,e,r){return t.l++,kp(t,e-1,r)}function MR(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=ds(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Bc[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Ca(t);break;case 2:r[1]=bf(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function BR(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?yf:ig)(t));return s}function UR(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var l=0;l!=s;++l)i[a][l]=MR(t,r.biff);return i}function zR(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function HR(t,e,r){if(r.biff==5)return $R(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),a=t.read_shift(4);return[n,s,a]}function $R(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function WR(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function VR(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function qR(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function GR(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,s]}var XR=Da,YR=Da,KR=Da;function Ep(t,e,r){return t.l+=2,[cR(t)]}function cy(t){return t.l+=6,[]}var JR=Ep,QR=cy,ZR=cy,eI=Ep;function _S(t){return t.l+=2,[Ns(t),t.read_shift(2)&1]}var tI=Ep,rI=_S,nI=cy,sI=Ep,aI=Ep,iI=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function oI(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),a=t.read_shift(2),i=iI[r>>2&31];return{ixti:e,coltype:r&3,rt:i,idx:n,c:s,C:a}}function lI(t){return t.l+=2,[t.read_shift(4)]}function cI(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function uI(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function dI(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function fI(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function hI(t){return t.l+=4,[0,0]}var ww={1:{n:"PtgExp",f:PR},2:{n:"PtgTbl",f:KR},3:{n:"PtgAdd",f:ws},4:{n:"PtgSub",f:ws},5:{n:"PtgMul",f:ws},6:{n:"PtgDiv",f:ws},7:{n:"PtgPower",f:ws},8:{n:"PtgConcat",f:ws},9:{n:"PtgLt",f:ws},10:{n:"PtgLe",f:ws},11:{n:"PtgEq",f:ws},12:{n:"PtgGe",f:ws},13:{n:"PtgGt",f:ws},14:{n:"PtgNe",f:ws},15:{n:"PtgIsect",f:ws},16:{n:"PtgUnion",f:ws},17:{n:"PtgRange",f:ws},18:{n:"PtgUplus",f:ws},19:{n:"PtgUminus",f:ws},20:{n:"PtgPercent",f:ws},21:{n:"PtgParen",f:ws},22:{n:"PtgMissArg",f:ws},23:{n:"PtgStr",f:OR},26:{n:"PtgSheet",f:cI},27:{n:"PtgEndSheet",f:uI},28:{n:"PtgErr",f:LR},29:{n:"PtgBool",f:RR},30:{n:"PtgInt",f:DR},31:{n:"PtgNum",f:IR},32:{n:"PtgArray",f:gR},33:{n:"PtgFunc",f:AR},34:{n:"PtgFuncVar",f:CR},35:{n:"PtgName",f:zR},36:{n:"PtgRef",f:kR},37:{n:"PtgArea",f:fR},38:{n:"PtgMemArea",f:WR},39:{n:"PtgMemErr",f:XR},40:{n:"PtgMemNoMem",f:YR},41:{n:"PtgMemFunc",f:VR},42:{n:"PtgRefErr",f:qR},43:{n:"PtgAreaErr",f:pR},44:{n:"PtgRefN",f:jR},45:{n:"PtgAreaN",f:xR},46:{n:"PtgMemAreaN",f:dI},47:{n:"PtgMemNoMemN",f:fI},57:{n:"PtgNameX",f:HR},58:{n:"PtgRef3d",f:ER},59:{n:"PtgArea3d",f:hR},60:{n:"PtgRefErr3d",f:GR},61:{n:"PtgAreaErr3d",f:mR},255:{}},pI={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},mI={1:{n:"PtgElfLel",f:_S},2:{n:"PtgElfRw",f:sI},3:{n:"PtgElfCol",f:JR},6:{n:"PtgElfRwV",f:aI},7:{n:"PtgElfColV",f:eI},10:{n:"PtgElfRadical",f:tI},11:{n:"PtgElfRadicalS",f:nI},13:{n:"PtgElfColS",f:QR},15:{n:"PtgElfColSV",f:ZR},16:{n:"PtgElfRadicalLel",f:rI},25:{n:"PtgList",f:oI},29:{n:"PtgSxName",f:lI},255:{}},xI={0:{n:"PtgAttrNoop",f:hI},1:{n:"PtgAttrSemi",f:_R},2:{n:"PtgAttrIf",f:bR},4:{n:"PtgAttrChoose",f:vR},8:{n:"PtgAttrGoto",f:yR},16:{n:"PtgAttrSum",f:FR},32:{n:"PtgAttrBaxcel",f:bw},33:{n:"PtgAttrBaxcel",f:bw},64:{n:"PtgAttrSpace",f:NR},65:{n:"PtgAttrSpaceSemi",f:SR},128:{n:"PtgAttrIfError",f:wR},255:{}};function Ap(t,e,r,n){if(n.biff<8)return Da(t,e);for(var s=t.l+e,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=UR(t,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=BR(t,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=t.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return e=s-t.l,e!==0&&a.push(Da(t,e)),a}function Cp(t,e,r){for(var n=t.l+e,s,a,i=[];n!=t.l;)e=n-t.l,a=t[t.l],s=ww[a]||ww[pI[a]],(a===24||a===25)&&(s=(a===24?mI:xI)[t[t.l+1]]),!s||!s.f?Da(t,e):i.push([s.n,s.f(t,e,r)]);return i}function gI(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var vI={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function yI(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function NS(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function _w(t,e,r){var n=NS(t,e,r);return n=="#REF"?n:yI(n,r)}function ka(t,e,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},l=[],c,d,h,p=0,x=0,m,b="";if(!t[0]||!t[0][0])return"";for(var y=-1,w="",S=0,k=t[0].length;S<k;++S){var A=t[0][S];switch(A[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),y>=0){switch(t[0][y][1][0]){case 0:w=ts(" ",t[0][y][1][1]);break;case 1:w=ts("\r",t[0][y][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}d=d+w,y=-1}l.push(d+vI[A[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=jh(A[1][1],i,s),l.push(Eh(h,a));break;case"PtgRefN":h=r?jh(A[1][1],r,s):A[1][1],l.push(Eh(h,a));break;case"PtgRef3d":p=A[1][1],h=jh(A[1][2],i,s),b=_w(n,p,s),l.push(b+"!"+Eh(h,a));break;case"PtgFunc":case"PtgFuncVar":var z=A[1][0],H=A[1][1];z||(z=0),z&=127;var V=z==0?[]:l.slice(-z);l.length-=z,H==="User"&&(H=V.shift()),l.push(H+"("+V.join(",")+")");break;case"PtgBool":l.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(A[1]);break;case"PtgNum":l.push(String(A[1]));break;case"PtgStr":l.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(A[1]);break;case"PtgAreaN":m=J5(A[1][1],r?{s:r}:i,s),l.push(S1(m,s));break;case"PtgArea":m=J5(A[1][1],i,s),l.push(S1(m,s));break;case"PtgArea3d":p=A[1][1],m=A[1][2],b=_w(n,p,s),l.push(b+"!"+S1(m,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=A[1][2];var B=(n.names||[])[x-1]||(n[0]||[])[x],R=B?B.Name:"SH33TJSNAME"+String(x);R&&R.slice(0,6)=="_xlfn."&&!s.xlfn&&(R=R.slice(6)),l.push(R);break;case"PtgNameX":var O=A[1][1];x=A[1][2];var ee;if(s.biff<=5)O<0&&(O=-O),n[O]&&(ee=n[O][x]);else{var I="";if(((n[O]||[])[0]||[])[0]==14849||(((n[O]||[])[0]||[])[0]==1025?n[O][x]&&n[O][x].itab>0&&(I=n.SheetNames[n[O][x].itab-1]+"!"):I=n.SheetNames[x-1]+"!"),n[O]&&n[O][x])I+=n[O][x].Name;else if(n[0]&&n[0][x])I+=n[0][x].Name;else{var P=(NS(n,O,s)||"").split(";;");P[x-1]?I=P[x-1]:I+="SH33TJSERRX"}l.push(I);break}ee||(ee={Name:"SH33TJSERRY"}),l.push(ee.Name);break;case"PtgParen":var ae="(",G=")";if(y>=0){switch(w="",t[0][y][1][0]){case 2:ae=ts(" ",t[0][y][1][1])+ae;break;case 3:ae=ts("\r",t[0][y][1][1])+ae;break;case 4:G=ts(" ",t[0][y][1][1])+G;break;case 5:G=ts("\r",t[0][y][1][1])+G;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}y=-1}l.push(ae+l.pop()+G);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":h={c:A[1][1],r:A[1][0]};var M={c:r.c,r:r.r};if(n.sharedf[fr(h)]){var te=n.sharedf[fr(h)];l.push(ka(te,i,M,n,s))}else{var ie=!1;for(c=0;c!=n.arrayf.length;++c)if(d=n.arrayf[c],!(h.c<d[0].s.c||h.c>d[0].e.c)&&!(h.r<d[0].s.r||h.r>d[0].e.r)){l.push(ka(d[1],i,M,n,s)),ie=!0;break}ie||l.push(A[1])}break;case"PtgArray":l.push("{"+gI(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var le=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&y>=0&&le.indexOf(t[0][S][0])==-1){A=t[0][y];var X=!0;switch(A[1][0]){case 4:X=!1;case 0:w=ts(" ",A[1][1]);break;case 5:X=!1;case 1:w=ts("\r",A[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}l.push((X?w:"")+l.pop()+(X?"":w)),y=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function bI(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],Da(t,e-2)];var l=Cp(t,i,r);return e!==i+s&&(a=Ap(t,e-i-s,l,r)),t.l=n,[l,a]}function wI(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],Da(t,e-2)];var l=Cp(t,i,r);return e!==i+s&&(a=Ap(t,e-i-s,l,r)),t.l=n,[l,a]}function _I(t,e,r,n){var s=t.l+e,a=Cp(t,n,r),i;return s!==t.l&&(i=Ap(t,s-t.l,a,r)),[a,i]}function NI(t,e,r){var n=t.l+e,s,a=t.read_shift(2),i=Cp(t,a,r);return a==65535?[[],Da(t,e-2)]:(e!==a+2&&(s=Ap(t,n-a-2,i,r)),[i,s])}function SI(t){var e;if(Nc(t,t.l+6)!==65535)return[Ca(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function kI(t){if(t==null){var e=st(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return lf(t);return lf(0)}function C1(t,e,r){var n=t.l+e,s=Ml(t);r.biff==2&&++t.l;var a=SI(t),i=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var l=wI(t,n-t.l,r);return{cell:s,val:a[0],formula:l,shared:i>>3&1,tt:a[1]}}function jI(t,e,r,n,s){var a=uf(e,r,s),i=kI(t.v),l=st(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var d=st(t.bf.length),h=0;h<t.bf.length;++h)d[h]=t.bf[h];var p=$s([a,i,l,d]);return p}function og(t,e,r){var n=t.read_shift(4),s=Cp(t,n,r),a=t.read_shift(4),i=a>0?Ap(t,a,s,r):null;return[s,i]}var EI=og,lg=og,AI=og,CI=og,TI={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},SS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FI={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Nw(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function PI(t){var e="of:="+t.replace(oy,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function T1(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function LI(t){return t.replace(/\./,"!")}var Ch={},m0={},Th=typeof Map<"u";function uy(t,e,r){var n=0,s=t.length;if(r){if(Th?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var a=Th?r.get(e):r[e];n<a.length;++n)if(t[a[n]].t===e)return t.Count++,a[n]}}else for(;n<s;++n)if(t[n].t===e)return t.Count++,n;return t[s]={t:e},t.Count++,t.Unique++,r&&(Th?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function cg(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Ea=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=tp(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Sx(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Zd(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function id(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],s=60,a=t.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Fl(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=n=s;break}}for(s=0;s!=a;++s)if(t[s].numFmtId===n)return s;return t[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function kS(t,e,r,n,s,a){try{n.cellNF&&(t.z=ar[e])}catch(l){if(n.WTF)throw l}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Dn(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ar[e]==null&&Fl(CT[e]||"General",e),t.t==="e")t.w=t.w||Bc[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Xh(t.v);else if(t.t==="d"){var i=Fs(t.v);(i|0)===i?t.w=i.toString(10):t.w=Xh(i)}else{if(t.v===void 0)return"";t.w=af(t.v,m0)}else t.t==="d"?t.w=Ii(e,Fs(t.v),m0):t.w=Ii(e,t.v,m0)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{t.s=a.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Nx(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Nx(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&a.Fills)throw l}}}function DI(t,e,r){if(t&&t["!ref"]){var n=Dr(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function RI(t,e){var r=Dr(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Nr(r))}var II=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,OI=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,MI=/<(?:\w:)?hyperlink [^>]*>/mg,BI=/"(\w*:\w*)"/,UI=/<(?:\w:)?col\b[^>]*[\/]?>/g,zI=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,HI=/<(?:\w:)?pageMargins[^>]*\/>/g,jS=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,$I=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,WI=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function VI(t,e,r,n,s,a,i){if(!t)return t;n||(n={"!id":{}});var l=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",h="",p=t.match(OI);p?(d=t.slice(0,p.index),h=t.slice(p.index+p[0].length)):d=h=t;var x=d.match(jS);x?dy(x[0],l,s,r):(x=d.match($I))&&GI(x[0],x[1]||"",l,s,r);var m=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var b=d.slice(m,m+50).match(BI);b&&RI(l,b[1])}var y=d.match(WI);y&&y[1]&&iO(y[1],s);var w=[];if(e.cellStyles){var S=d.match(UI);S&&tO(w,S)}p&&cO(p[1],l,e,c,a,i);var k=h.match(zI);k&&(l["!autofilter"]=nO(k[0]));var A=[],z=h.match(II);if(z)for(m=0;m!=z.length;++m)A[m]=Dr(z[m].slice(z[m].indexOf('"')+1));var H=h.match(MI);H&&QI(l,H,n);var V=h.match(HI);if(V&&(l["!margins"]=ZI(xr(V[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Nr(c)),e.sheetRows>0&&l["!ref"]){var B=Dr(l["!ref"]);e.sheetRows<=+B.e.r&&(B.e.r=e.sheetRows-1,B.e.r>c.e.r&&(B.e.r=c.e.r),B.e.r<B.s.r&&(B.s.r=B.e.r),B.e.c>c.e.c&&(B.e.c=c.e.c),B.e.c<B.s.c&&(B.s.c=B.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Nr(B))}return w.length>0&&(l["!cols"]=w),A.length>0&&(l["!merges"]=A),l}function qI(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Nr(t[r])+'"/>';return e+"</mergeCells>"}function dy(t,e,r,n){var s=xr(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Wr(fn(s.codeName)))}function GI(t,e,r,n,s){dy(t.slice(0,t.indexOf(">")),r,n,s)}function XI(t,e,r,n,s){var a=!1,i={},l=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=Cl(un(c))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),l=(l||"")+St("outlinePr",null,d)}!a&&!l||(s[s.length]=St("sheetPr",l,i))}var YI=["objects","scenarios","selectLockedCells","selectUnlockedCells"],KI=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function JI(t){var e={sheet:1};return YI.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),KI.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=sy(t.password).toString(16).toUpperCase()),St("sheetProtection",null,e)}function QI(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var a=xr(fn(e[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+Wr(a.location))):(a.Target="#"+Wr(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var l=Dr(a.ref),c=l.s.r;c<=l.e.r;++c)for(var d=l.s.c;d<=l.e.c;++d){var h=fr({c:d,r:c});n?(t[c]||(t[c]=[]),t[c][d]||(t[c][d]={t:"z",v:void 0}),t[c][d].l=a):(t[h]||(t[h]={t:"z",v:void 0}),t[h].l=a)}}}function ZI(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function eO(t){return Zd(t),St("pageMargins",null,t)}function tO(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=xr(e[n],!0);s.hidden&&(s.hidden=Cn(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,ay(s.width)),Ku(s);a<=i;)t[a++]=vn(s)}}function rO(t,e){for(var r=["<cols>"],n,s=0;s!=e.length;++s)(n=e[s])&&(r[r.length]=St("col",null,cg(s,n)));return r[r.length]="</cols>",r.join("")}function nO(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function sO(t,e,r,n){var s=typeof t.ref=="string"?t.ref:Nr(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=Ka(s);i.s.r==i.e.r&&(i.e.r=Ka(e["!ref"]).e.r,s=Nr(i));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),St("autoFilter",null,{ref:s})}var aO=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function iO(t,e){e.Views||(e.Views=[{}]),(t.match(aO)||[]).forEach(function(r,n){var s=xr(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),Cn(s.rightToLeft)&&(e.Views[n].RTL=!0)})}function oO(t,e,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),St("sheetViews",St("sheetView",null,s),{})}function lO(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",a=t.t,i=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=Bc[t.v];break;case"d":n&&n.cellDates?s=Dn(t.v,-1).toISOString():(t=vn(t),t.t="n",s=""+(t.v=Fs(Dn(t.v)))),typeof t.z>"u"&&(t.z=ar[14]);break;default:s=t.v;break}var l=aa("v",un(s)),c={r:e},d=id(n.cellXfs,t,n);switch(d!==0&&(c.s=d),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=aa("v",""+uy(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=a&&(t.t=a,t.v=i),typeof t.f=="string"&&t.f){var h=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;l=St("f",un(t.f),h)+(t.v!=null?l:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),St("c",l,c)}var cO=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=Yh("v"),i=Yh("f");return function(c,d,h,p,x,m){for(var b=0,y="",w=[],S=[],k=0,A=0,z=0,H="",V,B,R=0,O=0,ee,I,P=0,ae=0,G=Array.isArray(m.CellXf),M,te=[],ie=[],le=Array.isArray(d),X=[],fe={},K=!1,E=!!h.sheetStubs,W=c.split(e),L=0,F=W.length;L!=F;++L){y=W[L].trim();var q=y.length;if(q!==0){var he=0;e:for(b=0;b<q;++b)switch(y[b]){case">":if(y[b-1]!="/"){++b;break e}if(h&&h.cellStyles){if(B=xr(y.slice(he,b),!0),R=B.r!=null?parseInt(B.r,10):R+1,O=-1,h.sheetRows&&h.sheetRows<R)continue;fe={},K=!1,B.ht&&(K=!0,fe.hpt=parseFloat(B.ht),fe.hpx=k0(fe.hpt)),B.hidden=="1"&&(K=!0,fe.hidden=!0),B.outlineLevel!=null&&(K=!0,fe.level=+B.outlineLevel),K&&(X[R-1]=fe)}break;case"<":he=b;break}if(he>=b)break;if(B=xr(y.slice(he,b),!0),R=B.r!=null?parseInt(B.r,10):R+1,O=-1,!(h.sheetRows&&h.sheetRows<R)){p.s.r>R-1&&(p.s.r=R-1),p.e.r<R-1&&(p.e.r=R-1),h&&h.cellStyles&&(fe={},K=!1,B.ht&&(K=!0,fe.hpt=parseFloat(B.ht),fe.hpx=k0(fe.hpt)),B.hidden=="1"&&(K=!0,fe.hidden=!0),B.outlineLevel!=null&&(K=!0,fe.level=+B.outlineLevel),K&&(X[R-1]=fe)),w=y.slice(b).split(t);for(var me=0;me!=w.length&&w[me].trim().charAt(0)=="<";++me);for(w=w.slice(me),b=0;b!=w.length;++b)if(y=w[b].trim(),y.length!==0){if(S=y.match(r),k=b,A=0,z=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,S!=null&&S.length===2){for(k=0,H=S[1],A=0;A!=H.length&&!((z=H.charCodeAt(A)-64)<1||z>26);++A)k=26*k+z;--k,O=k}else++O;for(A=0;A!=y.length&&y.charCodeAt(A)!==62;++A);if(++A,B=xr(y.slice(0,A),!0),B.r||(B.r=fr({r:R-1,c:O})),H=y.slice(A),V={t:""},(S=H.match(a))!=null&&S[1]!==""&&(V.v=Wr(S[1])),h.cellFormula){if((S=H.match(i))!=null&&S[1]!==""){if(V.f=Wr(fn(S[1])).replace(/\r\n/g,`
`),h.xlfn||(V.f=yw(V.f)),S[0].indexOf('t="array"')>-1)V.F=(H.match(s)||[])[1],V.F.indexOf(":")>-1&&te.push([Dr(V.F),V.F]);else if(S[0].indexOf('t="shared"')>-1){I=xr(S[0]);var Z=Wr(fn(S[1]));h.xlfn||(Z=yw(Z)),ie[parseInt(I.si,10)]=[I,Z,B.r]}}else(S=H.match(/<f[^>]*\/>/))&&(I=xr(S[0]),ie[I.si]&&(V.f=aR(ie[I.si][1],ie[I.si][2],B.r)));var Se=Gn(B.r);for(A=0;A<te.length;++A)Se.r>=te[A][0].s.r&&Se.r<=te[A][0].e.r&&Se.c>=te[A][0].s.c&&Se.c<=te[A][0].e.c&&(V.F=te[A][1])}if(B.t==null&&V.v===void 0)if(V.f||V.F)V.v=0,V.t="n";else if(E)V.t="z";else continue;else V.t=B.t||"n";switch(p.s.c>O&&(p.s.c=O),p.e.c<O&&(p.e.c=O),V.t){case"n":if(V.v==""||V.v==null){if(!E)continue;V.t="z"}else V.v=parseFloat(V.v);break;case"s":if(typeof V.v>"u"){if(!E)continue;V.t="z"}else ee=Ch[parseInt(V.v,10)],V.v=ee.t,V.r=ee.r,h.cellHTML&&(V.h=ee.h);break;case"str":V.t="s",V.v=V.v!=null?fn(V.v):"",h.cellHTML&&(V.h=Bv(V.v));break;case"inlineStr":S=H.match(n),V.t="s",S!=null&&(ee=ny(S[1]))?(V.v=ee.t,h.cellHTML&&(V.h=ee.h)):V.v="";break;case"b":V.v=Cn(V.v);break;case"d":h.cellDates?V.v=Dn(V.v,1):(V.v=Fs(Dn(V.v,1)),V.t="n");break;case"e":(!h||h.cellText!==!1)&&(V.w=V.v),V.v=AN[V.v];break}if(P=ae=0,M=null,G&&B.s!==void 0&&(M=m.CellXf[B.s],M!=null&&(M.numFmtId!=null&&(P=M.numFmtId),h.cellStyles&&M.fillId!=null&&(ae=M.fillId))),kS(V,P,ae,h,x,m),h.cellDates&&G&&V.t=="n"&&pf(ar[P])&&(V.t="d",V.v=sg(V.v)),B.cm&&h.xlmeta){var We=(h.xlmeta.Cell||[])[+B.cm-1];We&&We.type=="XLDAPR"&&(V.D=!0)}if(le){var ue=Gn(B.r);d[ue.r]||(d[ue.r]=[]),d[ue.r][ue.c]=V}else d[B.r]=V}}}}X.length>0&&(d["!rows"]=X)}})();function uO(t,e,r,n){var s=[],a=[],i=Dr(t["!ref"]),l="",c,d="",h=[],p=0,x=0,m=t["!rows"],b=Array.isArray(t),y={r:d},w,S=-1;for(x=i.s.c;x<=i.e.c;++x)h[x]=Pn(x);for(p=i.s.r;p<=i.e.r;++p){for(a=[],d=ns(p),x=i.s.c;x<=i.e.c;++x){c=h[x]+d;var k=b?(t[p]||[])[x]:t[c];k!==void 0&&(l=lO(k,c,t,e))!=null&&a.push(l)}(a.length>0||m&&m[p])&&(y={r:d},m&&m[p]&&(w=m[p],w.hidden&&(y.hidden=1),S=-1,w.hpx?S=rp(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(y.ht=S,y.customHeight=1),w.level&&(y.outlineLevel=w.level)),s[s.length]=St("row",a.join(""),y))}if(m)for(;p<m.length;++p)m&&m[p]&&(y={r:p+1},w=m[p],w.hidden&&(y.hidden=1),S=-1,w.hpx?S=rp(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(y.ht=S,y.customHeight=1),w.level&&(y.outlineLevel=w.level),s[s.length]=St("row","",y));return s.join("")}function ES(t,e,r,n){var s=[vs,St("worksheet",null,{xmlns:mf[0],"xmlns:r":Cs.r})],a=r.SheetNames[t],i=0,l="",c=r.Sheets[a];c==null&&(c={});var d=c["!ref"]||"A1",h=Dr(d);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),d=Nr(h)}n||(n={}),c["!comments"]=[];var p=[];XI(c,r,t,e,s),s[s.length]=St("dimension",null,{ref:d}),s[s.length]=oO(c,e,t,r),e.sheetFormat&&(s[s.length]=St("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=rO(c,c["!cols"])),s[i=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=uO(c,e),l.length>0&&(s[s.length]=l)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),c["!protect"]&&(s[s.length]=JI(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=sO(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=qI(c["!merges"]));var x=-1,m,b=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(y){y[1].Target&&(m={ref:y[0]},y[1].Target.charAt(0)!="#"&&(b=ln(n,-1,un(y[1].Target).replace(/#.*$/,""),Tr.HLINK),m["r:id"]="rId"+b),(x=y[1].Target.indexOf("#"))>-1&&(m.location=un(y[1].Target.slice(x+1))),y[1].Tooltip&&(m.tooltip=un(y[1].Tooltip)),s[s.length]=St("hyperlink",null,m))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=eO(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=aa("ignoredErrors",St("ignoredError",null,{numberStoredAsText:1,sqref:d}))),p.length>0&&(b=ln(n,-1,"../drawings/drawing"+(t+1)+".xml",Tr.DRAW),s[s.length]=St("drawing",null,{"r:id":"rId"+b}),c["!drawing"]=p),c["!comments"].length>0&&(b=ln(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Tr.VML),s[s.length]=St("legacyDrawing",null,{"r:id":"rId"+b}),c["!legacy"]=b),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function dO(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function fO(t,e,r){var n=st(145),s=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var a=320;s.hpx?a=rp(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var d={r:t,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var p=-1,x=-1,m=h<<10;m<h+1<<10;++m){d.c=m;var b=Array.isArray(r)?(r[d.r]||[])[d.c]:r[fr(d)];b&&(p<0&&(p=m),x=m)}p<0||(++l,n.write_shift(4,p),n.write_shift(4,x))}var y=n.l;return n.l=c,n.write_shift(4,l),n.l=y,n.length>n.l?n.slice(0,n.l):n}function hO(t,e,r,n){var s=fO(n,r,e);(s.length>17||(e["!rows"]||[])[n])&&ct(t,0,s)}var pO=yf,mO=I0;function xO(){}function gO(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=bF(t),r}function vO(t,e,r){r==null&&(r=st(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return bx({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),NN(t,r),r.slice(0,r.l)}function yO(t){var e=go(t);return[e]}function bO(t,e,r){return r==null&&(r=st(8)),xf(e,r)}function wO(t){var e=gf(t);return[e]}function _O(t,e,r){return r==null&&(r=st(4)),vf(e,r)}function NO(t){var e=go(t),r=t.read_shift(1);return[e,r,"b"]}function SO(t,e,r){return r==null&&(r=st(9)),xf(e,r),r.write_shift(1,t.v?1:0),r}function kO(t){var e=gf(t),r=t.read_shift(1);return[e,r,"b"]}function jO(t,e,r){return r==null&&(r=st(5)),vf(e,r),r.write_shift(1,t.v?1:0),r}function EO(t){var e=go(t),r=t.read_shift(1);return[e,r,"e"]}function AO(t,e,r){return r==null&&(r=st(9)),xf(e,r),r.write_shift(1,t.v),r}function CO(t){var e=gf(t),r=t.read_shift(1);return[e,r,"e"]}function TO(t,e,r){return r==null&&(r=st(8)),vf(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function FO(t){var e=go(t),r=t.read_shift(4);return[e,r,"s"]}function PO(t,e,r){return r==null&&(r=st(12)),xf(e,r),r.write_shift(4,e.v),r}function LO(t){var e=gf(t),r=t.read_shift(4);return[e,r,"s"]}function DO(t,e,r){return r==null&&(r=st(8)),vf(e,r),r.write_shift(4,e.v),r}function RO(t){var e=go(t),r=Ca(t);return[e,r,"n"]}function IO(t,e,r){return r==null&&(r=st(16)),xf(e,r),lf(t.v,r),r}function AS(t){var e=gf(t),r=Ca(t);return[e,r,"n"]}function OO(t,e,r){return r==null&&(r=st(12)),vf(e,r),lf(t.v,r),r}function MO(t){var e=go(t),r=Qv(t);return[e,r,"n"]}function BO(t,e,r){return r==null&&(r=st(12)),xf(e,r),SN(t.v,r),r}function UO(t){var e=gf(t),r=Qv(t);return[e,r,"n"]}function zO(t,e,r){return r==null&&(r=st(8)),vf(e,r),SN(t.v,r),r}function HO(t){var e=go(t),r=Yv(t);return[e,r,"is"]}function $O(t){var e=go(t),r=La(t);return[e,r,"str"]}function WO(t,e,r){return r==null&&(r=st(12+4*t.v.length)),xf(e,r),Vs(t.v,r),r.length>r.l?r.slice(0,r.l):r}function VO(t){var e=gf(t),r=La(t);return[e,r,"str"]}function qO(t,e,r){return r==null&&(r=st(8+4*t.v.length)),vf(e,r),Vs(t.v,r),r.length>r.l?r.slice(0,r.l):r}function GO(t,e,r){var n=t.l+e,s=go(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"b"];if(r.cellFormula){t.l+=2;var l=lg(t,n-t.l,r);i[3]=ka(l,null,s,r.supbooks,r)}else t.l=n;return i}function XO(t,e,r){var n=t.l+e,s=go(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"e"];if(r.cellFormula){t.l+=2;var l=lg(t,n-t.l,r);i[3]=ka(l,null,s,r.supbooks,r)}else t.l=n;return i}function YO(t,e,r){var n=t.l+e,s=go(t);s.r=r["!row"];var a=Ca(t),i=[s,a,"n"];if(r.cellFormula){t.l+=2;var l=lg(t,n-t.l,r);i[3]=ka(l,null,s,r.supbooks,r)}else t.l=n;return i}function KO(t,e,r){var n=t.l+e,s=go(t);s.r=r["!row"];var a=La(t),i=[s,a,"str"];if(r.cellFormula){t.l+=2;var l=lg(t,n-t.l,r);i[3]=ka(l,null,s,r.supbooks,r)}else t.l=n;return i}var JO=yf,QO=I0;function ZO(t,e){return e==null&&(e=st(4)),e.write_shift(4,t),e}function eM(t,e){var r=t.l+e,n=yf(t),s=Kv(t),a=La(t),i=La(t),l=La(t);t.l=r;var c={rfx:n,relId:s,loc:a,display:l};return i&&(c.Tooltip=i),c}function tM(t,e){var r=st(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));I0({s:Gn(t[0]),e:Gn(t[0])},r),Jv("rId"+e,r);var n=t[1].Target.indexOf("#"),s=n==-1?"":t[1].Target.slice(n+1);return Vs(s||"",r),Vs(t[1].Tooltip||"",r),Vs("",r),r.slice(0,r.l)}function rM(){}function nM(t,e,r){var n=t.l+e,s=kN(t),a=t.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var l=EI(t,n-t.l,r);i[1]=l}else t.l=n;return i}function sM(t,e,r){var n=t.l+e,s=yf(t),a=[s];if(r.cellFormula){var i=CI(t,n-t.l,r);a[1]=i,t.l=n}else t.l=n;return a}function aM(t,e,r){r==null&&(r=st(18));var n=cg(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var CS=["left","right","top","bottom","header","footer"];function iM(t){var e={};return CS.forEach(function(r){e[r]=Ca(t)}),e}function oM(t,e){return e==null&&(e=st(48)),Zd(t),CS.forEach(function(r){lf(t[r],e)}),e}function lM(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function cM(t,e,r){r==null&&(r=st(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function uM(t){var e=st(24);return e.write_shift(4,4),e.write_shift(4,1),I0(t,e),e}function dM(t,e){return e==null&&(e=st(66)),e.write_shift(2,t.password?sy(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function fM(){}function hM(){}function pM(t,e,r,n,s,a,i){if(!t)return t;var l=e||{};n||(n={"!id":{}});var c=l.dense?[]:{},d,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,x=!1,m,b,y,w,S,k,A,z,H,V=[];l.biff=12,l["!row"]=0;var B=0,R=!1,O=[],ee={},I=l.supbooks||s.supbooks||[[]];if(I.sharedf=ee,I.arrayf=O,I.SheetNames=s.SheetNames||s.Sheets.map(function(le){return le.name}),!l.supbooks&&(l.supbooks=I,s.Names))for(var P=0;P<s.Names.length;++P)I[0][P+1]=s.Names[P];var ae=[],G=[],M=!1;np[16]={n:"BrtShortReal",f:AS};var te;if(Mc(t,function(X,fe,K){if(!x)switch(K){case 148:d=X;break;case 0:m=X,l.sheetRows&&l.sheetRows<=m.r&&(x=!0),z=ns(w=m.r),l["!row"]=m.r,(X.hidden||X.hpt||X.level!=null)&&(X.hpt&&(X.hpx=k0(X.hpt)),G[X.r]=X);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:X[2]},X[2]){case"n":b.v=X[1];break;case"s":A=Ch[X[1]],b.v=A.t,b.r=A.r;break;case"b":b.v=!!X[1];break;case"e":b.v=X[1],l.cellText!==!1&&(b.w=Bc[b.v]);break;case"str":b.t="s",b.v=X[1];break;case"is":b.t="s",b.v=X[1].t;break}if((y=i.CellXf[X[0].iStyleRef])&&kS(b,y.numFmtId,null,l,a,i),S=X[0].c==-1?S+1:X[0].c,l.dense?(c[w]||(c[w]=[]),c[w][S]=b):c[Pn(S)+z]=b,l.cellFormula){for(R=!1,B=0;B<O.length;++B){var E=O[B];m.r>=E[0].s.r&&m.r<=E[0].e.r&&S>=E[0].s.c&&S<=E[0].e.c&&(b.F=Nr(E[0]),R=!0)}!R&&X.length>3&&(b.f=X[3])}if(h.s.r>m.r&&(h.s.r=m.r),h.s.c>S&&(h.s.c=S),h.e.r<m.r&&(h.e.r=m.r),h.e.c<S&&(h.e.c=S),l.cellDates&&y&&b.t=="n"&&pf(ar[y.numFmtId])){var W=Iu(b.v);W&&(b.t="d",b.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}te&&(te.type=="XLDAPR"&&(b.D=!0),te=void 0);break;case 1:case 12:if(!l.sheetStubs||p)break;b={t:"z",v:void 0},S=X[0].c==-1?S+1:X[0].c,l.dense?(c[w]||(c[w]=[]),c[w][S]=b):c[Pn(S)+z]=b,h.s.r>m.r&&(h.s.r=m.r),h.s.c>S&&(h.s.c=S),h.e.r<m.r&&(h.e.r=m.r),h.e.c<S&&(h.e.c=S),te&&(te.type=="XLDAPR"&&(b.D=!0),te=void 0);break;case 176:V.push(X);break;case 49:te=((l.xlmeta||{}).Cell||[])[X-1];break;case 494:var L=n["!id"][X.relId];for(L?(X.Target=L.Target,X.loc&&(X.Target+="#"+X.loc),X.Rel=L):X.relId==""&&(X.Target="#"+X.loc),w=X.rfx.s.r;w<=X.rfx.e.r;++w)for(S=X.rfx.s.c;S<=X.rfx.e.c;++S)l.dense?(c[w]||(c[w]=[]),c[w][S]||(c[w][S]={t:"z",v:void 0}),c[w][S].l=X):(k=fr({c:S,r:w}),c[k]||(c[k]={t:"z",v:void 0}),c[k].l=X);break;case 426:if(!l.cellFormula)break;O.push(X),H=l.dense?c[w][S]:c[Pn(S)+z],H.f=ka(X[1],h,{r:m.r,c:S},I,l),H.F=Nr(X[0]);break;case 427:if(!l.cellFormula)break;ee[fr(X[0].s)]=X[1],H=l.dense?c[w][S]:c[Pn(S)+z],H.f=ka(X[1],h,{r:m.r,c:S},I,l);break;case 60:if(!l.cellStyles)break;for(;X.e>=X.s;)ae[X.e--]={width:X.w/256,hidden:!!(X.flags&1),level:X.level},M||(M=!0,ay(X.w/256)),Ku(ae[X.e+1]);break;case 161:c["!autofilter"]={ref:Nr(X)};break;case 476:c["!margins"]=X;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),X.name&&(s.Sheets[r].CodeName=X.name),(X.above||X.left)&&(c["!outline"]={above:X.above,left:X.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),X.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!fe.T){if(!p||l.WTF)throw new Error("Unexpected record 0x"+K.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(h.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=Nr(d||h)),l.sheetRows&&c["!ref"]){var ie=Dr(c["!ref"]);l.sheetRows<=+ie.e.r&&(ie.e.r=l.sheetRows-1,ie.e.r>h.e.r&&(ie.e.r=h.e.r),ie.e.r<ie.s.r&&(ie.s.r=ie.e.r),ie.e.c>h.e.c&&(ie.e.c=h.e.c),ie.e.c<ie.s.c&&(ie.s.c=ie.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Nr(ie))}return V.length>0&&(c["!merges"]=V),ae.length>0&&(c["!cols"]=ae),G.length>0&&(c["!rows"]=G),c}function mM(t,e,r,n,s,a,i){if(e.v===void 0)return!1;var l="";switch(e.t){case"b":l=e.v?"1":"0";break;case"d":e=vn(e),e.z=e.z||ar[14],e.v=Fs(Dn(e.v)),e.t="n";break;case"n":case"e":l=""+e.v;break;default:l=e.v;break}var c={r,c:n};switch(c.s=id(s.cellXfs,e,s),e.l&&a["!links"].push([fr(c),e.l]),e.c&&a["!comments"].push([fr(c),e.c]),e.t){case"s":case"str":return s.bookSST?(l=uy(s.Strings,e.v,s.revStrings),c.t="s",c.v=l,i?ct(t,18,DO(e,c)):ct(t,7,PO(e,c))):(c.t="str",i?ct(t,17,qO(e,c)):ct(t,6,WO(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?i?ct(t,13,zO(e,c)):ct(t,2,BO(e,c)):i?ct(t,16,OO(e,c)):ct(t,5,IO(e,c)),!0;case"b":return c.t="b",i?ct(t,15,jO(e,c)):ct(t,4,SO(e,c)),!0;case"e":return c.t="e",i?ct(t,14,TO(e,c)):ct(t,3,AO(e,c)),!0}return i?ct(t,12,_O(e,c)):ct(t,1,bO(e,c)),!0}function xM(t,e,r,n){var s=Dr(e["!ref"]||"A1"),a,i="",l=[];ct(t,145);var c=Array.isArray(e),d=s.e.r;e["!rows"]&&(d=Math.max(s.e.r,e["!rows"].length-1));for(var h=s.s.r;h<=d;++h){i=ns(h),hO(t,e,s,h);var p=!1;if(h<=s.e.r)for(var x=s.s.c;x<=s.e.c;++x){h===s.s.r&&(l[x]=Pn(x)),a=l[x]+i;var m=c?(e[h]||[])[x]:e[a];if(!m){p=!1;continue}p=mM(t,m,h,x,n,e,p)}}ct(t,146)}function gM(t,e){!e||!e["!merges"]||(ct(t,177,ZO(e["!merges"].length)),e["!merges"].forEach(function(r){ct(t,176,QO(r))}),ct(t,178))}function vM(t,e){!e||!e["!cols"]||(ct(t,390),e["!cols"].forEach(function(r,n){r&&ct(t,60,aM(n,r))}),ct(t,391))}function yM(t,e){!e||!e["!ref"]||(ct(t,648),ct(t,649,uM(Dr(e["!ref"]))),ct(t,650))}function bM(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var s=ln(r,-1,n[1].Target.replace(/#.*$/,""),Tr.HLINK);ct(t,494,tM(n,s))}}),delete e["!links"]}function wM(t,e,r,n){if(e["!comments"].length>0){var s=ln(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Tr.VML);ct(t,551,Jv("rId"+s)),e["!legacy"]=s}}function _M(t,e,r,n){if(e["!autofilter"]){var s=e["!autofilter"],a=typeof s.ref=="string"?s.ref:Nr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=Ka(a);l.s.r==l.e.r&&(l.e.r=Ka(e["!ref"]).e.r,a=Nr(l));for(var c=0;c<i.length;++c){var d=i[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),ct(t,161,I0(Dr(a))),ct(t,162)}}function NM(t,e,r){ct(t,133),ct(t,137,cM(e,r)),ct(t,138),ct(t,134)}function SM(t,e){e["!protect"]&&ct(t,535,dM(e["!protect"]))}function kM(t,e,r,n){var s=xi(),a=r.SheetNames[t],i=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch{}var c=Dr(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],ct(s,129),(r.vbaraw||i["!outline"])&&ct(s,147,vO(l,i["!outline"])),ct(s,148,mO(c)),NM(s,i,r.Workbook),vM(s,i),xM(s,i,t,e),SM(s,i),_M(s,i,r,t),gM(s,i),bM(s,i,n),i["!margins"]&&ct(s,476,oM(i["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&yM(s,i),wM(s,i,t,n),ct(s,130),s.end()}function jM(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(e[+i[1]]=r?+i[2]:i[2])});var s=Wr((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[e,s,n]}function EM(t,e,r,n,s,a){var i=a||{"!type":"chart"};if(!t)return a;var l=0,c=0,d="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var x=jM(p);h.s.r=h.s.c=0,h.e.c=l,d=Pn(l),x[0].forEach(function(m,b){i[d+ns(b)]={t:"n",v:m,z:x[1]},c=b}),h.e.r<c&&(h.e.r=c),++l}),l>0&&(i["!ref"]=Nr(h)),i}function AM(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,l=t.match(jS);return l&&dy(l[0],a,s,r),(i=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function CM(t,e){t.l+=10;var r=La(t);return{name:r}}function TM(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Mc(t,function(c,d,h){switch(h){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!i||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},e),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var fy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],FM=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],PM=[],LM=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Sw(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var a=e[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Cn(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function kw(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Cn(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function TS(t){kw(t.WBProps,fy),kw(t.CalcPr,LM),Sw(t.WBView,FM),Sw(t.Sheets,PM),m0.date1904=Cn(t.WBProps.date1904)}function DM(t){return!t.Workbook||!t.Workbook.WBProps?"false":Cn(t.Workbook.WBProps.date1904)?"true":"false"}var RM="][*?/\\".split("");function FS(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return RM.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function IM(t,e,r){t.forEach(function(n,s){FS(n);for(var a=0;a<s;++a)if(n==t[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=e&&e[s]&&e[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function PS(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];IM(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)DI(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var OM=/<\w+:workbook/;function MM(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(t.replace(Ia,function(c,d){var h=xr(c);switch(Ol(h[0])){case"<?xml":break;case"<workbook":c.match(OM)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=h[s];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":fy.forEach(function(p){if(h[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=Cn(h[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(h[p[0]],10);break;default:r.WBProps[p[0]]=h[p[0]]}}),h.codeName&&(r.WBProps.CodeName=fn(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=Wr(fn(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=fn(h.name),h.comment&&(a.Comment=h.comment),h.localSheetId&&(a.Sheet=+h.localSheetId),Cn(h.hidden||"0")&&(a.Hidden=!0),i=d+c.length;break;case"</definedName>":a.Ref=Wr(fn(t.slice(i,d))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return c}),mf.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return TS(r),r}function LS(t){var e=[vs];e[e.length]=St("workbook",null,{xmlns:mf[0],"xmlns:r":Cs.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(fy.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=St("workbookPr",null,n);var s=t.Workbook&&t.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",a=0;a!=t.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==t.SheetNames.length&&(a=0),e[e.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",a=0;a!=t.SheetNames.length;++a){var i={name:un(t.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}e[e.length]=St("sheet",null,i)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(e[e.length]=St("definedName",un(l.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function BM(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=P2(t),r.name=La(t),r}function UM(t,e){return e||(e=st(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Jv(t.strRelID,e),Vs(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function zM(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?La(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function HM(t,e){e||(e=st(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),NN(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function $M(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function WM(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),a=wF(t),i=AI(t,0,r),l=Kv(t);t.l=n;var c={Name:a,Ptg:i};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function VM(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],np[16]={n:"BrtFRTArchID$",f:$M},Mc(t,function(c,d,h){switch(h){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=ka(c.Ptg,null,null,i,e),delete e.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([h,c]):i[0]=[h,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(h),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},e),TS(r),r.Names=a,r.supbooks=i,r}function qM(t,e){ct(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};ct(t,156,UM(s))}ct(t,144)}function GM(t,e){e||(e=st(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Vs("SheetJS",e),Vs(qh.version,e),Vs(qh.version,e),Vs("7262",e),e.length>e.l?e.slice(0,e.l):e}function XM(t,e){e||(e=st(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function YM(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(ct(t,135),ct(t,158,XM(s)),ct(t,136))}}function KM(t,e){var r=xi();return ct(r,131),ct(r,128,GM()),ct(r,153,HM(t.Workbook&&t.Workbook.WBProps||null)),YM(r,t),qM(r,t),ct(r,132),r.end()}function JM(t,e,r){return e.slice(-4)===".bin"?VM(t,r):MM(t,r)}function QM(t,e,r,n,s,a,i,l){return e.slice(-4)===".bin"?pM(t,n,r,s,a,i,l):VI(t,n,r,s,a,i,l)}function ZM(t,e,r,n,s,a,i,l){return e.slice(-4)===".bin"?TM(t,n,r,s,a):AM(t,n,r,s,a)}function e9(t,e,r,n,s,a,i,l){return e.slice(-4)===".bin"?nR():sR()}function t9(t,e,r,n,s,a,i,l){return e.slice(-4)===".bin"?tR():rR()}function r9(t,e,r,n){return e.slice(-4)===".bin"?QL(t,r,n):UL(t,r,n)}function n9(t,e,r){return fS(t,r)}function s9(t,e,r){return e.slice(-4)===".bin"?aL(t,r):rL(t,r)}function a9(t,e,r){return e.slice(-4)===".bin"?KD(t,r):zD(t,r)}function i9(t,e,r){return e.slice(-4)===".bin"?MD(t):ID(t)}function o9(t,e,r,n){return r.slice(-4)===".bin"?BD(t,e,r,n):void 0}function l9(t,e,r){return e.slice(-4)===".bin"?LD(t,e,r):RD(t,e,r)}function c9(t,e,r){return(e.slice(-4)===".bin"?KM:LS)(t)}function u9(t,e,r,n,s){return(e.slice(-4)===".bin"?kM:ES)(t,r,n,s)}function d9(t,e,r){return(e.slice(-4)===".bin"?lD:uS)(t,r)}function f9(t,e,r){return(e.slice(-4)===".bin"?lL:rS)(t,r)}function h9(t,e,r){return(e.slice(-4)===".bin"?JD:mS)(t)}function p9(t){return(t.slice(-4)===".bin"?DD:hS)()}var DS=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,RS=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Bo(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(DS),a,i,l,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(RS),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(i+1),n[l]=a[2].slice(1,a[2].length-1));return n}function m9(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(DS),s,a,i,l;if(n)for(l=0;l!=n.length;++l)s=n[l].match(RS),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var Fh;function x9(t,e){var r=Fh[t]||Wr(t);return r==="General"?af(e):Ii(r,e)}function g9(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Cn(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Dn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Wr(e)]=s}function v9(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Bc[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Xh(t.v):t.w=af(t.v):t.w=x9(e||"General",t.v)}catch(a){if(r.WTF)throw a}try{var n=Fh[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&pf(n)){var s=Iu(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function y9(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=PL[n.Pattern]||n.Pattern)}t[e.ID]=e}function b9(t,e,r,n,s,a,i,l,c,d){var h="General",p=n.StyleID,x={};d=d||{};var m=[],b=0;for(p===void 0&&l&&(p=l.StyleID),p===void 0&&i&&(p=i.StyleID);a[p]!==void 0&&(a[p].nf&&(h=a[p].nf),a[p].Interior&&m.push(a[p].Interior),!!a[p].Parent);)p=a[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Cn(t);break;case"String":n.t="s",n.r=H5(Wr(t)),n.v=t.indexOf("<")>-1?Wr(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Dn(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Wr(t):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=AN[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=H5(e||t));break}if(v9(n,h,d),d.cellFormula!==!1)if(n.Formula){var y=Wr(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=p0(y,s),delete n.Formula,n.ArrayRange=="RC"?n.F=p0("RC:RC",s):n.ArrayRange&&(n.F=p0(n.ArrayRange,s),c.push([Dr(n.F),n.F]))}else for(b=0;b<c.length;++b)s.r>=c[b][0].s.r&&s.r<=c[b][0].e.r&&s.c>=c[b][0].s.c&&s.c<=c[b][0].e.c&&(n.F=c[b][1]);d.cellStyles&&(m.forEach(function(w){!x.patternType&&w.patternType&&(x.patternType=w.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function w9(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function F1(t,e){var r=e||{};L0();var n=o0(Uv(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof Br<"u"?n=Br.utils.decode(65001,hx(n)):n=fn(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=vn(r);return i.type="string",S0.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Re){s.indexOf("<"+Re)>=0&&(a=!0)}),a)return nB(n,r);Fh={"General Number":"General","General Date":ar[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ar[15],"Short Date":ar[14],"Long Time":ar[19],"Medium Time":ar[18],"Short Time":ar[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ar[2],Standard:ar[4],Percent:ar[10],Scientific:ar[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],d,h={},p=[],x=r.dense?[]:{},m="",b={},y={},w=Bo('<Data ss:Type="String">'),S=0,k=0,A=0,z={s:{r:2e6,c:2e6},e:{r:0,c:0}},H={},V={},B="",R=0,O=[],ee={},I={},P=0,ae=[],G=[],M={},te=[],ie,le=!1,X=[],fe=[],K={},E=0,W=0,L={Sheets:[],WBProps:{date1904:!1}},F={};Jh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var q="";l=Jh.exec(n);)switch(l[3]=(q=l[3]).toLowerCase()){case"data":if(q=="data"){if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?b9(n.slice(S,l.index),B,w,c[c.length-1][0]=="comment"?M:b,{c:k,r:A},H,te[k],y,X,r):(B="",w=Bo(l[0]),S=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(G.length>0&&(b.c=G),(!r.sheetRows||r.sheetRows>A)&&b.v!==void 0&&(r.dense?(x[A]||(x[A]=[]),x[A][k]=b):x[Pn(k)+ns(A)]=b),b.HRef&&(b.l={Target:Wr(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(E=k+(parseInt(b.MergeAcross,10)|0),W=A+(parseInt(b.MergeDown,10)|0),O.push({s:{c:k,r:A},e:{c:E,r:W}})),!r.sheetStubs)b.MergeAcross?k=E+1:++k;else if(b.MergeAcross||b.MergeDown){for(var he=k;he<=E;++he)for(var me=A;me<=W;++me)(he>k||me>A)&&(r.dense?(x[me]||(x[me]=[]),x[me][he]={t:"z"}):x[Pn(he)+ns(me)]={t:"z"});k=E+1}else++k;else b=m9(l[0]),b.Index&&(k=+b.Index-1),k<z.s.c&&(z.s.c=k),k>z.e.c&&(z.e.c=k),l[0].slice(-2)==="/>"&&++k,G=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(A<z.s.r&&(z.s.r=A),A>z.e.r&&(z.e.r=A),l[0].slice(-2)==="/>"&&(y=Bo(l[0]),y.Index&&(A=+y.Index-1)),k=0,++A):(y=Bo(l[0]),y.Index&&(A=+y.Index-1),K={},(y.AutoFitHeight=="0"||y.Height)&&(K.hpx=parseInt(y.Height,10),K.hpt=rp(K.hpx),fe[A]=K),y.Hidden=="1"&&(K.hidden=!0,fe[A]=K));break;case"worksheet":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));p.push(m),z.s.r<=z.e.r&&z.s.c<=z.e.c&&(x["!ref"]=Nr(z),r.sheetRows&&r.sheetRows<=z.e.r&&(x["!fullref"]=x["!ref"],z.e.r=r.sheetRows-1,x["!ref"]=Nr(z))),O.length&&(x["!merges"]=O),te.length>0&&(x["!cols"]=te),fe.length>0&&(x["!rows"]=fe),h[m]=x}else z={s:{r:2e6,c:2e6},e:{r:0,c:0}},A=k=0,c.push([l[3],!1]),d=Bo(l[0]),m=Wr(d.Name),x=r.dense?[]:{},O=[],X=[],fe=[],F={name:m,Hidden:0},L.Sheets.push(F);break;case"table":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),te=[],le=!1}break;case"style":l[1]==="/"?y9(H,V,r):V=Bo(l[0]);break;case"numberformat":V.nf=Wr(Bo(l[0]).Format||"General"),Fh[V.nf]&&(V.nf=Fh[V.nf]);for(var Z=0;Z!=392&&ar[Z]!=V.nf;++Z);if(Z==392){for(Z=57;Z!=392;++Z)if(ar[Z]==null){Fl(V.nf,Z);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ie=Bo(l[0]),ie.Hidden&&(ie.hidden=!0,delete ie.Hidden),ie.Width&&(ie.wpx=parseInt(ie.Width,10)),!le&&ie.wpx>10){le=!0,Ea=lS;for(var Se=0;Se<te.length;++Se)te[Se]&&Ku(te[Se])}le&&Ku(ie),te[ie.Index-1||te.length]=ie;for(var We=0;We<+ie.Span;++We)te[te.length]=vn(ie);break;case"namedrange":if(l[1]==="/")break;L.Names||(L.Names=[]);var ue=xr(l[0]),nt={Name:ue.Name,Ref:p0(ue.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&(nt.Sheet=L.Sheets.length-1),L.Names.push(nt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?B+=n.slice(R,l.index):R=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;V.Interior=Bo(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?qF(ee,q,n.slice(P,l.index)):P=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));w9(M),G.push(M)}else c.push([l[3],!1]),d=Bo(l[0]),M={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var rt=Bo(l[0]);x["!autofilter"]={ref:p0(rt.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return Tw(n,r);var De=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:De=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:De=!1}break;case"excelworkbook":switch(l[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:De=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:De=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(P,l.index)){case"SheetHidden":F.Hidden=1;break;case"SheetVeryHidden":F.Hidden=2;break}else P=l.index+l[0].length;break;case"header":x["!margins"]||Zd(x["!margins"]={},"xlml"),isNaN(+xr(l[0]).Margin)||(x["!margins"].header=+xr(l[0]).Margin);break;case"footer":x["!margins"]||Zd(x["!margins"]={},"xlml"),isNaN(+xr(l[0]).Margin)||(x["!margins"].footer=+xr(l[0]).Margin);break;case"pagemargins":var ve=xr(l[0]);x["!margins"]||Zd(x["!margins"]={},"xlml"),isNaN(+ve.Top)||(x["!margins"].top=+ve.Top),isNaN(+ve.Left)||(x["!margins"].left=+ve.Left),isNaN(+ve.Right)||(x["!margins"].right=+ve.Right),isNaN(+ve.Bottom)||(x["!margins"].bottom=+ve.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:De=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:De=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:De=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:De=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:De=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:De=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:De=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:De=!1}break;case"smarttags":break;default:De=!1;break}if(De||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?g9(I,q,ae,n.slice(P,l.index)):(ae=l,P=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var Xe={};return!r.bookSheets&&!r.bookProps&&(Xe.Sheets=h),Xe.SheetNames=p,Xe.Workbook=L,Xe.SSF=vn(ar),Xe.Props=ee,Xe.Custprops=I,Xe}function B2(t,e){switch(my(e=e||{}),e.type||"base64"){case"base64":return F1(Ri(t),e);case"binary":case"buffer":case"file":return F1(t,e);case"array":return F1(sd(t),e)}}function _9(t,e){var r=[];return t.Props&&r.push(GF(t.Props,e)),t.Custprops&&r.push(XF(t.Props,t.Custprops)),r.join("")}function N9(){return""}function S9(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,s){var a=[];a.push(St("NumberFormat",null,{"ss:Format":un(ar[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(St("Style",a.join(""),i))}),St("Styles",r.join(""))}function IS(t){return St("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+ly(t.Ref,{r:0,c:0})})}function k9(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var s=e[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(IS(s)))}return St("Names",r.join(""))}function j9(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var l=s[i];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(IS(l)))}return a.join("")}function E9(t,e,r,n){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push(St("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push(St("Footer",null,{"x:Margin":t["!margins"].footer})),s.push(St("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(St("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push(aa("ProtectContents","True")),t["!protect"].objects&&s.push(aa("ProtectObjects","True")),t["!protect"].scenarios&&s.push(aa("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push(aa("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push(aa("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){t["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":St("WorksheetOptions",s.join(""),{xmlns:Ci.x})}function A9(t){return t.map(function(e){var r=KT(e.t||""),n=St("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return St("Comment",n,{"ss:Author":e.a})}).join("")}function C9(t,e,r,n,s,a,i){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+un(ly(t.f,i))),t.F&&t.F.slice(0,e.length)==e){var c=Gn(t.F.slice(e.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=un(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=un(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],h=0;h!=d.length;++h)d[h].s.c!=i.c||d[h].s.r!=i.r||(d[h].e.c>d[h].s.c&&(l["ss:MergeAcross"]=d[h].e.c-d[h].s.c),d[h].e.r>d[h].s.r&&(l["ss:MergeDown"]=d[h].e.r-d[h].s.r));var p="",x="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",x=String(t.v);break;case"b":p="Boolean",x=t.v?"1":"0";break;case"e":p="Error",x=Bc[t.v];break;case"d":p="DateTime",x=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||ar[14]);break;case"s":p="String",x=YT(t.v||"");break}var m=id(n.cellXfs,t,n);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=i.c+1;var b=t.v!=null?x:"",y=t.t=="z"?"":'<Data ss:Type="'+p+'">'+b+"</Data>";return(t.c||[]).length>0&&(y+=A9(t.c)),St("Cell",y,l)}function T9(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=k0(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function F9(t,e,r,n){if(!t["!ref"])return"";var s=Dr(t["!ref"]),a=t["!merges"]||[],i=0,l=[];t["!cols"]&&t["!cols"].forEach(function(w,S){Ku(w);var k=!!w.width,A=cg(S,w),z={"ss:Index":S+1};k&&(z["ss:Width"]=ep(A.width)),w.hidden&&(z["ss:Hidden"]="1"),l.push(St("Column",null,z))});for(var c=Array.isArray(t),d=s.s.r;d<=s.e.r;++d){for(var h=[T9(d,(t["!rows"]||[])[d])],p=s.s.c;p<=s.e.c;++p){var x=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>p)&&!(a[i].s.r>d)&&!(a[i].e.c<p)&&!(a[i].e.r<d)){(a[i].s.c!=p||a[i].s.r!=d)&&(x=!0);break}if(!x){var m={r:d,c:p},b=fr(m),y=c?(t[d]||[])[p]:t[b];h.push(C9(y,b,t,e,r,n,m))}}h.push("</Row>"),h.length>2&&l.push(h.join(""))}return l.join("")}function P9(t,e,r){var n=[],s=r.SheetNames[t],a=r.Sheets[s],i=a?j9(a,e,t,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?F9(a,e,t,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(E9(a,e,t,r)),n.join("")}function L9(t,e){e||(e={}),t.SSF||(t.SSF=vn(ar)),t.SSF&&(L0(),Np(t.SSF),e.revssf=ng(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],id(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(_9(t,e)),r.push(N9()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(St("Worksheet",P9(n,e,t),{"ss:Name":un(t.SheetNames[n])}));return r[2]=S9(t,e),r[3]=k9(t),vs+St("Workbook",r.join(""),{xmlns:Ci.ss,"xmlns:o":Ci.o,"xmlns:x":Ci.x,"xmlns:ss":Ci.ss,"xmlns:dt":Ci.dt,"xmlns:html":Ci.html})}function D9(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=jF(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=EF(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var R9=[60,1084,2066,2165,2175];function I9(t,e,r,n,s){var a=n,i=[],l=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}i.push(l),r.l+=a;for(var c=Nc(r,r.l),d=U2[c],h=0;d!=null&&R9.indexOf(c)>-1;)a=Nc(r,r.l+2),h=r.l+4,c==2066?h+=4:(c==2165||c==2175)&&(h+=12),l=r.slice(h,r.l+4+a),i.push(l),r.l+=4+a,d=U2[c=Nc(r,r.l)];var p=$s(i);sa(p,0);var x=0;p.lens=[];for(var m=0;m<i.length;++m)p.lens.push(x),x+=i[m].length;if(p.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+p.length+" < "+n;return e.f(p,p.length,s)}function _l(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ar[n])}catch(a){if(e.WTF)throw a}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Bc[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Xh(t.v):t.w=af(t.v):t.w=Ii(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(a){if(e.WTF)throw a}if(e.cellDates&&n&&t.t=="n"&&pf(ar[n]||String(n))){var s=Iu(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Am(t,e,r){return{v:t,ixfe:e,t:r}}function O9(t,e){var r={opts:{}},n={},s=e.dense?[]:{},a={},i={},l=null,c=[],d="",h={},p,x="",m,b,y,w,S={},k=[],A,z,H=[],V=[],B={Sheets:[],WBProps:{date1904:!1},Views:[{}]},R={},O=function(bt){return bt<8?Kd[bt]:bt<64&&V[bt-8]||Kd[bt]},ee=function(bt,lt,tr){var ke=lt.XF.data;if(!(!ke||!ke.patternType||!tr||!tr.cellStyles)){lt.s={},lt.s.patternType=ke.patternType;var $t;($t=Zh(O(ke.icvFore)))&&(lt.s.fgColor={rgb:$t}),($t=Zh(O(ke.icvBack)))&&(lt.s.bgColor={rgb:$t})}},I=function(bt,lt,tr){if(!(K>1)&&!(tr.sheetRows&&bt.r>=tr.sheetRows)){if(tr.cellStyles&&lt.XF&&lt.XF.data&&ee(bt,lt,tr),delete lt.ixfe,delete lt.XF,p=bt,x=fr(bt),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),bt.r<i.s.r&&(i.s.r=bt.r),bt.c<i.s.c&&(i.s.c=bt.c),bt.r+1>i.e.r&&(i.e.r=bt.r+1),bt.c+1>i.e.c&&(i.e.c=bt.c+1),tr.cellFormula&&lt.f){for(var ke=0;ke<k.length;++ke)if(!(k[ke][0].s.c>bt.c||k[ke][0].s.r>bt.r)&&!(k[ke][0].e.c<bt.c||k[ke][0].e.r<bt.r)){lt.F=Nr(k[ke][0]),(k[ke][0].s.c!=bt.c||k[ke][0].s.r!=bt.r)&&delete lt.f,lt.f&&(lt.f=""+ka(k[ke][1],i,bt,X,P));break}}tr.dense?(s[bt.r]||(s[bt.r]=[]),s[bt.r][bt.c]=lt):s[x]=lt}},P={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(P.password=e.password);var ae,G=[],M=[],te=[],ie=[],le=!1,X=[];X.SheetNames=P.snames,X.sharedf=P.sharedf,X.arrayf=P.arrayf,X.names=[],X.XTI=[];var fe=0,K=0,E=0,W=[],L=[],F;P.codepage=1200,po(1200);for(var q=!1;t.l<t.length-1;){var he=t.l,me=t.read_shift(2);if(me===0&&fe===10)break;var Z=t.l===t.length?0:t.read_shift(2),Se=U2[me];if(Se&&Se.f){if(e.bookSheets&&fe===133&&me!==133)break;if(fe=me,Se.r===2||Se.r==12){var We=t.read_shift(2);if(Z-=2,!P.enc&&We!==me&&((We&255)<<8|We>>8)!==me)throw new Error("rt mismatch: "+We+"!="+me);Se.r==12&&(t.l+=10,Z-=10)}var ue={};if(me===10?ue=Se.f(t,Z,P):ue=I9(me,Se,t,Z,P),K==0&&[9,521,1033,2057].indexOf(fe)===-1)continue;switch(me){case 34:r.opts.Date1904=B.WBProps.date1904=ue;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(t.l=0),P.enc=ue,!e.password)throw new Error("File is password-protected");if(ue.valid==null)throw new Error("Encryption scheme unsupported");if(!ue.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=ue;break;case 66:var nt=Number(ue);switch(nt){case 21010:nt=1200;break;case 32768:nt=1e4;break;case 32769:nt=1252;break}po(P.codepage=nt),q=!0;break;case 317:P.rrtabid=ue;break;case 25:P.winlocked=ue;break;case 439:r.opts.RefreshAll=ue;break;case 12:r.opts.CalcCount=ue;break;case 16:r.opts.CalcDelta=ue;break;case 17:r.opts.CalcIter=ue;break;case 13:r.opts.CalcMode=ue;break;case 14:r.opts.CalcPrecision=ue;break;case 95:r.opts.CalcSaveRecalc=ue;break;case 15:P.CalcRefMode=ue;break;case 2211:r.opts.FullCalc=ue;break;case 129:ue.fDialog&&(s["!type"]="dialog"),ue.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),ue.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:H.push(ue);break;case 430:X.push([ue]),X[X.length-1].XTI=[];break;case 35:case 547:X[X.length-1].push(ue);break;case 24:case 536:F={Name:ue.Name,Ref:ka(ue.rgce,i,null,X,P)},ue.itab>0&&(F.Sheet=ue.itab-1),X.names.push(F),X[0]||(X[0]=[],X[0].XTI=[]),X[X.length-1].push(ue),ue.Name=="_xlnm._FilterDatabase"&&ue.itab>0&&ue.rgce&&ue.rgce[0]&&ue.rgce[0][0]&&ue.rgce[0][0][0]=="PtgArea3d"&&(L[ue.itab-1]={ref:Nr(ue.rgce[0][0][1][2])});break;case 22:P.ExternCount=ue;break;case 23:X.length==0&&(X[0]=[],X[0].XTI=[]),X[X.length-1].XTI=X[X.length-1].XTI.concat(ue),X.XTI=X.XTI.concat(ue);break;case 2196:if(P.biff<8)break;F!=null&&(F.Comment=ue[1]);break;case 18:s["!protect"]=ue;break;case 19:ue!==0&&P.WTF&&console.error("Password verifier: "+ue);break;case 133:a[ue.pos]=ue,P.snames.push(ue.name);break;case 10:{if(--K)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=Nr(i),e.sheetRows&&e.sheetRows<=i.e.r){var rt=i.e.r;i.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Nr(i),i.e.r=rt}i.e.r++,i.e.c++}G.length>0&&(s["!merges"]=G),M.length>0&&(s["!objects"]=M),te.length>0&&(s["!cols"]=te),ie.length>0&&(s["!rows"]=ie),B.Sheets.push(R)}d===""?h=s:n[d]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[me]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ue.BIFFVer]||8),P.biffguess=ue.BIFFVer==0,ue.BIFFVer==0&&ue.dt==4096&&(P.biff=5,q=!0,po(P.codepage=28591)),P.biff==8&&ue.BIFFVer==0&&ue.dt==16&&(P.biff=2),K++)break;if(s=e.dense?[]:{},P.biff<8&&!q&&(q=!0,po(P.codepage=e.codepage||1252)),P.biff<5||ue.BIFFVer==0&&ue.dt==4096){d===""&&(d="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var De={pos:t.l-Z,name:d};a[De.pos]=De,P.snames.push(d)}else d=(a[he]||{name:""}).name;ue.dt==32&&(s["!type"]="chart"),ue.dt==64&&(s["!type"]="macro"),G=[],M=[],P.arrayf=k=[],te=[],ie=[],le=!1,R={Hidden:(a[he]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[ue.r]||[])[ue.c]:s[fr({c:ue.c,r:ue.r})])&&++ue.c,A={ixfe:ue.ixfe,XF:H[ue.ixfe]||{},v:ue.val,t:"n"},E>0&&(A.z=W[A.ixfe>>8&63]),_l(A,e,r.opts.Date1904),I({c:ue.c,r:ue.r},A,e);break;case 5:case 517:A={ixfe:ue.ixfe,XF:H[ue.ixfe],v:ue.val,t:ue.t},E>0&&(A.z=W[A.ixfe>>8&63]),_l(A,e,r.opts.Date1904),I({c:ue.c,r:ue.r},A,e);break;case 638:A={ixfe:ue.ixfe,XF:H[ue.ixfe],v:ue.rknum,t:"n"},E>0&&(A.z=W[A.ixfe>>8&63]),_l(A,e,r.opts.Date1904),I({c:ue.c,r:ue.r},A,e);break;case 189:for(var ve=ue.c;ve<=ue.C;++ve){var Xe=ue.rkrec[ve-ue.c][0];A={ixfe:Xe,XF:H[Xe],v:ue.rkrec[ve-ue.c][1],t:"n"},E>0&&(A.z=W[A.ixfe>>8&63]),_l(A,e,r.opts.Date1904),I({c:ve,r:ue.r},A,e)}break;case 6:case 518:case 1030:{if(ue.val=="String"){l=ue;break}if(A=Am(ue.val,ue.cell.ixfe,ue.tt),A.XF=H[A.ixfe],e.cellFormula){var Re=ue.formula;if(Re&&Re[0]&&Re[0][0]&&Re[0][0][0]=="PtgExp"){var Ke=Re[0][0][1][0],it=Re[0][0][1][1],pt=fr({r:Ke,c:it});S[pt]?A.f=""+ka(ue.formula,i,ue.cell,X,P):A.F=((e.dense?(s[Ke]||[])[it]:s[pt])||{}).F}else A.f=""+ka(ue.formula,i,ue.cell,X,P)}E>0&&(A.z=W[A.ixfe>>8&63]),_l(A,e,r.opts.Date1904),I(ue.cell,A,e),l=ue}break;case 7:case 519:if(l)l.val=ue,A=Am(ue,l.cell.ixfe,"s"),A.XF=H[A.ixfe],e.cellFormula&&(A.f=""+ka(l.formula,i,l.cell,X,P)),E>0&&(A.z=W[A.ixfe>>8&63]),_l(A,e,r.opts.Date1904),I(l.cell,A,e),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(ue);var vt=fr(ue[0].s);if(m=e.dense?(s[ue[0].s.r]||[])[ue[0].s.c]:s[vt],e.cellFormula&&m){if(!l||!vt||!m)break;m.f=""+ka(ue[1],i,ue[0],X,P),m.F=Nr(ue[0])}}break;case 1212:{if(!e.cellFormula)break;if(x){if(!l)break;S[fr(l.cell)]=ue[0],m=e.dense?(s[l.cell.r]||[])[l.cell.c]:s[fr(l.cell)],(m||{}).f=""+ka(ue[0],i,p,X,P)}}break;case 253:A=Am(c[ue.isst].t,ue.ixfe,"s"),c[ue.isst].h&&(A.h=c[ue.isst].h),A.XF=H[A.ixfe],E>0&&(A.z=W[A.ixfe>>8&63]),_l(A,e,r.opts.Date1904),I({c:ue.c,r:ue.r},A,e);break;case 513:e.sheetStubs&&(A={ixfe:ue.ixfe,XF:H[ue.ixfe],t:"z"},E>0&&(A.z=W[A.ixfe>>8&63]),_l(A,e,r.opts.Date1904),I({c:ue.c,r:ue.r},A,e));break;case 190:if(e.sheetStubs)for(var Pt=ue.c;Pt<=ue.C;++Pt){var Dt=ue.ixfe[Pt-ue.c];A={ixfe:Dt,XF:H[Dt],t:"z"},E>0&&(A.z=W[A.ixfe>>8&63]),_l(A,e,r.opts.Date1904),I({c:Pt,r:ue.r},A,e)}break;case 214:case 516:case 4:A=Am(ue.val,ue.ixfe,"s"),A.XF=H[A.ixfe],E>0&&(A.z=W[A.ixfe>>8&63]),_l(A,e,r.opts.Date1904),I({c:ue.c,r:ue.r},A,e);break;case 0:case 512:K===1&&(i=ue);break;case 252:c=ue;break;case 1054:if(P.biff==4){W[E++]=ue[1];for(var Ot=0;Ot<E+163&&ar[Ot]!=ue[1];++Ot);Ot>=163&&Fl(ue[1],E+163)}else Fl(ue[1],ue[0]);break;case 30:{W[E++]=ue;for(var Yt=0;Yt<E+163&&ar[Yt]!=ue;++Yt);Yt>=163&&Fl(ue,E+163)}break;case 229:G=G.concat(ue);break;case 93:M[ue.cmo[0]]=P.lastobj=ue;break;case 438:P.lastobj.TxO=ue;break;case 127:P.lastobj.ImData=ue;break;case 440:for(w=ue[0].s.r;w<=ue[0].e.r;++w)for(y=ue[0].s.c;y<=ue[0].e.c;++y)m=e.dense?(s[w]||[])[y]:s[fr({c:y,r:w})],m&&(m.l=ue[1]);break;case 2048:for(w=ue[0].s.r;w<=ue[0].e.r;++w)for(y=ue[0].s.c;y<=ue[0].e.c;++y)m=e.dense?(s[w]||[])[y]:s[fr({c:y,r:w})],m&&m.l&&(m.l.Tooltip=ue[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;m=e.dense?(s[ue[0].r]||[])[ue[0].c]:s[fr(ue[0])];var lr=M[ue[2]];m||(e.dense?(s[ue[0].r]||(s[ue[0].r]=[]),m=s[ue[0].r][ue[0].c]={t:"z"}):m=s[fr(ue[0])]={t:"z"},i.e.r=Math.max(i.e.r,ue[0].r),i.s.r=Math.min(i.s.r,ue[0].r),i.e.c=Math.max(i.e.c,ue[0].c),i.s.c=Math.min(i.s.c,ue[0].c)),m.c||(m.c=[]),b={a:ue[1],t:lr.TxO.t},m.c.push(b)}break;case 2173:kD(H[ue.ixfe],ue.ext);break;case 125:{if(!P.cellStyles)break;for(;ue.e>=ue.s;)te[ue.e--]={width:ue.w/256,level:ue.level||0,hidden:!!(ue.flags&1)},le||(le=!0,ay(ue.w/256)),Ku(te[ue.e+1])}break;case 520:{var Qt={};ue.level!=null&&(ie[ue.r]=Qt,Qt.level=ue.level),ue.hidden&&(ie[ue.r]=Qt,Qt.hidden=!0),ue.hpt&&(ie[ue.r]=Qt,Qt.hpt=ue.hpt,Qt.hpx=k0(ue.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Zd(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[me]]=ue;break;case 161:s["!margins"]||Zd(s["!margins"]={}),s["!margins"].header=ue.header,s["!margins"].footer=ue.footer;break;case 574:ue.RTL&&(B.Views[0].RTL=!0);break;case 146:V=ue;break;case 2198:ae=ue;break;case 140:z=ue;break;case 442:d?R.CodeName=ue||R.name:B.WBProps.CodeName=ue||"ThisWorkbook";break}}else Se||console.error("Missing Info for XLS Record 0x"+me.toString(16)),t.l+=Z}return r.SheetNames=as(a).sort(function(It,bt){return Number(It)-Number(bt)}).map(function(It){return a[It].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&L.forEach(function(It,bt){r.Sheets[r.SheetNames[bt]]["!autofilter"]=It}),r.Strings=c,r.SSF=vn(ar),P.enc&&(r.Encryption=P.enc),ae&&(r.Themes=ae),r.Metadata={},z!==void 0&&(r.Metadata.Country=z),X.names.length>0&&(B.Names=X.names),r.Workbook=B,r}var Ph={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function M9(t,e,r){var n=er.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=iw(n,L2,Ph.DSI);for(var a in s)e[a]=s[a]}catch(d){if(r.WTF)throw d}var i=er.find(t,"/!SummaryInformation");if(i&&i.size>0)try{var l=iw(i,D2,Ph.SI);for(var c in l)e[c]==null&&(e[c]=l[c])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(DN(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function B9(t,e){var r=[],n=[],s=[],a=0,i,l=I5(L2,"n"),c=I5(D2,"n");if(t.Props)for(i=as(t.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(l,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],t.Props[i[a]]]);if(t.Custprops)for(i=as(t.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(t.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(l,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],t.Custprops[i[a]]]);var d=[];for(a=0;a<s.length;++a)zN.indexOf(s[a][0])>-1||LN.indexOf(s[a][0])>-1||s[a][1]!=null&&d.push(s[a]);n.length&&er.utils.cfb_add(e,"/SummaryInformation",ow(n,Ph.SI,c,D2)),(r.length||d.length)&&er.utils.cfb_add(e,"/DocumentSummaryInformation",ow(r,Ph.DSI,l,L2,d.length?d:null,Ph.UDI))}function hy(t,e){e||(e={}),my(e),tg(),e.codepage&&eg(e.codepage);var r,n;if(t.FullPaths){if(er.find(t,"/encryption"))throw new Error("File is password-protected");r=er.find(t,"!CompObj"),n=er.find(t,"/Workbook")||er.find(t,"/Book")}else{switch(e.type){case"base64":t=Ti(Ri(t));break;case"binary":t=Ti(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}sa(t,0),n={content:t}}var s,a;if(r&&D9(r),e.bookProps&&!e.bookSheets)s={};else{var i=Er?"buffer":"array";if(n&&n.content)s=O9(n.content,e);else if((a=er.find(t,"PerfectOffice_MAIN"))&&a.content)s=Qd.to_workbook(a.content,(e.type=i,e));else if((a=er.find(t,"NativeContent_MAIN"))&&a.content)s=Qd.to_workbook(a.content,(e.type=i,e));else throw(a=er.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&er.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=ZD(t))}var l={};return t.FullPaths&&M9(t,l,e),s.Props=s.Custprops=l,e.bookFiles&&(s.cfb=t),s}function U9(t,e){var r=e||{},n=er.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return er.utils.cfb_add(n,s,OS(t,r)),r.biff==8&&(t.Props||t.Custprops)&&B9(t,n),r.biff==8&&t.vbaraw&&eR(n,er.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var np={0:{f:dO},1:{f:yO},2:{f:MO},3:{f:EO},4:{f:NO},5:{f:RO},6:{f:$O},7:{f:FO},8:{f:KO},9:{f:YO},10:{f:GO},11:{f:XO},12:{f:wO},13:{f:UO},14:{f:CO},15:{f:kO},16:{f:AS},17:{f:VO},18:{f:LO},19:{f:Yv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:WM},40:{},42:{},43:{f:$L},44:{f:zL},45:{f:qL},46:{f:XL},47:{f:GL},48:{},49:{f:pF},50:{},51:{f:AD},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:QN},62:{f:HO},63:{f:OD},64:{f:fM},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Da,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:lM},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:gO},148:{f:pO,p:16},151:{f:rM},152:{},153:{f:zM},154:{},155:{},156:{f:BM},157:{},158:{},159:{T:1,f:sL},160:{T:-1},161:{T:1,f:yf},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:JO},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:jD},336:{T:-1},337:{f:FD,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:P2},357:{},358:{},359:{},360:{T:1},361:{},362:{f:JN},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:nM},427:{f:sM},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:iM},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:xO},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:eM},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:P2},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:XD},633:{T:1},634:{T:-1},635:{T:1,f:qD},636:{T:-1},637:{f:vF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:CM},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:hM},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},U2={6:{f:C1},10:{f:Cu},12:{f:Ns},13:{f:Ns},14:{f:ds},15:{f:ds},16:{f:Ca},17:{f:ds},18:{f:ds},19:{f:Ns},20:{f:hw},21:{f:hw},23:{f:JN},24:{f:mw},25:{f:ds},26:{},27:{},28:{f:hP},29:{},34:{f:ds},35:{f:pw},38:{f:Ca},39:{f:Ca},40:{f:Ca},41:{f:Ca},42:{f:ds},43:{f:ds},47:{f:kL},49:{f:U7},51:{f:Ns},60:{},61:{f:R7},64:{f:ds},65:{f:B7},66:{f:Ns},77:{},80:{},81:{},82:{},85:{f:Ns},89:{},90:{},91:{},92:{f:S7},93:{f:xP},94:{},95:{f:ds},96:{},97:{},99:{f:ds},125:{f:QN},128:{f:tP},129:{f:j7},130:{f:Ns},131:{f:ds},132:{f:ds},133:{f:E7},134:{},140:{f:SP},141:{f:Ns},144:{},146:{f:EP},151:{},152:{},153:{},154:{},155:{},156:{f:Ns},157:{},158:{},160:{f:DP},161:{f:TP},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:J7},190:{f:Q7},193:{f:Cu},197:{},198:{},199:{},200:{},201:{},202:{f:ds},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ns},220:{},221:{f:ds},222:{},224:{f:eP},225:{f:N7},226:{f:Cu},227:{},229:{f:pP},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:C7},253:{f:H7},255:{f:F7},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:HN},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ds},353:{f:Cu},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:iP},431:{f:ds},432:{},433:{},434:{},437:{},438:{f:yP},439:{f:ds},440:{f:bP},441:{},442:{f:jp},443:{},444:{f:Ns},445:{},446:{},448:{f:Cu},449:{f:D7,r:2},450:{f:Cu},512:{f:uw},513:{f:LP},515:{f:sP},516:{f:W7},517:{f:fw},519:{f:RP},520:{f:P7},523:{},545:{f:xw},549:{f:cw},566:{},574:{f:O7},638:{f:K7},659:{},1048:{},1054:{f:q7},1084:{},1212:{f:uP},2048:{f:_P},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:km},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Cu},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:AP,r:12},2173:{f:SD,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ds,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:cP,r:12},2197:{},2198:{f:vD,r:12},2199:{},2200:{},2201:{},2202:{f:dP,r:12},2203:{f:Cu},2204:{},2205:{},2206:{},2207:{},2211:{f:L7},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ns},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:FP},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:jP},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:uw},1:{},2:{f:UP},3:{f:MP},4:{f:OP},5:{f:fw},7:{f:HP},8:{},9:{f:km},11:{},22:{f:Ns},30:{f:X7},31:{},32:{},33:{f:xw},36:{},37:{f:cw},50:{f:$P},62:{},52:{},67:{},68:{f:Ns},69:{},86:{},126:{},127:{f:IP},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:WP},223:{},234:{},354:{},421:{},518:{f:C1},521:{f:km},536:{f:mw},547:{f:pw},561:{},579:{},1030:{f:C1},1033:{f:km},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function kt(t,e,r,n){var s=e;if(!isNaN(s)){var a=n||(r||[]).length||0,i=t.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&qv(r)&&t.push(r)}}function z9(t,e,r,n){var s=(r||[]).length||0;if(s<=8224)return kt(t,e,r,s);var a=e;if(!isNaN(a)){for(var i=r.parts||[],l=0,c=0,d=0;d+(i[l]||8224)<=8224;)d+=i[l]||8224,l++;var h=t.next(4);for(h.write_shift(2,a),h.write_shift(2,d),t.push(r.slice(c,c+d)),c+=d;c<s;){for(h=t.next(4),h.write_shift(2,60),d=0;d+(i[l]||8224)<=8224;)d+=i[l]||8224,l++;h.write_shift(2,d),t.push(r.slice(c,c+d)),c+=d}}}function Tp(t,e,r){return t||(t=st(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function H9(t,e,r,n){var s=st(9);return Tp(s,t,e),$N(r,n||"b",s),s}function $9(t,e,r){var n=st(8+2*r.length);return Tp(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function W9(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?Fs(Dn(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?kt(t,2,zP(r,n,s)):kt(t,3,BP(r,n,s));return;case"b":case"e":kt(t,5,H9(r,n,e.v,e.t));return;case"s":case"str":kt(t,4,$9(r,n,(e.v||"").slice(0,255)));return}kt(t,1,Tp(null,r,n))}function V9(t,e,r,n){var s=Array.isArray(e),a=Dr(e["!ref"]||"A1"),i,l="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=Nr(a)}for(var d=a.s.r;d<=a.e.r;++d){l=ns(d);for(var h=a.s.c;h<=a.e.c;++h){d===a.s.r&&(c[h]=Pn(h)),i=c[h]+l;var p=s?(e[d]||[])[h]:e[i];p&&W9(t,p,d,h)}}}function q9(t,e){for(var r=e||{},n=xi(),s=0,a=0;a<t.SheetNames.length;++a)t.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return kt(n,r.biff==4?1033:r.biff==3?521:9,ry(t,16,r)),V9(n,t.Sheets[t.SheetNames[s]],s,r),kt(n,10),n.end()}function G9(t,e,r){kt(t,49,z7({sz:12,name:"Arial"},r))}function X9(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&kt(t,1054,G7(s,e[s],r))})}function Y9(t,e){var r=st(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),kt(t,2151,r),r=st(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),XN(Dr(e["!ref"]||"A1"),r),r.write_shift(4,4),kt(t,2152,r)}function K9(t,e){for(var r=0;r<16;++r)kt(t,224,dw({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){kt(t,224,dw(n,0,e))})}function J9(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];kt(t,440,wP(n)),n[1].Tooltip&&kt(t,2048,NP(n))}delete e["!links"]}function Q9(t,e){if(e){var r=0;e.forEach(function(n,s){++r<=256&&n&&kt(t,125,CP(cg(s,n),s))})}}function Z9(t,e,r,n,s){var a=16+id(s.cellXfs,e,s);if(e.v==null&&!e.bf){kt(t,513,uf(r,n,a));return}if(e.bf)kt(t,6,jI(e,r,n,s,a));else switch(e.t){case"d":case"n":var i=e.t=="d"?Fs(Dn(e.v)):e.v;kt(t,515,aP(r,n,i,a));break;case"b":case"e":kt(t,517,nP(r,n,e.v,a,s,e.t));break;case"s":case"str":if(s.bookSST){var l=uy(s.Strings,e.v,s.revStrings);kt(t,253,$7(r,n,l,a))}else kt(t,516,V7(r,n,(e.v||"").slice(0,255),a,s));break;default:kt(t,513,uf(r,n,a))}}function eB(t,e,r){var n=xi(),s=r.SheetNames[t],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},l=(i.Sheets||[])[t]||{},c=Array.isArray(a),d=e.biff==8,h,p="",x=[],m=Dr(a["!ref"]||"A1"),b=d?65536:16384;if(m.e.c>255||m.e.r>=b){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,b-1)}kt(n,2057,ry(r,16,e)),kt(n,13,co(1)),kt(n,12,co(100)),kt(n,15,Ya(!0)),kt(n,17,Ya(!1)),kt(n,16,lf(.001)),kt(n,95,Ya(!0)),kt(n,42,Ya(!1)),kt(n,43,Ya(!1)),kt(n,130,co(1)),kt(n,128,rP()),kt(n,131,Ya(!1)),kt(n,132,Ya(!1)),d&&Q9(n,a["!cols"]),kt(n,512,Y7(m,e)),d&&(a["!links"]=[]);for(var y=m.s.r;y<=m.e.r;++y){p=ns(y);for(var w=m.s.c;w<=m.e.c;++w){y===m.s.r&&(x[w]=Pn(w)),h=x[w]+p;var S=c?(a[y]||[])[w]:a[h];S&&(Z9(n,S,y,w,e),d&&S.l&&a["!links"].push([h,S.l]))}}var k=l.CodeName||l.name||s;return d&&kt(n,574,M7((i.Views||[])[0])),d&&(a["!merges"]||[]).length&&kt(n,229,mP(a["!merges"])),d&&J9(n,a),kt(n,442,WN(k)),d&&Y9(n,a),kt(n,10),n.end()}function tB(t,e,r){var n=xi(),s=(t||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(kt(n,2057,ry(t,5,r)),r.bookType=="xla"&&kt(n,135),kt(n,225,l?co(1200):null),kt(n,193,n7(2)),c&&kt(n,191),c&&kt(n,192),kt(n,226),kt(n,92,k7("SheetJS",r)),kt(n,66,co(l?1200:1252)),l&&kt(n,353,co(0)),l&&kt(n,448),kt(n,317,PP(t.SheetNames.length)),l&&t.vbaraw&&kt(n,211),l&&t.vbaraw){var d=i.CodeName||"ThisWorkbook";kt(n,442,WN(d))}kt(n,156,co(17)),kt(n,25,Ya(!1)),kt(n,18,Ya(!1)),kt(n,19,co(0)),l&&kt(n,431,Ya(!1)),l&&kt(n,444,co(0)),kt(n,61,I7()),kt(n,64,Ya(!1)),kt(n,141,co(0)),kt(n,34,Ya(DM(t)=="true")),kt(n,14,Ya(!0)),l&&kt(n,439,Ya(!1)),kt(n,218,co(0)),G9(n,t,r),X9(n,t.SSF,r),K9(n,r),l&&kt(n,352,Ya(!1));var h=n.end(),p=xi();l&&kt(p,140,kP()),l&&r.Strings&&z9(p,252,T7(r.Strings)),kt(p,10);var x=p.end(),m=xi(),b=0,y=0;for(y=0;y<t.SheetNames.length;++y)b+=(l?12:11)+(l?2:1)*t.SheetNames[y].length;var w=h.length+b+x.length;for(y=0;y<t.SheetNames.length;++y){var S=a[y]||{};kt(m,133,A7({pos:w,hs:S.Hidden||0,dt:0,name:t.SheetNames[y]},r)),w+=e[y].length}var k=m.end();if(b!=k.length)throw new Error("BS8 "+b+" != "+k.length);var A=[];return h.length&&A.push(h),k.length&&A.push(k),x.length&&A.push(x),$s(A)}function rB(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=vn(ar)),t&&t.SSF&&(L0(),Np(t.SSF),r.revssf=ng(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,xy(r),r.cellXfs=[],id(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)n[n.length]=eB(s,r,t);return n.unshift(tB(t,n,r)),$s(n)}function OS(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Ka(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=e||{};switch(a.biff||2){case 8:case 5:return rB(t,e);case 4:case 3:case 2:return q9(t,e)}throw new Error("invalid type "+a.bookType+" for BIFF")}function jw(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),i=s.index,l=a&&a.index||t.length,c=zT(t.slice(i,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,h=0,p=0,x=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(i=0;i<c.length;++i){var y=c[i].trim(),w=y.slice(0,3).toLowerCase();if(w=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}h=0;continue}if(!(w!="<td"&&w!="<th")){var S=y.split(/<\/t[dh]>/i);for(l=0;l<S.length;++l){var k=S[l].trim();if(k.match(/<t[dh]/i)){for(var A=k,z=0;A.charAt(0)=="<"&&(z=A.indexOf(">"))>-1;)A=A.slice(z+1);for(var H=0;H<b.length;++H){var V=b[H];V.s.c==h&&V.s.r<d&&d<=V.e.r&&(h=V.e.c+1,H=-1)}var B=xr(k.slice(0,k.indexOf(">")));x=B.colspan?+B.colspan:1,((p=+B.rowspan)>1||x>1)&&b.push({s:{r:d,c:h},e:{r:d+(p||1)-1,c:h+x-1}});var R=B.t||B["data-t"]||"";if(!A.length){h+=x;continue}if(A=dN(A),m.s.r>d&&(m.s.r=d),m.e.r<d&&(m.e.r=d),m.s.c>h&&(m.s.c=h),m.e.c<h&&(m.e.c=h),!A.length){h+=x;continue}var O={t:"s",v:A};r.raw||!A.trim().length||R=="s"||(A==="TRUE"?O={t:"b",v:!0}:A==="FALSE"?O={t:"b",v:!1}:isNaN(Yo(A))?isNaN(N0(A).getDate())||(O={t:"d",v:Dn(A)},r.cellDates||(O={t:"n",v:Fs(O.v)}),O.z=r.dateNF||ar[14]):O={t:"n",v:Yo(A)}),r.dense?(n[d]||(n[d]=[]),n[d][h]=O):n[fr({r:d,c:h})]=O,h+=x}}}}return n["!ref"]=Nr(m),b.length&&(n["!merges"]=b),n}function MS(t,e,r,n){for(var s=t["!merges"]||[],a=[],i=e.s.c;i<=e.e.c;++i){for(var l=0,c=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>i)&&!(s[d].e.r<r||s[d].e.c<i)){if(s[d].s.r<r||s[d].s.c<i){l=-1;break}l=s[d].e.r-s[d].s.r+1,c=s[d].e.c-s[d].s.c+1;break}if(!(l<0)){var h=fr({r,c:i}),p=n.dense?(t[r]||[])[i]:t[h],x=p&&p.v!=null&&(p.h||Bv(p.w||(Il(p),p.w)||""))||"",m={};l>1&&(m.rowspan=l),c>1&&(m.colspan=c),n.editable?x='<span contenteditable="true">'+x+"</span>":p&&(m["data-t"]=p&&p.t||"z",p.v!=null&&(m["data-v"]=p.v),p.z!=null&&(m["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+p.l.Target+'">'+x+"</a>")),m.id=(n.id||"sjs")+"-"+h,a.push(St("td",x,m))}}var b="<tr>";return b+a.join("")+"</tr>"}var BS='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',US="</body></html>";function nB(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ad(jw(r[0],e),e);var n=wy();return r.forEach(function(s,a){_y(n,jw(s,e),"Sheet"+(a+1))}),n}function zS(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function HS(t,e){var r=e||{},n=r.header!=null?r.header:BS,s=r.footer!=null?r.footer:US,a=[n],i=Ka(t["!ref"]);r.dense=Array.isArray(t),a.push(zS(t,i,r));for(var l=i.s.r;l<=i.e.r;++l)a.push(MS(t,i,l,r));return a.push("</table>"+s),a.join("")}function $S(t,e,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Gn(n.origin):n.origin;s=i.r,a=i.c}var l=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:s,c:a}};if(t["!ref"]){var h=Ka(t["!ref"]);d.s.r=Math.min(d.s.r,h.s.r),d.s.c=Math.min(d.s.c,h.s.c),d.e.r=Math.max(d.e.r,h.e.r),d.e.c=Math.max(d.e.c,h.e.c),s==-1&&(d.e.r=s=h.e.r+1)}var p=[],x=0,m=t["!rows"]||(t["!rows"]=[]),b=0,y=0,w=0,S=0,k=0,A=0;for(t["!cols"]||(t["!cols"]=[]);b<l.length&&y<c;++b){var z=l[b];if(Ew(z)){if(n.display)continue;m[y]={hidden:!0}}var H=z.children;for(w=S=0;w<H.length;++w){var V=H[w];if(!(n.display&&Ew(V))){var B=V.hasAttribute("data-v")?V.getAttribute("data-v"):V.hasAttribute("v")?V.getAttribute("v"):dN(V.innerHTML),R=V.getAttribute("data-z")||V.getAttribute("z");for(x=0;x<p.length;++x){var O=p[x];O.s.c==S+a&&O.s.r<y+s&&y+s<=O.e.r&&(S=O.e.c+1-a,x=-1)}A=+V.getAttribute("colspan")||1,((k=+V.getAttribute("rowspan")||1)>1||A>1)&&p.push({s:{r:y+s,c:S+a},e:{r:y+s+(k||1)-1,c:S+a+(A||1)-1}});var ee={t:"s",v:B},I=V.getAttribute("data-t")||V.getAttribute("t")||"";B!=null&&(B.length==0?ee.t=I||"z":n.raw||B.trim().length==0||I=="s"||(B==="TRUE"?ee={t:"b",v:!0}:B==="FALSE"?ee={t:"b",v:!1}:isNaN(Yo(B))?isNaN(N0(B).getDate())||(ee={t:"d",v:Dn(B)},n.cellDates||(ee={t:"n",v:Fs(ee.v)}),ee.z=n.dateNF||ar[14]):ee={t:"n",v:Yo(B)})),ee.z===void 0&&R!=null&&(ee.z=R);var P="",ae=V.getElementsByTagName("A");if(ae&&ae.length)for(var G=0;G<ae.length&&!(ae[G].hasAttribute("href")&&(P=ae[G].getAttribute("href"),P.charAt(0)!="#"));++G);P&&P.charAt(0)!="#"&&(ee.l={Target:P}),n.dense?(t[y+s]||(t[y+s]=[]),t[y+s][S+a]=ee):t[fr({c:S+a,r:y+s})]=ee,d.e.c<S+a&&(d.e.c=S+a),S+=A}}++y}return p.length&&(t["!merges"]=(t["!merges"]||[]).concat(p)),d.e.r=Math.max(d.e.r,y-1+s),t["!ref"]=Nr(d),y>=c&&(t["!fullref"]=Nr((d.e.r=l.length-b+y-1+s,d))),t}function WS(t,e){var r=e||{},n=r.dense?[]:{};return $S(n,t,e)}function sB(t,e){return ad(WS(t,e),e)}function Ew(t){var e="",r=aB(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function aB(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function iB(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Wr(e.replace(/<[^>]*>/g,""));return[r]}var Aw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function VS(t,e){var r=e||{},n=Uv(t),s=[],a,i,l={name:""},c="",d=0,h,p,x={},m=[],b=r.dense?[]:{},y,w,S={value:""},k="",A=0,z=[],H=-1,V=-1,B={s:{r:1e6,c:1e7},e:{r:0,c:0}},R=0,O={},ee=[],I={},P=0,ae=0,G=[],M=1,te=1,ie=[],le={Names:[]},X={},fe=["",""],K=[],E={},W="",L=0,F=!1,q=!1,he=0;for(Jh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=Jh.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(B.e.c>=B.s.c&&B.e.r>=B.s.r?b["!ref"]=Nr(B):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=B.e.r&&(b["!fullref"]=b["!ref"],B.e.r=r.sheetRows-1,b["!ref"]=Nr(B)),ee.length&&(b["!merges"]=ee),G.length&&(b["!rows"]=G),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),m.push(h.name),x[h.name]=b,q=!1):y[0].charAt(y[0].length-2)!=="/"&&(h=xr(y[0],!1),H=V=-1,B.s.r=B.s.c=1e7,B.e.r=B.e.c=0,b=r.dense?[]:{},ee=[],G=[],q=!0);break;case"table-row-group":y[1]==="/"?--R:++R;break;case"table-row":case"":if(y[1]==="/"){H+=M,M=1;break}if(p=xr(y[0],!1),p.?H=p.-1:H==-1&&(H=0),M=+p["number-rows-repeated"]||1,M<10)for(he=0;he<M;++he)R>0&&(G[H+he]={level:R});V=-1;break;case"covered-table-cell":y[1]!=="/"&&++V,r.sheetStubs&&(r.dense?(b[H]||(b[H]=[]),b[H][V]={t:"z"}):b[fr({r:H,c:V})]={t:"z"}),k="",z=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++V,S=xr(y[0],!1),te=parseInt(S["number-columns-repeated"]||"1",10),w={t:"z",v:null},S.formula&&r.cellFormula!=!1&&(w.f=Nw(Wr(S.formula))),(S.||S["value-type"])=="string"&&(w.t="s",w.v=Wr(S["string-value"]||""),r.dense?(b[H]||(b[H]=[]),b[H][V]=w):b[fr({r:H,c:V})]=w),V+=te-1;else if(y[1]!=="/"){++V,k="",A=0,z=[],te=1;var me=M?H+M-1:H;if(V>B.e.c&&(B.e.c=V),V<B.s.c&&(B.s.c=V),H<B.s.r&&(B.s.r=H),me>B.e.r&&(B.e.r=me),S=xr(y[0],!1),K=[],E={},w={t:S.||S["value-type"],v:null},r.cellFormula)if(S.formula&&(S.formula=Wr(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(P=parseInt(S["number-matrix-rows-spanned"],10)||0,ae=parseInt(S["number-matrix-columns-spanned"],10)||0,I={s:{r:H,c:V},e:{r:H+P-1,c:V+ae-1}},w.F=Nr(I),ie.push([I,w.F])),S.formula)w.f=Nw(S.formula);else for(he=0;he<ie.length;++he)H>=ie[he][0].s.r&&H<=ie[he][0].e.r&&V>=ie[he][0].s.c&&V<=ie[he][0].e.c&&(w.F=ie[he][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(P=parseInt(S["number-rows-spanned"],10)||0,ae=parseInt(S["number-columns-spanned"],10)||0,I={s:{r:H,c:V},e:{r:H+P-1,c:V+ae-1}},ee.push(I)),S["number-columns-repeated"]&&(te=parseInt(S["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Cn(S["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(S.value);break;case"percentage":w.t="n",w.v=parseFloat(S.value);break;case"currency":w.t="n",w.v=parseFloat(S.value);break;case"date":w.t="d",w.v=Dn(S["date-value"]),r.cellDates||(w.t="n",w.v=Fs(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=MT(S["time-value"])/86400,r.cellDates&&(w.t="d",w.v=sg(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(S.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",S["string-value"]!=null&&(k=Wr(S["string-value"]),z=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(F=!1,w.t==="s"&&(w.v=k||"",z.length&&(w.R=z),F=A==0),X.Target&&(w.l=X),K.length>0&&(w.c=K,K=[]),k&&r.cellText!==!1&&(w.w=k),F&&(w.t="z",delete w.v),(!F||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=H))for(var Z=0;Z<M;++Z){if(te=parseInt(S["number-columns-repeated"]||"1",10),r.dense)for(b[H+Z]||(b[H+Z]=[]),b[H+Z][V]=Z==0?w:vn(w);--te>0;)b[H+Z][V+te]=vn(w);else for(b[fr({r:H+Z,c:V})]=w;--te>0;)b[fr({r:H+Z,c:V+te})]=vn(w);B.e.c<=V&&(B.e.c=V)}te=parseInt(S["number-columns-repeated"]||"1",10),V+=te-1,te=0,w={},k="",z=[]}X={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((a=s.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((a=s.pop())[0]!==y[3])throw"Bad state: "+a;E.t=k,z.length&&(E.R=z),E.a=W,K.push(E)}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);W="",L=0,k="",A=0,z=[];break;case"creator":y[1]==="/"?W=n.slice(L,y.index):L=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((a=s.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);k="",A=0,z=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(O[l.name]=c,(a=s.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&(c="",l=xr(y[0],!1),s.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=xr(y[0],!1),c+=Aw[y[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=xr(y[0],!1),c+=Aw[y[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(d,y.index);break}else d=y.index+y[0].length;break;case"named-range":i=xr(y[0],!1),fe=T1(i["cell-range-address"]);var Se={Name:i.name,Ref:fe[0]+"!"+fe[1]};q&&(Se.Sheet=m.length),le.Names.push(Se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(y[1]==="/"&&(!S||!S["string-value"])){var We=iB(n.slice(A,y.index));k=(k.length>0?k+`
`:"")+We[0]}else xr(y[0],!1),A=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{fe=T1(xr(y[0])["target-range-address"]),x[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(X=xr(y[0],!1),!X.href)break;X.Target=Wr(X.href),delete X.href,X.Target.charAt(0)=="#"&&X.Target.indexOf(".")>-1?(fe=T1(X.Target.slice(1)),X.Target="#"+fe[0]+"!"+fe[1]):X.Target.match(/^\.\.[\\\/]/)&&(X.Target=X.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var ue={Sheets:x,SheetNames:m,Workbook:le};return r.bookSheets&&delete ue.Sheets,ue}function Cw(t,e){e=e||{},lo(t,"META-INF/manifest.xml")&&MF(_s(t,"META-INF/manifest.xml"),e);var r=Fi(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=VS(fn(r),e);return lo(t,"meta.xml")&&(n.Props=FN(_s(t,"meta.xml"))),n}function Tw(t,e){return VS(t,e)}var oB=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Kh({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return vs+e}})(),Fw=(function(){var t=function(a){return un(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,l){var c=[];c.push('      <table:table table:name="'+un(i.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,h=0,p=Ka(a["!ref"]||"A1"),x=a["!merges"]||[],m=0,b=Array.isArray(a);if(a["!cols"])for(h=0;h<=p.e.c;++h)c.push("        <table:table-column"+(a["!cols"][h]?' table:style-name="co'+a["!cols"][h].ods+'"':"")+`></table:table-column>
`);var y="",w=a["!rows"]||[];for(d=0;d<p.s.r;++d)y=w[d]?' table:style-name="ro'+w[d].ods+'"':"",c.push("        <table:table-row"+y+`></table:table-row>
`);for(;d<=p.e.r;++d){for(y=w[d]?' table:style-name="ro'+w[d].ods+'"':"",c.push("        <table:table-row"+y+`>
`),h=0;h<p.s.c;++h)c.push(e);for(;h<=p.e.c;++h){var S=!1,k={},A="";for(m=0;m!=x.length;++m)if(!(x[m].s.c>h)&&!(x[m].s.r>d)&&!(x[m].e.c<h)&&!(x[m].e.r<d)){(x[m].s.c!=h||x[m].s.r!=d)&&(S=!0),k["table:number-columns-spanned"]=x[m].e.c-x[m].s.c+1,k["table:number-rows-spanned"]=x[m].e.r-x[m].s.r+1;break}if(S){c.push(r);continue}var z=fr({r:d,c:h}),H=b?(a[d]||[])[h]:a[z];if(H&&H.f&&(k["table:formula"]=un(PI(H.f)),H.F&&H.F.slice(0,z.length)==z)){var V=Ka(H.F);k["table:number-matrix-columns-spanned"]=V.e.c-V.s.c+1,k["table:number-matrix-rows-spanned"]=V.e.r-V.s.r+1}if(!H){c.push(e);continue}switch(H.t){case"b":A=H.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=H.v?"true":"false";break;case"n":A=H.w||String(H.v||0),k["office:value-type"]="float",k["office:value"]=H.v||0;break;case"s":case"str":A=H.v==null?"":H.v,k["office:value-type"]="string";break;case"d":A=H.w||Dn(H.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=Dn(H.v).toISOString(),k["table:style-name"]="ce1";break;default:c.push(e);continue}var B=t(A);if(H.l&&H.l.Target){var R=H.l.Target;R=R.charAt(0)=="#"?"#"+LI(R.slice(1)):R,R.charAt(0)!="#"&&!R.match(/^\w+:/)&&(R="../"+R),B=St("text:a",B,{"xlink:href":R.replace(/&/g,"&amp;")})}c.push("          "+St("table:table-cell",St("text:p",B,{}),k)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;i.SheetNames.map(function(d){return i.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var h=0;h<d["!cols"].length;++h)if(d["!cols"][h]){var p=d["!cols"][h];if(p.width==null&&p.wpx==null&&p.wch==null)continue;Ku(p),p.ods=l;var x=d["!cols"][h].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),a.push(`  </style:style>
`),++l}}});var c=0;i.SheetNames.map(function(d){return i.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var h=0;h<d["!rows"].length;++h)if(d["!rows"][h]){d["!rows"][h].ods=c;var p=d["!rows"][h].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,l){var c=[vs],d=Kh({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=Kh({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+d+h+`>
`),c.push(TN().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),s(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var p=0;p!=i.SheetNames.length;++p)c.push(n(i.Sheets[i.SheetNames[p]],i,p));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function qS(t,e){if(e.bookType=="fods")return Fw(t,e);var r=Iv(),n="",s=[],a=[];return n="mimetype",kr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",kr(r,n,Fw(t,e)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",kr(r,n,oB(t,e)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",kr(r,n,vs+TN()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",kr(r,n,zF(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",kr(r,n,BF(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function df(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function z2(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):fn(sd(t))}function lB(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ti(Cl(t))}function cB(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Qu(t){var e=t.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function Pw(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function uB(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function dB(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)t[e+a]=s&255;t[e+15]|=r>=0?0:128}function sp(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function on(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function ss(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Yr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=sp(t,r),a=s&7;s=Math.floor(s/8);var i=0,l;if(s==0)break;switch(a){case 0:{for(var c=r[0];t[r[0]++]>=128;);l=t.slice(c,r[0])}break;case 5:i=4,l=t.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,l=t.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=sp(t,r),l=t.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var d={data:l,type:a};e[s]==null?e[s]=[d]:e[s].push(d)}return e}function ra(t){var e=[];return t.forEach(function(r,n){r.forEach(function(s){s.data&&(e.push(on(n*8+s.type)),s.type==2&&e.push(on(s.data.length)),e.push(s.data))})}),Qu(e)}function py(t,e){return t?.map(function(r){return e(r.data)})||[]}function io(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=sp(t,n),a=Yr(t.slice(n[0],n[0]+s));n[0]+=s;var i={id:ss(a[1][0].data),messages:[]};a[2].forEach(function(l){var c=Yr(l.data),d=ss(c[3][0].data);i.messages.push({meta:c,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=a[3])!=null&&e[0]&&(i.merge=ss(a[3][0].data)>>>0>0),r.push(i)}return r}function Qf(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:on(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:on(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:on(i.data.length)}],n[2].push({data:ra(i.meta),type:2})});var a=ra(n);e.push(on(a.length)),e.push(a),s.forEach(function(i){return e.push(i)})}),Qu(e)}function fB(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=sp(e,r),s=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var i=e[r[0]++]>>2;if(i<60)++i;else{var l=i-59;i=e[r[0]],l>1&&(i|=e[r[0]+1]<<8),l>2&&(i|=e[r[0]+2]<<16),l>3&&(i|=e[r[0]+3]<<24),i>>>=0,i++,r[0]+=l}s.push(e.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,d=0;if(a==1?(d=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,a==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Qu(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(s.push(s[0].slice(-c)),d-=c;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-c,-c+d))}}var h=Qu(s);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function oo(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(fB(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Qu(e)}function Zf(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var a=on(n),i=a.length;e.push(a),n<=60?(i++,e.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return Qu(e)}function hB(t,e,r,n){var s=df(t),a=s.getUint32(4,!0),i=(n>1?12:8)+Pw(a&(n>1?3470:398))*4,l=-1,c=-1,d=NaN,h=new Date(2001,0,1);a&512&&(l=s.getUint32(i,!0),i+=4),i+=Pw(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(i,!0),i+=4),a&32&&(d=s.getFloat64(i,!0),i+=8),a&64&&(h.setTime(h.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var p;switch(t[2]){case 0:break;case 2:p={t:"n",v:d};break;case 3:p={t:"s",v:e[c]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(l>-1)p={t:"s",v:r[l]};else if(c>-1)p={t:"s",v:e[c]};else if(!isNaN(d))p={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return p}function pB(t,e,r){var n=df(t),s=n.getUint32(8,!0),a=12,i=-1,l=-1,c=NaN,d=NaN,h=new Date(2001,0,1);s&1&&(c=uB(t,a),a+=16),s&2&&(d=n.getFloat64(a,!0),a+=8),s&4&&(h.setTime(h.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(l=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var p;switch(t[1]){case 0:break;case 2:p={t:"n",v:c};break;case 3:p={t:"s",v:e[l]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(i>-1)p={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:p={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return p}function P1(t,e){var r=new Uint8Array(32),n=df(r),s=12,a=0;switch(r[0]=5,t.t){case"n":r[1]=2,dB(r,s,t.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,t.v?1:0,!0),a|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(s,e.indexOf(t.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,a,!0),r.slice(0,s)}function L1(t,e){var r=new Uint8Array(32),n=df(r),s=12,a=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(s,t.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,t.v?1:0,!0),a|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(s,e.indexOf(t.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,a,!0),r.slice(0,s)}function mB(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return hB(t,e,r,t[0]);case 5:return pB(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Sa(t){var e=Yr(t);return sp(e[1][0].data)}function Lw(t,e){var r=Yr(e.data),n=ss(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var l=Yr(i.data),c=ss(l[1][0].data)>>>0;switch(n){case 1:a[c]=z2(l[3][0].data);break;case 8:{var d=t[Sa(l[9][0].data)][0],h=Yr(d.data),p=t[Sa(h[1][0].data)][0],x=ss(p.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var m=Yr(p.data);a[c]=m[3].map(function(b){return z2(b.data)}).join("")}break}}),a}function xB(t,e){var r,n,s,a,i,l,c,d,h,p,x,m,b,y,w=Yr(t),S=ss(w[1][0].data)>>>0,k=ss(w[2][0].data)>>>0,A=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&ss(w[8][0].data)>0||!1,z,H;if((a=(s=w[7])==null?void 0:s[0])!=null&&a.data&&e!=0)z=(l=(i=w[7])==null?void 0:i[0])==null?void 0:l.data,H=(d=(c=w[6])==null?void 0:c[0])==null?void 0:d.data;else if((p=(h=w[4])==null?void 0:h[0])!=null&&p.data&&e!=1)z=(m=(x=w[4])==null?void 0:x[0])==null?void 0:m.data,H=(y=(b=w[3])==null?void 0:b[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var V=A?4:1,B=df(z),R=[],O=0;O<z.length/2;++O){var ee=B.getUint16(O*2,!0);ee<65535&&R.push([O,ee])}if(R.length!=k)throw"Expected ".concat(k," cells, found ").concat(R.length);var I=[];for(O=0;O<R.length-1;++O)I[R[O][0]]=H.subarray(R[O][1]*V,R[O+1][1]*V);return R.length>=1&&(I[R[R.length-1][0]]=H.subarray(R[R.length-1][1]*V)),{R:S,cells:I}}function gB(t,e){var r,n=Yr(e.data),s=(r=n?.[7])!=null&&r[0]?ss(n[7][0].data)>>>0>0?1:0:-1,a=py(n[5],function(i){return xB(i,s)});return{nrows:ss(n[4][0].data)>>>0,data:a.reduce(function(i,l){return i[l.R]||(i[l.R]=[]),l.cells.forEach(function(c,d){if(i[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));i[l.R][d]=c}),i},[])}}function vB(t,e,r){var n,s=Yr(e.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(ss(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(ss(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Nr(a);var i=Yr(s[4][0].data),l=Lw(t,t[Sa(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?Lw(t,t[Sa(i[17][0].data)][0]):[],d=Yr(i[3][0].data),h=0;d[1].forEach(function(p){var x=Yr(p.data),m=t[Sa(x[2][0].data)][0],b=ss(m.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var y=gB(t,m);y.data.forEach(function(w,S){w.forEach(function(k,A){var z=fr({r:h+S,c:A}),H=mB(k,l,c);H&&(r[z]=H)})}),h+=y.nrows})}function yB(t,e){var r=Yr(e.data),n={"!ref":"A1"},s=t[Sa(r[2][0].data)],a=ss(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return vB(t,s[0],n),n}function bB(t,e){var r,n=Yr(e.data),s={name:(r=n[1])!=null&&r[0]?z2(n[1][0].data):"",sheets:[]},a=py(n[2],Sa);return a.forEach(function(i){t[i].forEach(function(l){var c=ss(l.meta[1][0].data);c==6e3&&s.sheets.push(yB(t,l))})}),s}function wB(t,e){var r=wy(),n=Yr(e.data),s=py(n[1],Sa);if(s.forEach(function(a){t[a].forEach(function(i){var l=ss(i.meta[1][0].data);if(l==2){var c=bB(t,i);c.sheets.forEach(function(d,h){_y(r,d,h==0?c.name:c.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function D1(t){var e,r,n,s,a={},i=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=oo(c.content)}catch(p){return console.log("?? "+c.content.length+" "+(p.message||p))}var h;try{h=io(d)}catch(p){return console.log("## "+(p.message||p))}h.forEach(function(p){a[p.id]=p.messages,i.push(p.id)})}}),!i.length)throw new Error("File has no messages");var l=((s=(n=(r=(e=a?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&ss(a[1][0].meta[1][0].data)==1&&a[1][0];if(l||i.forEach(function(c){a[c].forEach(function(d){var h=ss(d.meta[1][0].data)>>>0;if(h==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return wB(a,l)}function _B(t,e,r){var n,s,a,i;if(!((n=t[6])!=null&&n[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((i=(a=t[8])==null?void 0:a[0])==null?void 0:i.data)&&ss(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,d=df(t[7][0].data),h=0,p=[],x=df(t[4][0].data),m=0,b=[],y=0;y<e.length;++y){if(e[y]==null){d.setUint16(y*2,65535,!0),x.setUint16(y*2,65535);continue}d.setUint16(y*2,h,!0),x.setUint16(y*2,m,!0);var w,S;switch(typeof e[y]){case"string":w=P1({t:"s",v:e[y]},r),S=L1({t:"s",v:e[y]},r);break;case"number":w=P1({t:"n",v:e[y]},r),S=L1({t:"n",v:e[y]},r);break;case"boolean":w=P1({t:"b",v:e[y]},r),S=L1({t:"b",v:e[y]},r);break;default:throw new Error("Unsupported value "+e[y])}p.push(w),h+=w.length,b.push(S),m+=S.length,++c}for(t[2][0].data=on(c);y<t[7][0].data.length/2;++y)d.setUint16(y*2,65535,!0),x.setUint16(y*2,65535,!0);return t[6][0].data=Qu(p),t[3][0].data=Qu(b),c}function NB(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ka(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Nr(n)));var a=Ex(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(W){return W.forEach(function(L){typeof L=="string"&&i.push(L)})});var l={},c=[],d=er.read(e.numbers,{type:"base64"});d.FileIndex.map(function(W,L){return[W,d.FullPaths[L]]}).forEach(function(W){var L=W[0],F=W[1];if(L.type==2&&L.name.match(/\.iwa/)){var q=L.content,he=oo(q),me=io(he);me.forEach(function(Z){c.push(Z.id),l[Z.id]={deps:[],location:F,type:ss(Z.messages[0].meta[1][0].data)}})}}),c.sort(function(W,L){return W-L});var h=c.filter(function(W){return W>1}).map(function(W){return[W,on(W)]});d.FileIndex.map(function(W,L){return[W,d.FullPaths[L]]}).forEach(function(W){var L=W[0];if(W[1],!!L.name.match(/\.iwa/)){var F=io(oo(L.content));F.forEach(function(q){q.messages.forEach(function(he){h.forEach(function(me){q.messages.some(function(Z){return ss(Z.meta[1][0].data)!=11006&&cB(Z.data,me[1])})&&l[me[0]].deps.push(q.id)})})})}});for(var p=er.find(d,l[1].location),x=io(oo(p.content)),m,b=0;b<x.length;++b){var y=x[b];y.id==1&&(m=y)}var w=Sa(Yr(m.messages[0].data)[1][0].data);for(p=er.find(d,l[w].location),x=io(oo(p.content)),b=0;b<x.length;++b)y=x[b],y.id==w&&(m=y);for(w=Sa(Yr(m.messages[0].data)[2][0].data),p=er.find(d,l[w].location),x=io(oo(p.content)),b=0;b<x.length;++b)y=x[b],y.id==w&&(m=y);for(w=Sa(Yr(m.messages[0].data)[2][0].data),p=er.find(d,l[w].location),x=io(oo(p.content)),b=0;b<x.length;++b)y=x[b],y.id==w&&(m=y);var S=Yr(m.messages[0].data);{S[6][0].data=on(n.e.r+1),S[7][0].data=on(n.e.c+1);var k=Sa(S[46][0].data),A=er.find(d,l[k].location),z=io(oo(A.content));{for(var H=0;H<z.length&&z[H].id!=k;++H);if(z[H].id!=k)throw"Bad ColumnRowUIDMapArchive";var V=Yr(z[H].messages[0].data);V[1]=[],V[2]=[],V[3]=[];for(var B=0;B<=n.e.c;++B){var R=[];R[1]=R[2]=[{type:0,data:on(B+420690)}],V[1].push({type:2,data:ra(R)}),V[2].push({type:0,data:on(B)}),V[3].push({type:0,data:on(B)})}V[4]=[],V[5]=[],V[6]=[];for(var O=0;O<=n.e.r;++O)R=[],R[1]=R[2]=[{type:0,data:on(O+726270)}],V[4].push({type:2,data:ra(R)}),V[5].push({type:0,data:on(O)}),V[6].push({type:0,data:on(O)});z[H].messages[0].data=ra(V)}A.content=Zf(Qf(z)),A.size=A.content.length,delete S[46];var ee=Yr(S[4][0].data);{ee[7][0].data=on(n.e.r+1);var I=Yr(ee[1][0].data),P=Sa(I[2][0].data);A=er.find(d,l[P].location),z=io(oo(A.content));{if(z[0].id!=P)throw"Bad HeaderStorageBucket";var ae=Yr(z[0].messages[0].data);for(O=0;O<a.length;++O){var G=Yr(ae[2][0].data);G[1][0].data=on(O),G[4][0].data=on(a[O].length),ae[2][O]={type:ae[2][0].type,data:ra(G)}}z[0].messages[0].data=ra(ae)}A.content=Zf(Qf(z)),A.size=A.content.length;var M=Sa(ee[2][0].data);A=er.find(d,l[M].location),z=io(oo(A.content));{if(z[0].id!=M)throw"Bad HeaderStorageBucket";for(ae=Yr(z[0].messages[0].data),B=0;B<=n.e.c;++B)G=Yr(ae[2][0].data),G[1][0].data=on(B),G[4][0].data=on(n.e.r+1),ae[2][B]={type:ae[2][0].type,data:ra(G)};z[0].messages[0].data=ra(ae)}A.content=Zf(Qf(z)),A.size=A.content.length;var te=Sa(ee[4][0].data);(function(){for(var W=er.find(d,l[te].location),L=io(oo(W.content)),F,q=0;q<L.length;++q){var he=L[q];he.id==te&&(F=he)}var me=Yr(F.messages[0].data);{me[3]=[];var Z=[];i.forEach(function(ue,nt){Z[1]=[{type:0,data:on(nt)}],Z[2]=[{type:0,data:on(1)}],Z[3]=[{type:2,data:lB(ue)}],me[3].push({type:2,data:ra(Z)})})}F.messages[0].data=ra(me);var Se=Qf(L),We=Zf(Se);W.content=We,W.size=W.content.length})();var ie=Yr(ee[3][0].data);{var le=ie[1][0];delete ie[2];var X=Yr(le.data);{var fe=Sa(X[2][0].data);(function(){for(var W=er.find(d,l[fe].location),L=io(oo(W.content)),F,q=0;q<L.length;++q){var he=L[q];he.id==fe&&(F=he)}var me=Yr(F.messages[0].data);{delete me[6],delete ie[7];var Z=new Uint8Array(me[5][0].data);me[5]=[];for(var Se=0,We=0;We<=n.e.r;++We){var ue=Yr(Z);Se+=_B(ue,a[We],i),ue[1][0].data=on(We),me[5].push({data:ra(ue),type:2})}me[1]=[{type:0,data:on(n.e.c+1)}],me[2]=[{type:0,data:on(n.e.r+1)}],me[3]=[{type:0,data:on(Se)}],me[4]=[{type:0,data:on(n.e.r+1)}]}F.messages[0].data=ra(me);var nt=Qf(L),rt=Zf(nt);W.content=rt,W.size=W.content.length})()}le.data=ra(X)}ee[3][0].data=ra(ie)}S[4][0].data=ra(ee)}m.messages[0].data=ra(S);var K=Qf(x),E=Zf(K);return p.content=E,p.size=p.content.length,d}function GS(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function my(t){GS([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function xy(t){GS([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function SB(t){return Tr.WS.indexOf(t)>-1?"sheet":t==Tr.CS?"chart":t==Tr.DS?"dialog":t==Tr.MS?"macro":t&&t.length?t:"sheet"}function kB(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,SB(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function jB(t,e,r,n,s,a,i,l,c,d,h,p){try{a[n]=Ah(Fi(t,r,!0),e);var x=_s(t,e),m;switch(l){case"sheet":m=QM(x,e,s,c,a[n],d,h,p);break;case"chart":if(m=ZM(x,e,s,c,a[n],d,h,p),!m||!m["!drawel"])break;var b=yh(m["!drawel"].Target,e),y=Qh(b),w=UD(Fi(t,b,!0),Ah(Fi(t,y,!0),b)),S=yh(w,b),k=Qh(S);m=EM(Fi(t,S,!0),S,c,Ah(Fi(t,k,!0),S),d,m);break;case"macro":m=e9(x,e,s,c,a[n],d,h,p);break;case"dialog":m=t9(x,e,s,c,a[n],d,h,p);break;default:throw new Error("Unrecognized sheet type "+l)}i[n]=m;var A=[];a&&a[n]&&as(a[n]).forEach(function(z){var H="";if(a[n][z].Type==Tr.CMNT){H=yh(a[n][z].Target,e);var V=a9(_s(t,H,!0),H,c);if(!V||!V.length)return;vw(m,V,!1)}a[n][z].Type==Tr.TCMNT&&(H=yh(a[n][z].Target,e),A=A.concat(HD(_s(t,H,!0),c)))}),A&&A.length&&vw(m,A,!0,c.people||[])}catch(z){if(c.WTF)throw z}}function no(t){return t.charAt(0)=="/"?t.slice(1):t}function XS(t,e){if(L0(),e=e||{},my(e),lo(t,"META-INF/manifest.xml")||lo(t,"objectdata.xml"))return Cw(t,e);if(lo(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof D1<"u"){if(t.FileIndex)return D1(t);var r=er.utils.cfb_new();return B5(t).forEach(function(G){kr(r,G,$T(t,G))}),D1(r)}throw new Error("Unsupported NUMBERS file")}if(!lo(t,"[Content_Types].xml"))throw lo(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):lo(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=B5(t),s=IF(Fi(t,"[Content_Types].xml")),a=!1,i,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",_s(t,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!_s(t,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},d={};if(!e.bookSheets&&!e.bookProps){if(Ch=[],s.sst)try{Ch=s9(_s(t,no(s.sst)),s.sst,e)}catch(G){if(e.WTF)throw G}e.cellStyles&&s.themes.length&&(c=n9(Fi(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(d=r9(_s(t,no(s.style)),s.style,c,e))}s.links.map(function(G){try{var M=Ah(Fi(t,Qh(no(G))),G);return o9(_s(t,no(G)),M,G,e)}catch{}});var h=JM(_s(t,no(s.workbooks[0])),s.workbooks[0],e),p={},x="";s.coreprops.length&&(x=_s(t,no(s.coreprops[0]),!0),x&&(p=FN(x)),s.extprops.length!==0&&(x=_s(t,no(s.extprops[0]),!0),x&&$F(x,p,e)));var m={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(x=Fi(t,no(s.custprops[0]),!0),x&&(m=VF(x,e)));var b={};if((e.bookSheets||e.bookProps)&&(h.Sheets?i=h.Sheets.map(function(M){return M.name}):p.Worksheets&&p.SheetNames.length>0&&(i=p.SheetNames),e.bookProps&&(b.Props=p,b.Custprops=m),e.bookSheets&&typeof i<"u"&&(b.SheetNames=i),e.bookSheets?b.SheetNames:e.bookProps))return b;i={};var y={};e.bookDeps&&s.calcchain&&(y=i9(_s(t,no(s.calcchain)),s.calcchain));var w=0,S={},k,A;{var z=h.Sheets;p.Worksheets=z.length,p.SheetNames=[];for(var H=0;H!=z.length;++H)p.SheetNames[H]=z[H].name}var V=a?"bin":"xml",B=s.workbooks[0].lastIndexOf("/"),R=(s.workbooks[0].slice(0,B+1)+"_rels/"+s.workbooks[0].slice(B+1)+".rels").replace(/^\//,"");lo(t,R)||(R="xl/_rels/workbook."+V+".rels");var O=Ah(Fi(t,R,!0),R.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=l9(_s(t,no(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=WD(_s(t,no(s.people[0])),e)),O&&(O=kB(O,h.Sheets));var ee=_s(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=p.Worksheets;++w){var I="sheet";if(O&&O[w]?(k="xl/"+O[w][1].replace(/[\/]?xl\//,""),lo(t,k)||(k=O[w][1]),lo(t,k)||(k=R.replace(/_rels\/.*$/,"")+O[w][1]),I=O[w][2]):(k="xl/worksheets/sheet"+(w+1-ee)+"."+V,k=k.replace(/sheet0\./,"sheet.")),A=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(p.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var P=!1,ae=0;ae!=e.sheets.length;++ae)typeof e.sheets[ae]=="number"&&e.sheets[ae]==w&&(P=1),typeof e.sheets[ae]=="string"&&e.sheets[ae].toLowerCase()==p.SheetNames[w].toLowerCase()&&(P=1);if(!P)continue e}}jB(t,k,A,p.SheetNames[w],w,S,i,I,e,h,c,d)}return b={Directory:s,Workbook:h,Props:p,Custprops:m,Deps:y,Sheets:i,SheetNames:p.SheetNames,Strings:Ch,Styles:d,Themes:c,SSF:vn(ar)},e&&e.bookFiles&&(t.files?(b.keys=n,b.files=t.files):(b.keys=[],b.files={},t.FullPaths.forEach(function(G,M){G=G.replace(/^Root Entry[\/]/,""),b.keys.push(G),b.files[G]=t.FileIndex[M]}))),e&&e.bookVBA&&(s.vba.length>0?b.vbaraw=_s(t,no(s.vba[0]),!0):s.defaults&&s.defaults.bin===QD&&(b.vbaraw=_s(t,"xl/vbaProject.bin",!0))),b}function EB(t,e){var r=e||{},n="Workbook",s=er.find(t,n);try{if(n="/!DataSpaces/Version",s=er.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(cL(s.content),n="/!DataSpaces/DataSpaceMap",s=er.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=dL(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=er.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=fL(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=er.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);pL(s.content)}catch{}if(n="/EncryptionInfo",s=er.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=mL(s.content);if(n="/EncryptedPackage",s=er.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function AB(t,e){return e.bookType=="ods"?qS(t,e):e.bookType=="numbers"?NB(t,e):e.bookType=="xlsb"?CB(t,e):YS(t,e)}function CB(t,e){l0=1024,t&&!t.SSF&&(t.SSF=vn(ar)),t&&t.SSF&&(L0(),Np(t.SSF),e.revssf=ng(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Th?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=xS.indexOf(e.bookType)>-1,s=ey();xy(e=e||{});var a=Iv(),i="",l=0;if(e.cellXfs=[],id(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),i="docProps/core.xml",kr(a,i,PN(t.Props,e)),s.coreprops.push(i),ln(e.rels,2,i,Tr.CORE_PROPS),i="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(t.SheetNames[d]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,kr(a,i,RN(t.Props)),s.extprops.push(i),ln(e.rels,3,i,Tr.EXT_PROPS),t.Custprops!==t.Props&&as(t.Custprops||{}).length>0&&(i="docProps/custom.xml",kr(a,i,IN(t.Custprops)),s.custprops.push(i),ln(e.rels,4,i,Tr.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var h={"!id":{}},p=t.Sheets[t.SheetNames[l-1]],x=(p||{})["!type"]||"sheet";switch(x){case"chart":default:i="xl/worksheets/sheet"+l+"."+r,kr(a,i,u9(l-1,i,e,t,h)),s.sheets.push(i),ln(e.wbrels,-1,"worksheets/sheet"+l+"."+r,Tr.WS[0])}if(p){var m=p["!comments"],b=!1,y="";m&&m.length>0&&(y="xl/comments"+l+"."+r,kr(a,y,h9(m,y)),s.comments.push(y),ln(h,-1,"../comments"+l+"."+r,Tr.CMNT),b=!0),p["!legacy"]&&b&&kr(a,"xl/drawings/vmlDrawing"+l+".vml",pS(l,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&kr(a,Qh(i),h0(h))}return e.Strings!=null&&e.Strings.length>0&&(i="xl/sharedStrings."+r,kr(a,i,f9(e.Strings,i,e)),s.strs.push(i),ln(e.wbrels,-1,"sharedStrings."+r,Tr.SST)),i="xl/workbook."+r,kr(a,i,c9(t,i)),s.workbooks.push(i),ln(e.rels,1,i,Tr.WB),i="xl/theme/theme1.xml",kr(a,i,iy(t.Themes,e)),s.themes.push(i),ln(e.wbrels,-1,"theme/theme1.xml",Tr.THEME),i="xl/styles."+r,kr(a,i,d9(t,i,e)),s.styles.push(i),ln(e.wbrels,-1,"styles."+r,Tr.STY),t.vbaraw&&n&&(i="xl/vbaProject.bin",kr(a,i,t.vbaraw),s.vba.push(i),ln(e.wbrels,-1,"vbaProject.bin",Tr.VBA)),i="xl/metadata."+r,kr(a,i,p9(i)),s.metadata.push(i),ln(e.wbrels,-1,"metadata."+r,Tr.XLMETA),kr(a,"[Content_Types].xml",CN(s,e)),kr(a,"_rels/.rels",h0(e.rels)),kr(a,"xl/_rels/workbook."+r+".rels",h0(e.wbrels)),delete e.revssf,delete e.ssf,a}function YS(t,e){l0=1024,t&&!t.SSF&&(t.SSF=vn(ar)),t&&t.SSF&&(L0(),Np(t.SSF),e.revssf=ng(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Th?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=xS.indexOf(e.bookType)>-1,s=ey();xy(e=e||{});var a=Iv(),i="",l=0;if(e.cellXfs=[],id(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),i="docProps/core.xml",kr(a,i,PN(t.Props,e)),s.coreprops.push(i),ln(e.rels,2,i,Tr.CORE_PROPS),i="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(t.SheetNames[d]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,kr(a,i,RN(t.Props)),s.extprops.push(i),ln(e.rels,3,i,Tr.EXT_PROPS),t.Custprops!==t.Props&&as(t.Custprops||{}).length>0&&(i="docProps/custom.xml",kr(a,i,IN(t.Custprops)),s.custprops.push(i),ln(e.rels,4,i,Tr.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,l=1;l<=t.SheetNames.length;++l){var p={"!id":{}},x=t.Sheets[t.SheetNames[l-1]],m=(x||{})["!type"]||"sheet";switch(m){case"chart":default:i="xl/worksheets/sheet"+l+"."+r,kr(a,i,ES(l-1,e,t,p)),s.sheets.push(i),ln(e.wbrels,-1,"worksheets/sheet"+l+"."+r,Tr.WS[0])}if(x){var b=x["!comments"],y=!1,w="";if(b&&b.length>0){var S=!1;b.forEach(function(k){k[1].forEach(function(A){A.T==!0&&(S=!0)})}),S&&(w="xl/threadedComments/threadedComment"+l+"."+r,kr(a,w,$D(b,h,e)),s.threadedcomments.push(w),ln(p,-1,"../threadedComments/threadedComment"+l+"."+r,Tr.TCMNT)),w="xl/comments"+l+"."+r,kr(a,w,mS(b)),s.comments.push(w),ln(p,-1,"../comments"+l+"."+r,Tr.CMNT),y=!0}x["!legacy"]&&y&&kr(a,"xl/drawings/vmlDrawing"+l+".vml",pS(l,x["!comments"])),delete x["!comments"],delete x["!legacy"]}p["!id"].rId1&&kr(a,Qh(i),h0(p))}return e.Strings!=null&&e.Strings.length>0&&(i="xl/sharedStrings."+r,kr(a,i,rS(e.Strings,e)),s.strs.push(i),ln(e.wbrels,-1,"sharedStrings."+r,Tr.SST)),i="xl/workbook."+r,kr(a,i,LS(t)),s.workbooks.push(i),ln(e.rels,1,i,Tr.WB),i="xl/theme/theme1.xml",kr(a,i,iy(t.Themes,e)),s.themes.push(i),ln(e.wbrels,-1,"theme/theme1.xml",Tr.THEME),i="xl/styles."+r,kr(a,i,uS(t,e)),s.styles.push(i),ln(e.wbrels,-1,"styles."+r,Tr.STY),t.vbaraw&&n&&(i="xl/vbaProject.bin",kr(a,i,t.vbaraw),s.vba.push(i),ln(e.wbrels,-1,"vbaProject.bin",Tr.VBA)),i="xl/metadata."+r,kr(a,i,hS()),s.metadata.push(i),ln(e.wbrels,-1,"metadata."+r,Tr.XLMETA),h.length>1&&(i="xl/persons/person.xml",kr(a,i,VD(h)),s.people.push(i),ln(e.wbrels,-1,"persons/person.xml",Tr.PEOPLE)),kr(a,"[Content_Types].xml",CN(s,e)),kr(a,"_rels/.rels",h0(e.rels)),kr(a,"xl/_rels/workbook."+r+".rels",h0(e.wbrels)),delete e.revssf,delete e.ssf,a}function gy(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Ri(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function TB(t,e){return er.find(t,"EncryptedPackage")?EB(t,e):hy(t,e)}function FB(t,e){var r,n=t,s=e||{};return s.type||(s.type=Er&&Buffer.isBuffer(t)?"buffer":"base64"),r=lN(n,s),XS(r,s)}function KS(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return B2(t.slice(r),e);default:break e}return S0.to_workbook(t,e)}function PB(t,e){var r="",n=gy(t,e);switch(e.type){case"base64":r=Ri(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=of(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=fn(r)),e.type="binary",KS(r,e)}function LB(t,e){var r=t;return e.type=="base64"&&(r=Ri(r)),r=Br.utils.decode(1200,r.slice(2),"str"),e.type="binary",KS(r,e)}function DB(t){return t.match(/[^\x00-\x7F]/)?Cl(t):t}function R1(t,e,r,n){return n?(r.type="string",S0.to_workbook(t,r)):S0.to_workbook(e,r)}function kx(t,e){tg();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return kx(new Uint8Array(t),(r=vn(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),m0={},r.dateNF&&(m0.dateNF=r.dateNF),r.type||(r.type=Er&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Er?"buffer":"binary",n=RT(t),typeof Uint8Array<"u"&&!Er&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=DB(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),l=new Uint8Array(i);if(l.foo="bar",!l.foo)return r=vn(r),r.type="array",kx(Pv(n),r)}switch((s=gy(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return TB(er.read(n,r),r);break;case 9:if(s[1]<=8)return hy(n,r);break;case 60:return B2(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return qP(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return eS.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?FB(n,r):R1(t,n,r,a);case 239:return s[3]===60?B2(n,r):R1(t,n,r,a);case 255:if(s[1]===254)return LB(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Qd.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Qd.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return M2.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return oS.to_workbook(n,r);break;case 10:case 13:case 32:return PB(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return VP.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?M2.to_workbook(n,r):R1(t,n,r,a)}function Dw(t,e){var r=e||{};return r.type="file",kx(t,r)}function JS(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Sp(e.file,er.write(t,{type:Er?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return er.write(t,e)}function RB(t,e){var r=vn(e||{}),n=AB(t,r);return QS(n,r)}function IB(t,e){var r=vn(e||{}),n=YS(t,r);return QS(n,r)}function QS(t,e){var r={},n=Er?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?er.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(_p(s))}return e.password&&typeof encrypt_agile<"u"?JS(encrypt_agile(s,e.password),e):e.type==="file"?Sp(e.file,s):e.type=="string"?fn(s):s}function OB(t,e){var r=e||{},n=U9(t,r);return JS(n,r)}function kl(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Gh(Cl(n));case"binary":return Cl(n);case"string":return t;case"file":return Sp(e.file,n,"utf8");case"buffer":return Er?Oc(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):kl(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function MB(t,e){switch(e.type){case"base64":return Gh(t);case"binary":return t;case"string":return t;case"file":return Sp(e.file,t,"binary");case"buffer":return Er?Oc(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Cm(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Gh(r):e.type=="string"?fn(r):r;case"file":return Sp(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function vy(t,e){tg(),PS(t);var r=vn(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=vy(t,r);return r.type="array",_p(n)}return IB(t,r)}function ug(t,e){tg(),PS(t);var r=vn(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=ug(t,r);return r.type="array",_p(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return kl(L9(t,r),r);case"slk":case"sylk":return kl(ZN.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return kl(HS(t.Sheets[t.SheetNames[s]],r),r);case"txt":return MB(tk(t.Sheets[t.SheetNames[s]],r),r);case"csv":return kl(by(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return kl(eS.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return Cm(M2.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return kl(S0.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return kl(oS.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return kl(tS.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return kl(qS(t,r),r);case"wk1":return Cm(Qd.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return Cm(Qd.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Cm(OS(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),OB(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return RB(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function yy(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function jx(t,e,r){var n=r||{};return n.type="file",n.file=e,yy(n),ug(t,n)}function BB(t,e,r){var n=r||{};return n.type="file",n.file=e,yy(n),vy(t,n)}function UB(t,e,r,n){var s=r||{};s.type="file",s.file=t,yy(s),s.type="buffer";var a=n;return a instanceof Function||(a=r),Mu.writeFile(t,ug(e,s),a)}function ZS(t,e,r,n,s,a,i,l){var c=ns(r),d=l.defval,h=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),p=!0,x=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!i||t[r])for(var m=e.s.c;m<=e.e.c;++m){var b=i?t[r][m]:t[n[m]+c];if(b===void 0||b.t===void 0){if(d===void 0)continue;a[m]!=null&&(x[a[m]]=d);continue}var y=b.v;switch(b.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(a[m]!=null){if(y==null)if(b.t=="e"&&y===null)x[a[m]]=null;else if(d!==void 0)x[a[m]]=d;else if(h&&y===null)x[a[m]]=null;else continue;else x[a[m]]=h&&(b.t!=="n"||b.t==="n"&&l.rawNumbers!==!1)?y:Il(b,y,l);y!=null&&(p=!1)}}return{row:x,isempty:p}}function Ex(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},h=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof h){case"string":c=Dr(h);break;case"number":c=Dr(t["!ref"]),c.s.r=h;break;default:c=h}n>0&&(s=0);var p=ns(c.s.r),x=[],m=[],b=0,y=0,w=Array.isArray(t),S=c.s.r,k=0,A={};w&&!t[S]&&(t[S]=[]);var z=d.skipHidden&&t["!cols"]||[],H=d.skipHidden&&t["!rows"]||[];for(k=c.s.c;k<=c.e.c;++k)if(!(z[k]||{}).hidden)switch(x[k]=Pn(k),r=w?t[S][k]:t[x[k]+p],n){case 1:a[k]=k-c.s.c;break;case 2:a[k]=x[k];break;case 3:a[k]=d.header[k-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=i=Il(r,null,d),y=A[i]||0,!y)A[i]=1;else{do l=i+"_"+y++;while(A[l]);A[i]=y,A[l]=1}a[k]=l}for(S=c.s.r+s;S<=c.e.r;++S)if(!(H[S]||{}).hidden){var V=ZS(t,c,S,x,n,a,w,d);(V.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(m[b++]=V.row)}return m.length=b,m}var Rw=/"/g;function ek(t,e,r,n,s,a,i,l){for(var c=!0,d=[],h="",p=ns(r),x=e.s.c;x<=e.e.c;++x)if(n[x]){var m=l.dense?(t[r]||[])[x]:t[n[x]+p];if(m==null)h="";else if(m.v!=null){c=!1,h=""+(l.rawNumbers&&m.t=="n"?m.v:Il(m,null,l));for(var b=0,y=0;b!==h.length;++b)if((y=h.charCodeAt(b))===s||y===a||y===34||l.forceQuotes){h='"'+h.replace(Rw,'""')+'"';break}h=="ID"&&(h='"ID"')}else m.f!=null&&!m.F?(c=!1,h="="+m.f,h.indexOf(",")>=0&&(h='"'+h.replace(Rw,'""')+'"')):h="";d.push(h)}return l.blankrows===!1&&c?null:d.join(i)}function by(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=Dr(t["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),d=new RegExp((a=="|"?"\\|":a)+"+$"),h="",p=[];n.dense=Array.isArray(t);for(var x=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],b=s.s.c;b<=s.e.c;++b)(x[b]||{}).hidden||(p[b]=Pn(b));for(var y=0,w=s.s.r;w<=s.e.r;++w)(m[w]||{}).hidden||(h=ek(t,s,w,p,i,c,a,n),h!=null&&(n.strip&&(h=h.replace(d,"")),(h||n.blankrows!==!1)&&r.push((y++?l:"")+h)));return delete n.dense,r.join("")}function tk(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=by(t,e);if(typeof Br>"u"||e.type=="string")return r;var n=Br.utils.encode(1200,r,"str");return""+n}function zB(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=Dr(t["!ref"]),a="",i=[],l,c=[],d=Array.isArray(t);for(l=s.s.c;l<=s.e.c;++l)i[l]=Pn(l);for(var h=s.s.r;h<=s.e.r;++h)for(a=ns(h),l=s.s.c;l<=s.e.c;++l)if(e=i[l]+a,r=d?(t[h]||[])[l]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function rk(t,e,r){var n=r||{},s=+!n.skipHeader,a=t||{},i=0,l=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Gn(n.origin):n.origin;i=c.r,l=c.c}var d,h={s:{c:0,r:0},e:{c:l,r:i+e.length-1+s}};if(a["!ref"]){var p=Dr(a["!ref"]);h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),i==-1&&(i=p.e.r+1,h.e.r=i+e.length-1+s)}else i==-1&&(i=0,h.e.r=e.length-1+s);var x=n.header||[],m=0;e.forEach(function(y,w){as(y).forEach(function(S){(m=x.indexOf(S))==-1&&(x[m=x.length]=S);var k=y[S],A="z",z="",H=fr({c:l+m,r:i+w+s});d=ap(a,H),k&&typeof k=="object"&&!(k instanceof Date)?a[H]=k:(typeof k=="number"?A="n":typeof k=="boolean"?A="b":typeof k=="string"?A="s":k instanceof Date?(A="d",n.cellDates||(A="n",k=Fs(k)),z=n.dateNF||ar[14]):k===null&&n.nullError&&(A="e",k=0),d?(d.t=A,d.v=k,delete d.w,delete d.R,z&&(d.z=z)):a[H]=d={t:A,v:k},z&&(d.z=z))})}),h.e.c=Math.max(h.e.c,l+x.length-1);var b=ns(i);if(s)for(m=0;m<x.length;++m)a[Pn(m+l)+b]={t:"s",v:x[m]};return a["!ref"]=Nr(h),a}function HB(t,e){return rk(null,t,e)}function ap(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Gn(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?ap(t,fr(e)):ap(t,fr({r:e,c:r||0}))}function $B(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function wy(){return{SheetNames:[],Sheets:{}}}function _y(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=i+s)!=-1;++s);}if(FS(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function WB(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=$B(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function VB(t,e){return t.z=e,t}function nk(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function qB(t,e,r){return nk(t,"#"+e,r)}function GB(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function XB(t,e,r,n){for(var s=typeof e!="string"?e:Dr(e),a=typeof e=="string"?e:Nr(e),i=s.s.r;i<=s.e.r;++i)for(var l=s.s.c;l<=s.e.c;++l){var c=ap(t,i,l);c.t="n",c.F=a,delete c.v,i==s.s.r&&l==s.s.c&&(c.f=r,n&&(c.D=!0))}return t}var na={encode_col:Pn,encode_row:ns,encode_cell:fr,encode_range:Nr,decode_col:Xv,decode_row:Gv,split_cell:hF,decode_cell:Gn,decode_range:Ka,format_cell:Il,sheet_add_aoa:_N,sheet_add_json:rk,sheet_add_dom:$S,aoa_to_sheet:R0,json_to_sheet:HB,table_to_sheet:WS,table_to_book:sB,sheet_to_csv:by,sheet_to_txt:tk,sheet_to_json:Ex,sheet_to_html:HS,sheet_to_formulae:zB,sheet_to_row_object_array:Ex,sheet_get_cell:ap,book_new:wy,book_append_sheet:_y,book_set_sheet_visibility:WB,cell_set_number_format:VB,cell_set_hyperlink:nk,cell_set_internal_link:qB,cell_add_comment:GB,sheet_set_array_formula:XB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},dg;function YB(t){dg=t}function KB(t,e){var r=dg(),n=e??{};if(t==null||t["!ref"]==null)return r.push(null),r;var s=Dr(t["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),d=new RegExp((a=="|"?"\\|":a)+"+$"),h="",p=[];n.dense=Array.isArray(t);for(var x=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],b=s.s.c;b<=s.e.c;++b)(x[b]||{}).hidden||(p[b]=Pn(b));var y=s.s.r,w=!1,S=0;return r._read=function(){if(!w)return w=!0,r.push("\uFEFF");for(;y<=s.e.r;)if(++y,!(m[y-1]||{}).hidden&&(h=ek(t,s,y-1,p,i,c,a,n),h!=null&&(n.strip&&(h=h.replace(d,"")),h||n.blankrows!==!1)))return r.push((S++?l:"")+h);return r.push(null)},r}function JB(t,e){var r=dg(),n=e||{},s=n.header!=null?n.header:BS,a=n.footer!=null?n.footer:US;r.push(s);var i=Ka(t["!ref"]);n.dense=Array.isArray(t),r.push(zS(t,i,n));var l=i.s.r,c=!1;return r._read=function(){if(l>i.e.r)return c||(c=!0,r.push("</table>"+a)),r.push(null);for(;l<=i.e.r;){r.push(MS(t,i,l,n)),++l;break}},r}function QB(t,e){var r=dg({objectMode:!0});if(t==null||t["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},s=0,a=1,i=[],l=0,c="",d={s:{r:0,c:0},e:{r:0,c:0}},h=e||{},p=h.range!=null?h.range:t["!ref"];switch(h.header===1?s=1:h.header==="A"?s=2:Array.isArray(h.header)&&(s=3),typeof p){case"string":d=Dr(p);break;case"number":d=Dr(t["!ref"]),d.s.r=p;break;default:d=p}s>0&&(a=0);var x=ns(d.s.r),m=[],b=0,y=Array.isArray(t),w=d.s.r,S=0,k={};y&&!t[w]&&(t[w]=[]);var A=h.skipHidden&&t["!cols"]||[],z=h.skipHidden&&t["!rows"]||[];for(S=d.s.c;S<=d.e.c;++S)if(!(A[S]||{}).hidden)switch(m[S]=Pn(S),n=y?t[w][S]:t[m[S]+x],s){case 1:i[S]=S-d.s.c;break;case 2:i[S]=m[S];break;case 3:i[S]=h.header[S-d.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),c=l=Il(n,null,h),b=k[l]||0,!b)k[l]=1;else{do c=l+"_"+b++;while(k[c]);k[l]=b,k[c]=1}i[S]=c}return w=d.s.r+a,r._read=function(){for(;w<=d.e.r;)if(!(z[w-1]||{}).hidden){var H=ZS(t,d,w,m,s,i,y,h);if(++w,H.isempty===!1||(s===1?h.blankrows!==!1:h.blankrows)){r.push(H.row);return}}return r.push(null)},r}var ZB={to_json:QB,to_html:JB,to_csv:KB,set_readable:YB};const eU=qh.version,sk=Object.freeze(Object.defineProperty({__proto__:null,CFB:er,SSF:rN,parse_xlscfb:hy,parse_zip:XS,read:kx,readFile:Dw,readFileSync:Dw,set_cptable:sT,set_fs:LT,stream:ZB,utils:na,version:eU,write:ug,writeFile:jx,writeFileAsync:UB,writeFileSync:jx,writeFileXLSX:BB,writeXLSX:vy},Symbol.toStringTag,{value:"Module"}));function dn(t){"@babel/helpers - typeof";return dn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dn(t)}var Ta=Uint8Array,Pi=Uint16Array,Ny=Int32Array,fg=new Ta([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),hg=new Ta([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),H2=new Ta([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ak=function(t,e){for(var r=new Pi(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var s=new Ny(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)s[a]=a-r[n]<<5|n;return{b:r,r:s}},ik=ak(fg,2),ok=ik.b,$2=ik.r;ok[28]=258,$2[258]=28;var lk=ak(hg,0),tU=lk.b,Iw=lk.r,W2=new Pi(32768);for(var Tn=0;Tn<32768;++Tn){var Tu=(Tn&43690)>>1|(Tn&21845)<<1;Tu=(Tu&52428)>>2|(Tu&13107)<<2,Tu=(Tu&61680)>>4|(Tu&3855)<<4,W2[Tn]=((Tu&65280)>>8|(Tu&255)<<8)>>1}var Pl=(function(t,e,r){for(var n=t.length,s=0,a=new Pi(e);s<n;++s)t[s]&&++a[t[s]-1];var i=new Pi(e);for(s=1;s<e;++s)i[s]=i[s-1]+a[s-1]<<1;var l;if(r){l=new Pi(1<<e);var c=15-e;for(s=0;s<n;++s)if(t[s])for(var d=s<<4|t[s],h=e-t[s],p=i[t[s]-1]++<<h,x=p|(1<<h)-1;p<=x;++p)l[W2[p]>>c]=d}else for(l=new Pi(n),s=0;s<n;++s)t[s]&&(l[s]=W2[i[t[s]-1]++]>>15-t[s]);return l}),Zu=new Ta(288);for(var Tn=0;Tn<144;++Tn)Zu[Tn]=8;for(var Tn=144;Tn<256;++Tn)Zu[Tn]=9;for(var Tn=256;Tn<280;++Tn)Zu[Tn]=7;for(var Tn=280;Tn<288;++Tn)Zu[Tn]=8;var ip=new Ta(32);for(var Tn=0;Tn<32;++Tn)ip[Tn]=5;var rU=Pl(Zu,9,0),nU=Pl(Zu,9,1),sU=Pl(ip,5,0),aU=Pl(ip,5,1),I1=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},Uo=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},O1=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Sy=function(t){return(t+7)/8|0},ck=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Ta(t.subarray(e,r))},iU=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ho=function(t,e,r){var n=new Error(e||iU[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,Ho),!r)throw n;return n},oU=function(t,e,r,n){var s=t.length,a=0;if(!s||e.f&&!e.l)return r||new Ta(0);var i=!r,l=i||e.i!=2,c=e.i;i&&(r=new Ta(s*3));var d=function(We){var ue=r.length;if(We>ue){var nt=new Ta(Math.max(ue*2,We));nt.set(r),r=nt}},h=e.f||0,p=e.p||0,x=e.b||0,m=e.l,b=e.d,y=e.m,w=e.n,S=s*8;do{if(!m){h=Uo(t,p,1);var k=Uo(t,p+1,3);if(p+=3,k)if(k==1)m=nU,b=aU,y=9,w=5;else if(k==2){var V=Uo(t,p,31)+257,B=Uo(t,p+10,15)+4,R=V+Uo(t,p+5,31)+1;p+=14;for(var O=new Ta(R),ee=new Ta(19),I=0;I<B;++I)ee[H2[I]]=Uo(t,p+I*3,7);p+=B*3;for(var P=I1(ee),ae=(1<<P)-1,G=Pl(ee,P,1),I=0;I<R;){var M=G[Uo(t,p,ae)];p+=M&15;var A=M>>4;if(A<16)O[I++]=A;else{var te=0,ie=0;for(A==16?(ie=3+Uo(t,p,3),p+=2,te=O[I-1]):A==17?(ie=3+Uo(t,p,7),p+=3):A==18&&(ie=11+Uo(t,p,127),p+=7);ie--;)O[I++]=te}}var le=O.subarray(0,V),X=O.subarray(V);y=I1(le),w=I1(X),m=Pl(le,y,1),b=Pl(X,w,1)}else Ho(1);else{var A=Sy(p)+4,z=t[A-4]|t[A-3]<<8,H=A+z;if(H>s){c&&Ho(0);break}l&&d(x+z),r.set(t.subarray(A,H),x),e.b=x+=z,e.p=p=H*8,e.f=h;continue}if(p>S){c&&Ho(0);break}}l&&d(x+131072);for(var fe=(1<<y)-1,K=(1<<w)-1,E=p;;E=p){var te=m[O1(t,p)&fe],W=te>>4;if(p+=te&15,p>S){c&&Ho(0);break}if(te||Ho(2),W<256)r[x++]=W;else if(W==256){E=p,m=null;break}else{var L=W-254;if(W>264){var I=W-257,F=fg[I];L=Uo(t,p,(1<<F)-1)+ok[I],p+=F}var q=b[O1(t,p)&K],he=q>>4;q||Ho(3),p+=q&15;var X=tU[he];if(he>3){var F=hg[he];X+=O1(t,p)&(1<<F)-1,p+=F}if(p>S){c&&Ho(0);break}l&&d(x+131072);var me=x+L;if(x<X){var Z=a-X,Se=Math.min(X,me);for(Z+x<0&&Ho(3);x<Se;++x)r[x]=n[Z+x]}for(;x<me;++x)r[x]=r[x-X]}}e.l=m,e.p=E,e.b=x,e.f=h,m&&(h=1,e.m=y,e.d=b,e.n=w)}while(!h);return x!=r.length&&i?ck(r,0,x):r.subarray(0,x)},mc=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},ch=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},M1=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var s=r.length,a=r.slice();if(!s)return{t:dk,l:0};if(s==1){var i=new Ta(r[0].s+1);return i[r[0].s]=1,{t:i,l:1}}r.sort(function(H,V){return H.f-V.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],d=0,h=1,p=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};h!=s-1;)l=r[r[d].f<r[p].f?d++:p++],c=r[d!=h&&r[d].f<r[p].f?d++:p++],r[h++]={s:-1,f:l.f+c.f,l,r:c};for(var x=a[0].s,n=1;n<s;++n)a[n].s>x&&(x=a[n].s);var m=new Pi(x+1),b=V2(r[h-1],m,0);if(b>e){var n=0,y=0,w=b-e,S=1<<w;for(a.sort(function(V,B){return m[B.s]-m[V.s]||V.f-B.f});n<s;++n){var k=a[n].s;if(m[k]>e)y+=S-(1<<b-m[k]),m[k]=e;else break}for(y>>=w;y>0;){var A=a[n].s;m[A]<e?y-=1<<e-m[A]++-1:++n}for(;n>=0&&y;--n){var z=a[n].s;m[z]==e&&(--m[z],++y)}b=e}return{t:new Ta(m),l:b}},V2=function(t,e,r){return t.s==-1?Math.max(V2(t.l,e,r+1),V2(t.r,e,r+1)):e[t.s]=r},Ow=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Pi(++e),n=0,s=t[0],a=1,i=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==s&&l!=e)++a;else{if(!s&&a>2){for(;a>138;a-=138)i(32754);a>2&&(i(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(i(s),--a;a>6;a-=6)i(8304);a>2&&(i(a-3<<5|8208),a=0)}for(;a--;)i(s);a=1,s=t[l]}return{c:r.subarray(0,n),n:e}},uh=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},uk=function(t,e,r){var n=r.length,s=Sy(e+2);t[s]=n&255,t[s+1]=n>>8,t[s+2]=t[s]^255,t[s+3]=t[s+1]^255;for(var a=0;a<n;++a)t[s+a+4]=r[a];return(s+4+n)*8},Mw=function(t,e,r,n,s,a,i,l,c,d,h){mc(e,h++,r),++s[256];for(var p=M1(s,15),x=p.t,m=p.l,b=M1(a,15),y=b.t,w=b.l,S=Ow(x),k=S.c,A=S.n,z=Ow(y),H=z.c,V=z.n,B=new Pi(19),R=0;R<k.length;++R)++B[k[R]&31];for(var R=0;R<H.length;++R)++B[H[R]&31];for(var O=M1(B,7),ee=O.t,I=O.l,P=19;P>4&&!ee[H2[P-1]];--P);var ae=d+5<<3,G=uh(s,Zu)+uh(a,ip)+i,M=uh(s,x)+uh(a,y)+i+14+3*P+uh(B,ee)+2*B[16]+3*B[17]+7*B[18];if(c>=0&&ae<=G&&ae<=M)return uk(e,h,t.subarray(c,c+d));var te,ie,le,X;if(mc(e,h,1+(M<G)),h+=2,M<G){te=Pl(x,m,0),ie=x,le=Pl(y,w,0),X=y;var fe=Pl(ee,I,0);mc(e,h,A-257),mc(e,h+5,V-1),mc(e,h+10,P-4),h+=14;for(var R=0;R<P;++R)mc(e,h+3*R,ee[H2[R]]);h+=3*P;for(var K=[k,H],E=0;E<2;++E)for(var W=K[E],R=0;R<W.length;++R){var L=W[R]&31;mc(e,h,fe[L]),h+=ee[L],L>15&&(mc(e,h,W[R]>>5&127),h+=W[R]>>12)}}else te=rU,ie=Zu,le=sU,X=ip;for(var R=0;R<l;++R){var F=n[R];if(F>255){var L=F>>18&31;ch(e,h,te[L+257]),h+=ie[L+257],L>7&&(mc(e,h,F>>23&31),h+=fg[L]);var q=F&31;ch(e,h,le[q]),h+=X[q],q>3&&(ch(e,h,F>>5&8191),h+=hg[q])}else ch(e,h,te[F]),h+=ie[F]}return ch(e,h,te[256]),h+ie[256]},lU=new Ny([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),dk=new Ta(0),cU=function(t,e,r,n,s,a){var i=a.z||t.length,l=new Ta(n+i+5*(1+Math.ceil(i/7e3))+s),c=l.subarray(n,l.length-s),d=a.l,h=(a.r||0)&7;if(e){h&&(c[0]=a.r>>3);for(var p=lU[e-1],x=p>>13,m=p&8191,b=(1<<r)-1,y=a.p||new Pi(32768),w=a.h||new Pi(b+1),S=Math.ceil(r/3),k=2*S,A=function(rt){return(t[rt]^t[rt+1]<<S^t[rt+2]<<k)&b},z=new Ny(25e3),H=new Pi(288),V=new Pi(32),B=0,R=0,O=a.i||0,ee=0,I=a.w||0,P=0;O+2<i;++O){var ae=A(O),G=O&32767,M=w[ae];if(y[G]=M,w[ae]=G,I<=O){var te=i-O;if((B>7e3||ee>24576)&&(te>423||!d)){h=Mw(t,c,0,z,H,V,R,ee,P,O-P,h),ee=B=R=0,P=O;for(var ie=0;ie<286;++ie)H[ie]=0;for(var ie=0;ie<30;++ie)V[ie]=0}var le=2,X=0,fe=m,K=G-M&32767;if(te>2&&ae==A(O-K))for(var E=Math.min(x,te)-1,W=Math.min(32767,O),L=Math.min(258,te);K<=W&&--fe&&G!=M;){if(t[O+le]==t[O+le-K]){for(var F=0;F<L&&t[O+F]==t[O+F-K];++F);if(F>le){if(le=F,X=K,F>E)break;for(var q=Math.min(K,F-2),he=0,ie=0;ie<q;++ie){var me=O-K+ie&32767,Z=y[me],Se=me-Z&32767;Se>he&&(he=Se,M=me)}}}G=M,M=y[G],K+=G-M&32767}if(X){z[ee++]=268435456|$2[le]<<18|Iw[X];var We=$2[le]&31,ue=Iw[X]&31;R+=fg[We]+hg[ue],++H[257+We],++V[ue],I=O+le,++B}else z[ee++]=t[O],++H[t[O]]}}for(O=Math.max(O,I);O<i;++O)z[ee++]=t[O],++H[t[O]];h=Mw(t,c,d,z,H,V,R,ee,P,O-P,h),d||(a.r=h&7|c[h/8|0]<<3,h-=7,a.h=w,a.p=y,a.i=O,a.w=I)}else{for(var O=a.w||0;O<i+d;O+=65535){var nt=O+65535;nt>=i&&(c[h/8|0]=d,nt=i),h=uk(c,h+1,t.subarray(O,nt))}a.i=i}return ck(l,0,n+Sy(h)+s)},fk=function(){var t=1,e=0;return{p:function(r){for(var n=t,s=e,a=r.length|0,i=0;i!=a;){for(var l=Math.min(i+2655,a);i<l;++i)s+=n+=r[i];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}t=n,e=s},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},uU=function(t,e,r,n,s){if(!s&&(s={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),i=new Ta(a.length+t.length);i.set(a),i.set(t,a.length),t=i,s.w=a.length}return cU(t,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,s)},hk=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},dU=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var s=fk();s.p(e.dictionary),hk(t,2,s.d())}},fU=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&Ho(6,"invalid zlib data"),(t[1]>>5&1)==1&&Ho(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function q2(t,e){e||(e={});var r=fk();r.p(t);var n=uU(t,e,e.dictionary?6:2,4);return dU(n,e),hk(n,n.length-4,r.d()),n}function hU(t,e){return oU(t.subarray(fU(t),-4),{i:2},e,e)}var pU=typeof TextDecoder<"u"&&new TextDecoder,mU=0;try{pU.decode(dk,{stream:!0}),mU=1}catch{}var dr=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function B1(){dr.console&&typeof dr.console.log=="function"&&dr.console.log.apply(dr.console,arguments)}var gn={log:B1,warn:function(t){dr.console&&(typeof dr.console.warn=="function"?dr.console.warn.apply(dr.console,arguments):B1.call(null,arguments))},error:function(t){dr.console&&(typeof dr.console.error=="function"?dr.console.error.apply(dr.console,arguments):B1(t))}};function U1(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){Ud(n.response,e,r)},n.onerror=function(){gn.error("could not download file")},n.send()}function Bw(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Tm(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Lh,G2,Ud=dr.saveAs||((typeof window>"u"?"undefined":dn(window))!=="object"||window!==dr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=dr.URL||dr.webkitURL,s=document.createElement("a");e=e||t.name||"download",s.download=e,s.rel="noopener",typeof t=="string"?(s.href=t,s.origin!==location.origin?Bw(s.href)?U1(t,e,r):Tm(s,s.target="_blank"):Tm(s)):(s.href=n.createObjectURL(t),setTimeout((function(){n.revokeObjectURL(s.href)}),4e4),setTimeout((function(){Tm(s)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(Bw(t))U1(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout((function(){Tm(n)}))}else navigator.msSaveOrOpenBlob((function(s,a){return a===void 0?a={autoBom:!1}:dn(a)!=="object"&&(gn.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s})(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return U1(t,e,r);var s=t.type==="application/octet-stream",a=/constructor/i.test(dr.HTMLElement)||dr.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||s&&a)&&(typeof FileReader>"u"?"undefined":dn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var h=l.result;h=i?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=h:location=h,n=null},l.readAsDataURL(t)}else{var c=dr.URL||dr.webkitURL,d=c.createObjectURL(t);n?n.location=d:location.href=d,n=null,setTimeout((function(){c.revokeObjectURL(d)}),4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function pk(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,a=r[n].process,i=s.exec(t);i&&(e=a(i),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function z1(t,e){var r=t[0],n=t[1],s=t[2],a=t[3];r=ya(r,n,s,a,e[0],7,-680876936),a=ya(a,r,n,s,e[1],12,-389564586),s=ya(s,a,r,n,e[2],17,606105819),n=ya(n,s,a,r,e[3],22,-1044525330),r=ya(r,n,s,a,e[4],7,-176418897),a=ya(a,r,n,s,e[5],12,1200080426),s=ya(s,a,r,n,e[6],17,-1473231341),n=ya(n,s,a,r,e[7],22,-45705983),r=ya(r,n,s,a,e[8],7,1770035416),a=ya(a,r,n,s,e[9],12,-1958414417),s=ya(s,a,r,n,e[10],17,-42063),n=ya(n,s,a,r,e[11],22,-1990404162),r=ya(r,n,s,a,e[12],7,1804603682),a=ya(a,r,n,s,e[13],12,-40341101),s=ya(s,a,r,n,e[14],17,-1502002290),r=ba(r,n=ya(n,s,a,r,e[15],22,1236535329),s,a,e[1],5,-165796510),a=ba(a,r,n,s,e[6],9,-1069501632),s=ba(s,a,r,n,e[11],14,643717713),n=ba(n,s,a,r,e[0],20,-373897302),r=ba(r,n,s,a,e[5],5,-701558691),a=ba(a,r,n,s,e[10],9,38016083),s=ba(s,a,r,n,e[15],14,-660478335),n=ba(n,s,a,r,e[4],20,-405537848),r=ba(r,n,s,a,e[9],5,568446438),a=ba(a,r,n,s,e[14],9,-1019803690),s=ba(s,a,r,n,e[3],14,-187363961),n=ba(n,s,a,r,e[8],20,1163531501),r=ba(r,n,s,a,e[13],5,-1444681467),a=ba(a,r,n,s,e[2],9,-51403784),s=ba(s,a,r,n,e[7],14,1735328473),r=wa(r,n=ba(n,s,a,r,e[12],20,-1926607734),s,a,e[5],4,-378558),a=wa(a,r,n,s,e[8],11,-2022574463),s=wa(s,a,r,n,e[11],16,1839030562),n=wa(n,s,a,r,e[14],23,-35309556),r=wa(r,n,s,a,e[1],4,-1530992060),a=wa(a,r,n,s,e[4],11,1272893353),s=wa(s,a,r,n,e[7],16,-155497632),n=wa(n,s,a,r,e[10],23,-1094730640),r=wa(r,n,s,a,e[13],4,681279174),a=wa(a,r,n,s,e[0],11,-358537222),s=wa(s,a,r,n,e[3],16,-722521979),n=wa(n,s,a,r,e[6],23,76029189),r=wa(r,n,s,a,e[9],4,-640364487),a=wa(a,r,n,s,e[12],11,-421815835),s=wa(s,a,r,n,e[15],16,530742520),r=_a(r,n=wa(n,s,a,r,e[2],23,-995338651),s,a,e[0],6,-198630844),a=_a(a,r,n,s,e[7],10,1126891415),s=_a(s,a,r,n,e[14],15,-1416354905),n=_a(n,s,a,r,e[5],21,-57434055),r=_a(r,n,s,a,e[12],6,1700485571),a=_a(a,r,n,s,e[3],10,-1894986606),s=_a(s,a,r,n,e[10],15,-1051523),n=_a(n,s,a,r,e[1],21,-2054922799),r=_a(r,n,s,a,e[8],6,1873313359),a=_a(a,r,n,s,e[15],10,-30611744),s=_a(s,a,r,n,e[6],15,-1560198380),n=_a(n,s,a,r,e[13],21,1309151649),r=_a(r,n,s,a,e[4],6,-145523070),a=_a(a,r,n,s,e[11],10,-1120210379),s=_a(s,a,r,n,e[2],15,718787259),n=_a(n,s,a,r,e[9],21,-343485551),t[0]=Bu(r,t[0]),t[1]=Bu(n,t[1]),t[2]=Bu(s,t[2]),t[3]=Bu(a,t[3])}function pg(t,e,r,n,s,a){return e=Bu(Bu(e,t),Bu(n,a)),Bu(e<<s|e>>>32-s,r)}function ya(t,e,r,n,s,a,i){return pg(e&r|~e&n,t,e,s,a,i)}function ba(t,e,r,n,s,a,i){return pg(e&n|r&~n,t,e,s,a,i)}function wa(t,e,r,n,s,a,i){return pg(e^r^n,t,e,s,a,i)}function _a(t,e,r,n,s,a,i){return pg(r^(e|~n),t,e,s,a,i)}function mk(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)z1(n,xU(t.substring(e-64,e)));t=t.substring(e-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)s[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(z1(n,s),e=0;e<16;e++)s[e]=0;return s[14]=8*r,z1(n,s),n}function xU(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}Lh=dr.atob.bind(dr),G2=dr.btoa.bind(dr);var Uw="0123456789abcdef".split("");function gU(t){for(var e="",r=0;r<4;r++)e+=Uw[t>>8*r+4&15]+Uw[t>>8*r&15];return e}function vU(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function X2(t){return mk(t).map(vU).join("")}var yU=(function(t){for(var e=0;e<t.length;e++)t[e]=gU(t[e]);return t.join("")})(mk("hello"))!="5d41402abc4b2a76b9719d911017c592";function Bu(t,e){if(yU){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Y2(t,e){var r,n,s,a;if(t!==r){for(var i=(s=t,a=1+(256/t.length>>0),new Array(a+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var h=l[c];d=(d+h+i.charCodeAt(c))%256,l[c]=l[d],l[d]=h}r=t,n=l}else l=n;var p=e.length,x=0,m=0,b="";for(c=0;c<p;c++)m=(m+(h=l[x=(x+1)%256]))%256,l[x]=l[m],l[m]=h,i=l[(l[x]+l[m])%256],b+=String.fromCharCode(e.charCodeAt(c)^i);return b}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var zw={print:4,modify:8,copy:16,"annot-forms":32};function a0(t,e,r,n){this.v=1,this.r=2;var s=192;t.forEach((function(l){if(zw.perm!==void 0)throw new Error("Invalid permission: "+l);s+=zw[l]})),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(e+this.padding).substr(0,32),i=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,i),this.P=-(1+(255^s)),this.encryptionKey=X2(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Y2(this.encryptionKey,this.padding)}function i0(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var s=t.charCodeAt(n);s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?e+="#"+("0"+s.toString(16)).slice(-2):e+=t[n]}return e}function Hw(t){if(dn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var a=Math.random().toString(35);return e[r][a]=[n,!!s],a},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var a in e[r]){var i=e[r][a];try{i[0].apply(t,n)}catch(l){dr.console&&gn.error("jsPDF PubSub Error",l.message,l)}i[1]&&s.push(a)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Ax(t){if(!(this instanceof Ax))return new Ax(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function xk(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Wd(t,e,r,n,s){if(!(this instanceof Wd))return new Wd(t,e,r,n,s);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,xk.call(this,n,s)}function c0(t,e,r,n,s){if(!(this instanceof c0))return new c0(t,e,r,n,s);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,xk.call(this,n,s)}function or(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],a=arguments[3],i=[],l=1,c=16,d="S",h=null;dn(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,s=t.format||s,a=t.compress||t.compressPdf||a,(h=t.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),d=t.defaultPathOperation||"S"),i=t.filters||(a===!0?["FlateEncode"]:i),n=n||"mm",r=(""+(r||"P")).toLowerCase();var p=t.putOnlyUsedFonts||!1,x={},m={internal:{},__private__:{}};m.__private__.PubSub=Hw;var b="1.3",y=m.__private__.getPdfVersion=function(){return b};m.__private__.setPdfVersion=function(j){b=j};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return w};var S=m.__private__.getPageFormat=function(j){return w[j]};s=s||"a4";var k={COMPAT:"compat",ADVANCED:"advanced"},A=k.COMPAT;function z(){this.saveGraphicsState(),ve(new Mt(lt,0,0,-lt,0,cl()*lt).toString()+" cm"),this.setFontSize(this.getFontSize()/lt),d="n",A=k.ADVANCED}function H(){this.restoreGraphicsState(),d="S",A=k.COMPAT}var V=m.__private__.combineFontStyleAndFontWeight=function(j,J){if(j=="bold"&&J=="normal"||j=="bold"&&J==400||j=="normal"&&J=="italic"||j=="bold"&&J=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return J&&(j=J==400||J==="normal"?j==="italic"?"italic":"normal":J!=700&&J!=="bold"||j!=="normal"?(J==700?"bold":J)+""+j:"bold"),j};m.advancedAPI=function(j){var J=A===k.COMPAT;return J&&z.call(this),typeof j!="function"||(j(this),J&&H.call(this)),this},m.compatAPI=function(j){var J=A===k.ADVANCED;return J&&H.call(this),typeof j!="function"||(j(this),J&&z.call(this)),this},m.isAdvancedAPI=function(){return A===k.ADVANCED};var B,R=function(j){if(A!==k.ADVANCED)throw new Error(j+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},O=m.roundToPrecision=m.__private__.roundToPrecision=function(j,J){var _e=e||J;if(isNaN(j)||isNaN(_e))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return j.toFixed(_e).replace(/0+$/,"")};B=m.hpf=m.__private__.hpf=typeof c=="number"?function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return O(j,c)}:c==="smart"?function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return O(j,j>-1&&j<1?16:5)}:function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return O(j,16)};var ee=m.f2=m.__private__.f2=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.f2");return O(j,2)},I=m.__private__.f3=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.f3");return O(j,3)},P=m.scale=m.__private__.scale=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.scale");return A===k.COMPAT?j*lt:A===k.ADVANCED?j:void 0},ae=function(j){return A===k.COMPAT?cl()-j:A===k.ADVANCED?j:void 0},G=function(j){return P(ae(j))};m.__private__.setPrecision=m.setPrecision=function(j){typeof parseInt(j,10)=="number"&&(e=parseInt(j,10))};var M,te="00000000000000000000000000000000",ie=m.__private__.getFileId=function(){return te},le=m.__private__.setFileId=function(j){return te=j!==void 0&&/^[a-fA-F0-9]{32}$/.test(j)?j.toUpperCase():te.split("").map((function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))})).join(""),h!==null&&(Sn=new a0(h.userPermissions,h.userPassword,h.ownerPassword,te)),te};m.setFileId=function(j){return le(j),this},m.getFileId=function(){return ie()};var X=m.__private__.convertDateToPDFDate=function(j){var J=j.getTimezoneOffset(),_e=J<0?"+":"-",je=Math.floor(Math.abs(J/60)),Ie=Math.abs(J%60),Ze=[_e,L(je),"'",L(Ie),"'"].join("");return["D:",j.getFullYear(),L(j.getMonth()+1),L(j.getDate()),L(j.getHours()),L(j.getMinutes()),L(j.getSeconds()),Ze].join("")},fe=m.__private__.convertPDFDateToDate=function(j){var J=parseInt(j.substr(2,4),10),_e=parseInt(j.substr(6,2),10)-1,je=parseInt(j.substr(8,2),10),Ie=parseInt(j.substr(10,2),10),Ze=parseInt(j.substr(12,2),10),dt=parseInt(j.substr(14,2),10);return new Date(J,_e,je,Ie,Ze,dt,0)},K=m.__private__.setCreationDate=function(j){var J;if(j===void 0&&(j=new Date),j instanceof Date)J=X(j);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(j))throw new Error("Invalid argument passed to jsPDF.setCreationDate");J=j}return M=J},E=m.__private__.getCreationDate=function(j){var J=M;return j==="jsDate"&&(J=fe(M)),J};m.setCreationDate=function(j){return K(j),this},m.getCreationDate=function(j){return E(j)};var W,L=m.__private__.padd2=function(j){return("0"+parseInt(j)).slice(-2)},F=m.__private__.padd2Hex=function(j){return("00"+(j=j.toString())).substr(j.length)},q=0,he=[],me=[],Z=0,Se=[],We=[],ue=!1,nt=me,rt=function(){q=0,Z=0,me=[],he=[],Se=[],pe=mn(),xe=mn()};m.__private__.setCustomOutputDestination=function(j){ue=!0,nt=j};var De=function(j){ue||(nt=j)};m.__private__.resetCustomOutputDestination=function(){ue=!1,nt=me};var ve=m.__private__.out=function(j){return j=j.toString(),Z+=j.length+1,nt.push(j),nt},Xe=m.__private__.write=function(j){return ve(arguments.length===1?j.toString():Array.prototype.join.call(arguments," "))},Re=m.__private__.getArrayBuffer=function(j){for(var J=j.length,_e=new ArrayBuffer(J),je=new Uint8Array(_e);J--;)je[J]=j.charCodeAt(J);return _e},Ke=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return Ke};var it=t.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(j){return it=A===k.ADVANCED?j/lt:j,this};var pt,vt=m.__private__.getFontSize=m.getFontSize=function(){return A===k.COMPAT?it:it*lt},Pt=t.R2L||!1;m.__private__.setR2L=m.setR2L=function(j){return Pt=j,this},m.__private__.getR2L=m.getR2L=function(){return Pt};var Dt,Ot=m.__private__.setZoomMode=function(j){var J=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(j))pt=j;else if(isNaN(j)){if(J.indexOf(j)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+j+'" is not recognized.');pt=j}else pt=parseInt(j,10)};m.__private__.getZoomMode=function(){return pt};var Yt,lr=m.__private__.setPageMode=function(j){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(j)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+j+'" is not recognized.');Dt=j};m.__private__.getPageMode=function(){return Dt};var Qt=m.__private__.setLayoutMode=function(j){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(j)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+j+'" is not recognized.');Yt=j};m.__private__.getLayoutMode=function(){return Yt},m.__private__.setDisplayMode=m.setDisplayMode=function(j,J,_e){return Ot(j),Qt(J),lr(_e),this};var It={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(j){if(Object.keys(It).indexOf(j)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return It[j]},m.__private__.getDocumentProperties=function(){return It},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(j){for(var J in It)It.hasOwnProperty(J)&&j[J]&&(It[J]=j[J]);return this},m.__private__.setDocumentProperty=function(j,J){if(Object.keys(It).indexOf(j)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return It[j]=J};var bt,lt,tr,ke,$t,$e={},wt={},Wt=[],jt={},hr={},Vt={},Sr={},Ur=null,rr=0,Ut=[],cr=new Hw(m),Te=t.hotfixes||[],yt={},pr={},hn=[],Mt=function j(J,_e,je,Ie,Ze,dt){if(!(this instanceof j))return new j(J,_e,je,Ie,Ze,dt);isNaN(J)&&(J=1),isNaN(_e)&&(_e=0),isNaN(je)&&(je=0),isNaN(Ie)&&(Ie=1),isNaN(Ze)&&(Ze=0),isNaN(dt)&&(dt=0),this._matrix=[J,_e,je,Ie,Ze,dt]};Object.defineProperty(Mt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(j){this._matrix[0]=j}}),Object.defineProperty(Mt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(j){this._matrix[1]=j}}),Object.defineProperty(Mt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(j){this._matrix[2]=j}}),Object.defineProperty(Mt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(j){this._matrix[3]=j}}),Object.defineProperty(Mt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(j){this._matrix[4]=j}}),Object.defineProperty(Mt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(j){this._matrix[5]=j}}),Object.defineProperty(Mt.prototype,"a",{get:function(){return this._matrix[0]},set:function(j){this._matrix[0]=j}}),Object.defineProperty(Mt.prototype,"b",{get:function(){return this._matrix[1]},set:function(j){this._matrix[1]=j}}),Object.defineProperty(Mt.prototype,"c",{get:function(){return this._matrix[2]},set:function(j){this._matrix[2]=j}}),Object.defineProperty(Mt.prototype,"d",{get:function(){return this._matrix[3]},set:function(j){this._matrix[3]=j}}),Object.defineProperty(Mt.prototype,"e",{get:function(){return this._matrix[4]},set:function(j){this._matrix[4]=j}}),Object.defineProperty(Mt.prototype,"f",{get:function(){return this._matrix[5]},set:function(j){this._matrix[5]=j}}),Object.defineProperty(Mt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Mt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Mt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Mt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Mt.prototype.join=function(j){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(B).join(j)},Mt.prototype.multiply=function(j){var J=j.sx*this.sx+j.shy*this.shx,_e=j.sx*this.shy+j.shy*this.sy,je=j.shx*this.sx+j.sy*this.shx,Ie=j.shx*this.shy+j.sy*this.sy,Ze=j.tx*this.sx+j.ty*this.shx+this.tx,dt=j.tx*this.shy+j.ty*this.sy+this.ty;return new Mt(J,_e,je,Ie,Ze,dt)},Mt.prototype.decompose=function(){var j=this.sx,J=this.shy,_e=this.shx,je=this.sy,Ie=this.tx,Ze=this.ty,dt=Math.sqrt(j*j+J*J),Tt=(j/=dt)*_e+(J/=dt)*je;_e-=j*Tt,je-=J*Tt;var Jt=Math.sqrt(_e*_e+je*je);return Tt/=Jt,j*(je/=Jt)<J*(_e/=Jt)&&(j=-j,J=-J,Tt=-Tt,dt=-dt),{scale:new Mt(dt,0,0,Jt,0,0),translate:new Mt(1,0,0,1,Ie,Ze),rotate:new Mt(j,J,-J,j,0,0),skew:new Mt(1,0,Tt,1,0,0)}},Mt.prototype.toString=function(j){return this.join(" ")},Mt.prototype.inversed=function(){var j=this.sx,J=this.shy,_e=this.shx,je=this.sy,Ie=this.tx,Ze=this.ty,dt=1/(j*je-J*_e),Tt=je*dt,Jt=-J*dt,yr=-_e*dt,vr=j*dt;return new Mt(Tt,Jt,yr,vr,-Tt*Ie-yr*Ze,-Jt*Ie-vr*Ze)},Mt.prototype.applyToPoint=function(j){var J=j.x*this.sx+j.y*this.shx+this.tx,_e=j.x*this.shy+j.y*this.sy+this.ty;return new Wi(J,_e)},Mt.prototype.applyToRectangle=function(j){var J=this.applyToPoint(j),_e=this.applyToPoint(new Wi(j.x+j.w,j.y+j.h));return new ll(J.x,J.y,_e.x-J.x,_e.y-J.y)},Mt.prototype.clone=function(){var j=this.sx,J=this.shy,_e=this.shx,je=this.sy,Ie=this.tx,Ze=this.ty;return new Mt(j,J,_e,je,Ie,Ze)},m.Matrix=Mt;var Un=m.matrixMult=function(j,J){return J.multiply(j)},yn=new Mt(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=yn;var zn=function(j,J){if(!hr[j]){var _e=(J instanceof Wd?"Sh":"P")+(Object.keys(jt).length+1).toString(10);J.id=_e,hr[j]=_e,jt[_e]=J,cr.publish("addPattern",J)}};m.ShadingPattern=Wd,m.TilingPattern=c0,m.addShadingPattern=function(j,J){return R("addShadingPattern()"),zn(j,J),this},m.beginTilingPattern=function(j){R("beginTilingPattern()"),Af(j.boundingBox[0],j.boundingBox[1],j.boundingBox[2]-j.boundingBox[0],j.boundingBox[3]-j.boundingBox[1],j.matrix)},m.endTilingPattern=function(j,J){R("endTilingPattern()"),J.stream=We[W].join(`
`),zn(j,J),cr.publish("endTilingPattern",J),hn.pop().restore()};var pn=m.__private__.newObject=function(){var j=mn();return se(j,!0),j},mn=m.__private__.newObjectDeferred=function(){return q++,he[q]=function(){return Z},q},se=function(j,J){return J=typeof J=="boolean"&&J,he[j]=Z,J&&ve(j+" 0 obj"),j},ye=m.__private__.newAdditionalObject=function(){var j={objId:mn(),content:""};return Se.push(j),j},pe=mn(),xe=mn(),be=m.__private__.decodeColorString=function(j){var J=j.split(" ");if(J.length!==2||J[1]!=="g"&&J[1]!=="G")J.length===5&&(J[4]==="k"||J[4]==="K")&&(J=[(1-J[0])*(1-J[3]),(1-J[1])*(1-J[3]),(1-J[2])*(1-J[3]),"r"]);else{var _e=parseFloat(J[0]);J=[_e,_e,_e,"r"]}for(var je="#",Ie=0;Ie<3;Ie++)je+=("0"+Math.floor(255*parseFloat(J[Ie])).toString(16)).slice(-2);return je},we=m.__private__.encodeColorString=function(j){var J;typeof j=="string"&&(j={ch1:j});var _e=j.ch1,je=j.ch2,Ie=j.ch3,Ze=j.ch4,dt=j.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof _e=="string"&&_e.charAt(0)!=="#"){var Tt=new pk(_e);if(Tt.ok)_e=Tt.toHex();else if(!/^\d*\.?\d*$/.test(_e))throw new Error('Invalid color "'+_e+'" passed to jsPDF.encodeColorString.')}if(typeof _e=="string"&&/^#[0-9A-Fa-f]{3}$/.test(_e)&&(_e="#"+_e[1]+_e[1]+_e[2]+_e[2]+_e[3]+_e[3]),typeof _e=="string"&&/^#[0-9A-Fa-f]{6}$/.test(_e)){var Jt=parseInt(_e.substr(1),16);_e=Jt>>16&255,je=Jt>>8&255,Ie=255&Jt}if(je===void 0||Ze===void 0&&_e===je&&je===Ie)if(typeof _e=="string")J=_e+" "+dt[0];else switch(j.precision){case 2:J=ee(_e/255)+" "+dt[0];break;case 3:default:J=I(_e/255)+" "+dt[0]}else if(Ze===void 0||dn(Ze)==="object"){if(Ze&&!isNaN(Ze.a)&&Ze.a===0)return J=["1.","1.","1.",dt[1]].join(" ");if(typeof _e=="string")J=[_e,je,Ie,dt[1]].join(" ");else switch(j.precision){case 2:J=[ee(_e/255),ee(je/255),ee(Ie/255),dt[1]].join(" ");break;default:case 3:J=[I(_e/255),I(je/255),I(Ie/255),dt[1]].join(" ")}}else if(typeof _e=="string")J=[_e,je,Ie,Ze,dt[2]].join(" ");else switch(j.precision){case 2:J=[ee(_e),ee(je),ee(Ie),ee(Ze),dt[2]].join(" ");break;case 3:default:J=[I(_e),I(je),I(Ie),I(Ze),dt[2]].join(" ")}return J},Ue=m.__private__.getFilters=function(){return i},Je=m.__private__.putStream=function(j){var J=(j=j||{}).data||"",_e=j.filters||Ue(),je=j.alreadyAppliedFilters||[],Ie=j.addLength1||!1,Ze=J.length,dt=j.objectId,Tt=function(Ps){return Ps};if(h!==null&&dt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(Tt=Sn.encryptor(dt,0));var Jt={};_e===!0&&(_e=["FlateEncode"]);var yr=j.additionalKeyValues||[],vr=(Jt=or.API.processDataByFilters!==void 0?or.API.processDataByFilters(J,_e):{data:J,reverseChain:[]}).reverseChain+(Array.isArray(je)?je.join(" "):je.toString());if(Jt.data.length!==0&&(yr.push({key:"Length",value:Jt.data.length}),Ie===!0&&yr.push({key:"Length1",value:Ze})),vr.length!=0)if(vr.split("/").length-1==1)yr.push({key:"Filter",value:vr});else{yr.push({key:"Filter",value:"["+vr+"]"});for(var Fr=0;Fr<yr.length;Fr+=1)if(yr[Fr].key==="DecodeParms"){for(var kn=[],Rn=0;Rn<Jt.reverseChain.split("/").length-1;Rn+=1)kn.push("null");kn.push(yr[Fr].value),yr[Fr].value="["+kn.join(" ")+"]"}}ve("<<");for(var Yn=0;Yn<yr.length;Yn++)ve("/"+yr[Yn].key+" "+yr[Yn].value);ve(">>"),Jt.data.length!==0&&(ve("stream"),ve(Tt(Jt.data)),ve("endstream"))},Be=m.__private__.putPage=function(j){var J=j.number,_e=j.data,je=j.objId,Ie=j.contentsObjId;se(je,!0),ve("<</Type /Page"),ve("/Parent "+j.rootDictionaryObjId+" 0 R"),ve("/Resources "+j.resourceDictionaryObjId+" 0 R"),ve("/MediaBox ["+parseFloat(B(j.mediaBox.bottomLeftX))+" "+parseFloat(B(j.mediaBox.bottomLeftY))+" "+B(j.mediaBox.topRightX)+" "+B(j.mediaBox.topRightY)+"]"),j.cropBox!==null&&ve("/CropBox ["+B(j.cropBox.bottomLeftX)+" "+B(j.cropBox.bottomLeftY)+" "+B(j.cropBox.topRightX)+" "+B(j.cropBox.topRightY)+"]"),j.bleedBox!==null&&ve("/BleedBox ["+B(j.bleedBox.bottomLeftX)+" "+B(j.bleedBox.bottomLeftY)+" "+B(j.bleedBox.topRightX)+" "+B(j.bleedBox.topRightY)+"]"),j.trimBox!==null&&ve("/TrimBox ["+B(j.trimBox.bottomLeftX)+" "+B(j.trimBox.bottomLeftY)+" "+B(j.trimBox.topRightX)+" "+B(j.trimBox.topRightY)+"]"),j.artBox!==null&&ve("/ArtBox ["+B(j.artBox.bottomLeftX)+" "+B(j.artBox.bottomLeftY)+" "+B(j.artBox.topRightX)+" "+B(j.artBox.topRightY)+"]"),typeof j.userUnit=="number"&&j.userUnit!==1&&ve("/UserUnit "+j.userUnit),cr.publish("putPage",{objId:je,pageContext:Ut[J],pageNumber:J,page:_e}),ve("/Contents "+Ie+" 0 R"),ve(">>"),ve("endobj");var Ze=_e.join(`
`);return A===k.ADVANCED&&(Ze+=`
Q`),se(Ie,!0),Je({data:Ze,filters:Ue(),objectId:Ie}),ve("endobj"),je},He=m.__private__.putPages=function(){var j,J,_e=[];for(j=1;j<=rr;j++)Ut[j].objId=mn(),Ut[j].contentsObjId=mn();for(j=1;j<=rr;j++)_e.push(Be({number:j,data:We[j],objId:Ut[j].objId,contentsObjId:Ut[j].contentsObjId,mediaBox:Ut[j].mediaBox,cropBox:Ut[j].cropBox,bleedBox:Ut[j].bleedBox,trimBox:Ut[j].trimBox,artBox:Ut[j].artBox,userUnit:Ut[j].userUnit,rootDictionaryObjId:pe,resourceDictionaryObjId:xe}));se(pe,!0),ve("<</Type /Pages");var je="/Kids [";for(J=0;J<rr;J++)je+=_e[J]+" 0 R ";ve(je+"]"),ve("/Count "+rr),ve(">>"),ve("endobj"),cr.publish("postPutPages")},qe=function(j){cr.publish("putFont",{font:j,out:ve,newObject:pn,putStream:Je}),j.isAlreadyPutted!==!0&&(j.objectNumber=pn(),ve("<<"),ve("/Type /Font"),ve("/BaseFont /"+i0(j.postScriptName)),ve("/Subtype /Type1"),typeof j.encoding=="string"&&ve("/Encoding /"+j.encoding),ve("/FirstChar 32"),ve("/LastChar 255"),ve(">>"),ve("endobj"))},ut=function(){for(var j in $e)$e.hasOwnProperty(j)&&(p===!1||p===!0&&x.hasOwnProperty(j))&&qe($e[j])},Nt=function(j){j.objectNumber=pn();var J=[];J.push({key:"Type",value:"/XObject"}),J.push({key:"Subtype",value:"/Form"}),J.push({key:"BBox",value:"["+[B(j.x),B(j.y),B(j.x+j.width),B(j.y+j.height)].join(" ")+"]"}),J.push({key:"Matrix",value:"["+j.matrix.toString()+"]"});var _e=j.pages[1].join(`
`);Je({data:_e,additionalKeyValues:J,objectId:j.objectNumber}),ve("endobj")},Ct=function(){for(var j in yt)yt.hasOwnProperty(j)&&Nt(yt[j])},gt=function(j,J){var _e,je=[],Ie=1/(J-1);for(_e=0;_e<1;_e+=Ie)je.push(_e);if(je.push(1),j[0].offset!=0){var Ze={offset:0,color:j[0].color};j.unshift(Ze)}if(j[j.length-1].offset!=1){var dt={offset:1,color:j[j.length-1].color};j.push(dt)}for(var Tt="",Jt=0,yr=0;yr<je.length;yr++){for(_e=je[yr];_e>j[Jt+1].offset;)Jt++;var vr=j[Jt].offset,Fr=(_e-vr)/(j[Jt+1].offset-vr),kn=j[Jt].color,Rn=j[Jt+1].color;Tt+=F(Math.round((1-Fr)*kn[0]+Fr*Rn[0]).toString(16))+F(Math.round((1-Fr)*kn[1]+Fr*Rn[1]).toString(16))+F(Math.round((1-Fr)*kn[2]+Fr*Rn[2]).toString(16))}return Tt.trim()},mt=function(j,J){J||(J=21);var _e=pn(),je=gt(j.colors,J),Ie=[];Ie.push({key:"FunctionType",value:"0"}),Ie.push({key:"Domain",value:"[0.0 1.0]"}),Ie.push({key:"Size",value:"["+J+"]"}),Ie.push({key:"BitsPerSample",value:"8"}),Ie.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ie.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Je({data:je,additionalKeyValues:Ie,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:_e}),ve("endobj"),j.objectNumber=pn(),ve("<< /ShadingType "+j.type),ve("/ColorSpace /DeviceRGB");var Ze="/Coords ["+B(parseFloat(j.coords[0]))+" "+B(parseFloat(j.coords[1]))+" ";j.type===2?Ze+=B(parseFloat(j.coords[2]))+" "+B(parseFloat(j.coords[3])):Ze+=B(parseFloat(j.coords[2]))+" "+B(parseFloat(j.coords[3]))+" "+B(parseFloat(j.coords[4]))+" "+B(parseFloat(j.coords[5])),ve(Ze+="]"),j.matrix&&ve("/Matrix ["+j.matrix.toString()+"]"),ve("/Function "+_e+" 0 R"),ve("/Extend [true true]"),ve(">>"),ve("endobj")},ur=function(j,J){var _e=mn(),je=pn();J.push({resourcesOid:_e,objectOid:je}),j.objectNumber=je;var Ie=[];Ie.push({key:"Type",value:"/Pattern"}),Ie.push({key:"PatternType",value:"1"}),Ie.push({key:"PaintType",value:"1"}),Ie.push({key:"TilingType",value:"1"}),Ie.push({key:"BBox",value:"["+j.boundingBox.map(B).join(" ")+"]"}),Ie.push({key:"XStep",value:B(j.xStep)}),Ie.push({key:"YStep",value:B(j.yStep)}),Ie.push({key:"Resources",value:_e+" 0 R"}),j.matrix&&Ie.push({key:"Matrix",value:"["+j.matrix.toString()+"]"}),Je({data:j.stream,additionalKeyValues:Ie,objectId:j.objectNumber}),ve("endobj")},Ir=function(j){var J;for(J in jt)jt.hasOwnProperty(J)&&(jt[J]instanceof Wd?mt(jt[J]):jt[J]instanceof c0&&ur(jt[J],j))},Qr=function(j){for(var J in j.objectNumber=pn(),ve("<<"),j)switch(J){case"opacity":ve("/ca "+ee(j[J]));break;case"stroke-opacity":ve("/CA "+ee(j[J]))}ve(">>"),ve("endobj")},_n=function(){var j;for(j in Vt)Vt.hasOwnProperty(j)&&Qr(Vt[j])},vi=function(){for(var j in ve("/XObject <<"),yt)yt.hasOwnProperty(j)&&yt[j].objectNumber>=0&&ve("/"+j+" "+yt[j].objectNumber+" 0 R");cr.publish("putXobjectDict"),ve(">>")},Mi=function(){Sn.oid=pn(),ve("<<"),ve("/Filter /Standard"),ve("/V "+Sn.v),ve("/R "+Sn.r),ve("/U <"+Sn.toHexString(Sn.U)+">"),ve("/O <"+Sn.toHexString(Sn.O)+">"),ve("/P "+Sn.P),ve(">>"),ve("endobj")},Oa=function(){for(var j in ve("/Font <<"),$e)$e.hasOwnProperty(j)&&(p===!1||p===!0&&x.hasOwnProperty(j))&&ve("/"+j+" "+$e[j].objectNumber+" 0 R");ve(">>")},Xn=function(){if(Object.keys(jt).length>0){for(var j in ve("/Shading <<"),jt)jt.hasOwnProperty(j)&&jt[j]instanceof Wd&&jt[j].objectNumber>=0&&ve("/"+j+" "+jt[j].objectNumber+" 0 R");cr.publish("putShadingPatternDict"),ve(">>")}},Bi=function(j){if(Object.keys(jt).length>0){for(var J in ve("/Pattern <<"),jt)jt.hasOwnProperty(J)&&jt[J]instanceof m.TilingPattern&&jt[J].objectNumber>=0&&jt[J].objectNumber<j&&ve("/"+J+" "+jt[J].objectNumber+" 0 R");cr.publish("putTilingPatternDict"),ve(">>")}},Nn=function(){if(Object.keys(Vt).length>0){var j;for(j in ve("/ExtGState <<"),Vt)Vt.hasOwnProperty(j)&&Vt[j].objectNumber>=0&&ve("/"+j+" "+Vt[j].objectNumber+" 0 R");cr.publish("putGStateDict"),ve(">>")}},Hn=function(j){se(j.resourcesOid,!0),ve("<<"),ve("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Oa(),Xn(),Bi(j.objectOid),Nn(),vi(),ve(">>"),ve("endobj")},_f=function(){var j=[];ut(),_n(),Ct(),Ir(j),cr.publish("putResources"),j.forEach(Hn),Hn({resourcesOid:xe,objectOid:Number.MAX_SAFE_INTEGER}),cr.publish("postPutResources")},Nf=function(){cr.publish("putAdditionalObjects");for(var j=0;j<Se.length;j++){var J=Se[j];se(J.objId,!0),ve(J.content),ve("endobj")}cr.publish("postPutAdditionalObjects")},Ul=function(j){wt[j.fontName]=wt[j.fontName]||{},wt[j.fontName][j.fontStyle]=j.id},tl=function(j,J,_e,je,Ie){var Ze={id:"F"+(Object.keys($e).length+1).toString(10),postScriptName:j,fontName:J,fontStyle:_e,encoding:je,isStandardFont:Ie||!1,metadata:{}};return cr.publish("addFont",{font:Ze,instance:this}),$e[Ze.id]=Ze,Ul(Ze),Ze.id},zl=function(j){for(var J=0,_e=Ke.length;J<_e;J++){var je=tl.call(this,j[J][0],j[J][1],j[J][2],Ke[J][3],!0);p===!1&&(x[je]=!0);var Ie=j[J][0].split("-");Ul({id:je,fontName:Ie[0],fontStyle:Ie[1]||""})}cr.publish("addFonts",{fonts:$e,dictionary:wt})},oa=function(j){return j.foo=function(){try{return j.apply(this,arguments)}catch(je){var J=je.stack||"";~J.indexOf(" at ")&&(J=J.split(" at ")[1]);var _e="Error in function "+J.split(`
`)[0].split("<")[0]+": "+je.message;if(!dr.console)throw new Error(_e);dr.console.error(_e,je),dr.alert&&alert(_e)}},j.foo.bar=j,j.foo},zc=function(j,J){var _e,je,Ie,Ze,dt,Tt,Jt,yr,vr;if(Ie=(J=J||{}).sourceEncoding||"Unicode",dt=J.outputEncoding,(J.autoencode||dt)&&$e[bt].metadata&&$e[bt].metadata[Ie]&&$e[bt].metadata[Ie].encoding&&(Ze=$e[bt].metadata[Ie].encoding,!dt&&$e[bt].encoding&&(dt=$e[bt].encoding),!dt&&Ze.codePages&&(dt=Ze.codePages[0]),typeof dt=="string"&&(dt=Ze[dt]),dt)){for(Jt=!1,Tt=[],_e=0,je=j.length;_e<je;_e++)(yr=dt[j.charCodeAt(_e)])?Tt.push(String.fromCharCode(yr)):Tt.push(j[_e]),Tt[_e].charCodeAt(0)>>8&&(Jt=!0);j=Tt.join("")}for(_e=j.length;Jt===void 0&&_e!==0;)j.charCodeAt(_e-1)>>8&&(Jt=!0),_e--;if(!Jt)return j;for(Tt=J.noBOM?[]:[254,255],_e=0,je=j.length;_e<je;_e++){if((vr=(yr=j.charCodeAt(_e))>>8)>>8)throw new Error("Character at position "+_e+" of string '"+j+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Tt.push(vr),Tt.push(yr-(vr<<8))}return String.fromCharCode.apply(void 0,Tt)},la=m.__private__.pdfEscape=m.pdfEscape=function(j,J){return zc(j,J).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Hl=m.__private__.beginPage=function(j){We[++rr]=[],Ut[rr]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(j[0]),topRightY:Number(j[1])}},rl(rr),De(We[W])},ld=function(j,J){var _e,je,Ie;switch(r=J||r,typeof j=="string"&&(_e=S(j.toLowerCase()),Array.isArray(_e)&&(je=_e[0],Ie=_e[1])),Array.isArray(j)&&(je=j[0]*lt,Ie=j[1]*lt),isNaN(je)&&(je=s[0],Ie=s[1]),(je>14400||Ie>14400)&&(gn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),je=Math.min(14400,je),Ie=Math.min(14400,Ie)),s=[je,Ie],r.substr(0,1)){case"l":Ie>je&&(s=[Ie,je]);break;case"p":je>Ie&&(s=[Ie,je])}Hl(s),Gl(fd),ve(ca),pd!==0&&ve(pd+" J"),Yl!==0&&ve(Yl+" j"),cr.publish("addPage",{pageNumber:rr})},cd=function(j){j>0&&j<=rr&&(We.splice(j,1),Ut.splice(j,1),rr--,W>rr&&(W=rr),this.setPage(W))},rl=function(j){j>0&&j<=rr&&(W=j)},M0=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return We.length-1},Hc=function(j,J,_e){var je,Ie=void 0;return _e=_e||{},j=j!==void 0?j:$e[bt].fontName,J=J!==void 0?J:$e[bt].fontStyle,je=j.toLowerCase(),wt[je]!==void 0&&wt[je][J]!==void 0?Ie=wt[je][J]:wt[j]!==void 0&&wt[j][J]!==void 0?Ie=wt[j][J]:_e.disableWarning===!1&&gn.warn("Unable to look up font label for font '"+j+"', '"+J+"'. Refer to getFontList() for available fonts."),Ie||_e.noFallback||(Ie=wt.times[J])==null&&(Ie=wt.times.normal),Ie},zr=m.__private__.putInfo=function(){var j=pn(),J=function(je){return je};for(var _e in h!==null&&(J=Sn.encryptor(j,0)),ve("<<"),ve("/Producer ("+la(J("jsPDF "+or.version))+")"),It)It.hasOwnProperty(_e)&&It[_e]&&ve("/"+_e.substr(0,1).toUpperCase()+_e.substr(1)+" ("+la(J(It[_e]))+")");ve("/CreationDate ("+la(J(M))+")"),ve(">>"),ve("endobj")},$c=m.__private__.putCatalog=function(j){var J=(j=j||{}).rootDictionaryObjId||pe;switch(pn(),ve("<<"),ve("/Type /Catalog"),ve("/Pages "+J+" 0 R"),pt||(pt="fullwidth"),pt){case"fullwidth":ve("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ve("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ve("/OpenAction [3 0 R /Fit]");break;case"original":ve("/OpenAction [3 0 R /XYZ null null 1]");break;default:var _e=""+pt;_e.substr(_e.length-1)==="%"&&(pt=parseInt(pt)/100),typeof pt=="number"&&ve("/OpenAction [3 0 R /XYZ null null "+ee(pt)+"]")}switch(Yt||(Yt="continuous"),Yt){case"continuous":ve("/PageLayout /OneColumn");break;case"single":ve("/PageLayout /SinglePage");break;case"two":case"twoleft":ve("/PageLayout /TwoColumnLeft");break;case"tworight":ve("/PageLayout /TwoColumnRight")}Dt&&ve("/PageMode /"+Dt),cr.publish("putCatalog"),ve(">>"),ve("endobj")},Sf=m.__private__.putTrailer=function(){ve("trailer"),ve("<<"),ve("/Size "+(q+1)),ve("/Root "+q+" 0 R"),ve("/Info "+(q-1)+" 0 R"),h!==null&&ve("/Encrypt "+Sn.oid+" 0 R"),ve("/ID [ <"+te+"> <"+te+"> ]"),ve(">>")},ud=m.__private__.putHeader=function(){ve("%PDF-"+b),ve("%")},kf=m.__private__.putXRef=function(){var j="0000000000";ve("xref"),ve("0 "+(q+1)),ve("0000000000 65535 f ");for(var J=1;J<=q;J++)typeof he[J]=="function"?ve((j+he[J]()).slice(-10)+" 00000 n "):he[J]!==void 0?ve((j+he[J]).slice(-10)+" 00000 n "):ve("0000000000 00000 n ")},Ui=m.__private__.buildDocument=function(){rt(),De(me),cr.publish("buildDocument"),ud(),He(),Nf(),_f(),h!==null&&Mi(),zr(),$c();var j=Z;return kf(),Sf(),ve("startxref"),ve(""+j),ve("%%EOF"),De(We[W]),me.join(`
`)},$l=m.__private__.getBlob=function(j){return new Blob([Re(j)],{type:"application/pdf"})},nl=m.output=m.__private__.output=oa((function(j,J){switch(typeof(J=J||{})=="string"?J={filename:J}:J.filename=J.filename||"generated.pdf",j){case void 0:return Ui();case"save":m.save(J.filename);break;case"arraybuffer":return Re(Ui());case"blob":return $l(Ui());case"bloburi":case"bloburl":if(dr.URL!==void 0&&typeof dr.URL.createObjectURL=="function")return dr.URL&&dr.URL.createObjectURL($l(Ui()))||void 0;gn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var _e="",je=Ui();try{_e=G2(je)}catch{_e=G2(unescape(encodeURIComponent(je)))}return"data:application/pdf;filename="+J.filename+";base64,"+_e;case"pdfobjectnewwindow":if(Object.prototype.toString.call(dr)==="[object Window]"){var Ie="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ze=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';J.pdfObjectUrl&&(Ie=J.pdfObjectUrl,Ze="");var dt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ie+'"'+Ze+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(J)+");<\/script></body></html>",Tt=dr.open();return Tt!==null&&Tt.document.write(dt),Tt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(dr)==="[object Window]"){var Jt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(J.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+J.filename+'" width="500px" height="400px" /></body></html>',yr=dr.open();if(yr!==null){yr.document.write(Jt);var vr=this;yr.document.documentElement.querySelector("#pdfViewer").onload=function(){yr.document.title=J.filename,yr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(vr.output("bloburl"))}}return yr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(dr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Fr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",J)+'"></iframe></body></html>',kn=dr.open();if(kn!==null&&(kn.document.write(Fr),kn.document.title=J.filename),kn||typeof safari>"u")return kn;break;case"datauri":case"dataurl":return dr.document.location.href=this.output("datauristring",J);default:return null}})),Wl=function(j){return Array.isArray(Te)===!0&&Te.indexOf(j)>-1};switch(n){case"pt":lt=1;break;case"mm":lt=72/25.4;break;case"cm":lt=72/2.54;break;case"in":lt=72;break;case"px":lt=Wl("px_scaling")==1?.75:96/72;break;case"pc":case"em":lt=12;break;case"ex":lt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);lt=n}var Sn=null;K(),le();var zi=function(j){return h!==null?Sn.encryptor(j,0):function(J){return J}},yi=m.__private__.getPageInfo=m.getPageInfo=function(j){if(isNaN(j)||j%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ut[j].objId,pageNumber:j,pageContext:Ut[j]}},ir=m.__private__.getPageInfoByObjId=function(j){if(isNaN(j)||j%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var J in Ut)if(Ut[J].objId===j)break;return yi(J)},Vl=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:Ut[W].objId,pageNumber:W,pageContext:Ut[W]}};m.addPage=function(){return ld.apply(this,arguments),this},m.setPage=function(){return rl.apply(this,arguments),De.call(this,We[W]),this},m.insertPage=function(j){return this.addPage(),this.movePage(W,j),this},m.movePage=function(j,J){var _e,je;if(j>J){_e=We[j],je=Ut[j];for(var Ie=j;Ie>J;Ie--)We[Ie]=We[Ie-1],Ut[Ie]=Ut[Ie-1];We[J]=_e,Ut[J]=je,this.setPage(J)}else if(j<J){_e=We[j],je=Ut[j];for(var Ze=j;Ze<J;Ze++)We[Ze]=We[Ze+1],Ut[Ze]=Ut[Ze+1];We[J]=_e,Ut[J]=je,this.setPage(J)}return this},m.deletePage=function(){return cd.apply(this,arguments),this},m.__private__.text=m.text=function(j,J,_e,je,Ie){var Ze,dt,Tt,Jt,yr,vr,Fr,kn,Rn,Yn=(je=je||{}).scope||this;if(typeof j=="number"&&typeof J=="number"&&(typeof _e=="string"||Array.isArray(_e))){var Ps=_e;_e=J,J=j,j=Ps}if(arguments[3]instanceof Mt?(R("The transform parameter of text() with a Matrix value"),Rn=Ie):(Tt=arguments[4],Jt=arguments[5],dn(Fr=arguments[3])==="object"&&Fr!==null||(typeof Tt=="string"&&(Jt=Tt,Tt=null),typeof Fr=="string"&&(Jt=Fr,Fr=null),typeof Fr=="number"&&(Tt=Fr,Fr=null),je={flags:Fr,angle:Tt,align:Jt})),isNaN(J)||isNaN(_e)||j==null)throw new Error("Invalid arguments passed to jsPDF.text");if(j.length===0)return Yn;var ys="",Ni=!1,Ba=typeof je.lineHeightFactor=="number"?je.lineHeightFactor:ql,Za=Yn.internal.scaleFactor;function ul(sn){return sn=sn.split("	").join(Array(je.TabLen||9).join(" ")),la(sn,Fr)}function gd(sn){for(var Zr,On=sn.concat(),Kn=[],Gi=On.length;Gi--;)typeof(Zr=On.shift())=="string"?Kn.push(Zr):Array.isArray(sn)&&(Zr.length===1||Zr[1]===void 0&&Zr[2]===void 0)?Kn.push(Zr[0]):Kn.push([Zr[0],Zr[1],Zr[2]]);return Kn}function Zc(sn,Zr){var On;if(typeof sn=="string")On=Zr(sn)[0];else if(Array.isArray(sn)){for(var Kn,Gi,cu=sn.concat(),nc=[],bd=cu.length;bd--;)typeof(Kn=cu.shift())=="string"?nc.push(Zr(Kn)[0]):Array.isArray(Kn)&&typeof Kn[0]=="string"&&(Gi=Zr(Kn[0],Kn[1],Kn[2]),nc.push([Gi[0],Gi[1],Gi[2]]));On=nc}return On}var Kl=!1,eu=!0;if(typeof j=="string")Kl=!0;else if(Array.isArray(j)){var tu=j.concat();dt=[];for(var Jl,In=tu.length;In--;)(typeof(Jl=tu.shift())!="string"||Array.isArray(Jl)&&typeof Jl[0]!="string")&&(eu=!1);Kl=eu}if(Kl===!1)throw new Error('Type of text must be string or Array. "'+j+'" is not recognized.');typeof j=="string"&&(j=j.match(/[\r?\n]/)?j.split(/\r\n|\r|\n/g):[j]);var ru=it/Yn.internal.scaleFactor,nu=ru*(Ba-1);switch(je.baseline){case"bottom":_e-=nu;break;case"top":_e+=ru-nu;break;case"hanging":_e+=ru-2*nu;break;case"middle":_e+=ru/2-nu}if((vr=je.maxWidth||0)>0&&(typeof j=="string"?j=Yn.splitTextToSize(j,vr):Object.prototype.toString.call(j)==="[object Array]"&&(j=j.reduce((function(sn,Zr){return sn.concat(Yn.splitTextToSize(Zr,vr))}),[]))),Ze={text:j,x:J,y:_e,options:je,mutex:{pdfEscape:la,activeFontKey:bt,fonts:$e,activeFontSize:it}},cr.publish("preProcessText",Ze),j=Ze.text,Tt=(je=Ze.options).angle,!(Rn instanceof Mt)&&Tt&&typeof Tt=="number"){Tt*=Math.PI/180,je.rotationDirection===0&&(Tt=-Tt),A===k.ADVANCED&&(Tt=-Tt);var su=Math.cos(Tt),au=Math.sin(Tt);Rn=new Mt(su,au,-au,su,0,0)}else Tt&&Tt instanceof Mt&&(Rn=Tt);A!==k.ADVANCED||Rn||(Rn=yn),(yr=je.charSpace||ol)!==void 0&&(ys+=B(P(yr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(kn=je.horizontalScale)!==void 0&&(ys+=B(100*kn)+` Tz
`),je.lang;var Xs=-1,Ql=je.renderingMode!==void 0?je.renderingMode:je.stroke,bo=Yn.internal.getCurrentPageInfo().pageContext;switch(Ql){case 0:case!1:case"fill":Xs=0;break;case 1:case!0:case"stroke":Xs=1;break;case 2:case"fillThenStroke":Xs=2;break;case 3:case"invisible":Xs=3;break;case 4:case"fillAndAddForClipping":Xs=4;break;case 5:case"strokeAndAddPathForClipping":Xs=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Xs=6;break;case 7:case"addToPathForClipping":Xs=7}var Cf=bo.usedRenderingMode!==void 0?bo.usedRenderingMode:-1;Xs!==-1?ys+=Xs+` Tr
`:Cf!==-1&&(ys+=`0 Tr
`),Xs!==-1&&(bo.usedRenderingMode=Xs),Jt=je.align||"left";var Ys,iu=it*Ba,vd=Yn.internal.pageSize.getWidth(),ou=$e[bt];yr=je.charSpace||ol,vr=je.maxWidth||0,Fr=Object.assign({autoencode:!0,noBOM:!0},je.flags);var Vi=[],dl=function(sn){return Yn.getStringUnitWidth(sn,{font:ou,charSpace:yr,fontSize:it,doKerning:!1})*it/Za};if(Object.prototype.toString.call(j)==="[object Array]"){var Ks;dt=gd(j),Jt!=="left"&&(Ys=dt.map(dl));var Ls,fl=0;if(Jt==="right"){J-=Ys[0],j=[],In=dt.length;for(var wo=0;wo<In;wo++)wo===0?(Ls=Ja(J),Ks=Qa(_e)):(Ls=P(fl-Ys[wo]),Ks=-iu),j.push([dt[wo],Ls,Ks]),fl=Ys[wo]}else if(Jt==="center"){J-=Ys[0]/2,j=[],In=dt.length;for(var _o=0;_o<In;_o++)_o===0?(Ls=Ja(J),Ks=Qa(_e)):(Ls=P((fl-Ys[_o])/2),Ks=-iu),j.push([dt[_o],Ls,Ks]),fl=Ys[_o]}else if(Jt==="left"){j=[],In=dt.length;for(var lu=0;lu<In;lu++)j.push(dt[lu])}else if(Jt==="justify"&&ou.encoding==="Identity-H"){j=[],In=dt.length,vr=vr!==0?vr:vd;for(var No=0,Hr=0;Hr<In;Hr++)if(Ks=Hr===0?Qa(_e):-iu,Ls=Hr===0?Ja(J):No,Hr<In-1){var So=P((vr-Ys[Hr])/(dt[Hr].split(" ").length-1)),Ds=dt[Hr].split(" ");j.push([Ds[0]+" ",Ls,Ks]),No=0;for(var Ua=1;Ua<Ds.length;Ua++){var Zl=(dl(Ds[Ua-1]+" "+Ds[Ua])-dl(Ds[Ua]))*Za+So;Ua==Ds.length-1?j.push([Ds[Ua],Zl,0]):j.push([Ds[Ua]+" ",Zl,0]),No-=Zl}}else j.push([dt[Hr],Ls,Ks]);j.push(["",No,0])}else{if(Jt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(j=[],In=dt.length,vr=vr!==0?vr:vd,Hr=0;Hr<In;Hr++)Ks=Hr===0?Qa(_e):-iu,Ls=Hr===0?Ja(J):0,Hr<In-1?Vi.push(B(P((vr-Ys[Hr])/(dt[Hr].split(" ").length-1)))):Vi.push(0),j.push([dt[Hr],Ls,Ks])}}var yd=typeof je.R2L=="boolean"?je.R2L:Pt;yd===!0&&(j=Zc(j,(function(sn,Zr,On){return[sn.split("").reverse().join(""),Zr,On]}))),Ze={text:j,x:J,y:_e,options:je,mutex:{pdfEscape:la,activeFontKey:bt,fonts:$e,activeFontSize:it}},cr.publish("postProcessText",Ze),j=Ze.text,Ni=Ze.mutex.isHex||!1;var ec=$e[bt].encoding;ec!=="WinAnsiEncoding"&&ec!=="StandardEncoding"||(j=Zc(j,(function(sn,Zr,On){return[ul(sn),Zr,On]}))),dt=gd(j),j=[];for(var tc,rc,za,ko=0,qi=1,jo=Array.isArray(dt[0])?qi:ko,Eo="",hl=function(sn,Zr,On){var Kn="";return On instanceof Mt?(On=typeof je.angle=="number"?Un(On,new Mt(1,0,0,1,sn,Zr)):Un(new Mt(1,0,0,1,sn,Zr),On),A===k.ADVANCED&&(On=Un(new Mt(1,0,0,-1,0,0),On)),Kn=On.join(" ")+` Tm
`):Kn=B(sn)+" "+B(Zr)+` Td
`,Kn},ks=0;ks<dt.length;ks++){switch(Eo="",jo){case qi:za=(Ni?"<":"(")+dt[ks][0]+(Ni?">":")"),tc=parseFloat(dt[ks][1]),rc=parseFloat(dt[ks][2]);break;case ko:za=(Ni?"<":"(")+dt[ks]+(Ni?">":")"),tc=Ja(J),rc=Qa(_e)}Vi!==void 0&&Vi[ks]!==void 0&&(Eo=Vi[ks]+` Tw
`),ks===0?j.push(Eo+hl(tc,rc,Rn)+za):jo===ko?j.push(Eo+za):jo===qi&&j.push(Eo+hl(tc,rc,Rn)+za)}j=jo===ko?j.join(` Tj
T* `):j.join(` Tj
`),j+=` Tj
`;var ua=`BT
/`;return ua+=bt+" "+it+` Tf
`,ua+=B(it*Ba)+` TL
`,ua+=is+`
`,ua+=ys,ua+=j,ve(ua+="ET"),x[bt]=!0,Yn};var Hi=m.__private__.clip=m.clip=function(j){return ve(j==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return Hi("evenodd")},m.__private__.discardPath=m.discardPath=function(){return ve("n"),this};var $i=m.__private__.isValidStyle=function(j){var J=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(j)!==-1&&(J=!0),J};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(j){return $i(j)&&(d=j),this};var dd=m.__private__.getStyle=m.getStyle=function(j){var J=d;switch(j){case"D":case"S":J="S";break;case"F":J="f";break;case"FD":case"DF":J="B";break;case"f":case"f*":case"B":case"B*":J=j}return J},sl=m.close=function(){return ve("h"),this};m.stroke=function(){return ve("S"),this},m.fill=function(j){return Wc("f",j),this},m.fillEvenOdd=function(j){return Wc("f*",j),this},m.fillStroke=function(j){return Wc("B",j),this},m.fillStrokeEvenOdd=function(j){return Wc("B*",j),this};var Wc=function(j,J){dn(J)==="object"?jf(J,j):ve(j)},Vc=function(j){j===null||A===k.ADVANCED&&j===void 0||(j=dd(j),ve(j))};function qc(j,J,_e,je,Ie){var Ze=new c0(J||this.boundingBox,_e||this.xStep,je||this.yStep,this.gState,Ie||this.matrix);Ze.stream=this.stream;var dt=j+"$$"+this.cloneIndex+++"$$";return zn(dt,Ze),Ze}var jf=function(j,J){var _e=hr[j.key],je=jt[_e];if(je instanceof Wd)ve("q"),ve(B0(J)),je.gState&&m.setGState(je.gState),ve(j.matrix.toString()+" cm"),ve("/"+_e+" sh"),ve("Q");else if(je instanceof c0){var Ie=new Mt(1,0,0,-1,0,cl());j.matrix&&(Ie=Ie.multiply(j.matrix||yn),_e=qc.call(je,j.key,j.boundingBox,j.xStep,j.yStep,Ie).id),ve("q"),ve("/Pattern cs"),ve("/"+_e+" scn"),je.gState&&m.setGState(je.gState),ve(J),ve("Q")}},B0=function(j){switch(j){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},vo=m.moveTo=function(j,J){return ve(B(P(j))+" "+B(G(J))+" m"),this},bi=m.lineTo=function(j,J){return ve(B(P(j))+" "+B(G(J))+" l"),this},Ma=m.curveTo=function(j,J,_e,je,Ie,Ze){return ve([B(P(j)),B(G(J)),B(P(_e)),B(G(je)),B(P(Ie)),B(G(Ze)),"c"].join(" ")),this};m.__private__.line=m.line=function(j,J,_e,je,Ie){if(isNaN(j)||isNaN(J)||isNaN(_e)||isNaN(je)||!$i(Ie))throw new Error("Invalid arguments passed to jsPDF.line");return A===k.COMPAT?this.lines([[_e-j,je-J]],j,J,[1,1],Ie||"S"):this.lines([[_e-j,je-J]],j,J,[1,1]).stroke()},m.__private__.lines=m.lines=function(j,J,_e,je,Ie,Ze){var dt,Tt,Jt,yr,vr,Fr,kn,Rn,Yn,Ps,ys,Ni;if(typeof j=="number"&&(Ni=_e,_e=J,J=j,j=Ni),je=je||[1,1],Ze=Ze||!1,isNaN(J)||isNaN(_e)||!Array.isArray(j)||!Array.isArray(je)||!$i(Ie)||typeof Ze!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(vo(J,_e),dt=je[0],Tt=je[1],yr=j.length,Ps=J,ys=_e,Jt=0;Jt<yr;Jt++)(vr=j[Jt]).length===2?(Ps=vr[0]*dt+Ps,ys=vr[1]*Tt+ys,bi(Ps,ys)):(Fr=vr[0]*dt+Ps,kn=vr[1]*Tt+ys,Rn=vr[2]*dt+Ps,Yn=vr[3]*Tt+ys,Ps=vr[4]*dt+Ps,ys=vr[5]*Tt+ys,Ma(Fr,kn,Rn,Yn,Ps,ys));return Ze&&sl(),Vc(Ie),this},m.path=function(j){for(var J=0;J<j.length;J++){var _e=j[J],je=_e.c;switch(_e.op){case"m":vo(je[0],je[1]);break;case"l":bi(je[0],je[1]);break;case"c":Ma.apply(this,je);break;case"h":sl()}}return this},m.__private__.rect=m.rect=function(j,J,_e,je,Ie){if(isNaN(j)||isNaN(J)||isNaN(_e)||isNaN(je)||!$i(Ie))throw new Error("Invalid arguments passed to jsPDF.rect");return A===k.COMPAT&&(je=-je),ve([B(P(j)),B(G(J)),B(P(_e)),B(P(je)),"re"].join(" ")),Vc(Ie),this},m.__private__.triangle=m.triangle=function(j,J,_e,je,Ie,Ze,dt){if(isNaN(j)||isNaN(J)||isNaN(_e)||isNaN(je)||isNaN(Ie)||isNaN(Ze)||!$i(dt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[_e-j,je-J],[Ie-_e,Ze-je],[j-Ie,J-Ze]],j,J,[1,1],dt,!0),this},m.__private__.roundedRect=m.roundedRect=function(j,J,_e,je,Ie,Ze,dt){if(isNaN(j)||isNaN(J)||isNaN(_e)||isNaN(je)||isNaN(Ie)||isNaN(Ze)||!$i(dt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Tt=4/3*(Math.SQRT2-1);return Ie=Math.min(Ie,.5*_e),Ze=Math.min(Ze,.5*je),this.lines([[_e-2*Ie,0],[Ie*Tt,0,Ie,Ze-Ze*Tt,Ie,Ze],[0,je-2*Ze],[0,Ze*Tt,-Ie*Tt,Ze,-Ie,Ze],[2*Ie-_e,0],[-Ie*Tt,0,-Ie,-Ze*Tt,-Ie,-Ze],[0,2*Ze-je],[0,-Ze*Tt,Ie*Tt,-Ze,Ie,-Ze]],j+Ie,J,[1,1],dt,!0),this},m.__private__.ellipse=m.ellipse=function(j,J,_e,je,Ie){if(isNaN(j)||isNaN(J)||isNaN(_e)||isNaN(je)||!$i(Ie))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ze=4/3*(Math.SQRT2-1)*_e,dt=4/3*(Math.SQRT2-1)*je;return vo(j+_e,J),Ma(j+_e,J-dt,j+Ze,J-je,j,J-je),Ma(j-Ze,J-je,j-_e,J-dt,j-_e,J),Ma(j-_e,J+dt,j-Ze,J+je,j,J+je),Ma(j+Ze,J+je,j+_e,J+dt,j+_e,J),Vc(Ie),this},m.__private__.circle=m.circle=function(j,J,_e,je){if(isNaN(j)||isNaN(J)||isNaN(_e)||!$i(je))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(j,J,_e,_e,je)},m.setFont=function(j,J,_e){return _e&&(J=V(J,_e)),bt=Hc(j,J,{disableWarning:!1}),this};var Gc=m.__private__.getFont=m.getFont=function(){return $e[Hc.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var j,J,_e={};for(j in wt)if(wt.hasOwnProperty(j))for(J in _e[j]=[],wt[j])wt[j].hasOwnProperty(J)&&_e[j].push(J);return _e},m.addFont=function(j,J,_e,je,Ie){var Ze=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ze.indexOf(arguments[3])!==-1?Ie=arguments[3]:arguments[3]&&Ze.indexOf(arguments[3])==-1&&(_e=V(_e,je)),Ie=Ie||"Identity-H",tl.call(this,j,J,_e,Ie)};var ql,fd=t.lineWidth||.200025,al=m.__private__.getLineWidth=m.getLineWidth=function(){return fd},Gl=m.__private__.setLineWidth=m.setLineWidth=function(j){return fd=j,ve(B(P(j))+" w"),this};m.__private__.setLineDash=or.API.setLineDash=or.API.setLineDashPattern=function(j,J){if(j=j||[],J=J||0,isNaN(J)||!Array.isArray(j))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return j=j.map((function(_e){return B(P(_e))})).join(" "),J=B(P(J)),ve("["+j+"] "+J+" d"),this};var Xc=m.__private__.getLineHeight=m.getLineHeight=function(){return it*ql};m.__private__.getLineHeight=m.getLineHeight=function(){return it*ql};var hd=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(j){return typeof(j=j||1.15)=="number"&&(ql=j),this},wi=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return ql};hd(t.lineHeight);var Ja=m.__private__.getHorizontalCoordinate=function(j){return P(j)},Qa=m.__private__.getVerticalCoordinate=function(j){return A===k.ADVANCED?j:Ut[W].mediaBox.topRightY-Ut[W].mediaBox.bottomLeftY-P(j)},Ef=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(j){return B(Ja(j))},_i=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(j){return B(Qa(j))},ca=t.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return be(ca)},m.__private__.setStrokeColor=m.setDrawColor=function(j,J,_e,je){return ca=we({ch1:j,ch2:J,ch3:_e,ch4:je,pdfColorType:"draw",precision:2}),ve(ca),this};var Yc=t.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return be(Yc)},m.__private__.setFillColor=m.setFillColor=function(j,J,_e,je){return Yc=we({ch1:j,ch2:J,ch3:_e,ch4:je,pdfColorType:"fill",precision:2}),ve(Yc),this};var is=t.textColor||"0 g",il=m.__private__.getTextColor=m.getTextColor=function(){return be(is)};m.__private__.setTextColor=m.setTextColor=function(j,J,_e,je){return is=we({ch1:j,ch2:J,ch3:_e,ch4:je,pdfColorType:"text",precision:3}),this};var ol=t.charSpace,Xl=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(ol||0)};m.__private__.setCharSpace=m.setCharSpace=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ol=j,this};var pd=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(j){var J=m.CapJoinStyles[j];if(J===void 0)throw new Error("Line cap style of '"+j+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return pd=J,ve(J+" J"),this};var Yl=0;m.__private__.setLineJoin=m.setLineJoin=function(j){var J=m.CapJoinStyles[j];if(J===void 0)throw new Error("Line join style of '"+j+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Yl=J,ve(J+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(j){if(j=j||0,isNaN(j))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ve(B(P(j))+" M"),this},m.GState=Ax,m.setGState=function(j){(j=typeof j=="string"?Vt[Sr[j]]:Kc(null,j)).equals(Ur)||(ve("/"+j.id+" gs"),Ur=j)};var Kc=function(j,J){if(!j||!Sr[j]){var _e=!1;for(var je in Vt)if(Vt.hasOwnProperty(je)&&Vt[je].equals(J)){_e=!0;break}if(_e)J=Vt[je];else{var Ie="GS"+(Object.keys(Vt).length+1).toString(10);Vt[Ie]=J,J.id=Ie}return j&&(Sr[j]=J.id),cr.publish("addGState",J),J}};m.addGState=function(j,J){return Kc(j,J),this},m.saveGraphicsState=function(){return ve("q"),Wt.push({key:bt,size:it,color:is}),this},m.restoreGraphicsState=function(){ve("Q");var j=Wt.pop();return bt=j.key,it=j.size,is=j.color,Ur=null,this},m.setCurrentTransformationMatrix=function(j){return ve(j.toString()+" cm"),this},m.comment=function(j){return ve("#"+j),this};var Wi=function(j,J){var _e=j||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return _e},set:function(Ze){isNaN(Ze)||(_e=parseFloat(Ze))}});var je=J||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return je},set:function(Ze){isNaN(Ze)||(je=parseFloat(Ze))}});var Ie="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ie},set:function(Ze){Ie=Ze.toString()}}),this},ll=function(j,J,_e,je){Wi.call(this,j,J),this.type="rect";var Ie=_e||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ie},set:function(dt){isNaN(dt)||(Ie=parseFloat(dt))}});var Ze=je||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ze},set:function(dt){isNaN(dt)||(Ze=parseFloat(dt))}}),this},Jc=function(){this.page=rr,this.currentPage=W,this.pages=We.slice(0),this.pagesContext=Ut.slice(0),this.x=tr,this.y=ke,this.matrix=$t,this.width=yo(W),this.height=cl(W),this.outputDestination=nt,this.id="",this.objectNumber=-1};Jc.prototype.restore=function(){rr=this.page,W=this.currentPage,Ut=this.pagesContext,We=this.pages,tr=this.x,ke=this.y,$t=this.matrix,md(W,this.width),xd(W,this.height),nt=this.outputDestination};var Af=function(j,J,_e,je,Ie){hn.push(new Jc),rr=W=0,We=[],tr=j,ke=J,$t=Ie,Hl([_e,je])},U0=function(j){if(pr[j])hn.pop().restore();else{var J=new Jc,_e="Xo"+(Object.keys(yt).length+1).toString(10);J.id=_e,pr[j]=_e,yt[_e]=J,cr.publish("addFormObject",J),hn.pop().restore()}};for(var Qc in m.beginFormObject=function(j,J,_e,je,Ie){return Af(j,J,_e,je,Ie),this},m.endFormObject=function(j){return U0(j),this},m.doFormObject=function(j,J){var _e=yt[pr[j]];return ve("q"),ve(J.toString()+" cm"),ve("/"+_e.id+" Do"),ve("Q"),this},m.getFormObject=function(j){var J=yt[pr[j]];return{x:J.x,y:J.y,width:J.width,height:J.height,matrix:J.matrix}},m.save=function(j,J){return j=j||"generated.pdf",(J=J||{}).returnPromise=J.returnPromise||!1,J.returnPromise===!1?(Ud($l(Ui()),j),typeof Ud.unload=="function"&&dr.setTimeout&&setTimeout(Ud.unload,911),this):new Promise((function(_e,je){try{var Ie=Ud($l(Ui()),j);typeof Ud.unload=="function"&&dr.setTimeout&&setTimeout(Ud.unload,911),_e(Ie)}catch(Ze){je(Ze.message)}}))},or.API)or.API.hasOwnProperty(Qc)&&(Qc==="events"&&or.API.events.length?(function(j,J){var _e,je,Ie;for(Ie=J.length-1;Ie!==-1;Ie--)_e=J[Ie][0],je=J[Ie][1],j.subscribe.apply(j,[_e].concat(typeof je=="function"?[je]:je))})(cr,or.API.events):m[Qc]=or.API[Qc]);var yo=m.getPageWidth=function(j){return(Ut[j=j||W].mediaBox.topRightX-Ut[j].mediaBox.bottomLeftX)/lt},md=m.setPageWidth=function(j,J){Ut[j].mediaBox.topRightX=J*lt+Ut[j].mediaBox.bottomLeftX},cl=m.getPageHeight=function(j){return(Ut[j=j||W].mediaBox.topRightY-Ut[j].mediaBox.bottomLeftY)/lt},xd=m.setPageHeight=function(j,J){Ut[j].mediaBox.topRightY=J*lt+Ut[j].mediaBox.bottomLeftY};return m.internal={pdfEscape:la,getStyle:dd,getFont:Gc,getFontSize:vt,getCharSpace:Xl,getTextColor:il,getLineHeight:Xc,getLineHeightFactor:wi,getLineWidth:al,write:Xe,getHorizontalCoordinate:Ja,getVerticalCoordinate:Qa,getCoordinateString:Ef,getVerticalCoordinateString:_i,collections:{},newObject:pn,newAdditionalObject:ye,newObjectDeferred:mn,newObjectDeferredBegin:se,getFilters:Ue,putStream:Je,events:cr,scaleFactor:lt,pageSize:{getWidth:function(){return yo(W)},setWidth:function(j){md(W,j)},getHeight:function(){return cl(W)},setHeight:function(j){xd(W,j)}},encryptionOptions:h,encryption:Sn,getEncryptor:zi,output:nl,getNumberOfPages:M0,pages:We,out:ve,f2:ee,f3:I,getPageInfo:yi,getPageInfoByObjId:ir,getCurrentPageInfo:Vl,getPDFVersion:y,Point:Wi,Rectangle:ll,Matrix:Mt,hasHotfix:Wl},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return yo(W)},set:function(j){md(W,j)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return cl(W)},set:function(j){xd(W,j)},enumerable:!0,configurable:!0}),zl.call(m,Ke),bt="F1",ld(s,r),cr.publish("initialized"),m}a0.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},a0.prototype.toHexString=function(t){return t.split("").map((function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)})).join("")},a0.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},a0.prototype.processOwnerPassword=function(t,e){return Y2(X2(e).substr(0,5),t)},a0.prototype.encryptor=function(t,e){var r=X2(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return Y2(r,n)}},Ax.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||dn(t)!==dn(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},or.API={events:[]},or.version="3.0.1";var es=or.API,ky=1,wf=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},e0=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},br=function(t){return t.toFixed(2)},Fu=function(t){return t.toFixed(5)};es.__acroform__={};var gi=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},$w=function(t){return t*ky},jl=function(t){var e=new vk,r=Ht.internal.getHeight(t)||0,n=Ht.internal.getWidth(t)||0;return e.BBox=[0,0,Number(br(n)),Number(br(r))],e},bU=es.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},wU=es.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},_U=es.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(t&1<<e)==0?0:1},fs=es.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return _U(t,e-1)},hs=es.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return bU(t,e-1)},ps=es.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return wU(t,e-1)},NU=es.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,s=t[0],a=t[1],i=t[2],l=t[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=n(a+l)||0,c.upperRight_X=r(s+i)||0,c.upperRight_Y=n(a)||0,[Number(br(c.lowerLeft_X)),Number(br(c.lowerLeft_Y)),Number(br(c.upperRight_X)),Number(br(c.upperRight_Y))]},SU=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=K2(t,r),s=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+s+" "+br(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=jl(t);return a.scope=t.scope,a.stream=e.join(`
`),a}},K2=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},s=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");s=t.multiline?s.map((function(I){return I.split(`
`)})):s.map((function(I){return[I]}));var a=r,i=Ht.internal.getHeight(t)||0;i=i<0?-i:i;var l=Ht.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(I,P,ae){if(I+1<s.length){var G=P+" "+s[I+1][0];return Fm(G,t,ae).width<=l-4}return!1};a++;e:for(;a>0;){e="",a--;var d,h,p=Fm("3",t,a).height,x=t.multiline?i-a:(i-p)/2,m=x+=2,b=0,y=0,w=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+Fm(e,t,a=12).width+", FieldWidth:"+l+`
`;break}for(var S="",k=0,A=0;A<s.length;A++)if(s.hasOwnProperty(A)){var z=!1;if(s[A].length!==1&&w!==s[A].length-1){if((p+2)*(k+2)+2>i)continue e;S+=s[A][w],z=!0,y=A,A--}else{S=(S+=s[A][w]+" ").substr(S.length-1)==" "?S.substr(0,S.length-1):S;var H=parseInt(A),V=c(H,S,a),B=A>=s.length-1;if(V&&!B){S+=" ",w=0;continue}if(V||B){if(B)y=H;else if(t.multiline&&(p+2)*(k+2)+2>i)continue e}else{if(!t.multiline||(p+2)*(k+2)+2>i)continue e;y=H}}for(var R="",O=b;O<=y;O++){var ee=s[O];if(t.multiline){if(O===y){R+=ee[w]+" ",w=(w+1)%ee.length;continue}if(O===b){R+=ee[ee.length-1]+" ";continue}}R+=ee[0]+" "}switch(R=R.substr(R.length-1)==" "?R.substr(0,R.length-1):R,h=Fm(R,t,a).width,t.textAlign){case"right":d=l-h-2;break;case"center":d=(l-h)/2;break;case"left":default:d=2}e+=br(d)+" "+br(m)+` Td
`,e+="("+wf(R)+`) Tj
`,e+=-br(d)+` 0 Td
`,m=-(a+2),h=0,b=z?y:y+1,k++,S=""}break}return n.text=e,n.fontSize=a,n},Fm=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),s=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},kU={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},jU=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find((function(n){return n.type===r.type&&n.object===r.object}))===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},EU=function(t,e){for(var r in t)if(t.hasOwnProperty(r)){var n=r,s=t[r];e.internal.newObjectDeferredBegin(s.objId,!0),dn(s)==="object"&&typeof s.putStream=="function"&&s.putStream(),delete t[n]}},AU=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Zo.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(kU)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");ky=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new yk,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",(function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)})),t.internal.events.subscribe("buildDocument",(function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var a=n[s];a.objId=void 0,a.hasAnnotation&&jU(a,r)}})(t)})),t.internal.events.subscribe("putCatalog",(function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)})),t.internal.events.subscribe("postPutPages",(function(r){(function(n,s){var a=!n;for(var i in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(i)){var l=n[i],c=[],d=l.Rect;if(l.Rect&&(l.Rect=NU(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Ht.createDefaultAppearanceStream(l),dn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var h=SU(l);c.push({key:"AP",value:"<</N "+h+">>"}),s.internal.acroformPlugin.xForms.push(h)}if(l.appearanceStreamContent){var p="";for(var x in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(x)){var m=l.appearanceStreamContent[x];if(p+="/"+x+" ",p+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var i in m)if(m.hasOwnProperty(i)){var b=m[i];typeof b=="function"&&(b=b.call(s,l)),p+="/"+i+" "+b+" ",s.internal.acroformPlugin.xForms.indexOf(b)>=0||s.internal.acroformPlugin.xForms.push(b)}}else typeof(b=m)=="function"&&(b=b.call(s,l)),p+="/"+i+" "+b,s.internal.acroformPlugin.xForms.indexOf(b)>=0||s.internal.acroformPlugin.xForms.push(b);p+=">>"}c.push({key:"AP",value:`<<
`+p+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}a&&EU(s.internal.acroformPlugin.xForms,s)})(r,t)})),t.internal.acroformPlugin.isInitialized=!0}},gk=es.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(i){return i};if(Array.isArray(t)){for(var s="[",a=0;a<t.length;a++)switch(a!==0&&(s+=" "),dn(t[a])){case"boolean":case"number":case"object":s+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),s+="("+wf(n(t[a].toString()))+")"):s+=t[a].toString()}return s+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},H1=function(t,e,r){var n=function(s){return s};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),t="("+wf(n(t))+")"},Tl=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Tl.prototype.toString=function(){return this.objId+" 0 R"},Tl.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Tl.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter((function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"}));for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],s=this[n];s&&(Array.isArray(s)?t.push({key:n,value:gk(s,this.objId,this.scope)}):s instanceof Tl?(s.scope=this.scope,t.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&t.push({key:n,value:s}))}return t};var vk=function(){Tl.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};gi(vk,Tl);var yk=function(){Tl.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+wf(r(t))+")"}},set:function(r){t=r}})};gi(yk,Tl);var Zo=function t(){Tl.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(S){if(isNaN(S))throw new Error('Invalid value "'+S+'" for attribute F supplied.');e=S}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!fs(e,3)},set:function(S){S?this.F=hs(e,3):this.F=ps(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(S){if(isNaN(S))throw new Error('Invalid value "'+S+'" for attribute Ff supplied.');r=S}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(S){n=S!==void 0?S:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(S){n[0]=S}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(S){n[1]=S}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(S){n[2]=S}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(S){n[3]=S}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(S){switch(S){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=S;break;default:throw new Error('Invalid value "'+S+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof Cx)return;a="FieldObject"+t.FieldNum++}var S=function(k){return k};return this.scope&&(S=this.scope.internal.getEncryptor(this.objId)),"("+wf(S(a))+")"},set:function(S){a=S.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(S){a=S}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(S){i=S}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(S){l=S}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(S){c=S}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/ky:d},set:function(S){d=S}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(S){h=S}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof Cx||this instanceof ef))return H1(p,this.objId,this.scope)},set:function(S){S=S.toString(),p=S}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof zs?x:H1(x,this.objId,this.scope)},set:function(S){S=S.toString(),x=this instanceof zs?S:S.substr(0,1)==="("?e0(S.substr(1,S.length-2)):e0(S)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof zs?e0(x.substr(1,x.length-1)):x},set:function(S){S=S.toString(),x=this instanceof zs?"/"+S:S}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(S){this.V=S}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof zs?m:H1(m,this.objId,this.scope)},set:function(S){S=S.toString(),m=this instanceof zs?S:S.substr(0,1)==="("?e0(S.substr(1,S.length-2)):e0(S)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof zs?e0(m.substr(1,m.length-1)):m},set:function(S){S=S.toString(),m=this instanceof zs?"/"+S:S}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b,y=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return y},set:function(S){S=!!S,y=S}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(b)return b},set:function(S){b=S}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,1)},set:function(S){S?this.Ff=hs(this.Ff,1):this.Ff=ps(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,2)},set:function(S){S?this.Ff=hs(this.Ff,2):this.Ff=ps(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,3)},set:function(S){S?this.Ff=hs(this.Ff,3):this.Ff=ps(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(S){if([0,1,2].indexOf(S)===-1)throw new Error('Invalid value "'+S+'" for attribute Q supplied.');w=S}}),Object.defineProperty(this,"textAlign",{get:function(){var S;switch(w){case 0:default:S="left";break;case 1:S="center";break;case 2:S="right"}return S},configurable:!0,enumerable:!0,set:function(S){switch(S){case"right":case 2:w=2;break;case"center":case 1:w=1;break;case"left":case 0:default:w=0}}})};gi(Zo,Tl);var x0=function(){Zo.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return gk(e,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=(function(a,i,l){l||(l=1);for(var c,d=[];c=i.exec(a);)d.push(c[l]);return d})(n,/\((.*?)\)/g)),e=s}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,18)},set:function(r){r?this.Ff=hs(this.Ff,18):this.Ff=ps(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=hs(this.Ff,19):this.Ff=ps(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,20)},set:function(r){r?(this.Ff=hs(this.Ff,20),e.sort()):this.Ff=ps(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,22)},set:function(r){r?this.Ff=hs(this.Ff,22):this.Ff=ps(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,23)},set:function(r){r?this.Ff=hs(this.Ff,23):this.Ff=ps(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,27)},set:function(r){r?this.Ff=hs(this.Ff,27):this.Ff=ps(this.Ff,27)}}),this.hasAppearanceStream=!1};gi(x0,Zo);var g0=function(){x0.call(this),this.fontName="helvetica",this.combo=!1};gi(g0,x0);var v0=function(){g0.call(this),this.combo=!0};gi(v0,g0);var tx=function(){v0.call(this),this.edit=!0};gi(tx,v0);var zs=function(){Zo.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,15)},set:function(r){r?this.Ff=hs(this.Ff,15):this.Ff=ps(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,16)},set:function(r){r?this.Ff=hs(this.Ff,16):this.Ff=ps(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,17)},set:function(r){r?this.Ff=hs(this.Ff,17):this.Ff=ps(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,26)},set:function(r){r?this.Ff=hs(this.Ff,26):this.Ff=ps(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,s=[];for(n in s.push("<<"),e)s.push("/"+n+" ("+wf(r(e[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){dn(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};gi(zs,Zo);var rx=function(){zs.call(this),this.pushButton=!0};gi(rx,zs);var y0=function(){zs.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};gi(y0,zs);var Cx=function(){var t,e;Zo.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(s){e=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var a,i=[];for(a in i.push("<<"),n)i.push("/"+a+" ("+wf(s(n[a]))+")");return i.push(">>"),i.join(`
`)},set:function(s){dn(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Ht.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};gi(Cx,Zo),y0.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},y0.prototype.createOption=function(t){var e=new Cx;return e.Parent=this,e.optionName=t,this.Kids.push(e),CU.call(this.scope,e),e};var nx=function(){zs.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Ht.CheckBox.createAppearanceStream()};gi(nx,zs);var ef=function(){Zo.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,13)},set:function(e){e?this.Ff=hs(this.Ff,13):this.Ff=ps(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,21)},set:function(e){e?this.Ff=hs(this.Ff,21):this.Ff=ps(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,23)},set:function(e){e?this.Ff=hs(this.Ff,23):this.Ff=ps(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,24)},set:function(e){e?this.Ff=hs(this.Ff,24):this.Ff=ps(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,25)},set:function(e){e?this.Ff=hs(this.Ff,25):this.Ff=ps(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,26)},set:function(e){e?this.Ff=hs(this.Ff,26):this.Ff=ps(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};gi(ef,Zo);var sx=function(){ef.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,14)},set:function(t){t?this.Ff=hs(this.Ff,14):this.Ff=ps(this.Ff,14)}}),this.password=!0};gi(sx,ef);var Ht={CheckBox:{createAppearanceStream:function(){return{N:{On:Ht.CheckBox.YesNormal},D:{On:Ht.CheckBox.YesPushDown,Off:Ht.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=jl(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,s=t.scope.__private__.encodeColorString(t.color),a=K2(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+br(Ht.internal.getWidth(t))+" "+br(Ht.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+br(a.fontSize)+" Tf "+s),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=jl(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),s=[],a=Ht.internal.getHeight(t),i=Ht.internal.getWidth(t),l=K2(t,t.caption);return s.push("1 g"),s.push("0 0 "+br(i)+" "+br(a)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+br(i-1)+" "+br(a-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+br(l.fontSize)+" Tf "+n),s.push(l.text),s.push("ET"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(t){var e=jl(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+br(Ht.internal.getWidth(t))+" "+br(Ht.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Ht.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Ht.RadioButton.Circle.YesNormal,e.D[t]=Ht.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=jl(t);e.scope=t.scope;var r=[],n=Ht.internal.getWidth(t)<=Ht.internal.getHeight(t)?Ht.internal.getWidth(t)/4:Ht.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Ht.internal.Bezier_C,a=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Fu(Ht.internal.getWidth(t)/2)+" "+Fu(Ht.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=jl(t);e.scope=t.scope;var r=[],n=Ht.internal.getWidth(t)<=Ht.internal.getHeight(t)?Ht.internal.getWidth(t)/4:Ht.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*Ht.internal.Bezier_C).toFixed(5)),i=Number((n*Ht.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Fu(Ht.internal.getWidth(t)/2)+" "+Fu(Ht.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Fu(Ht.internal.getWidth(t)/2)+" "+Fu(Ht.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=jl(t);e.scope=t.scope;var r=[],n=Ht.internal.getWidth(t)<=Ht.internal.getHeight(t)?Ht.internal.getWidth(t)/4:Ht.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*Ht.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Fu(Ht.internal.getWidth(t)/2)+" "+Fu(Ht.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Ht.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Ht.RadioButton.Cross.YesNormal,e.D[t]=Ht.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=jl(t);e.scope=t.scope;var r=[],n=Ht.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+br(Ht.internal.getWidth(t)-2)+" "+br(Ht.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(br(n.x1.x)+" "+br(n.x1.y)+" m"),r.push(br(n.x2.x)+" "+br(n.x2.y)+" l"),r.push(br(n.x4.x)+" "+br(n.x4.y)+" m"),r.push(br(n.x3.x)+" "+br(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=jl(t);e.scope=t.scope;var r=Ht.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+br(Ht.internal.getWidth(t))+" "+br(Ht.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+br(Ht.internal.getWidth(t)-2)+" "+br(Ht.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(br(r.x1.x)+" "+br(r.x1.y)+" m"),n.push(br(r.x2.x)+" "+br(r.x2.y)+" l"),n.push(br(r.x4.x)+" "+br(r.x4.y)+" m"),n.push(br(r.x3.x)+" "+br(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=jl(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+br(Ht.internal.getWidth(t))+" "+br(Ht.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};Ht.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Ht.internal.getWidth(t),r=Ht.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},Ht.internal.getWidth=function(t){var e=0;return dn(t)==="object"&&(e=$w(t.Rect[2])),e},Ht.internal.getHeight=function(t){var e=0;return dn(t)==="object"&&(e=$w(t.Rect[3])),e};var CU=es.addField=function(t){if(AU(this,t),!(t instanceof Zo))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};es.AcroFormChoiceField=x0,es.AcroFormListBox=g0,es.AcroFormComboBox=v0,es.AcroFormEditBox=tx,es.AcroFormButton=zs,es.AcroFormPushButton=rx,es.AcroFormRadioButton=y0,es.AcroFormCheckBox=nx,es.AcroFormTextField=ef,es.AcroFormPasswordField=sx,es.AcroFormAppearance=Ht,es.AcroForm={ChoiceField:x0,ListBox:g0,ComboBox:v0,EditBox:tx,Button:zs,PushButton:rx,RadioButton:y0,CheckBox:nx,TextField:ef,PasswordField:sx,Appearance:Ht},or.AcroForm={ChoiceField:x0,ListBox:g0,ComboBox:v0,EditBox:tx,Button:zs,PushButton:rx,RadioButton:y0,CheckBox:nx,TextField:ef,PasswordField:sx,Appearance:Ht};or.AcroForm;function bk(t){return t.reduce((function(e,r,n){return e[r]=n,e}),{})}(function(t){t.__addimage__={};var e="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(I,P){var ae,G,M,te,ie,le=e;if((P=P||e)==="RGBA"||I.data!==void 0&&I.data instanceof Uint8ClampedArray&&"height"in I&&"width"in I)return"RGBA";if(V(I))for(ie in r)for(M=r[ie],ae=0;ae<M.length;ae+=1){for(te=!0,G=0;G<M[ae].length;G+=1)if(M[ae][G]!==void 0&&M[ae][G]!==I[G]){te=!1;break}if(te===!0){le=ie;break}}else for(ie in r)for(M=r[ie],ae=0;ae<M.length;ae+=1){for(te=!0,G=0;G<M[ae].length;G+=1)if(M[ae][G]!==void 0&&M[ae][G]!==I.charCodeAt(G)){te=!1;break}if(te===!0){le=ie;break}}return le===e&&P!==e&&(le=P),le},s=function I(P){for(var ae=this.internal.write,G=this.internal.putStream,M=(0,this.internal.getFilters)();M.indexOf("FlateEncode")!==-1;)M.splice(M.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var te=[];if(te.push({key:"Type",value:"/XObject"}),te.push({key:"Subtype",value:"/Image"}),te.push({key:"Width",value:P.width}),te.push({key:"Height",value:P.height}),P.colorSpace===w.INDEXED?te.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(te.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===w.DEVICE_CMYK&&te.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),te.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&te.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)){for(var ie="",le=0,X=P.transparency.length;le<X;le++)ie+=P.transparency[le]+" "+P.transparency[le]+" ";te.push({key:"Mask",value:"["+ie+"]"})}P.sMask!==void 0&&te.push({key:"SMask",value:P.objectId+1+" 0 R"});var fe=P.filter!==void 0?["/"+P.filter]:void 0;if(G({data:P.data,additionalKeyValues:te,alreadyAppliedFilters:fe,objectId:P.objectId}),ae("endobj"),"sMask"in P&&P.sMask!==void 0){var K="/Predictor "+P.predictor+" /Colors 1 /BitsPerComponent "+P.bitsPerComponent+" /Columns "+P.width,E={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:P.bitsPerComponent,decodeParameters:K,data:P.sMask};"filter"in P&&(E.filter=P.filter),I.call(this,E)}if(P.colorSpace===w.INDEXED){var W=this.internal.newObject();G({data:R(new Uint8Array(P.palette)),objectId:W}),ae("endobj")}},a=function(){var I=this.internal.collections.addImage_images;for(var P in I)s.call(this,I[P])},i=function(){var I,P=this.internal.collections.addImage_images,ae=this.internal.write;for(var G in P)ae("/I"+(I=P[G]).index,I.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",i))},c=function(){var I=this.internal.collections.addImage_images;return l.call(this),I},d=function(){return Object.keys(this.internal.collections.addImage_images).length},h=function(I){return typeof t["process"+I.toUpperCase()]=="function"},p=function(I){return dn(I)==="object"&&I.nodeType===1},x=function(I,P){if(I.nodeName==="IMG"&&I.hasAttribute("src")){var ae=""+I.getAttribute("src");if(ae.indexOf("data:image/")===0)return Lh(unescape(ae).split("base64,").pop());var G=t.loadFile(ae,!0);if(G!==void 0)return G}if(I.nodeName==="CANVAS"){if(I.width===0||I.height===0)throw new Error("Given canvas must have data. Canvas width: "+I.width+", height: "+I.height);var M;switch(P){case"PNG":M="image/png";break;case"WEBP":M="image/webp";break;case"JPEG":case"JPG":default:M="image/jpeg"}return Lh(I.toDataURL(M,1).split("base64,").pop())}},m=function(I){var P=this.internal.collections.addImage_images;if(P){for(var ae in P)if(I===P[ae].alias)return P[ae]}},b=function(I,P,ae){return I||P||(I=-96,P=-96),I<0&&(I=-1*ae.width*72/I/this.internal.scaleFactor),P<0&&(P=-1*ae.height*72/P/this.internal.scaleFactor),I===0&&(I=P*ae.width/ae.height),P===0&&(P=I*ae.height/ae.width),[I,P]},y=function(I,P,ae,G,M,te){var ie=b.call(this,ae,G,M),le=this.internal.getCoordinateString,X=this.internal.getVerticalCoordinateString,fe=c.call(this);if(ae=ie[0],G=ie[1],fe[M.index]=M,te){te*=Math.PI/180;var K=Math.cos(te),E=Math.sin(te),W=function(F){return F.toFixed(4)},L=[W(K),W(E),W(-1*E),W(K),0,0,"cm"]}this.internal.write("q"),te?(this.internal.write([1,"0","0",1,le(I),X(P+G),"cm"].join(" ")),this.internal.write(L.join(" ")),this.internal.write([le(ae),"0","0",le(G),"0","0","cm"].join(" "))):this.internal.write([le(ae),"0","0",le(G),le(I),X(P+G),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+M.index+" Do"),this.internal.write("Q")},w=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var S=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},k=t.__addimage__.sHashCode=function(I){var P,ae,G=0;if(typeof I=="string")for(ae=I.length,P=0;P<ae;P++)G=(G<<5)-G+I.charCodeAt(P),G|=0;else if(V(I))for(ae=I.byteLength/2,P=0;P<ae;P++)G=(G<<5)-G+I[P],G|=0;return G},A=t.__addimage__.validateStringAsBase64=function(I){(I=I||"").toString().trim();var P=!0;return I.length===0&&(P=!1),I.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(I.substr(0,I.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(I.substr(-2))===!1&&(P=!1),P},z=t.__addimage__.extractImageFromDataUrl=function(I){if(I==null||!(I=I.trim()).startsWith("data:"))return null;var P=I.indexOf(",");return P<0?null:I.substring(0,P).trim().endsWith("base64")?I.substring(P+1):null},H=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(I){return H()&&I instanceof ArrayBuffer};var V=t.__addimage__.isArrayBufferView=function(I){return H()&&typeof Uint32Array<"u"&&(I instanceof Int8Array||I instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&I instanceof Uint8ClampedArray||I instanceof Int16Array||I instanceof Uint16Array||I instanceof Int32Array||I instanceof Uint32Array||I instanceof Float32Array||I instanceof Float64Array)},B=t.__addimage__.binaryStringToUint8Array=function(I){for(var P=I.length,ae=new Uint8Array(P),G=0;G<P;G++)ae[G]=I.charCodeAt(G);return ae},R=t.__addimage__.arrayBufferToBinaryString=function(I){for(var P="",ae=V(I)?I:new Uint8Array(I),G=0;G<ae.length;G+=8192)P+=String.fromCharCode.apply(null,ae.subarray(G,G+8192));return P};t.addImage=function(){var I,P,ae,G,M,te,ie,le,X;if(typeof arguments[1]=="number"?(P=e,ae=arguments[1],G=arguments[2],M=arguments[3],te=arguments[4],ie=arguments[5],le=arguments[6],X=arguments[7]):(P=arguments[1],ae=arguments[2],G=arguments[3],M=arguments[4],te=arguments[5],ie=arguments[6],le=arguments[7],X=arguments[8]),dn(I=arguments[0])==="object"&&!p(I)&&"imageData"in I){var fe=I;I=fe.imageData,P=fe.format||P||e,ae=fe.x||ae||0,G=fe.y||G||0,M=fe.w||fe.width||M,te=fe.h||fe.height||te,ie=fe.alias||ie,le=fe.compression||le,X=fe.rotation||fe.angle||X}var K=this.internal.getFilters();if(le===void 0&&K.indexOf("FlateEncode")!==-1&&(le="SLOW"),isNaN(ae)||isNaN(G))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var E=O.call(this,I,P,ie,le);return y.call(this,ae,G,M,te,E,X),this};var O=function(I,P,ae,G){var M,te,ie;if(typeof I=="string"&&n(I)===e){I=unescape(I);var le=ee(I,!1);(le!==""||(le=t.loadFile(I,!0))!==void 0)&&(I=le)}if(p(I)&&(I=x(I,P)),P=n(I,P),!h(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((ie=ae)==null||ie.length===0)&&(ae=(function(X){return typeof X=="string"||V(X)?k(X):V(X.data)?k(X.data):null})(I)),(M=m.call(this,ae))||(H()&&(I instanceof Uint8Array||P==="RGBA"||(te=I,I=B(I))),M=this["process"+P.toUpperCase()](I,d.call(this),ae,(function(X){return X&&typeof X=="string"&&(X=X.toUpperCase()),X in t.image_compression?X:S.NONE})(G),te)),!M)throw new Error("An unknown error occurred whilst processing the image.");return M},ee=t.__addimage__.convertBase64ToBinaryString=function(I,P){P=typeof P!="boolean"||P;var ae,G="";if(typeof I=="string"){var M;ae=(M=z(I))!==null&&M!==void 0?M:I;try{G=Lh(ae)}catch(te){if(P)throw A(ae)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+te.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return G};t.getImageProperties=function(I){var P,ae,G="";if(p(I)&&(I=x(I)),typeof I=="string"&&n(I)===e&&((G=ee(I,!1))===""&&(G=t.loadFile(I)||""),I=G),ae=n(I),!h(ae))throw new Error("addImage does not support files of type '"+ae+"', please ensure that a plugin for '"+ae+"' support is added.");if(!H()||I instanceof Uint8Array||(I=B(I)),!(P=this["process"+ae.toUpperCase()](I)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=ae,P}})(or.API),(function(t){var e=function(r){if(r!==void 0&&r!="")return!0};or.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,s,a,i=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,h=!1,p=0;p<d.length&&!h;p++)switch((n=d[p]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var x=0;x<d.length;x++){n=d[x];var m=this.internal.pdfEscape,b=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var y=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),S=this.internal.getEncryptor(y.objId),k=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(s="/Rect ["+i(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+m(S(n.contents))+")",a+=" /Popup "+w.objId+" 0 R",a+=" /P "+c.objId+" 0 R",a+=" /T ("+m(S(k))+") >>",y.content=a;var A=y.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+i(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+A,n.open&&(a+=" /Open true"),a+=" >>",w.content=a,this.internal.write(y.objId,"0 R",w.objId,"0 R");break;case"freetext":s="/Rect ["+i(n.bounds.x)+" "+l(n.bounds.y)+" "+i(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var z=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+m(b(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+z+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var H=this.annotations._nameMap[n.options.name];n.options.pageNumber=H.page,n.options.top=H.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+m(b(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var V=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+V+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,s,a,i){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:d(n),w:c(r+s),h:d(n+a)},options:i,type:"link"})},t.textWithLink=function(r,n,s,a){var i,l,c=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){l=a.maxWidth;var h=this.splitTextToSize(r,l).length;i=Math.ceil(d*h)}else l=c,i=d;return this.text(r,n,s,a),s+=.2*d,a.align==="center"&&(n-=c/2),a.align==="right"&&(n-=c),this.link(n,s-d,l,i,a),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}})(or.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(y){return e[y.charCodeAt(0)]!==void 0},i=t.__arabicParser__.isArabicLetter=function(y){return typeof y=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(y)},l=t.__arabicParser__.isArabicEndLetter=function(y){return i(y)&&a(y)&&e[y.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(y){return i(y)&&s.indexOf(y.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(y){return i(y)&&a(y)&&e[y.charCodeAt(0)].length>=1};var d=t.__arabicParser__.arabicLetterHasFinalForm=function(y){return i(y)&&a(y)&&e[y.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(y){return i(y)&&a(y)&&e[y.charCodeAt(0)].length>=3};var h=t.__arabicParser__.arabicLetterHasMedialForm=function(y){return i(y)&&a(y)&&e[y.charCodeAt(0)].length==4},p=t.__arabicParser__.resolveLigatures=function(y){var w=0,S=r,k="",A=0;for(w=0;w<y.length;w+=1)S[y.charCodeAt(w)]!==void 0?(A++,typeof(S=S[y.charCodeAt(w)])=="number"&&(k+=String.fromCharCode(S),S=r,A=0),w===y.length-1&&(S=r,k+=y.charAt(w-(A-1)),w-=A-1,A=0)):(S=r,k+=y.charAt(w-A),w-=A,A=0);return k};t.__arabicParser__.isArabicDiacritic=function(y){return y!==void 0&&n[y.charCodeAt(0)]!==void 0};var x=t.__arabicParser__.getCorrectForm=function(y,w,S){return i(y)?a(y)===!1?-1:!d(y)||!i(w)&&!i(S)||!i(S)&&l(w)||l(y)&&!i(w)||l(y)&&c(w)||l(y)&&l(w)?0:h(y)&&i(w)&&!l(w)&&i(S)&&d(S)?3:l(y)||!i(S)?1:2:-1},m=function(y){var w=0,S=0,k=0,A="",z="",H="",V=(y=y||"").split("\\s+"),B=[];for(w=0;w<V.length;w+=1){for(B.push(""),S=0;S<V[w].length;S+=1)A=V[w][S],z=V[w][S-1],H=V[w][S+1],i(A)?(k=x(A,z,H),B[w]+=k!==-1?String.fromCharCode(e[A.charCodeAt(0)][k]):A):B[w]+=A;B[w]=p(B[w])}return B.join(" ")},b=t.__arabicParser__.processArabic=t.processArabic=function(){var y,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,S=[];if(Array.isArray(w)){var k=0;for(S=[],k=0;k<w.length;k+=1)Array.isArray(w[k])?S.push([m(w[k][0]),w[k][1],w[k][2]]):S.push([m(w[k])]);y=S}else y=m(w);return typeof arguments[0]=="string"?y:(arguments[0].text=y,arguments[0])};t.events.push(["preProcessText",b])})(or.API),or.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",(function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){this.internal.out("/OpenAction "+e+" 0 R")}))}return this},(function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(l){a=l}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(l){i=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(or.API),(function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(y){c=y}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(y){d=y}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(y){h=y}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(y){p=y}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(y){x=y}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(y){m=y}});var b=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return b},set:function(y){b=y}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,d){n.call(this);var h=(d=d||{}).fontSize||this.getFontSize(),p=d.font||this.getFont(),x=d.scaleFactor||this.internal.scaleFactor,m=0,b=0,y=0,w=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var S=d.maxWidth;S>0?typeof c=="string"?c=this.splitTextToSize(c,S):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce((function(A,z){return A.concat(w.splitTextToSize(z,S))}),[])):c=Array.isArray(c)?c:[c];for(var k=0;k<c.length;k++)m<(y=this.getStringUnitWidth(c[k],{font:p})*h)&&(m=y);return m!==0&&(b=c.length),{w:m/=x,h:Math.max((b*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/x,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=t.cell=function(){var c;c=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var d=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,p=this.internal.__cell__.margins||e,x=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=p.top,m&&x&&(this.printHeaderRow(c.lineNumber,!0),c.y+=x[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-h,c.y+h,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+h,{align:"center",baseline:"top",maxWidth:c.width-h-h}):this.text(c.text,c.x+h,c.y+h,{align:"left",baseline:"top",maxWidth:c.width-h-h})),this.internal.__cell__.lastCell=c,this};t.table=function(c,d,h,p,x){if(n.call(this),!h)throw new Error("No data for PDF table.");var m,b,y,w,S=[],k=[],A=[],z={},H={},V=[],B=[],R=(x=x||{}).autoSize||!1,O=x.printHeaders!==!1,ee=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,I=x.margins||Object.assign({width:this.getPageWidth()},e),P=typeof x.padding=="number"?x.padding:3,ae=x.headerBackgroundColor||"#c8c8c8",G=x.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=O,this.internal.__cell__.margins=I,this.internal.__cell__.table_font_size=ee,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=ae,this.internal.__cell__.headerTextColor=G,this.setFontSize(ee),p==null)k=S=Object.keys(h[0]),A=S.map((function(){return"left"}));else if(Array.isArray(p)&&dn(p[0])==="object")for(S=p.map((function(fe){return fe.name})),k=p.map((function(fe){return fe.prompt||fe.name||""})),A=p.map((function(fe){return fe.align||"left"})),m=0;m<p.length;m+=1)H[p[m].name]=p[m].width*(19.049976/25.4);else Array.isArray(p)&&typeof p[0]=="string"&&(k=S=p,A=S.map((function(){return"left"})));if(R||Array.isArray(p)&&typeof p[0]=="string")for(m=0;m<S.length;m+=1){for(z[w=S[m]]=h.map((function(fe){return fe[w]})),this.setFont(void 0,"bold"),V.push(this.getTextDimensions(k[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),b=z[w],this.setFont(void 0,"normal"),y=0;y<b.length;y+=1)V.push(this.getTextDimensions(b[y],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);H[w]=Math.max.apply(null,V)+P+P,V=[]}if(O){var M={};for(m=0;m<S.length;m+=1)M[S[m]]={},M[S[m]].text=k[m],M[S[m]].align=A[m];var te=l.call(this,M,H);B=S.map((function(fe){return new a(c,d,H[fe],te,M[fe].text,void 0,M[fe].align)})),this.setTableHeaderRow(B),this.printHeaderRow(1,!1)}var ie=p.reduce((function(fe,K){return fe[K.name]=K.align,fe}),{});for(m=0;m<h.length;m+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:m,data:h[m]},this);var le=l.call(this,h[m],H);for(y=0;y<S.length;y+=1){var X=h[m][S[y]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:m,col:y,data:X},this),i.call(this,new a(c,d,H[S[y]],le,X,m+2,ie[S[y]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var h=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(c).map((function(m){var b=c[m];return this.splitTextToSize(b.hasOwnProperty("text")?b.text:b,d[m]-h-h)}),this).map((function(m){return this.getLineHeightFactor()*m.length*p/x+h+h}),this).reduce((function(m,b){return Math.max(m,b)}),0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,d){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){h=this.internal.__cell__.tableHeaderRow[m].clone(),d&&(h.y=this.internal.__cell__.margins.top||0,x.push(h)),h.lineNumber=c;var b=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,h),this.setTextColor(b)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),r=!1}})(or.API);var wk={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},_k=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],J2=bk(_k),Nk=[100,200,300,400,500,600,700,800,900],TU=bk(Nk);function Q2(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=(function(a){return wk[a=a||"normal"]?a:"normal"})(t.style),n=(function(a){if(!a)return 400;if(typeof a=="number")return a>=100&&a<=900&&a%100==0?a:400;if(/^\d00$/.test(a))return parseInt(a);switch(a){case"bold":return 700;case"normal":default:return 400}})(t.weight),s=(function(a){return typeof J2[a=a||"normal"]=="number"?a:"normal"})(t.stretch);return{family:e,style:r,weight:n,stretch:s,src:t.src||[],ref:t.ref||{name:e,style:[s,r,n].join(" ")}}}function Ww(t,e,r,n){var s;for(s=r;s>=0&&s<e.length;s+=n)if(t[e[s]])return t[e[s]];for(s=r;s>=0&&s<e.length;s-=n)if(t[e[s]])return t[e[s]]}var FU={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Vw={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function qw(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function PU(t,e,r){for(var n=(r=r||{}).defaultFontFamily||"times",s=Object.assign({},FU,r.genericFontFamilies||{}),a=null,i=null,l=0;l<e.length;++l)if(s[(a=Q2(e[l])).family]&&(a.family=s[a.family]),t.hasOwnProperty(a.family)){i=t[a.family];break}if(!(i=i||t[n]))throw new Error("Could not find a font-family for the rule '"+qw(a)+"' and default family '"+n+"'.");if(i=(function(c,d){if(d[c])return d[c];var h=J2[c],p=h<=J2.normal?-1:1,x=Ww(d,_k,h,p);if(!x)throw new Error("Could not find a matching font-stretch value for "+c);return x})(a.stretch,i),i=(function(c,d){if(d[c])return d[c];for(var h=wk[c],p=0;p<h.length;++p)if(d[h[p]])return d[h[p]];throw new Error("Could not find a matching font-style for "+c)})(a.style,i),!(i=(function(c,d){if(d[c])return d[c];if(c===400&&d[500])return d[500];if(c===500&&d[400])return d[400];var h=TU[c],p=Ww(d,Nk,h,c<400?-1:1);if(!p)throw new Error("Could not find a matching font-weight for value "+c);return p})(a.weight,i)))throw new Error("Failed to resolve a font for the rule '"+qw(a)+"'.");return i}function Gw(t){return t.trimLeft()}function LU(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function DU(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Pm,Xw,Yw,$1=["times"];(function(t){var e,r,n,s,a,i,l,c,d,h=function(E){return E=E||{},this.isStrokeTransparent=E.isStrokeTransparent||!1,this.strokeOpacity=E.strokeOpacity||1,this.strokeStyle=E.strokeStyle||"#000000",this.fillStyle=E.fillStyle||"#000000",this.isFillTransparent=E.isFillTransparent||!1,this.fillOpacity=E.fillOpacity||1,this.font=E.font||"10px sans-serif",this.textBaseline=E.textBaseline||"alphabetic",this.textAlign=E.textAlign||"left",this.lineWidth=E.lineWidth||1,this.lineJoin=E.lineJoin||"miter",this.lineCap=E.lineCap||"butt",this.path=E.path||[],this.transform=E.transform!==void 0?E.transform.clone():new c,this.globalCompositeOperation=E.globalCompositeOperation||"normal",this.globalAlpha=E.globalAlpha||1,this.clip_path=E.clip_path||[],this.currentPoint=E.currentPoint||new i,this.miterLimit=E.miterLimit||10,this.lastPoint=E.lastPoint||new i,this.lineDashOffset=E.lineDashOffset||0,this.lineDash=E.lineDash||[],this.margin=E.margin||[0,0,0,0],this.prevPageLastElemOffset=E.prevPageLastElemOffset||0,this.ignoreClearRect=typeof E.ignoreClearRect!="boolean"||E.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new p(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,i=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new h}]);var p=function(E){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var W=E;Object.defineProperty(this,"pdf",{get:function(){return W}});var L=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return L},set:function(De){L=!!De}});var F=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return F},set:function(De){F=!!De}});var q=0;Object.defineProperty(this,"posX",{get:function(){return q},set:function(De){isNaN(De)||(q=De)}});var he=0;Object.defineProperty(this,"posY",{get:function(){return he},set:function(De){isNaN(De)||(he=De)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(De){var ve;typeof De=="number"?ve=[De,De,De,De]:((ve=new Array(4))[0]=De[0],ve[1]=De.length>=2?De[1]:ve[0],ve[2]=De.length>=3?De[2]:ve[0],ve[3]=De.length>=4?De[3]:ve[1]),d.margin=ve}});var me=!1;Object.defineProperty(this,"autoPaging",{get:function(){return me},set:function(De){me=De}});var Z=0;Object.defineProperty(this,"lastBreak",{get:function(){return Z},set:function(De){Z=De}});var Se=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Se},set:function(De){Se=De}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(De){De instanceof h&&(d=De)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(De){d.path=De}});var We=[];Object.defineProperty(this,"ctxStack",{get:function(){return We},set:function(De){We=De}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(De){var ve;ve=x(De),this.ctx.fillStyle=ve.style,this.ctx.isFillTransparent=ve.a===0,this.ctx.fillOpacity=ve.a,this.pdf.setFillColor(ve.r,ve.g,ve.b,{a:ve.a}),this.pdf.setTextColor(ve.r,ve.g,ve.b,{a:ve.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(De){var ve=x(De);this.ctx.strokeStyle=ve.style,this.ctx.isStrokeTransparent=ve.a===0,this.ctx.strokeOpacity=ve.a,ve.a===0?this.pdf.setDrawColor(255,255,255):(ve.a,this.pdf.setDrawColor(ve.r,ve.g,ve.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(De){["butt","round","square"].indexOf(De)!==-1&&(this.ctx.lineCap=De,this.pdf.setLineCap(De))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(De){isNaN(De)||(this.ctx.lineWidth=De,this.pdf.setLineWidth(De))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(De){["bevel","round","miter"].indexOf(De)!==-1&&(this.ctx.lineJoin=De,this.pdf.setLineJoin(De))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(De){isNaN(De)||(this.ctx.miterLimit=De,this.pdf.setMiterLimit(De))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(De){this.ctx.textBaseline=De}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(De){["right","end","center","left","start"].indexOf(De)!==-1&&(this.ctx.textAlign=De)}});var ue=null;function nt(De,ve){if(ue===null){var Xe=(function(Re){var Ke=[];return Object.keys(Re).forEach((function(it){Re[it].forEach((function(pt){var vt=null;switch(pt){case"bold":vt={family:it,weight:"bold"};break;case"italic":vt={family:it,style:"italic"};break;case"bolditalic":vt={family:it,weight:"bold",style:"italic"};break;case"":case"normal":vt={family:it}}vt!==null&&(vt.ref={name:it,style:pt},Ke.push(vt))}))})),Ke})(De.getFontList());ue=(function(Re){for(var Ke={},it=0;it<Re.length;++it){var pt=Q2(Re[it]),vt=pt.family,Pt=pt.stretch,Dt=pt.style,Ot=pt.weight;Ke[vt]=Ke[vt]||{},Ke[vt][Pt]=Ke[vt][Pt]||{},Ke[vt][Pt][Dt]=Ke[vt][Pt][Dt]||{},Ke[vt][Pt][Dt][Ot]=pt}return Ke})(Xe.concat(ve))}return ue}var rt=null;Object.defineProperty(this,"fontFaces",{get:function(){return rt},set:function(De){ue=null,rt=De}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(De){var ve;if(this.ctx.font=De,(ve=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(De))!==null){var Xe=ve[1];ve[2];var Re=ve[3],Ke=ve[4];ve[5];var it=ve[6],pt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ke)[2];Ke=Math.floor(pt==="px"?parseFloat(Ke)*this.pdf.internal.scaleFactor:pt==="em"?parseFloat(Ke)*this.pdf.getFontSize():parseFloat(Ke)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ke);var vt=(function(It){var bt,lt,tr=[],ke=It.trim();if(ke==="")return $1;if(ke in Vw)return[Vw[ke]];for(;ke!=="";){switch(lt=null,bt=(ke=Gw(ke)).charAt(0)){case'"':case"'":lt=LU(ke.substring(1),bt);break;default:lt=DU(ke)}if(lt===null||(tr.push(lt[0]),(ke=Gw(lt[1]))!==""&&ke.charAt(0)!==","))return $1;ke=ke.replace(/^,/,"")}return tr})(it);if(this.fontFaces){var Pt=PU(nt(this.pdf,this.fontFaces),vt.map((function(It){return{family:It,stretch:"normal",weight:Re,style:Xe}})));this.pdf.setFont(Pt.ref.name,Pt.ref.style)}else{var Dt="";(Re==="bold"||parseInt(Re,10)>=700||Xe==="bold")&&(Dt="bold"),Xe==="italic"&&(Dt+="italic"),Dt.length===0&&(Dt="normal");for(var Ot="",Yt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},lr=0;lr<vt.length;lr++){if(this.pdf.internal.getFont(vt[lr],Dt,{noFallback:!0,disableWarning:!0})!==void 0){Ot=vt[lr];break}if(Dt==="bolditalic"&&this.pdf.internal.getFont(vt[lr],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ot=vt[lr],Dt="bold";else if(this.pdf.internal.getFont(vt[lr],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ot=vt[lr],Dt="normal";break}}if(Ot===""){for(var Qt=0;Qt<vt.length;Qt++)if(Yt[vt[Qt]]){Ot=Yt[vt[Qt]];break}}Ot=Ot===""?"Times":Ot,this.pdf.setFont(Ot,Dt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(De){this.ctx.globalCompositeOperation=De}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(De){this.ctx.globalAlpha=De}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(De){this.ctx.lineDashOffset=De,K.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(De){this.ctx.lineDash=De,K.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(De){this.ctx.ignoreClearRect=!!De}})};p.prototype.setLineDash=function(E){this.lineDash=E},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){z.call(this,"fill",!1)},p.prototype.stroke=function(){z.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(E,W){if(isNaN(E)||isNaN(W))throw gn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var L=this.ctx.transform.applyToPoint(new i(E,W));this.path.push({type:"mt",x:L.x,y:L.y}),this.ctx.lastPoint=new i(E,W)},p.prototype.closePath=function(){var E=new i(0,0),W=0;for(W=this.path.length-1;W!==-1;W--)if(this.path[W].type==="begin"&&dn(this.path[W+1])==="object"&&typeof this.path[W+1].x=="number"){E=new i(this.path[W+1].x,this.path[W+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(E.x,E.y)},p.prototype.lineTo=function(E,W){if(isNaN(E)||isNaN(W))throw gn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var L=this.ctx.transform.applyToPoint(new i(E,W));this.path.push({type:"lt",x:L.x,y:L.y}),this.ctx.lastPoint=new i(L.x,L.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),z.call(this,null,!0)},p.prototype.quadraticCurveTo=function(E,W,L,F){if(isNaN(L)||isNaN(F)||isNaN(E)||isNaN(W))throw gn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var q=this.ctx.transform.applyToPoint(new i(L,F)),he=this.ctx.transform.applyToPoint(new i(E,W));this.path.push({type:"qct",x1:he.x,y1:he.y,x:q.x,y:q.y}),this.ctx.lastPoint=new i(q.x,q.y)},p.prototype.bezierCurveTo=function(E,W,L,F,q,he){if(isNaN(q)||isNaN(he)||isNaN(E)||isNaN(W)||isNaN(L)||isNaN(F))throw gn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var me=this.ctx.transform.applyToPoint(new i(q,he)),Z=this.ctx.transform.applyToPoint(new i(E,W)),Se=this.ctx.transform.applyToPoint(new i(L,F));this.path.push({type:"bct",x1:Z.x,y1:Z.y,x2:Se.x,y2:Se.y,x:me.x,y:me.y}),this.ctx.lastPoint=new i(me.x,me.y)},p.prototype.arc=function(E,W,L,F,q,he){if(isNaN(E)||isNaN(W)||isNaN(L)||isNaN(F)||isNaN(q))throw gn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(he=!!he,!this.ctx.transform.isIdentity){var me=this.ctx.transform.applyToPoint(new i(E,W));E=me.x,W=me.y;var Z=this.ctx.transform.applyToPoint(new i(0,L)),Se=this.ctx.transform.applyToPoint(new i(0,0));L=Math.sqrt(Math.pow(Z.x-Se.x,2)+Math.pow(Z.y-Se.y,2))}Math.abs(q-F)>=2*Math.PI&&(F=0,q=2*Math.PI),this.path.push({type:"arc",x:E,y:W,radius:L,startAngle:F,endAngle:q,counterclockwise:he})},p.prototype.arcTo=function(E,W,L,F,q){throw new Error("arcTo not implemented.")},p.prototype.rect=function(E,W,L,F){if(isNaN(E)||isNaN(W)||isNaN(L)||isNaN(F))throw gn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(E,W),this.lineTo(E+L,W),this.lineTo(E+L,W+F),this.lineTo(E,W+F),this.lineTo(E,W),this.lineTo(E+L,W),this.lineTo(E,W)},p.prototype.fillRect=function(E,W,L,F){if(isNaN(E)||isNaN(W)||isNaN(L)||isNaN(F))throw gn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var q={};this.lineCap!=="butt"&&(q.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(q.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(E,W,L,F),this.fill(),q.hasOwnProperty("lineCap")&&(this.lineCap=q.lineCap),q.hasOwnProperty("lineJoin")&&(this.lineJoin=q.lineJoin)}},p.prototype.strokeRect=function(E,W,L,F){if(isNaN(E)||isNaN(W)||isNaN(L)||isNaN(F))throw gn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");b.call(this)||(this.beginPath(),this.rect(E,W,L,F),this.stroke())},p.prototype.clearRect=function(E,W,L,F){if(isNaN(E)||isNaN(W)||isNaN(L)||isNaN(F))throw gn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(E,W,L,F))},p.prototype.save=function(E){E=typeof E!="boolean"||E;for(var W=this.pdf.internal.getCurrentPageInfo().pageNumber,L=0;L<this.pdf.internal.getNumberOfPages();L++)this.pdf.setPage(L+1),this.pdf.internal.out("q");if(this.pdf.setPage(W),E){this.ctx.fontSize=this.pdf.internal.getFontSize();var F=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=F}},p.prototype.restore=function(E){E=typeof E!="boolean"||E;for(var W=this.pdf.internal.getCurrentPageInfo().pageNumber,L=0;L<this.pdf.internal.getNumberOfPages();L++)this.pdf.setPage(L+1),this.pdf.internal.out("Q");this.pdf.setPage(W),E&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(E){var W,L,F,q;if(E.isCanvasGradient===!0&&(E=E.getColor()),!E)return{r:0,g:0,b:0,a:0,style:E};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(E))W=0,L=0,F=0,q=0;else{var he=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(E);if(he!==null)W=parseInt(he[1]),L=parseInt(he[2]),F=parseInt(he[3]),q=1;else if((he=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(E))!==null)W=parseInt(he[1]),L=parseInt(he[2]),F=parseInt(he[3]),q=parseFloat(he[4]);else{if(q=1,typeof E=="string"&&E.charAt(0)!=="#"){var me=new pk(E);E=me.ok?me.toHex():"#000000"}E.length===4?(W=E.substring(1,2),W+=W,L=E.substring(2,3),L+=L,F=E.substring(3,4),F+=F):(W=E.substring(1,3),L=E.substring(3,5),F=E.substring(5,7)),W=parseInt(W,16),L=parseInt(L,16),F=parseInt(F,16)}}return{r:W,g:L,b:F,a:q,style:E}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},b=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(E,W,L,F){if(isNaN(W)||isNaN(L)||typeof E!="string")throw gn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(F=isNaN(F)?void 0:F,!m.call(this)){var q=le(this.ctx.transform.rotation),he=this.ctx.transform.scaleX;P.call(this,{text:E,x:W,y:L,scale:he,angle:q,align:this.textAlign,maxWidth:F})}},p.prototype.strokeText=function(E,W,L,F){if(isNaN(W)||isNaN(L)||typeof E!="string")throw gn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!b.call(this)){F=isNaN(F)?void 0:F;var q=le(this.ctx.transform.rotation),he=this.ctx.transform.scaleX;P.call(this,{text:E,x:W,y:L,scale:he,renderingMode:"stroke",angle:q,align:this.textAlign,maxWidth:F})}},p.prototype.measureText=function(E){if(typeof E!="string")throw gn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var W=this.pdf,L=this.pdf.internal.scaleFactor,F=W.internal.getFontSize(),q=W.getStringUnitWidth(E)*F/W.internal.scaleFactor,he=function(me){var Z=(me=me||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Z}}),this};return new he({width:q*=Math.round(96*L/72*1e4)/1e4})},p.prototype.scale=function(E,W){if(isNaN(E)||isNaN(W))throw gn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var L=new c(E,0,0,W,0,0);this.ctx.transform=this.ctx.transform.multiply(L)},p.prototype.rotate=function(E){if(isNaN(E))throw gn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var W=new c(Math.cos(E),Math.sin(E),-Math.sin(E),Math.cos(E),0,0);this.ctx.transform=this.ctx.transform.multiply(W)},p.prototype.translate=function(E,W){if(isNaN(E)||isNaN(W))throw gn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var L=new c(1,0,0,1,E,W);this.ctx.transform=this.ctx.transform.multiply(L)},p.prototype.transform=function(E,W,L,F,q,he){if(isNaN(E)||isNaN(W)||isNaN(L)||isNaN(F)||isNaN(q)||isNaN(he))throw gn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var me=new c(E,W,L,F,q,he);this.ctx.transform=this.ctx.transform.multiply(me)},p.prototype.setTransform=function(E,W,L,F,q,he){E=isNaN(E)?1:E,W=isNaN(W)?0:W,L=isNaN(L)?0:L,F=isNaN(F)?1:F,q=isNaN(q)?0:q,he=isNaN(he)?0:he,this.ctx.transform=new c(E,W,L,F,q,he)};var y=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(E,W,L,F,q,he,me,Z,Se){var We=this.pdf.getImageProperties(E),ue=1,nt=1,rt=1,De=1;F!==void 0&&Z!==void 0&&(rt=Z/F,De=Se/q,ue=We.width/F*Z/F,nt=We.height/q*Se/q),he===void 0&&(he=W,me=L,W=0,L=0),F!==void 0&&Z===void 0&&(Z=F,Se=q),F===void 0&&Z===void 0&&(Z=We.width,Se=We.height);for(var ve,Xe=this.ctx.transform.decompose(),Re=le(Xe.rotate.shx),Ke=new c,it=(Ke=(Ke=(Ke=Ke.multiply(Xe.translate)).multiply(Xe.skew)).multiply(Xe.scale)).applyToRectangle(new l(he-W*rt,me-L*De,F*ue,q*nt)),pt=w.call(this,it),vt=[],Pt=0;Pt<pt.length;Pt+=1)vt.indexOf(pt[Pt])===-1&&vt.push(pt[Pt]);if(A(vt),this.autoPaging)for(var Dt=vt[0],Ot=vt[vt.length-1],Yt=Dt;Yt<Ot+1;Yt++){this.pdf.setPage(Yt);var lr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Qt=Yt===1?this.posY+this.margin[0]:this.margin[0],It=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],bt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],lt=Yt===1?0:It+(Yt-2)*bt;if(this.ctx.clip_path.length!==0){var tr=this.path;ve=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(ve,this.posX+this.margin[3],-lt+Qt+this.ctx.prevPageLastElemOffset),H.call(this,"fill",!0),this.path=tr}var ke=JSON.parse(JSON.stringify(it));ke=k([ke],this.posX+this.margin[3],-lt+Qt+this.ctx.prevPageLastElemOffset)[0];var $t=(Yt>Dt||Yt<Ot)&&y.call(this);$t&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],lr,bt,null).clip().discardPath()),this.pdf.addImage(E,"JPEG",ke.x,ke.y,ke.w,ke.h,null,null,Re),$t&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(E,"JPEG",it.x,it.y,it.w,it.h,null,null,Re)};var w=function(E,W,L){var F=[];W=W||this.pdf.internal.pageSize.width,L=L||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var q=this.posY+this.ctx.prevPageLastElemOffset;switch(E.type){default:case"mt":case"lt":F.push(Math.floor((E.y+q)/L)+1);break;case"arc":F.push(Math.floor((E.y+q-E.radius)/L)+1),F.push(Math.floor((E.y+q+E.radius)/L)+1);break;case"qct":var he=X(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x,E.y);F.push(Math.floor((he.y+q)/L)+1),F.push(Math.floor((he.y+he.h+q)/L)+1);break;case"bct":var me=fe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x2,E.y2,E.x,E.y);F.push(Math.floor((me.y+q)/L)+1),F.push(Math.floor((me.y+me.h+q)/L)+1);break;case"rect":F.push(Math.floor((E.y+q)/L)+1),F.push(Math.floor((E.y+E.h+q)/L)+1)}for(var Z=0;Z<F.length;Z+=1)for(;this.pdf.internal.getNumberOfPages()<F[Z];)S.call(this);return F},S=function(){var E=this.fillStyle,W=this.strokeStyle,L=this.font,F=this.lineCap,q=this.lineWidth,he=this.lineJoin;this.pdf.addPage(),this.fillStyle=E,this.strokeStyle=W,this.font=L,this.lineCap=F,this.lineWidth=q,this.lineJoin=he},k=function(E,W,L){for(var F=0;F<E.length;F++)switch(E[F].type){case"bct":E[F].x2+=W,E[F].y2+=L;case"qct":E[F].x1+=W,E[F].y1+=L;case"mt":case"lt":case"arc":default:E[F].x+=W,E[F].y+=L}return E},A=function(E){return E.sort((function(W,L){return W-L}))},z=function(E,W){for(var L,F,q=this.fillStyle,he=this.strokeStyle,me=this.lineCap,Z=this.lineWidth,Se=Math.abs(Z*this.ctx.transform.scaleX),We=this.lineJoin,ue=JSON.parse(JSON.stringify(this.path)),nt=JSON.parse(JSON.stringify(this.path)),rt=[],De=0;De<nt.length;De++)if(nt[De].x!==void 0)for(var ve=w.call(this,nt[De]),Xe=0;Xe<ve.length;Xe+=1)rt.indexOf(ve[Xe])===-1&&rt.push(ve[Xe]);for(var Re=0;Re<rt.length;Re++)for(;this.pdf.internal.getNumberOfPages()<rt[Re];)S.call(this);if(A(rt),this.autoPaging)for(var Ke=rt[0],it=rt[rt.length-1],pt=Ke;pt<it+1;pt++){this.pdf.setPage(pt),this.fillStyle=q,this.strokeStyle=he,this.lineCap=me,this.lineWidth=Se,this.lineJoin=We;var vt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Pt=pt===1?this.posY+this.margin[0]:this.margin[0],Dt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ot=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Yt=pt===1?0:Dt+(pt-2)*Ot;if(this.ctx.clip_path.length!==0){var lr=this.path;L=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(L,this.posX+this.margin[3],-Yt+Pt+this.ctx.prevPageLastElemOffset),H.call(this,E,!0),this.path=lr}if(F=JSON.parse(JSON.stringify(ue)),this.path=k(F,this.posX+this.margin[3],-Yt+Pt+this.ctx.prevPageLastElemOffset),W===!1||pt===0){var Qt=(pt>Ke||pt<it)&&y.call(this);Qt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],vt,Ot,null).clip().discardPath()),H.call(this,E,W),Qt&&this.pdf.restoreGraphicsState()}this.lineWidth=Z}else this.lineWidth=Se,H.call(this,E,W),this.lineWidth=Z;this.path=ue},H=function(E,W){if((E!=="stroke"||W||!b.call(this))&&(E==="stroke"||W||!m.call(this))){for(var L,F,q=[],he=this.path,me=0;me<he.length;me++){var Z=he[me];switch(Z.type){case"begin":q.push({begin:!0});break;case"close":q.push({close:!0});break;case"mt":q.push({start:Z,deltas:[],abs:[]});break;case"lt":var Se=q.length;if(he[me-1]&&!isNaN(he[me-1].x)&&(L=[Z.x-he[me-1].x,Z.y-he[me-1].y],Se>0)){for(;Se>=0;Se--)if(q[Se-1].close!==!0&&q[Se-1].begin!==!0){q[Se-1].deltas.push(L),q[Se-1].abs.push(Z);break}}break;case"bct":L=[Z.x1-he[me-1].x,Z.y1-he[me-1].y,Z.x2-he[me-1].x,Z.y2-he[me-1].y,Z.x-he[me-1].x,Z.y-he[me-1].y],q[q.length-1].deltas.push(L);break;case"qct":var We=he[me-1].x+2/3*(Z.x1-he[me-1].x),ue=he[me-1].y+2/3*(Z.y1-he[me-1].y),nt=Z.x+2/3*(Z.x1-Z.x),rt=Z.y+2/3*(Z.y1-Z.y),De=Z.x,ve=Z.y;L=[We-he[me-1].x,ue-he[me-1].y,nt-he[me-1].x,rt-he[me-1].y,De-he[me-1].x,ve-he[me-1].y],q[q.length-1].deltas.push(L);break;case"arc":q.push({deltas:[],abs:[],arc:!0}),Array.isArray(q[q.length-1].abs)&&q[q.length-1].abs.push(Z)}}F=W?null:E==="stroke"?"stroke":"fill";for(var Xe=!1,Re=0;Re<q.length;Re++)if(q[Re].arc)for(var Ke=q[Re].abs,it=0;it<Ke.length;it++){var pt=Ke[it];pt.type==="arc"?R.call(this,pt.x,pt.y,pt.radius,pt.startAngle,pt.endAngle,pt.counterclockwise,void 0,W,!Xe):ae.call(this,pt.x,pt.y),Xe=!0}else if(q[Re].close===!0)this.pdf.internal.out("h"),Xe=!1;else if(q[Re].begin!==!0){var vt=q[Re].start.x,Pt=q[Re].start.y;G.call(this,q[Re].deltas,vt,Pt),Xe=!0}F&&O.call(this,F),W&&ee.call(this)}},V=function(E){var W=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,L=W*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return E-L;case"top":return E+W-L;case"hanging":return E+W-2*L;case"middle":return E+W/2-L;case"ideographic":return E;case"alphabetic":default:return E}},B=function(E){return E+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var E=function(){};return E.colorStops=[],E.addColorStop=function(W,L){this.colorStops.push([W,L])},E.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},E.isCanvasGradient=!0,E},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var R=function(E,W,L,F,q,he,me,Z,Se){for(var We=te.call(this,L,F,q,he),ue=0;ue<We.length;ue++){var nt=We[ue];ue===0&&(Se?I.call(this,nt.x1+E,nt.y1+W):ae.call(this,nt.x1+E,nt.y1+W)),M.call(this,E,W,nt.x2,nt.y2,nt.x3,nt.y3,nt.x4,nt.y4)}Z?ee.call(this):O.call(this,me)},O=function(E){switch(E){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},ee=function(){this.pdf.clip(),this.pdf.discardPath()},I=function(E,W){this.pdf.internal.out(r(E)+" "+n(W)+" m")},P=function(E){var W;switch(E.align){case"right":case"end":W="right";break;case"center":W="center";break;case"left":case"start":default:W="left"}var L=this.pdf.getTextDimensions(E.text),F=V.call(this,E.y),q=B.call(this,F)-L.h,he=this.ctx.transform.applyToPoint(new i(E.x,F)),me=this.ctx.transform.decompose(),Z=new c;Z=(Z=(Z=Z.multiply(me.translate)).multiply(me.skew)).multiply(me.scale);for(var Se,We,ue,nt=this.ctx.transform.applyToRectangle(new l(E.x,F,L.w,L.h)),rt=Z.applyToRectangle(new l(E.x,q,L.w,L.h)),De=w.call(this,rt),ve=[],Xe=0;Xe<De.length;Xe+=1)ve.indexOf(De[Xe])===-1&&ve.push(De[Xe]);if(A(ve),this.autoPaging)for(var Re=ve[0],Ke=ve[ve.length-1],it=Re;it<Ke+1;it++){this.pdf.setPage(it);var pt=it===1?this.posY+this.margin[0]:this.margin[0],vt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Pt=this.pdf.internal.pageSize.height-this.margin[2],Dt=Pt-this.margin[0],Ot=this.pdf.internal.pageSize.width-this.margin[1],Yt=Ot-this.margin[3],lr=it===1?0:vt+(it-2)*Dt;if(this.ctx.clip_path.length!==0){var Qt=this.path;Se=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(Se,this.posX+this.margin[3],-1*lr+pt),H.call(this,"fill",!0),this.path=Qt}var It=k([JSON.parse(JSON.stringify(rt))],this.posX+this.margin[3],-lr+pt+this.ctx.prevPageLastElemOffset)[0];E.scale>=.01&&(We=this.pdf.internal.getFontSize(),this.pdf.setFontSize(We*E.scale),ue=this.lineWidth,this.lineWidth=ue*E.scale);var bt=this.autoPaging!=="text";if(bt||It.y+It.h<=Pt){if(bt||It.y>=pt&&It.x<=Ot){var lt=bt?E.text:this.pdf.splitTextToSize(E.text,E.maxWidth||Ot-It.x)[0],tr=k([JSON.parse(JSON.stringify(nt))],this.posX+this.margin[3],-lr+pt+this.ctx.prevPageLastElemOffset)[0],ke=bt&&(it>Re||it<Ke)&&y.call(this);ke&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Yt,Dt,null).clip().discardPath()),this.pdf.text(lt,tr.x,tr.y,{angle:E.angle,align:W,renderingMode:E.renderingMode}),ke&&this.pdf.restoreGraphicsState()}}else It.y<Pt&&(this.ctx.prevPageLastElemOffset+=Pt-It.y);E.scale>=.01&&(this.pdf.setFontSize(We),this.lineWidth=ue)}else E.scale>=.01&&(We=this.pdf.internal.getFontSize(),this.pdf.setFontSize(We*E.scale),ue=this.lineWidth,this.lineWidth=ue*E.scale),this.pdf.text(E.text,he.x+this.posX,he.y+this.posY,{angle:E.angle,align:W,renderingMode:E.renderingMode,maxWidth:E.maxWidth}),E.scale>=.01&&(this.pdf.setFontSize(We),this.lineWidth=ue)},ae=function(E,W,L,F){L=L||0,F=F||0,this.pdf.internal.out(r(E+L)+" "+n(W+F)+" l")},G=function(E,W,L){return this.pdf.lines(E,W,L,null,null)},M=function(E,W,L,F,q,he,me,Z){this.pdf.internal.out([e(s(L+E)),e(a(F+W)),e(s(q+E)),e(a(he+W)),e(s(me+E)),e(a(Z+W)),"c"].join(" "))},te=function(E,W,L,F){for(var q=2*Math.PI,he=Math.PI/2;W>L;)W-=q;var me=Math.abs(L-W);me<q&&F&&(me=q-me);for(var Z=[],Se=F?-1:1,We=W;me>1e-5;){var ue=We+Se*Math.min(me,he);Z.push(ie.call(this,E,We,ue)),me-=Math.abs(ue-We),We=ue}return Z},ie=function(E,W,L){var F=(L-W)/2,q=E*Math.cos(F),he=E*Math.sin(F),me=q,Z=-he,Se=me*me+Z*Z,We=Se+me*q+Z*he,ue=4/3*(Math.sqrt(2*Se*We)-We)/(me*he-Z*q),nt=me-ue*Z,rt=Z+ue*me,De=nt,ve=-rt,Xe=F+W,Re=Math.cos(Xe),Ke=Math.sin(Xe);return{x1:E*Math.cos(W),y1:E*Math.sin(W),x2:nt*Re-rt*Ke,y2:nt*Ke+rt*Re,x3:De*Re-ve*Ke,y3:De*Ke+ve*Re,x4:E*Math.cos(L),y4:E*Math.sin(L)}},le=function(E){return 180*E/Math.PI},X=function(E,W,L,F,q,he){var me=E+.5*(L-E),Z=W+.5*(F-W),Se=q+.5*(L-q),We=he+.5*(F-he),ue=Math.min(E,q,me,Se),nt=Math.max(E,q,me,Se),rt=Math.min(W,he,Z,We),De=Math.max(W,he,Z,We);return new l(ue,rt,nt-ue,De-rt)},fe=function(E,W,L,F,q,he,me,Z){var Se,We,ue,nt,rt,De,ve,Xe,Re,Ke,it,pt,vt,Pt,Dt=L-E,Ot=F-W,Yt=q-L,lr=he-F,Qt=me-q,It=Z-he;for(We=0;We<41;We++)Re=(ve=(ue=E+(Se=We/40)*Dt)+Se*((rt=L+Se*Yt)-ue))+Se*(rt+Se*(q+Se*Qt-rt)-ve),Ke=(Xe=(nt=W+Se*Ot)+Se*((De=F+Se*lr)-nt))+Se*(De+Se*(he+Se*It-De)-Xe),We==0?(it=Re,pt=Ke,vt=Re,Pt=Ke):(it=Math.min(it,Re),pt=Math.min(pt,Ke),vt=Math.max(vt,Re),Pt=Math.max(Pt,Ke));return new l(Math.round(it),Math.round(pt),Math.round(vt-it),Math.round(Pt-pt))},K=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var E,W,L=(E=this.ctx.lineDash,W=this.ctx.lineDashOffset,JSON.stringify({lineDash:E,lineDashOffset:W}));this.prevLineDash!==L&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=L)}}})(or.API),(function(t){var e=function(a){var i,l,c,d,h,p,x,m,b,y;for(l=[],c=0,d=(a+=i="\0\0\0\0".slice(a.length%4||4)).length;d>c;c+=4)(h=(a.charCodeAt(c)<<24)+(a.charCodeAt(c+1)<<16)+(a.charCodeAt(c+2)<<8)+a.charCodeAt(c+3))!==0?(p=(h=((h=((h=((h=(h-(y=h%85))/85)-(b=h%85))/85)-(m=h%85))/85)-(x=h%85))/85)%85,l.push(p+33,x+33,m+33,b+33,y+33)):l.push(122);return(function(w,S){for(var k=S;k>0;k--)w.pop()})(l,i.length),String.fromCharCode.apply(String,l)+"~>"},r=function(a){var i,l,c,d,h,p=String,x="length",m=255,b="charCodeAt",y="slice",w="replace";for(a[y](-2),a=a[y](0,-2)[w](/\s/g,"")[w]("z","!!!!!"),c=[],d=0,h=(a+=i="uuuuu"[y](a[x]%5||5))[x];h>d;d+=5)l=52200625*(a[b](d)-33)+614125*(a[b](d+1)-33)+7225*(a[b](d+2)-33)+85*(a[b](d+3)-33)+(a[b](d+4)-33),c.push(m&l>>24,m&l>>16,m&l>>8,m&l);return(function(S,k){for(var A=k;A>0;A--)S.pop()})(c,i[x]),p.fromCharCode.apply(p,c)},n=function(a){var i=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),i.test(a)===!1)return"";for(var l="",c=0;c<a.length;c+=2)l+=String.fromCharCode("0x"+(a[c]+a[c+1]));return l},s=function(a){for(var i=new Uint8Array(a.length),l=a.length;l--;)i[l]=a.charCodeAt(l);return a=(i=q2(i)).reduce((function(c,d){return c+String.fromCharCode(d)}),"")};t.processDataByFilters=function(a,i){var l=0,c=a||"",d=[];for(typeof(i=i||[])=="string"&&(i=[i]),l=0;l<i.length;l+=1)switch(i[l]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map((function(h){return("0"+h.charCodeAt().toString(16)).slice(-2)})).join("")+">",d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=s(c),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+i[l]+'" is not implemented')}return{data:c,reverseChain:d.reverse().join(" ")}}})(or.API),(function(t){t.loadFile=function(e,r,n){return(function(s,a,i){a=a!==!1,i=typeof i=="function"?i:function(){};var l=void 0;try{l=(function(c,d,h){var p=new XMLHttpRequest,x=0,m=function(b){var y=b.length,w=[],S=String.fromCharCode;for(x=0;x<y;x+=1)w.push(S(255&b.charCodeAt(x)));return w.join("")};if(p.open("GET",c,!d),p.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(p.onload=function(){p.status===200?h(m(this.responseText)):h(void 0)}),p.send(null),d&&p.status===200)return m(p.responseText)})(s,a,i)}catch{}return l})(e,r,n)},t.loadImageFile=t.loadFile})(or.API),(function(t){function e(){return(dr.html2canvas?Promise.resolve(dr.html2canvas):Vh(()=>import("./html2canvas.esm-B0tyYwQk.js"),[])).catch((function(i){return Promise.reject(new Error("Could not load html2canvas: "+i))})).then((function(i){return i.default?i.default:i}))}function r(){return(dr.DOMPurify?Promise.resolve(dr.DOMPurify):Vh(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch((function(i){return Promise.reject(new Error("Could not load dompurify: "+i))})).then((function(i){return i.default?i.default:i}))}var n=function(i){var l=dn(i);return l==="undefined"?"undefined":l==="string"||i instanceof String?"string":l==="number"||i instanceof Number?"number":l==="function"||i instanceof Function?"function":i&&i.constructor===Array?"array":i&&i.nodeType===1?"element":l==="object"?"object":"unknown"},s=function(i,l){var c=document.createElement(i);for(var d in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[d]=l.style[d];return c},a=function i(l){var c=Object.assign(i.convert(Promise.resolve()),JSON.parse(JSON.stringify(i.template))),d=i.convert(Promise.resolve(),c);return d=(d=d.setProgress(1,i,1,[i])).set(l)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(i,l){return i.__proto__=l||a.prototype,i},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(i,l){return this.then((function(){switch(l=l||(function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(i)){case"string":return this.then(r).then((function(c){return this.set({src:s("div",{innerHTML:i,dompurify:c})})}));case"element":return this.set({src:i});case"canvas":return this.set({canvas:i});case"img":return this.set({img:i});default:return this.error("Unknown source type.")}}))},a.prototype.to=function(i){switch(i){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then((function(){var i={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=(function c(d,h){for(var p=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),x=d.firstChild;x;x=x.nextSibling)h!==!0&&x.nodeType===1&&x.nodeName==="SCRIPT"||p.appendChild(c(x,h));return d.nodeType===1&&(d.nodeName==="CANVAS"?(p.width=d.width,p.height=d.height,p.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(p.value=d.value),p.addEventListener("load",(function(){p.scrollTop=d.scrollTop,p.scrollLeft=d.scrollLeft}),!0)),p})(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(i.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:i}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"}))},a.prototype.toCanvas=function(){var i=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(i).then(e).then((function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)})).then((function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)}))},a.prototype.toContext2d=function(){var i=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(i).then(e).then((function(l){var c=this.opt.jsPDF,d=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=d,d)for(var x=0;x<d.length;++x){var m=d[x],b=m.src.find((function(y){return y.format==="truetype"}));b&&c.addFont(b.url,m.ref.name,m.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,c.context2d.save(!0),l(this.prop.container,p)})).then((function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)}))},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then((function(){var i=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=i}))},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then((function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF}))},a.prototype.output=function(i,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(i,l):this.outputPdf(i,l)},a.prototype.outputPdf=function(i,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){return this.prop.pdf.output(i,l)}))},a.prototype.outputImg=function(i){return this.thenList([function(){return this.prop.img||this.toImg()}]).then((function(){switch(i){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+i+'" is not supported.'}}))},a.prototype.save=function(i){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(i?{filename:i}:null).then((function(){this.prop.pdf.save(this.opt.filename)}))},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){this.prop.callback(this.prop.pdf)}))},a.prototype.set=function(i){if(n(i)!=="object")return this;var l=Object.keys(i||{}).map((function(c){if(c in a.template.prop)return function(){this.prop[c]=i[c]};switch(c){case"margin":return this.setMargin.bind(this,i.margin);case"jsPDF":return function(){return this.opt.jsPDF=i.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,i.pageSize);default:return function(){this.opt[c]=i[c]}}}),this);return this.then((function(){return this.thenList(l)}))},a.prototype.get=function(i,l){return this.then((function(){var c=i in a.template.prop?this.prop[i]:this.opt[i];return l?l(c):c}))},a.prototype.setMargin=function(i){return this.then((function(){switch(n(i)){case"number":i=[i,i,i,i];case"array":if(i.length===2&&(i=[i[0],i[1],i[0],i[1]]),i.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=i})).then(this.setPageSize)},a.prototype.setPageSize=function(i){function l(c,d){return Math.floor(c*d/72*96)}return this.then((function(){(i=i||or.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(i.inner={width:i.width-this.opt.margin[1]-this.opt.margin[3],height:i.height-this.opt.margin[0]-this.opt.margin[2]},i.inner.px={width:l(i.inner.width,i.k),height:l(i.inner.height,i.k)},i.inner.ratio=i.inner.height/i.inner.width),this.prop.pageSize=i}))},a.prototype.setProgress=function(i,l,c,d){return i!=null&&(this.progress.val=i),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(i,l,c,d){return this.setProgress(i?this.progress.val+i:null,l||null,c?this.progress.n+c:null,d?this.progress.stack.concat(d):null)},a.prototype.then=function(i,l){var c=this;return this.thenCore(i,l,(function(d,h){return c.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,(function(p){return c.updateProgress(null,d),p})).then(d,h).then((function(p){return c.updateProgress(1),p}))}))},a.prototype.thenCore=function(i,l,c){c=c||Promise.prototype.then,i&&(i=i.bind(this)),l&&(l=l.bind(this));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:a.convert(Object.assign({},this),Promise.prototype),h=c.call(d,i,l);return a.convert(h,this.__proto__)},a.prototype.thenExternal=function(i,l){return Promise.prototype.then.call(this,i,l)},a.prototype.thenList=function(i){var l=this;return i.forEach((function(c){l=l.thenCore(c)})),l},a.prototype.catch=function(i){i&&(i=i.bind(this));var l=Promise.prototype.catch.call(this,i);return a.convert(l,this)},a.prototype.catchExternal=function(i){return Promise.prototype.catch.call(this,i)},a.prototype.error=function(i){return this.then((function(){throw new Error(i)}))},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,or.getPageSize=function(i,l,c){if(dn(i)==="object"){var d=i;i=d.orientation,l=d.unit||l,c=d.format||c}l=l||"mm",c=c||"a4",i=(""+(i||"P")).toLowerCase();var h,p=(""+c).toLowerCase(),x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+l}var m,b=0,y=0;if(x.hasOwnProperty(p))b=x[p][1]/h,y=x[p][0]/h;else try{b=c[1],y=c[0]}catch{throw new Error("Invalid format: "+c)}if(i==="p"||i==="portrait")i="p",y>b&&(m=y,y=b,b=m);else{if(i!=="l"&&i!=="landscape")throw"Invalid orientation: "+i;i="l",b>y&&(m=y,y=b,b=m)}return{width:y,height:b,unit:l,k:h,orientation:i}},t.html=function(i,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(Q2):null;var c=new a(l);return l.worker?c:c.from(i).doCallback()}})(or.API),or.API.addJS=function(t){return Yw=t,this.internal.events.subscribe("postPutResources",(function(){Pm=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Pm+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Xw=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Yw+")"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){Pm!==void 0&&Xw!==void 0&&this.internal.out("/Names <</JavaScript "+Pm+" 0 R>>")})),this},(function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),a=0;a<s.length;a++){var i=s[a],l=n.exec(i);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(i)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,h=[];for(a=0;a<d;a++){var p=r.internal.newObject();h.push(p);var x=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var m=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<h.length;a++)r.internal.write("(page_"+(a+1)+")"+h[a]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+m+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,a){var i={title:s,options:a,children:[]};return n==null&&(n=this.root),n.children.push(i),i},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var i=n.children[a];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var l=this.count=this.count_r({count:0},i);if(l>0&&this.line("/Count "+l),i.options&&i.options.pageNumber){var c=r.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var d=0;d<n.children.length;d++)this.renderItems(n.children[d])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var a=0;a<s.children.length;a++)n.count++,this.count_r(n,s.children[a]);return n.count}}])})(or.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,s,a,i,l){var c,d=this.decode.DCT_DECODE,h=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=i||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=(function(p){for(var x,m=256*p.charCodeAt(4)+p.charCodeAt(5),b=p.length,y={width:0,height:0,numcomponents:1},w=4;w<b;w+=2){if(w+=m,e.indexOf(p.charCodeAt(w+1))!==-1){x=256*p.charCodeAt(w+5)+p.charCodeAt(w+6),y={width:256*p.charCodeAt(w+7)+p.charCodeAt(w+8),height:x,numcomponents:p.charCodeAt(w+9)};break}m=256*p.charCodeAt(w+2)+p.charCodeAt(w+3)}return y})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}h={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:n,alias:s}}return h}})(or.API);var t0,Lm,Kw,Jw,Qw,RU=(function(){var t,e,r;function n(a){var i,l,c,d,h,p,x,m,b,y,w,S,k,A;for(this.data=a,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},p=null;;){switch(i=this.readUInt32(),b=(function(){var z,H;for(H=[],z=0;z<4;++z)H.push(String.fromCharCode(this.data[this.pos++]));return H}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(i);break;case"fcTL":p&&this.animation.frames.push(p),this.pos+=4,p={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},h=this.readUInt16(),d=this.readUInt16()||100,p.delay=1e3*h/d,p.disposeOp=this.data[this.pos++],p.blendOp=this.data[this.pos++],p.data=[];break;case"IDAT":case"fdAT":for(b==="fdAT"&&(this.pos+=4,i-=4),a=p?.data||this.imgData,S=0;0<=i?S<i:S>i;0<=i?++S:--S)a.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(i),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((y=c-this.transparency.indexed.length)>0)for(k=0;0<=y?k<y:k>y;0<=y?++k:--k)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(i)[0];break;case 2:this.transparency.rgb=this.read(i)}break;case"tEXt":x=(w=this.read(i)).indexOf(0),m=String.fromCharCode.apply(String,w.slice(0,x)),this.text[m]=String.fromCharCode.apply(String,w.slice(x+1));break;case"IEND":return p&&this.animation.frames.push(p),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(A=this.colorType)===4||A===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=i}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(a){var i,l;for(l=[],i=0;0<=a?i<a:i>a;0<=a?++i:--i)l.push(this.data[this.pos++]);return l},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(a){var i=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*i),c=0,d=this;if(a==null&&(a=this.imgData),a.length===0)return new Uint8Array(0);function h(p,x,m,b){var y,w,S,k,A,z,H,V,B,R,O,ee,I,P,ae,G,M,te,ie,le,X,fe=Math.ceil((d.width-p)/m),K=Math.ceil((d.height-x)/b),E=d.width==fe&&d.height==K;for(P=i*fe,ee=E?l:new Uint8Array(P*K),z=a.length,I=0,w=0;I<K&&c<z;){switch(a[c++]){case 0:for(k=M=0;M<P;k=M+=1)ee[w++]=a[c++];break;case 1:for(k=te=0;te<P;k=te+=1)y=a[c++],A=k<i?0:ee[w-i],ee[w++]=(y+A)%256;break;case 2:for(k=ie=0;ie<P;k=ie+=1)y=a[c++],S=(k-k%i)/i,ae=I&&ee[(I-1)*P+S*i+k%i],ee[w++]=(ae+y)%256;break;case 3:for(k=le=0;le<P;k=le+=1)y=a[c++],S=(k-k%i)/i,A=k<i?0:ee[w-i],ae=I&&ee[(I-1)*P+S*i+k%i],ee[w++]=(y+Math.floor((A+ae)/2))%256;break;case 4:for(k=X=0;X<P;k=X+=1)y=a[c++],S=(k-k%i)/i,A=k<i?0:ee[w-i],I===0?ae=G=0:(ae=ee[(I-1)*P+S*i+k%i],G=S&&ee[(I-1)*P+(S-1)*i+k%i]),H=A+ae-G,V=Math.abs(H-A),R=Math.abs(H-ae),O=Math.abs(H-G),B=V<=R&&V<=O?A:R<=O?ae:G,ee[w++]=(y+B)%256;break;default:throw new Error("Invalid filter algorithm: "+a[c-1])}if(!E){var W=((x+I*b)*d.width+p)*i,L=I*P;for(k=0;k<fe;k+=1){for(var F=0;F<i;F+=1)l[W++]=ee[L++];W+=(m-1)*i}}I++}}return a=hU(a),d.interlaceMethod==1?(h(0,0,8,8),h(4,0,8,8),h(0,4,4,8),h(2,0,4,4),h(0,2,2,4),h(1,0,2,2),h(0,1,1,2)):h(0,0,1,1),l},n.prototype.decodePalette=function(){var a,i,l,c,d,h,p,x,m;for(l=this.palette,h=this.transparency.indexed||[],d=new Uint8Array((h.length||0)+l.length),c=0,a=0,i=p=0,x=l.length;p<x;i=p+=3)d[c++]=l[i],d[c++]=l[i+1],d[c++]=l[i+2],d[c++]=(m=h[a++])!=null?m:255;return d},n.prototype.copyToImageData=function(a,i){var l,c,d,h,p,x,m,b,y,w,S;if(c=this.colors,y=null,l=this.hasAlphaChannel,this.palette.length&&(y=(S=this._decodedPalette)!=null?S:this._decodedPalette=this.decodePalette(),c=4,l=!0),b=(d=a.data||a).length,p=y||i,h=x=0,c===1)for(;h<b;)m=y?4*i[h/4]:x,w=p[m++],d[h++]=w,d[h++]=w,d[h++]=w,d[h++]=l?p[m++]:255,x=m;else for(;h<b;)m=y?4*i[h/4]:x,d[h++]=p[m++],d[h++]=p[m++],d[h++]=p[m++],d[h++]=l?p[m++]:255,x=m},n.prototype.decode=function(){var a;return a=new Uint8Array(this.width*this.height*4),this.copyToImageData(a,this.decodePixels()),a};var s=function(){if(Object.prototype.toString.call(dr)==="[object Window]"){try{e=dr.document.createElement("canvas"),r=e.getContext("2d")}catch{return!1}return!0}return!1};return s(),t=function(a){var i;if(s()===!0)return r.width=a.width,r.height=a.height,r.clearRect(0,0,a.width,a.height),r.putImageData(a,0,0),(i=new Image).src=e.toDataURL(),i;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(a){var i,l,c,d,h,p,x,m;if(this.animation){for(m=[],l=h=0,p=(x=this.animation.frames).length;h<p;l=++h)i=x[l],c=a.createImageData(i.width,i.height),d=this.decodePixels(new Uint8Array(i.data)),this.copyToImageData(c,d),i.imageData=c,m.push(i.image=t(c));return m}},n.prototype.renderFrame=function(a,i){var l,c,d;return l=(c=this.animation.frames)[i],d=c[i-1],i===0&&a.clearRect(0,0,this.width,this.height),d?.disposeOp===1?a.clearRect(d.xOffset,d.yOffset,d.width,d.height):d?.disposeOp===2&&a.putImageData(d.imageData,d.xOffset,d.yOffset),l.blendOp===0&&a.clearRect(l.xOffset,l.yOffset,l.width,l.height),a.drawImage(l.image,l.xOffset,l.yOffset)},n.prototype.animate=function(a){var i,l,c,d,h,p,x=this;return l=0,p=this.animation,d=p.numFrames,c=p.frames,h=p.numPlays,(i=function(){var m,b;if(m=l++%d,b=c[m],x.renderFrame(a,m),d>1&&l/d<h)return x.animation._timeout=setTimeout(i,b.delay)})()},n.prototype.stopAnimation=function(){var a;return clearTimeout((a=this.animation)!=null?a._timeout:void 0)},n.prototype.render=function(a){var i,l;return a._png&&a._png.stopAnimation(),a._png=this,a.width=this.width,a.height=this.height,i=a.getContext("2d"),this.animation?(this.decodeFrames(i),this.animate(i)):(l=i.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),i.putImageData(l,0,0))},n})();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function IU(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,s=t[e++],a=s>>7,i=1<<(7&s)+1;t[e++],t[e++];var l=null,c=null;a&&(l=e,c=i,e+=3*i);var d=!0,h=[],p=0,x=null,m=0,b=null;for(this.width=r,this.height=n;d&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,b=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((I=t[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var y=t[e++];p=t[e++]|t[e++]<<8,x=t[e++],(1&y)==0&&(x=null),m=y>>2&7,e++;break;case 254:for(;;){if(!((I=t[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var w=t[e++]|t[e++]<<8,S=t[e++]|t[e++]<<8,k=t[e++]|t[e++]<<8,A=t[e++]|t[e++]<<8,z=t[e++],H=z>>6&1,V=1<<(7&z)+1,B=l,R=c,O=!1;z>>7&&(O=!0,B=e,R=V,e+=3*V);var ee=e;for(e++;;){var I;if(!((I=t[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}h.push({x:w,y:S,width:k,height:A,has_local_palette:O,palette_offset:B,palette_size:R,data_offset:ee,data_length:e-ee,transparent_index:x,interlaced:!!H,delay:p,disposal:m});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return b},this.frameInfo=function(P){if(P<0||P>=h.length)throw new Error("Frame index out of range.");return h[P]},this.decodeAndBlitFrameBGRA=function(P,ae){var G=this.frameInfo(P),M=G.width*G.height,te=new Uint8Array(M);Zw(t,G.data_offset,te,M);var ie=G.palette_offset,le=G.transparent_index;le===null&&(le=256);var X=G.width,fe=r-X,K=X,E=4*(G.y*r+G.x),W=4*((G.y+G.height)*r+G.x),L=E,F=4*fe;G.interlaced===!0&&(F+=4*r*7);for(var q=8,he=0,me=te.length;he<me;++he){var Z=te[he];if(K===0&&(K=X,(L+=F)>=W&&(F=4*fe+4*r*(q-1),L=E+(X+fe)*(q<<1),q>>=1)),Z===le)L+=4;else{var Se=t[ie+3*Z],We=t[ie+3*Z+1],ue=t[ie+3*Z+2];ae[L++]=ue,ae[L++]=We,ae[L++]=Se,ae[L++]=255}--K}},this.decodeAndBlitFrameRGBA=function(P,ae){var G=this.frameInfo(P),M=G.width*G.height,te=new Uint8Array(M);Zw(t,G.data_offset,te,M);var ie=G.palette_offset,le=G.transparent_index;le===null&&(le=256);var X=G.width,fe=r-X,K=X,E=4*(G.y*r+G.x),W=4*((G.y+G.height)*r+G.x),L=E,F=4*fe;G.interlaced===!0&&(F+=4*r*7);for(var q=8,he=0,me=te.length;he<me;++he){var Z=te[he];if(K===0&&(K=X,(L+=F)>=W&&(F=4*fe+4*r*(q-1),L=E+(X+fe)*(q<<1),q>>=1)),Z===le)L+=4;else{var Se=t[ie+3*Z],We=t[ie+3*Z+1],ue=t[ie+3*Z+2];ae[L++]=Se,ae[L++]=We,ae[L++]=ue,ae[L++]=255}--K}}}function Zw(t,e,r,n){for(var s=t[e++],a=1<<s,i=a+1,l=i+1,c=s+1,d=(1<<c)-1,h=0,p=0,x=0,m=t[e++],b=new Int32Array(4096),y=null;;){for(;h<16&&m!==0;)p|=t[e++]<<h,h+=8,m===1?m=t[e++]:--m;if(h<c)break;var w=p&d;if(p>>=c,h-=c,w!==a){if(w===i)break;for(var S=w<l?w:y,k=0,A=S;A>a;)A=b[A]>>8,++k;var z=A;if(x+k+(S!==w?1:0)>n)return void gn.log("Warning, gif stream longer than expected.");r[x++]=z;var H=x+=k;for(S!==w&&(r[x++]=z),A=S;k--;)A=b[A],r[--H]=255&A,A>>=8;y!==null&&l<4096&&(b[l++]=y<<8|z,l>=d+1&&c<12&&(++c,d=d<<1|1)),y=w}else l=i+1,d=(1<<(c=s+1))-1,y=null}return x!==n&&gn.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function W1(t){var e,r,n,s,a,i=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),h=new Array(64),p=new Array(65535),x=new Array(65535),m=new Array(64),b=new Array(64),y=[],w=0,S=7,k=new Array(64),A=new Array(64),z=new Array(64),H=new Array(256),V=new Array(2048),B=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],R=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],O=[0,1,2,3,4,5,6,7,8,9,10,11],ee=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],I=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],ae=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],M=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function te(E,W){for(var L=0,F=0,q=new Array,he=1;he<=16;he++){for(var me=1;me<=E[he];me++)q[W[F]]=[],q[W[F]][0]=L,q[W[F]][1]=he,F++,L++;L*=2}return q}function ie(E){for(var W=E[0],L=E[1]-1;L>=0;)W&1<<L&&(w|=1<<S),L--,--S<0&&(w==255?(le(255),le(0)):le(w),S=7,w=0)}function le(E){y.push(E)}function X(E){le(E>>8&255),le(255&E)}function fe(E,W,L,F,q){for(var he,me=q[0],Z=q[240],Se=(function(Ke,it){var pt,vt,Pt,Dt,Ot,Yt,lr,Qt,It,bt,lt=0;for(It=0;It<8;++It){pt=Ke[lt],vt=Ke[lt+1],Pt=Ke[lt+2],Dt=Ke[lt+3],Ot=Ke[lt+4],Yt=Ke[lt+5],lr=Ke[lt+6];var tr=pt+(Qt=Ke[lt+7]),ke=pt-Qt,$t=vt+lr,$e=vt-lr,wt=Pt+Yt,Wt=Pt-Yt,jt=Dt+Ot,hr=Dt-Ot,Vt=tr+jt,Sr=tr-jt,Ur=$t+wt,rr=$t-wt;Ke[lt]=Vt+Ur,Ke[lt+4]=Vt-Ur;var Ut=.707106781*(rr+Sr);Ke[lt+2]=Sr+Ut,Ke[lt+6]=Sr-Ut;var cr=.382683433*((Vt=hr+Wt)-(rr=$e+ke)),Te=.5411961*Vt+cr,yt=1.306562965*rr+cr,pr=.707106781*(Ur=Wt+$e),hn=ke+pr,Mt=ke-pr;Ke[lt+5]=Mt+Te,Ke[lt+3]=Mt-Te,Ke[lt+1]=hn+yt,Ke[lt+7]=hn-yt,lt+=8}for(lt=0,It=0;It<8;++It){pt=Ke[lt],vt=Ke[lt+8],Pt=Ke[lt+16],Dt=Ke[lt+24],Ot=Ke[lt+32],Yt=Ke[lt+40],lr=Ke[lt+48];var Un=pt+(Qt=Ke[lt+56]),yn=pt-Qt,zn=vt+lr,pn=vt-lr,mn=Pt+Yt,se=Pt-Yt,ye=Dt+Ot,pe=Dt-Ot,xe=Un+ye,be=Un-ye,we=zn+mn,Ue=zn-mn;Ke[lt]=xe+we,Ke[lt+32]=xe-we;var Je=.707106781*(Ue+be);Ke[lt+16]=be+Je,Ke[lt+48]=be-Je;var Be=.382683433*((xe=pe+se)-(Ue=pn+yn)),He=.5411961*xe+Be,qe=1.306562965*Ue+Be,ut=.707106781*(we=se+pn),Nt=yn+ut,Ct=yn-ut;Ke[lt+40]=Ct+He,Ke[lt+24]=Ct-He,Ke[lt+8]=Nt+qe,Ke[lt+56]=Nt-qe,lt++}for(It=0;It<64;++It)bt=Ke[It]*it[It],m[It]=bt>0?bt+.5|0:bt-.5|0;return m})(E,W),We=0;We<64;++We)b[B[We]]=Se[We];var ue=b[0]-L;L=b[0],ue==0?ie(F[0]):(ie(F[x[he=32767+ue]]),ie(p[he]));for(var nt=63;nt>0&&b[nt]==0;)nt--;if(nt==0)return ie(me),L;for(var rt,De=1;De<=nt;){for(var ve=De;b[De]==0&&De<=nt;)++De;var Xe=De-ve;if(Xe>=16){rt=Xe>>4;for(var Re=1;Re<=rt;++Re)ie(Z);Xe&=15}he=32767+b[De],ie(q[(Xe<<4)+x[he]]),ie(p[he]),De++}return nt!=63&&ie(me),L}function K(E){E=Math.min(Math.max(E,1),100),a!=E&&((function(W){for(var L=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],F=0;F<64;F++){var q=i((L[F]*W+50)/100);q=Math.min(Math.max(q,1),255),l[B[F]]=q}for(var he=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],me=0;me<64;me++){var Z=i((he[me]*W+50)/100);Z=Math.min(Math.max(Z,1),255),c[B[me]]=Z}for(var Se=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],We=0,ue=0;ue<8;ue++)for(var nt=0;nt<8;nt++)d[We]=1/(l[B[We]]*Se[ue]*Se[nt]*8),h[We]=1/(c[B[We]]*Se[ue]*Se[nt]*8),We++})(E<50?Math.floor(5e3/E):Math.floor(200-2*E)),a=E)}this.encode=function(E,W){W&&K(W),y=new Array,w=0,S=7,X(65496),X(65504),X(16),le(74),le(70),le(73),le(70),le(0),le(1),le(1),le(0),X(1),X(1),le(0),le(0),(function(){X(65499),X(132),le(0);for(var vt=0;vt<64;vt++)le(l[vt]);le(1);for(var Pt=0;Pt<64;Pt++)le(c[Pt])})(),(function(vt,Pt){X(65472),X(17),le(8),X(Pt),X(vt),le(3),le(1),le(17),le(0),le(2),le(17),le(1),le(3),le(17),le(1)})(E.width,E.height),(function(){X(65476),X(418),le(0);for(var vt=0;vt<16;vt++)le(R[vt+1]);for(var Pt=0;Pt<=11;Pt++)le(O[Pt]);le(16);for(var Dt=0;Dt<16;Dt++)le(ee[Dt+1]);for(var Ot=0;Ot<=161;Ot++)le(I[Ot]);le(1);for(var Yt=0;Yt<16;Yt++)le(P[Yt+1]);for(var lr=0;lr<=11;lr++)le(ae[lr]);le(17);for(var Qt=0;Qt<16;Qt++)le(G[Qt+1]);for(var It=0;It<=161;It++)le(M[It])})(),X(65498),X(12),le(3),le(1),le(0),le(2),le(17),le(3),le(17),le(0),le(63),le(0);var L=0,F=0,q=0;w=0,S=7,this.encode.displayName="_encode_";for(var he,me,Z,Se,We,ue,nt,rt,De,ve=E.data,Xe=E.width,Re=E.height,Ke=4*Xe,it=0;it<Re;){for(he=0;he<Ke;){for(We=Ke*it+he,nt=-1,rt=0,De=0;De<64;De++)ue=We+(rt=De>>3)*Ke+(nt=4*(7&De)),it+rt>=Re&&(ue-=Ke*(it+1+rt-Re)),he+nt>=Ke&&(ue-=he+nt-Ke+4),me=ve[ue++],Z=ve[ue++],Se=ve[ue++],k[De]=(V[me]+V[Z+256>>0]+V[Se+512>>0]>>16)-128,A[De]=(V[me+768>>0]+V[Z+1024>>0]+V[Se+1280>>0]>>16)-128,z[De]=(V[me+1280>>0]+V[Z+1536>>0]+V[Se+1792>>0]>>16)-128;L=fe(k,d,L,e,n),F=fe(A,h,F,r,s),q=fe(z,h,q,r,s),he+=32}it+=8}if(S>=0){var pt=[];pt[1]=S+1,pt[0]=(1<<S+1)-1,ie(pt)}return X(65497),new Uint8Array(y)},t=t||50,(function(){for(var E=String.fromCharCode,W=0;W<256;W++)H[W]=E(W)})(),e=te(R,O),r=te(P,ae),n=te(ee,I),s=te(G,M),(function(){for(var E=1,W=2,L=1;L<=15;L++){for(var F=E;F<W;F++)x[32767+F]=L,p[32767+F]=[],p[32767+F][1]=L,p[32767+F][0]=F;for(var q=-(W-1);q<=-E;q++)x[32767+q]=L,p[32767+q]=[],p[32767+q][1]=L,p[32767+q][0]=W-1+q;E<<=1,W<<=1}})(),(function(){for(var E=0;E<256;E++)V[E]=19595*E,V[E+256>>0]=38470*E,V[E+512>>0]=7471*E+32768,V[E+768>>0]=-11059*E,V[E+1024>>0]=-21709*E,V[E+1280>>0]=32768*E+8421375,V[E+1536>>0]=-27439*E,V[E+1792>>0]=-5329*E})(),K(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function zo(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function e_(t){function e(R){if(!R)throw Error("assert :P")}function r(R,O,ee){for(var I=0;4>I;I++)if(R[O+I]!=ee.charCodeAt(I))return!0;return!1}function n(R,O,ee,I,P){for(var ae=0;ae<P;ae++)R[O+ae]=ee[I+ae]}function s(R,O,ee,I){for(var P=0;P<I;P++)R[O+P]=ee}function a(R){return new Int32Array(R)}function i(R,O){for(var ee=[],I=0;I<R;I++)ee.push(new O);return ee}function l(R,O){var ee=[];return(function I(P,ae,G){for(var M=G[ae],te=0;te<M&&(P.push(G.length>ae+1?[]:new O),!(G.length<ae+1));te++)I(P[te],ae+1,G)})(ee,0,R),ee}var c=function(){var R=this;function O(v,N){for(var T=1<<N-1>>>0;v&T;)T>>>=1;return T?(v&T-1)+T:v}function ee(v,N,T,U,Y){e(!(U%T));do v[N+(U-=T)]=Y;while(0<U)}function I(v,N,T,U,Y){if(e(2328>=Y),512>=Y)var re=a(512);else if((re=a(Y))==null)return 0;return(function(oe,ce,de,ge,Ee,Oe){var Me,Le,ot=ce,Ye=1<<de,Ce=a(16),Fe=a(16);for(e(Ee!=0),e(ge!=null),e(oe!=null),e(0<de),Le=0;Le<Ee;++Le){if(15<ge[Le])return 0;++Ce[ge[Le]]}if(Ce[0]==Ee)return 0;for(Fe[1]=0,Me=1;15>Me;++Me){if(Ce[Me]>1<<Me)return 0;Fe[Me+1]=Fe[Me]+Ce[Me]}for(Le=0;Le<Ee;++Le)Me=ge[Le],0<ge[Le]&&(Oe[Fe[Me]++]=Le);if(Fe[15]==1)return(ge=new P).g=0,ge.value=Oe[0],ee(oe,ot,1,Ye,ge),Ye;var tt,et=-1,at=Ye-1,Lt=0,Et=1,Zt=1,At=1<<de;for(Le=0,Me=1,Ee=2;Me<=de;++Me,Ee<<=1){if(Et+=Zt<<=1,0>(Zt-=Ce[Me]))return 0;for(;0<Ce[Me];--Ce[Me])(ge=new P).g=Me,ge.value=Oe[Le++],ee(oe,ot+Lt,Ee,At,ge),Lt=O(Lt,Me)}for(Me=de+1,Ee=2;15>=Me;++Me,Ee<<=1){if(Et+=Zt<<=1,0>(Zt-=Ce[Me]))return 0;for(;0<Ce[Me];--Ce[Me]){if(ge=new P,(Lt&at)!=et){for(ot+=At,tt=1<<(et=Me)-de;15>et&&!(0>=(tt-=Ce[et]));)++et,tt<<=1;Ye+=At=1<<(tt=et-de),oe[ce+(et=Lt&at)].g=tt+de,oe[ce+et].value=ot-ce-et}ge.g=Me-de,ge.value=Oe[Le++],ee(oe,ot+(Lt>>de),Ee,At,ge),Lt=O(Lt,Me)}}return Et!=2*Fe[15]-1?0:Ye})(v,N,T,U,Y,re)}function P(){this.value=this.g=0}function ae(){this.value=this.g=0}function G(){this.G=i(5,P),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(In,ae)}function M(v,N,T,U){e(v!=null),e(N!=null),e(2147483648>U),v.Ca=254,v.I=0,v.b=-8,v.Ka=0,v.oa=N,v.pa=T,v.Jd=N,v.Yc=T+U,v.Zc=4<=U?T+U-4+1:T,he(v)}function te(v,N){for(var T=0;0<N--;)T|=Z(v,128)<<N;return T}function ie(v,N){var T=te(v,N);return me(v)?-T:T}function le(v,N,T,U){var Y,re=0;for(e(v!=null),e(N!=null),e(4294967288>U),v.Sb=U,v.Ra=0,v.u=0,v.h=0,4<U&&(U=4),Y=0;Y<U;++Y)re+=N[T+Y]<<8*Y;v.Ra=re,v.bb=U,v.oa=N,v.pa=T}function X(v){for(;8<=v.u&&v.bb<v.Sb;)v.Ra>>>=8,v.Ra+=v.oa[v.pa+v.bb]<<su-8>>>0,++v.bb,v.u-=8;L(v)&&(v.h=1,v.u=0)}function fe(v,N){if(e(0<=N),!v.h&&N<=nu){var T=W(v)&ru[N];return v.u+=N,X(v),T}return v.h=1,v.u=0}function K(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function E(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function W(v){return v.Ra>>>(v.u&su-1)>>>0}function L(v){return e(v.bb<=v.Sb),v.h||v.bb==v.Sb&&v.u>su}function F(v,N){v.u=N,v.h=L(v)}function q(v){v.u>=au&&(e(v.u>=au),X(v))}function he(v){e(v!=null&&v.oa!=null),v.pa<v.Zc?(v.I=(v.oa[v.pa++]|v.I<<8)>>>0,v.b+=8):(e(v!=null&&v.oa!=null),v.pa<v.Yc?(v.b+=8,v.I=v.oa[v.pa++]|v.I<<8):v.Ka?v.b=0:(v.I<<=8,v.b+=8,v.Ka=1))}function me(v){return te(v,1)}function Z(v,N){var T=v.Ca;0>v.b&&he(v);var U=v.b,Y=T*N>>>8,re=(v.I>>>U>Y)+0;for(re?(T-=Y,v.I-=Y+1<<U>>>0):T=Y+1,U=T,Y=0;256<=U;)Y+=8,U>>=8;return U=7^Y+Xs[U],v.b-=U,v.Ca=(T<<U)-1,re}function Se(v,N,T){v[N+0]=T>>24&255,v[N+1]=T>>16&255,v[N+2]=T>>8&255,v[N+3]=T>>0&255}function We(v,N){return v[N+0]<<0|v[N+1]<<8}function ue(v,N){return We(v,N)|v[N+2]<<16}function nt(v,N){return We(v,N)|We(v,N+2)<<16}function rt(v,N){var T=1<<N;return e(v!=null),e(0<N),v.X=a(T),v.X==null?0:(v.Mb=32-N,v.Xa=N,1)}function De(v,N){e(v!=null),e(N!=null),e(v.Xa==N.Xa),n(N.X,0,v.X,0,1<<N.Xa)}function ve(){this.X=[],this.Xa=this.Mb=0}function Xe(v,N,T,U){e(T!=null),e(U!=null);var Y=T[0],re=U[0];return Y==0&&(Y=(v*re+N/2)/N),re==0&&(re=(N*Y+v/2)/v),0>=Y||0>=re?0:(T[0]=Y,U[0]=re,1)}function Re(v,N){return v+(1<<N)-1>>>N}function Ke(v,N){return((4278255360&v)+(4278255360&N)>>>0&4278255360)+((16711935&v)+(16711935&N)>>>0&16711935)>>>0}function it(v,N){R[N]=function(T,U,Y,re,oe,ce,de){var ge;for(ge=0;ge<oe;++ge){var Ee=R[v](ce[de+ge-1],Y,re+ge);ce[de+ge]=Ke(T[U+ge],Ee)}}}function pt(){this.ud=this.hd=this.jd=0}function vt(v,N){return((4278124286&(v^N))>>>1)+(v&N)>>>0}function Pt(v){return 0<=v&&256>v?v:0>v?0:255<v?255:void 0}function Dt(v,N){return Pt(v+(v-N+.5>>1))}function Ot(v,N,T){return Math.abs(N-T)-Math.abs(v-T)}function Yt(v,N,T,U,Y,re,oe){for(U=re[oe-1],T=0;T<Y;++T)re[oe+T]=U=Ke(v[N+T],U)}function lr(v,N,T,U,Y){var re;for(re=0;re<T;++re){var oe=v[N+re],ce=oe>>8&255,de=16711935&(de=(de=16711935&oe)+((ce<<16)+ce));U[Y+re]=(4278255360&oe)+de>>>0}}function Qt(v,N){N.jd=v>>0&255,N.hd=v>>8&255,N.ud=v>>16&255}function It(v,N,T,U,Y,re){var oe;for(oe=0;oe<U;++oe){var ce=N[T+oe],de=ce>>>8,ge=ce,Ee=255&(Ee=(Ee=ce>>>16)+((v.jd<<24>>24)*(de<<24>>24)>>>5));ge=255&(ge=(ge=ge+((v.hd<<24>>24)*(de<<24>>24)>>>5))+((v.ud<<24>>24)*(Ee<<24>>24)>>>5)),Y[re+oe]=(4278255360&ce)+(Ee<<16)+ge}}function bt(v,N,T,U,Y){R[N]=function(re,oe,ce,de,ge,Ee,Oe,Me,Le){for(de=Oe;de<Me;++de)for(Oe=0;Oe<Le;++Oe)ge[Ee++]=Y(ce[U(re[oe++])])},R[v]=function(re,oe,ce,de,ge,Ee,Oe){var Me=8>>re.b,Le=re.Ea,ot=re.K[0],Ye=re.w;if(8>Me)for(re=(1<<re.b)-1,Ye=(1<<Me)-1;oe<ce;++oe){var Ce,Fe=0;for(Ce=0;Ce<Le;++Ce)Ce&re||(Fe=U(de[ge++])),Ee[Oe++]=Y(ot[Fe&Ye]),Fe>>=Me}else R["VP8LMapColor"+T](de,ge,ot,Ye,Ee,Oe,oe,ce,Le)}}function lt(v,N,T,U,Y){for(T=N+T;N<T;){var re=v[N++];U[Y++]=re>>16&255,U[Y++]=re>>8&255,U[Y++]=re>>0&255}}function tr(v,N,T,U,Y){for(T=N+T;N<T;){var re=v[N++];U[Y++]=re>>16&255,U[Y++]=re>>8&255,U[Y++]=re>>0&255,U[Y++]=re>>24&255}}function ke(v,N,T,U,Y){for(T=N+T;N<T;){var re=(oe=v[N++])>>16&240|oe>>12&15,oe=oe>>0&240|oe>>28&15;U[Y++]=re,U[Y++]=oe}}function $t(v,N,T,U,Y){for(T=N+T;N<T;){var re=(oe=v[N++])>>16&248|oe>>13&7,oe=oe>>5&224|oe>>3&31;U[Y++]=re,U[Y++]=oe}}function $e(v,N,T,U,Y){for(T=N+T;N<T;){var re=v[N++];U[Y++]=re>>0&255,U[Y++]=re>>8&255,U[Y++]=re>>16&255}}function wt(v,N,T,U,Y,re){if(re==0)for(T=N+T;N<T;)Se(U,((re=v[N++])[0]>>24|re[1]>>8&65280|re[2]<<8&16711680|re[3]<<24)>>>0),Y+=32;else n(U,Y,v,N,T)}function Wt(v,N){R[N][0]=R[v+"0"],R[N][1]=R[v+"1"],R[N][2]=R[v+"2"],R[N][3]=R[v+"3"],R[N][4]=R[v+"4"],R[N][5]=R[v+"5"],R[N][6]=R[v+"6"],R[N][7]=R[v+"7"],R[N][8]=R[v+"8"],R[N][9]=R[v+"9"],R[N][10]=R[v+"10"],R[N][11]=R[v+"11"],R[N][12]=R[v+"12"],R[N][13]=R[v+"13"],R[N][14]=R[v+"0"],R[N][15]=R[v+"0"]}function jt(v){return v==du||v==sc||v==Nd||v==Sd}function hr(){this.eb=[],this.size=this.A=this.fb=0}function Vt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Sr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new hr,this.f.kb=new Vt,this.sd=null}function Ur(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function rr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ut(v){return alert("todo:WebPSamplerProcessPlane"),v.T}function cr(v,N){var T=v.T,U=N.ba.f.RGBA,Y=U.eb,re=U.fb+v.ka*U.A,oe=fa[N.ba.S],ce=v.y,de=v.O,ge=v.f,Ee=v.N,Oe=v.ea,Me=v.W,Le=N.cc,ot=N.dc,Ye=N.Mc,Ce=N.Nc,Fe=v.ka,tt=v.ka+v.T,et=v.U,at=et+1>>1;for(Fe==0?oe(ce,de,null,null,ge,Ee,Oe,Me,ge,Ee,Oe,Me,Y,re,null,null,et):(oe(N.ec,N.fc,ce,de,Le,ot,Ye,Ce,ge,Ee,Oe,Me,Y,re-U.A,Y,re,et),++T);Fe+2<tt;Fe+=2)Le=ge,ot=Ee,Ye=Oe,Ce=Me,Ee+=v.Rc,Me+=v.Rc,re+=2*U.A,oe(ce,(de+=2*v.fa)-v.fa,ce,de,Le,ot,Ye,Ce,ge,Ee,Oe,Me,Y,re-U.A,Y,re,et);return de+=v.fa,v.j+tt<v.o?(n(N.ec,N.fc,ce,de,et),n(N.cc,N.dc,ge,Ee,at),n(N.Mc,N.Nc,Oe,Me,at),T--):1&tt||oe(ce,de,null,null,ge,Ee,Oe,Me,ge,Ee,Oe,Me,Y,re+U.A,null,null,et),T}function Te(v,N,T){var U=v.F,Y=[v.J];if(U!=null){var re=v.U,oe=N.ba.S,ce=oe==_d||oe==Nd;N=N.ba.f.RGBA;var de=[0],ge=v.ka;de[0]=v.T,v.Kb&&(ge==0?--de[0]:(--ge,Y[0]-=v.width),v.j+v.ka+v.T==v.o&&(de[0]=v.o-v.j-ge));var Ee=N.eb;ge=N.fb+ge*N.A,v=Zr(U,Y[0],v.width,re,de,Ee,ge+(ce?0:3),N.A),e(T==de),v&&jt(oe)&&ua(Ee,ge,ce,re,de,N.A)}return 0}function yt(v){var N=v.ma,T=N.ba.S,U=11>T,Y=T==pl||T==wd||T==_d||T==an||T==12||jt(T);if(N.memory=null,N.Ib=null,N.Jb=null,N.Nd=null,!eu(N.Oa,v,Y?11:12))return 0;if(Y&&jt(T)&&dt(),v.da)alert("todo:use_scaling");else{if(U){if(N.Ib=Ut,v.Kb){if(T=v.U+1>>1,N.memory=a(v.U+2*T),N.memory==null)return 0;N.ec=N.memory,N.fc=0,N.cc=N.ec,N.dc=N.fc+v.U,N.Mc=N.cc,N.Nc=N.dc+T,N.Ib=cr,dt()}}else alert("todo:EmitYUV");Y&&(N.Jb=Te,U&&Ie())}if(U&&!js){for(v=0;256>v;++v)ha[v]=89858*(v-128)+Si>>Ao,pa[v]=-22014*(v-128)+Si,mu[v]=-45773*(v-128),lc[v]=113618*(v-128)+Si>>Ao;for(v=en;v<rn;++v)N=76283*(v-16)+Si>>Ao,Df[v-en]=Ba(N,255),zp[v-en]=Ba(N+8>>4,15);js=1}return 1}function pr(v){var N=v.ma,T=v.U,U=v.T;return e(!(1&v.ka)),0>=T||0>=U?0:(T=N.Ib(v,N),N.Jb!=null&&N.Jb(v,N,T),N.Dc+=T,1)}function hn(v){v.ma.memory=null}function Mt(v,N,T,U){return fe(v,8)!=47?0:(N[0]=fe(v,14)+1,T[0]=fe(v,14)+1,U[0]=fe(v,1),fe(v,3)!=0?0:!v.h)}function Un(v,N){if(4>v)return v+1;var T=v-2>>1;return(2+(1&v)<<T)+fe(N,T)+1}function yn(v,N){return 120<N?N-120:1<=(T=((T=Sg[N-1])>>4)*v+(8-(15&T)))?T:1;var T}function zn(v,N,T){var U=W(T),Y=v[N+=255&U].g-8;return 0<Y&&(F(T,T.u+8),U=W(T),N+=v[N].value,N+=U&(1<<Y)-1),F(T,T.u+v[N].g),v[N].value}function pn(v,N,T){return T.g+=v.g,T.value+=v.value<<N>>>0,e(8>=T.g),v.g}function mn(v,N,T){var U=v.xc;return e((N=U==0?0:v.vc[v.md*(T>>U)+(N>>U)])<v.Wb),v.Ya[N]}function se(v,N,T,U){var Y=v.ab,re=v.c*N,oe=v.C;N=oe+N;var ce=T,de=U;for(U=v.Ta,T=v.Ua;0<Y--;){var ge=v.gc[Y],Ee=oe,Oe=N,Me=ce,Le=de,ot=(de=U,ce=T,ge.Ea);switch(e(Ee<Oe),e(Oe<=ge.nc),ge.hc){case 2:Cf(Me,Le,(Oe-Ee)*ot,de,ce);break;case 0:var Ye=Ee,Ce=Oe,Fe=de,tt=ce,et=(At=ge).Ea;Ye==0&&(Ql(Me,Le,null,null,1,Fe,tt),Yt(Me,Le+1,0,0,et-1,Fe,tt+1),Le+=et,tt+=et,++Ye);for(var at=1<<At.b,Lt=at-1,Et=Re(et,At.b),Zt=At.K,At=At.w+(Ye>>At.b)*Et;Ye<Ce;){var Or=Zt,Mr=At,Pr=1;for(bo(Me,Le,Fe,tt-et,1,Fe,tt);Pr<et;){var wr=(Pr&~Lt)+at;wr>et&&(wr=et),(0,Vi[Or[Mr++]>>8&15])(Me,Le+ +Pr,Fe,tt+Pr-et,wr-Pr,Fe,tt+Pr),Pr=wr}Le+=et,tt+=et,++Ye&Lt||(At+=Et)}Oe!=ge.nc&&n(de,ce-ot,de,ce+(Oe-Ee-1)*ot,ot);break;case 1:for(ot=Me,Ce=Le,et=(Me=ge.Ea)-(tt=Me&~(Fe=(Le=1<<ge.b)-1)),Ye=Re(Me,ge.b),at=ge.K,ge=ge.w+(Ee>>ge.b)*Ye;Ee<Oe;){for(Lt=at,Et=ge,Zt=new pt,At=Ce+tt,Or=Ce+Me;Ce<At;)Qt(Lt[Et++],Zt),dl(Zt,ot,Ce,Le,de,ce),Ce+=Le,ce+=Le;Ce<Or&&(Qt(Lt[Et++],Zt),dl(Zt,ot,Ce,et,de,ce),Ce+=et,ce+=et),++Ee&Fe||(ge+=Ye)}break;case 3:if(Me==de&&Le==ce&&0<ge.b){for(Ce=de,Me=ot=ce+(Oe-Ee)*ot-(tt=(Oe-Ee)*Re(ge.Ea,ge.b)),Le=de,Fe=ce,Ye=[],tt=(et=tt)-1;0<=tt;--tt)Ye[tt]=Le[Fe+tt];for(tt=et-1;0<=tt;--tt)Ce[Me+tt]=Ye[tt];Ys(ge,Ee,Oe,de,ot,de,ce)}else Ys(ge,Ee,Oe,Me,Le,de,ce)}ce=U,de=T}de!=T&&n(U,T,ce,de,re)}function ye(v,N){var T=v.V,U=v.Ba+v.c*v.C,Y=N-v.C;if(e(N<=v.l.o),e(16>=Y),0<Y){var re=v.l,oe=v.Ta,ce=v.Ua,de=re.width;if(se(v,Y,T,U),Y=ce=[ce],e((T=v.C)<(U=N)),e(re.v<re.va),U>re.o&&(U=re.o),T<re.j){var ge=re.j-T;T=re.j,Y[0]+=ge*de}if(T>=U?T=0:(Y[0]+=4*re.v,re.ka=T-re.j,re.U=re.va-re.v,re.T=U-T,T=1),T){if(ce=ce[0],11>(T=v.ca).S){var Ee=T.f.RGBA,Oe=(U=T.S,Y=re.U,re=re.T,ge=Ee.eb,Ee.A),Me=re;for(Ee=Ee.fb+v.Ma*Ee.A;0<Me--;){var Le=oe,ot=ce,Ye=Y,Ce=ge,Fe=Ee;switch(U){case Tf:Ks(Le,ot,Ye,Ce,Fe);break;case pl:Ls(Le,ot,Ye,Ce,Fe);break;case du:Ls(Le,ot,Ye,Ce,Fe),ua(Ce,Fe,0,Ye,1,0);break;case Ip:_o(Le,ot,Ye,Ce,Fe);break;case wd:wt(Le,ot,Ye,Ce,Fe,1);break;case sc:wt(Le,ot,Ye,Ce,Fe,1),ua(Ce,Fe,0,Ye,1,0);break;case _d:wt(Le,ot,Ye,Ce,Fe,0);break;case Nd:wt(Le,ot,Ye,Ce,Fe,0),ua(Ce,Fe,1,Ye,1,0);break;case an:fl(Le,ot,Ye,Ce,Fe);break;case Sd:fl(Le,ot,Ye,Ce,Fe),sn(Ce,Fe,Ye,1,0);break;case Ff:wo(Le,ot,Ye,Ce,Fe);break;default:e(0)}ce+=de,Ee+=Oe}v.Ma+=re}else alert("todo:EmitRescaledRowsYUVA");e(v.Ma<=T.height)}}v.C=N,e(v.C<=v.i)}function pe(v){var N;if(0<v.ua)return 0;for(N=0;N<v.Wb;++N){var T=v.Ya[N].G,U=v.Ya[N].H;if(0<T[1][U[1]+0].g||0<T[2][U[2]+0].g||0<T[3][U[3]+0].g)return 0}return 1}function xe(v,N,T,U,Y,re){if(v.Z!=0){var oe=v.qd,ce=v.rd;for(e(Rs[v.Z]!=null);N<T;++N)Rs[v.Z](oe,ce,U,Y,U,Y,re),oe=U,ce=Y,Y+=re;v.qd=oe,v.rd=ce}}function be(v,N){var T=v.l.ma,U=T.Z==0||T.Z==1?v.l.j:v.C;if(U=v.C<U?U:v.C,e(N<=v.l.o),N>U){var Y=v.l.width,re=T.ca,oe=T.tb+Y*U,ce=v.V,de=v.Ba+v.c*U,ge=v.gc;e(v.ab==1),e(ge[0].hc==3),vd(ge[0],U,N,ce,de,re,oe),xe(T,U,N,re,oe,Y)}v.C=v.Ma=N}function we(v,N,T,U,Y,re,oe){var ce=v.$/U,de=v.$%U,ge=v.m,Ee=v.s,Oe=T+v.$,Me=Oe;Y=T+U*Y;var Le=T+U*re,ot=280+Ee.ua,Ye=v.Pb?ce:16777216,Ce=0<Ee.ua?Ee.Wa:null,Fe=Ee.wc,tt=Oe<Le?mn(Ee,de,ce):null;e(v.C<re),e(Le<=Y);var et=!1;e:for(;;){for(;et||Oe<Le;){var at=0;if(ce>=Ye){var Lt=Oe-T;e((Ye=v).Pb),Ye.wd=Ye.m,Ye.xd=Lt,0<Ye.s.ua&&De(Ye.s.Wa,Ye.s.vb),Ye=ce+Lf}if(de&Fe||(tt=mn(Ee,de,ce)),e(tt!=null),tt.Qb&&(N[Oe]=tt.qb,et=!0),!et)if(q(ge),tt.jc){at=ge,Lt=N;var Et=Oe,Zt=tt.pd[W(at)&In-1];e(tt.jc),256>Zt.g?(F(at,at.u+Zt.g),Lt[Et]=Zt.value,at=0):(F(at,at.u+Zt.g-256),e(256<=Zt.value),at=Zt.value),at==0&&(et=!0)}else at=zn(tt.G[0],tt.H[0],ge);if(ge.h)break;if(et||256>at){if(!et)if(tt.nd)N[Oe]=(tt.qb|at<<8)>>>0;else{if(q(ge),et=zn(tt.G[1],tt.H[1],ge),q(ge),Lt=zn(tt.G[2],tt.H[2],ge),Et=zn(tt.G[3],tt.H[3],ge),ge.h)break;N[Oe]=(Et<<24|et<<16|at<<8|Lt)>>>0}if(et=!1,++Oe,++de>=U&&(de=0,++ce,oe!=null&&ce<=re&&!(ce%16)&&oe(v,ce),Ce!=null))for(;Me<Oe;)at=N[Me++],Ce.X[(506832829*at&4294967295)>>>Ce.Mb]=at}else if(280>at){if(at=Un(at-256,ge),Lt=zn(tt.G[4],tt.H[4],ge),q(ge),Lt=yn(U,Lt=Un(Lt,ge)),ge.h)break;if(Oe-T<Lt||Y-Oe<at)break e;for(Et=0;Et<at;++Et)N[Oe+Et]=N[Oe+Et-Lt];for(Oe+=at,de+=at;de>=U;)de-=U,++ce,oe!=null&&ce<=re&&!(ce%16)&&oe(v,ce);if(e(Oe<=Y),de&Fe&&(tt=mn(Ee,de,ce)),Ce!=null)for(;Me<Oe;)at=N[Me++],Ce.X[(506832829*at&4294967295)>>>Ce.Mb]=at}else{if(!(at<ot))break e;for(et=at-280,e(Ce!=null);Me<Oe;)at=N[Me++],Ce.X[(506832829*at&4294967295)>>>Ce.Mb]=at;at=Oe,e(!(et>>>(Lt=Ce).Xa)),N[at]=Lt.X[et],et=!0}et||e(ge.h==L(ge))}if(v.Pb&&ge.h&&Oe<Y)e(v.m.h),v.a=5,v.m=v.wd,v.$=v.xd,0<v.s.ua&&De(v.s.vb,v.s.Wa);else{if(ge.h)break e;oe?.(v,ce>re?re:ce),v.a=0,v.$=Oe-T}return 1}return v.a=3,0}function Ue(v){e(v!=null),v.vc=null,v.yc=null,v.Ya=null;var N=v.Wa;N!=null&&(N.X=null),v.vb=null,e(v!=null)}function Je(){var v=new U0;return v==null?null:(v.a=0,v.xb=hu,Wt("Predictor","VP8LPredictors"),Wt("Predictor","VP8LPredictors_C"),Wt("PredictorAdd","VP8LPredictorsAdd"),Wt("PredictorAdd","VP8LPredictorsAdd_C"),Cf=lr,dl=It,Ks=lt,Ls=tr,fl=ke,wo=$t,_o=$e,R.VP8LMapColor32b=iu,R.VP8LMapColor8b=ou,v)}function Be(v,N,T,U,Y){var re=1,oe=[v],ce=[N],de=U.m,ge=U.s,Ee=null,Oe=0;e:for(;;){if(T)for(;re&&fe(de,1);){var Me=oe,Le=ce,ot=U,Ye=1,Ce=ot.m,Fe=ot.gc[ot.ab],tt=fe(Ce,2);if(ot.Oc&1<<tt)re=0;else{switch(ot.Oc|=1<<tt,Fe.hc=tt,Fe.Ea=Me[0],Fe.nc=Le[0],Fe.K=[null],++ot.ab,e(4>=ot.ab),tt){case 0:case 1:Fe.b=fe(Ce,3)+2,Ye=Be(Re(Fe.Ea,Fe.b),Re(Fe.nc,Fe.b),0,ot,Fe.K),Fe.K=Fe.K[0];break;case 3:var et,at=fe(Ce,8)+1,Lt=16<at?0:4<at?1:2<at?2:3;if(Me[0]=Re(Fe.Ea,Lt),Fe.b=Lt,et=Ye=Be(at,1,0,ot,Fe.K)){var Et,Zt=at,At=Fe,Or=1<<(8>>At.b),Mr=a(Or);if(Mr==null)et=0;else{var Pr=At.K[0],wr=At.w;for(Mr[0]=At.K[0][0],Et=1;Et<1*Zt;++Et)Mr[Et]=Ke(Pr[wr+Et],Mr[Et-1]);for(;Et<4*Or;++Et)Mr[Et]=0;At.K[0]=null,At.K[0]=Mr,et=1}}Ye=et;break;case 2:break;default:e(0)}re=Ye}}if(oe=oe[0],ce=ce[0],re&&fe(de,1)&&!(re=1<=(Oe=fe(de,4))&&11>=Oe)){U.a=3;break e}var tn;if(tn=re)t:{var nn,mr,jn,Zs=U,$n=oe,os=ce,qr=Oe,Is=T,Os=Zs.m,En=Zs.s,ls=[null],Es=1,ma=0,ri=Mp[qr];r:for(;;){if(Is&&fe(Os,1)){var An=fe(Os,3)+2,Jn=Re($n,An),Ha=Re(os,An),gl=Jn*Ha;if(!Be(Jn,Ha,0,Zs,ls))break r;for(ls=ls[0],En.xc=An,nn=0;nn<gl;++nn){var To=ls[nn]>>8&65535;ls[nn]=To,To>=Es&&(Es=To+1)}}if(Os.h)break r;for(mr=0;5>mr;++mr){var Gr=ac[mr];!mr&&0<qr&&(Gr+=1<<qr),ma<Gr&&(ma=Gr)}var Ki=i(Es*ri,P),Rf=Es,q0=i(Rf,G);if(q0==null)var ni=null;else e(65536>=Rf),ni=q0;var si=a(ma);if(ni==null||si==null||Ki==null){Zs.a=1;break r}var uc=Ki;for(nn=jn=0;nn<Es;++nn){var ai=ni[nn],Fo=ai.G,dc=ai.H,xu=0,$a=1,gu=0;for(mr=0;5>mr;++mr){Gr=ac[mr],Fo[mr]=uc,dc[mr]=jn,!mr&&0<qr&&(Gr+=1<<qr);s:{var vl,Po=Gr,vu=Zs,Ji=si,$p=uc,G0=jn,xn=0,ki=vu.m,X0=fe(ki,1);if(s(Ji,0,0,Po),X0){var Y0=fe(ki,1)+1,If=fe(ki,1),Of=fe(ki,If==0?1:8);Ji[Of]=1,Y0==2&&(Ji[Of=fe(ki,8)]=1);var Qi=1}else{var bn=a(19),Qn=fe(ki,4)+4;if(19<Qn){vu.a=3;var Wn=0;break s}for(vl=0;vl<Qn;++vl)bn[Ng[vl]]=fe(ki,3);var yu=void 0,Lo=void 0,bu=vu,Cg=bn,cs=Po,Mf=Ji,Cd=0,Zi=bu.m,ji=8,Wa=i(128,P);n:for(;I(Wa,0,7,Cg,19);){if(fe(Zi,1)){var Td=2+2*fe(Zi,3);if((yu=2+fe(Zi,Td))>cs)break n}else yu=cs;for(Lo=0;Lo<cs&&yu--;){q(Zi);var Bf=Wa[0+(127&W(Zi))];F(Zi,Zi.u+Bf.g);var yl=Bf.value;if(16>yl)Mf[Lo++]=yl,yl!=0&&(ji=yl);else{var Wp=yl==16,K0=yl-16,Vp=Pf[K0],J0=fe(Zi,kd[K0])+Vp;if(Lo+J0>cs)break n;for(var qp=Wp?ji:0;0<J0--;)Mf[Lo++]=qp}}Cd=1;break n}Cd||(bu.a=3),Qi=Cd}(Qi=Qi&&!ki.h)&&(xn=I($p,G0,8,Ji,Po)),Qi&&xn!=0?Wn=xn:(vu.a=3,Wn=0)}if(Wn==0)break r;if($a&&Op[mr]==1&&($a=uc[jn].g==0),xu+=uc[jn].g,jn+=Wn,3>=mr){var wu,Uf=si[0];for(wu=1;wu<Gr;++wu)si[wu]>Uf&&(Uf=si[wu]);gu+=Uf}}if(ai.nd=$a,ai.Qb=0,$a&&(ai.qb=(Fo[3][dc[3]+0].value<<24|Fo[1][dc[1]+0].value<<16|Fo[2][dc[2]+0].value)>>>0,xu==0&&256>Fo[0][dc[0]+0].value&&(ai.Qb=1,ai.qb+=Fo[0][dc[0]+0].value<<8)),ai.jc=!ai.Qb&&6>gu,ai.jc){var Fd,Va=ai;for(Fd=0;Fd<In;++Fd){var Do=Fd,Ei=Va.pd[Do],fc=Va.G[0][Va.H[0]+Do];256<=fc.value?(Ei.g=fc.g+256,Ei.value=fc.value):(Ei.g=0,Ei.value=0,Do>>=pn(fc,8,Ei),Do>>=pn(Va.G[1][Va.H[1]+Do],16,Ei),Do>>=pn(Va.G[2][Va.H[2]+Do],0,Ei),pn(Va.G[3][Va.H[3]+Do],24,Ei))}}}En.vc=ls,En.Wb=Es,En.Ya=ni,En.yc=Ki,tn=1;break t}tn=0}if(!(re=tn)){U.a=3;break e}if(0<Oe){if(ge.ua=1<<Oe,!rt(ge.Wa,Oe)){U.a=1,re=0;break e}}else ge.ua=0;var zf=U,Hf=oe,Gp=ce,$f=zf.s,Wf=$f.xc;if(zf.c=Hf,zf.i=Gp,$f.md=Re(Hf,Wf),$f.wc=Wf==0?-1:(1<<Wf)-1,T){U.xb=Yi;break e}if((Ee=a(oe*ce))==null){U.a=1,re=0;break e}re=(re=we(U,Ee,0,oe,ce,ce,null))&&!de.h;break e}return re?(Y!=null?Y[0]=Ee:(e(Ee==null),e(T)),U.$=0,T||Ue(ge)):Ue(ge),re}function He(v,N){var T=v.c*v.i,U=T+N+16*N;return e(v.c<=N),v.V=a(U),v.V==null?(v.Ta=null,v.Ua=0,v.a=1,0):(v.Ta=v.V,v.Ua=v.Ba+T+N,1)}function qe(v,N){var T=v.C,U=N-T,Y=v.V,re=v.Ba+v.c*T;for(e(N<=v.l.o);0<U;){var oe=16<U?16:U,ce=v.l.ma,de=v.l.width,ge=de*oe,Ee=ce.ca,Oe=ce.tb+de*T,Me=v.Ta,Le=v.Ua;se(v,oe,Y,re),On(Me,Le,Ee,Oe,ge),xe(ce,T,T+oe,Ee,Oe,de),U-=oe,Y+=oe*v.c,T+=oe}e(T==N),v.C=v.Ma=N}function ut(){this.ub=this.yd=this.td=this.Rb=0}function Nt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ct(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function gt(){this.Yb=(function(){var v=[];return(function N(T,U,Y){for(var re=Y[U],oe=0;oe<re&&(T.push(Y.length>U+1?[]:0),!(Y.length<U+1));oe++)N(T[oe],U+1,Y)})(v,0,[3,11]),v})()}function mt(){this.jb=a(3),this.Wc=l([4,8],gt),this.Xc=l([4,17],gt)}function ur(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Ir(){this.ld=this.La=this.dd=this.tc=0}function Qr(){this.Na=this.la=0}function _n(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function vi(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Mi(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ir),this.Y=0,this.ya=Array(new vi),this.aa=0,this.l=new Bi}function Oa(){this.y=a(16),this.f=a(8),this.ea=a(8)}function Xn(){this.cb=this.a=0,this.sc="",this.m=new K,this.Od=new ut,this.Kc=new Nt,this.ed=new ur,this.Qa=new Ct,this.Ic=this.$c=this.Aa=0,this.D=new Mi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,K),this.ia=0,this.pb=i(4,_n),this.Pa=new mt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Oa),this.Hd=0,this.rb=Array(new Qr),this.sb=0,this.wa=Array(new Ir),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new vi),this.L=this.aa=0,this.gd=l([4,2],Ir),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Bi(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Nn(){var v=new Xn;return v!=null&&(v.a=0,v.sc="OK",v.cb=0,v.Xb=0,ic||(ic=Ul)),v}function Hn(v,N,T){return v.a==0&&(v.a=N,v.sc=T,v.cb=0),0}function _f(v,N,T){return 3<=T&&v[N+0]==157&&v[N+1]==1&&v[N+2]==42}function Nf(v,N){if(v==null)return 0;if(v.a=0,v.sc="OK",N==null)return Hn(v,2,"null VP8Io passed to VP8GetHeaders()");var T=N.data,U=N.w,Y=N.ha;if(4>Y)return Hn(v,7,"Truncated header.");var re=T[U+0]|T[U+1]<<8|T[U+2]<<16,oe=v.Od;if(oe.Rb=!(1&re),oe.td=re>>1&7,oe.yd=re>>4&1,oe.ub=re>>5,3<oe.td)return Hn(v,3,"Incorrect keyframe parameters.");if(!oe.yd)return Hn(v,4,"Frame not displayable.");U+=3,Y-=3;var ce=v.Kc;if(oe.Rb){if(7>Y)return Hn(v,7,"cannot parse picture header");if(!_f(T,U,Y))return Hn(v,3,"Bad code word");ce.c=16383&(T[U+4]<<8|T[U+3]),ce.Td=T[U+4]>>6,ce.i=16383&(T[U+6]<<8|T[U+5]),ce.Ud=T[U+6]>>6,U+=7,Y-=7,v.za=ce.c+15>>4,v.Ub=ce.i+15>>4,N.width=ce.c,N.height=ce.i,N.Da=0,N.j=0,N.v=0,N.va=N.width,N.o=N.height,N.da=0,N.ib=N.width,N.hb=N.height,N.U=N.width,N.T=N.height,s((re=v.Pa).jb,0,255,re.jb.length),e((re=v.Qa)!=null),re.Cb=0,re.Bb=0,re.Fb=1,s(re.Zb,0,0,re.Zb.length),s(re.Lb,0,0,re.Lb)}if(oe.ub>Y)return Hn(v,7,"bad partition length");M(re=v.m,T,U,oe.ub),U+=oe.ub,Y-=oe.ub,oe.Rb&&(ce.Ld=me(re),ce.Kd=me(re)),ce=v.Qa;var de,ge=v.Pa;if(e(re!=null),e(ce!=null),ce.Cb=me(re),ce.Cb){if(ce.Bb=me(re),me(re)){for(ce.Fb=me(re),de=0;4>de;++de)ce.Zb[de]=me(re)?ie(re,7):0;for(de=0;4>de;++de)ce.Lb[de]=me(re)?ie(re,6):0}if(ce.Bb)for(de=0;3>de;++de)ge.jb[de]=me(re)?te(re,8):255}else ce.Bb=0;if(re.Ka)return Hn(v,3,"cannot parse segment header");if((ce=v.ed).zd=me(re),ce.Tb=te(re,6),ce.wb=te(re,3),ce.Pc=me(re),ce.Pc&&me(re)){for(ge=0;4>ge;++ge)me(re)&&(ce.vd[ge]=ie(re,6));for(ge=0;4>ge;++ge)me(re)&&(ce.od[ge]=ie(re,6))}if(v.L=ce.Tb==0?0:ce.zd?1:2,re.Ka)return Hn(v,3,"cannot parse filter header");var Ee=Y;if(Y=de=U,U=de+Ee,ce=Ee,v.Xb=(1<<te(v.m,2))-1,Ee<3*(ge=v.Xb))T=7;else{for(de+=3*ge,ce-=3*ge,Ee=0;Ee<ge;++Ee){var Oe=T[Y+0]|T[Y+1]<<8|T[Y+2]<<16;Oe>ce&&(Oe=ce),M(v.Jc[+Ee],T,de,Oe),de+=Oe,ce-=Oe,Y+=3}M(v.Jc[+ge],T,de,ce),T=de<U?0:5}if(T!=0)return Hn(v,T,"cannot parse partitions");for(T=te(de=v.m,7),Y=me(de)?ie(de,4):0,U=me(de)?ie(de,4):0,ce=me(de)?ie(de,4):0,ge=me(de)?ie(de,4):0,de=me(de)?ie(de,4):0,Ee=v.Qa,Oe=0;4>Oe;++Oe){if(Ee.Cb){var Me=Ee.Zb[Oe];Ee.Fb||(Me+=T)}else{if(0<Oe){v.pb[Oe]=v.pb[0];continue}Me=T}var Le=v.pb[Oe];Le.Sc[0]=fu[Ba(Me+Y,127)],Le.Sc[1]=jd[Ba(Me+0,127)],Le.Eb[0]=2*fu[Ba(Me+U,127)],Le.Eb[1]=101581*jd[Ba(Me+ce,127)]>>16,8>Le.Eb[1]&&(Le.Eb[1]=8),Le.Qc[0]=fu[Ba(Me+ge,117)],Le.Qc[1]=jd[Ba(Me+de,127)],Le.lc=Me+de}if(!oe.Rb)return Hn(v,4,"Not a key frame.");for(me(re),oe=v.Pa,T=0;4>T;++T){for(Y=0;8>Y;++Y)for(U=0;3>U;++U)for(ce=0;11>ce;++ce)ge=Z(re,jg[T][Y][U][ce])?te(re,8):Up[T][Y][U][ce],oe.Wc[T][Y].Yb[U][ce]=ge;for(Y=0;17>Y;++Y)oe.Xc[T][Y]=oe.Wc[T][$0[Y]]}return v.kc=me(re),v.kc&&(v.Bd=te(re,8)),v.cb=1}function Ul(v,N,T,U,Y,re,oe){var ce=N[Y].Yb[T];for(T=0;16>Y;++Y){if(!Z(v,ce[T+0]))return Y;for(;!Z(v,ce[T+1]);)if(ce=N[++Y].Yb[0],T=0,Y==16)return 16;var de=N[Y+1].Yb;if(Z(v,ce[T+2])){var ge=v,Ee=0;if(Z(ge,(Me=ce)[(Oe=T)+3]))if(Z(ge,Me[Oe+6])){for(ce=0,Oe=2*(Ee=Z(ge,Me[Oe+8]))+(Me=Z(ge,Me[Oe+9+Ee])),Ee=0,Me=z0[Oe];Me[ce];++ce)Ee+=Ee+Z(ge,Me[ce]);Ee+=3+(8<<Oe)}else Z(ge,Me[Oe+7])?(Ee=7+2*Z(ge,165),Ee+=Z(ge,145)):Ee=5+Z(ge,159);else Ee=Z(ge,Me[Oe+4])?3+Z(ge,Me[Oe+5]):2;ce=de[2]}else Ee=1,ce=de[1];de=oe+H0[Y],0>(ge=v).b&&he(ge);var Oe,Me=ge.b,Le=(Oe=ge.Ca>>1)-(ge.I>>Me)>>31;--ge.b,ge.Ca+=Le,ge.Ca|=1,ge.I-=(Oe+1&Le)<<Me,re[de]=((Ee^Le)-Le)*U[(0<Y)+0]}return 16}function tl(v){var N=v.rb[v.sb-1];N.la=0,N.Na=0,s(v.zc,0,0,v.zc.length),v.ja=0}function zl(v,N){if(v==null)return 0;if(N==null)return Hn(v,2,"NULL VP8Io parameter in VP8Decode().");if(!v.cb&&!Nf(v,N))return 0;if(e(v.cb),N.ac==null||N.ac(N)){N.ob&&(v.L=0);var T=cc[v.L];if(v.L==2?(v.yb=0,v.zb=0):(v.yb=N.v-T>>4,v.zb=N.j-T>>4,0>v.yb&&(v.yb=0),0>v.zb&&(v.zb=0)),v.Va=N.o+15+T>>4,v.Hb=N.va+15+T>>4,v.Hb>v.za&&(v.Hb=v.za),v.Va>v.Ub&&(v.Va=v.Ub),0<v.L){var U=v.ed;for(T=0;4>T;++T){var Y;if(v.Qa.Cb){var re=v.Qa.Lb[T];v.Qa.Fb||(re+=U.Tb)}else re=U.Tb;for(Y=0;1>=Y;++Y){var oe=v.gd[T][Y],ce=re;if(U.Pc&&(ce+=U.vd[0],Y&&(ce+=U.od[0])),0<(ce=0>ce?0:63<ce?63:ce)){var de=ce;0<U.wb&&(de=4<U.wb?de>>2:de>>1)>9-U.wb&&(de=9-U.wb),1>de&&(de=1),oe.dd=de,oe.tc=2*ce+de,oe.ld=40<=ce?2:15<=ce?1:0}else oe.tc=0;oe.La=Y}}}T=0}else Hn(v,6,"Frame setup failed"),T=v.a;if(T=T==0){if(T){v.$c=0,0<v.Aa||(v.Ic=Co);e:{T=v.Ic,U=4*(de=v.za);var ge=32*de,Ee=de+1,Oe=0<v.L?de*(0<v.Aa?2:1):0,Me=(v.Aa==2?2:1)*de;if((oe=U+832+(Y=3*(16*T+cc[v.L])/2*ge)+(re=v.Fa!=null&&0<v.Fa.length?v.Kc.c*v.Kc.i:0))!=oe)T=0;else{if(oe>v.Vb){if(v.Vb=0,v.Ec=a(oe),v.Fc=0,v.Ec==null){T=Hn(v,1,"no memory during frame initialization.");break e}v.Vb=oe}oe=v.Ec,ce=v.Fc,v.Ac=oe,v.Bc=ce,ce+=U,v.Gd=i(ge,Oa),v.Hd=0,v.rb=i(Ee+1,Qr),v.sb=1,v.wa=Oe?i(Oe,Ir):null,v.Y=0,v.D.Nb=0,v.D.wa=v.wa,v.D.Y=v.Y,0<v.Aa&&(v.D.Y+=de),e(!0),v.oc=oe,v.pc=ce,ce+=832,v.ya=i(Me,vi),v.aa=0,v.D.ya=v.ya,v.D.aa=v.aa,v.Aa==2&&(v.D.aa+=de),v.R=16*de,v.B=8*de,de=(ge=cc[v.L])*v.R,ge=ge/2*v.B,v.sa=oe,v.ta=ce+de,v.qa=v.sa,v.ra=v.ta+16*T*v.R+ge,v.Ha=v.qa,v.Ia=v.ra+8*T*v.B+ge,v.$c=0,ce+=Y,v.mb=re?oe:null,v.nb=re?ce:null,e(ce+re<=v.Fc+v.Vb),tl(v),s(v.Ac,v.Bc,0,U),T=1}}if(T){if(N.ka=0,N.y=v.sa,N.O=v.ta,N.f=v.qa,N.N=v.ra,N.ea=v.Ha,N.Vd=v.Ia,N.fa=v.R,N.Rc=v.B,N.F=null,N.J=0,!bd){for(T=-255;255>=T;++T)Kn[255+T]=0>T?-T:T;for(T=-1020;1020>=T;++T)Gi[1020+T]=-128>T?-128:127<T?127:T;for(T=-112;112>=T;++T)cu[112+T]=-16>T?-16:15<T?15:T;for(T=-255;510>=T;++T)nc[255+T]=0>T?0:255<T?255:T;bd=1}lu=zr,No=cd,So=rl,Ds=M0,Ua=Hc,Hr=ld,Zl=Yc,yd=is,ec=Xl,tc=pd,rc=il,za=ol,ko=Yl,qi=Kc,jo=wi,Eo=Ja,hl=Qa,ks=Ef,ti[0]=$i,ti[1]=Sf,ti[2]=Vl,ti[3]=Hi,ti[4]=dd,ti[5]=Wc,ti[6]=sl,ti[7]=Vc,ti[8]=jf,ti[9]=qc,Qs[0]=Wl,Qs[1]=kf,Qs[2]=Ui,Qs[3]=$l,Qs[4]=Sn,Qs[5]=zi,Qs[6]=yi,da[0]=Ma,da[1]=ud,da[2]=B0,da[3]=vo,da[4]=ql,da[5]=Gc,da[6]=fd,T=1}else T=0}T&&(T=(function(Le,ot){for(Le.M=0;Le.M<Le.Va;++Le.M){var Ye,Ce=Le.Jc[Le.M&Le.Xb],Fe=Le.m,tt=Le;for(Ye=0;Ye<tt.za;++Ye){var et=Fe,at=tt,Lt=at.Ac,Et=at.Bc+4*Ye,Zt=at.zc,At=at.ya[at.aa+Ye];if(at.Qa.Bb?At.$b=Z(et,at.Pa.jb[0])?2+Z(et,at.Pa.jb[2]):Z(et,at.Pa.jb[1]):At.$b=0,at.kc&&(At.Ad=Z(et,at.Bd)),At.Za=!Z(et,145)+0,At.Za){var Or=At.Ob,Mr=0;for(at=0;4>at;++at){var Pr,wr=Zt[0+at];for(Pr=0;4>Pr;++Pr){wr=kg[Lt[Et+Pr]][wr];for(var tn=Bp[Z(et,wr[0])];0<tn;)tn=Bp[2*tn+Z(et,wr[tn])];wr=-tn,Lt[Et+Pr]=wr}n(Or,Mr,Lt,Et,4),Mr+=4,Zt[0+at]=wr}}else wr=Z(et,156)?Z(et,128)?1:3:Z(et,163)?2:0,At.Ob[0]=wr,s(Lt,Et,wr,4),s(Zt,0,wr,4);At.Dd=Z(et,142)?Z(et,114)?Z(et,183)?1:3:2:0}if(tt.m.Ka)return Hn(Le,7,"Premature end-of-partition0 encountered.");for(;Le.ja<Le.za;++Le.ja){if(tt=Ce,et=(Fe=Le).rb[Fe.sb-1],Lt=Fe.rb[Fe.sb+Fe.ja],Ye=Fe.ya[Fe.aa+Fe.ja],Et=Fe.kc?Ye.Ad:0)et.la=Lt.la=0,Ye.Za||(et.Na=Lt.Na=0),Ye.Hc=0,Ye.Gc=0,Ye.ia=0;else{var nn,mr;if(et=Lt,Lt=tt,Et=Fe.Pa.Xc,Zt=Fe.ya[Fe.aa+Fe.ja],At=Fe.pb[Zt.$b],at=Zt.ad,Or=0,Mr=Fe.rb[Fe.sb-1],wr=Pr=0,s(at,Or,0,384),Zt.Za)var jn=0,Zs=Et[3];else{tn=a(16);var $n=et.Na+Mr.Na;if($n=ic(Lt,Et[1],$n,At.Eb,0,tn,0),et.Na=Mr.Na=(0<$n)+0,1<$n)lu(tn,0,at,Or);else{var os=tn[0]+3>>3;for(tn=0;256>tn;tn+=16)at[Or+tn]=os}jn=1,Zs=Et[0]}var qr=15&et.la,Is=15&Mr.la;for(tn=0;4>tn;++tn){var Os=1&Is;for(os=mr=0;4>os;++os)qr=qr>>1|(Os=($n=ic(Lt,Zs,$n=Os+(1&qr),At.Sc,jn,at,Or))>jn)<<7,mr=mr<<2|(3<$n?3:1<$n?2:at[Or+0]!=0),Or+=16;qr>>=4,Is=Is>>1|Os<<7,Pr=(Pr<<8|mr)>>>0}for(Zs=qr,jn=Is>>4,nn=0;4>nn;nn+=2){for(mr=0,qr=et.la>>4+nn,Is=Mr.la>>4+nn,tn=0;2>tn;++tn){for(Os=1&Is,os=0;2>os;++os)$n=Os+(1&qr),qr=qr>>1|(Os=0<($n=ic(Lt,Et[2],$n,At.Qc,0,at,Or)))<<3,mr=mr<<2|(3<$n?3:1<$n?2:at[Or+0]!=0),Or+=16;qr>>=2,Is=Is>>1|Os<<5}wr|=mr<<4*nn,Zs|=qr<<4<<nn,jn|=(240&Is)<<nn}et.la=Zs,Mr.la=jn,Zt.Hc=Pr,Zt.Gc=wr,Zt.ia=43690&wr?0:At.ia,Et=!(Pr|wr)}if(0<Fe.L&&(Fe.wa[Fe.Y+Fe.ja]=Fe.gd[Ye.$b][Ye.Za],Fe.wa[Fe.Y+Fe.ja].La|=!Et),tt.Ka)return Hn(Le,7,"Premature end-of-file encountered.")}if(tl(Le),Fe=ot,tt=1,Ye=(Ce=Le).D,et=0<Ce.L&&Ce.M>=Ce.zb&&Ce.M<=Ce.Va,Ce.Aa==0)e:{if(Ye.M=Ce.M,Ye.uc=et,Zc(Ce,Ye),tt=1,Ye=(mr=Ce.D).Nb,et=(wr=cc[Ce.L])*Ce.R,Lt=wr/2*Ce.B,tn=16*Ye*Ce.R,os=8*Ye*Ce.B,Et=Ce.sa,Zt=Ce.ta-et+tn,At=Ce.qa,at=Ce.ra-Lt+os,Or=Ce.Ha,Mr=Ce.Ia-Lt+os,Is=(qr=mr.M)==0,Pr=qr>=Ce.Va-1,Ce.Aa==2&&Zc(Ce,mr),mr.uc)for(Os=($n=Ce).D.M,e($n.D.uc),mr=$n.yb;mr<$n.Hb;++mr){jn=mr,Zs=Os;var En=(ls=(Gr=$n).D).Nb;nn=Gr.R;var ls=ls.wa[ls.Y+jn],Es=Gr.sa,ma=Gr.ta+16*En*nn+16*jn,ri=ls.dd,An=ls.tc;if(An!=0)if(e(3<=An),Gr.L==1)0<jn&&Eo(Es,ma,nn,An+4),ls.La&&ks(Es,ma,nn,An),0<Zs&&jo(Es,ma,nn,An+4),ls.La&&hl(Es,ma,nn,An);else{var Jn=Gr.B,Ha=Gr.qa,gl=Gr.ra+8*En*Jn+8*jn,To=Gr.Ha,Gr=Gr.Ia+8*En*Jn+8*jn;En=ls.ld,0<jn&&(yd(Es,ma,nn,An+4,ri,En),tc(Ha,gl,To,Gr,Jn,An+4,ri,En)),ls.La&&(za(Es,ma,nn,An,ri,En),qi(Ha,gl,To,Gr,Jn,An,ri,En)),0<Zs&&(Zl(Es,ma,nn,An+4,ri,En),ec(Ha,gl,To,Gr,Jn,An+4,ri,En)),ls.La&&(rc(Es,ma,nn,An,ri,En),ko(Ha,gl,To,Gr,Jn,An,ri,En))}}if(Ce.ia&&alert("todo:DitherRow"),Fe.put!=null){if(mr=16*qr,qr=16*(qr+1),Is?(Fe.y=Ce.sa,Fe.O=Ce.ta+tn,Fe.f=Ce.qa,Fe.N=Ce.ra+os,Fe.ea=Ce.Ha,Fe.W=Ce.Ia+os):(mr-=wr,Fe.y=Et,Fe.O=Zt,Fe.f=At,Fe.N=at,Fe.ea=Or,Fe.W=Mr),Pr||(qr-=wr),qr>Fe.o&&(qr=Fe.o),Fe.F=null,Fe.J=null,Ce.Fa!=null&&0<Ce.Fa.length&&mr<qr&&(Fe.J=xd(Ce,Fe,mr,qr-mr),Fe.F=Ce.mb,Fe.F==null&&Fe.F.length==0)){tt=Hn(Ce,3,"Could not decode alpha data.");break e}mr<Fe.j&&(wr=Fe.j-mr,mr=Fe.j,e(!(1&wr)),Fe.O+=Ce.R*wr,Fe.N+=Ce.B*(wr>>1),Fe.W+=Ce.B*(wr>>1),Fe.F!=null&&(Fe.J+=Fe.width*wr)),mr<qr&&(Fe.O+=Fe.v,Fe.N+=Fe.v>>1,Fe.W+=Fe.v>>1,Fe.F!=null&&(Fe.J+=Fe.v),Fe.ka=mr-Fe.j,Fe.U=Fe.va-Fe.v,Fe.T=qr-mr,tt=Fe.put(Fe))}Ye+1!=Ce.Ic||Pr||(n(Ce.sa,Ce.ta-et,Et,Zt+16*Ce.R,et),n(Ce.qa,Ce.ra-Lt,At,at+8*Ce.B,Lt),n(Ce.Ha,Ce.Ia-Lt,Or,Mr+8*Ce.B,Lt))}if(!tt)return Hn(Le,6,"Output aborted.")}return 1})(v,N)),N.bc!=null&&N.bc(N),T&=1}return T?(v.cb=0,T):0}function oa(v,N,T,U,Y){Y=v[N+T+32*U]+(Y>>3),v[N+T+32*U]=-256&Y?0>Y?0:255:Y}function zc(v,N,T,U,Y,re){oa(v,N,0,T,U+Y),oa(v,N,1,T,U+re),oa(v,N,2,T,U-re),oa(v,N,3,T,U-Y)}function la(v){return(20091*v>>16)+v}function Hl(v,N,T,U){var Y,re=0,oe=a(16);for(Y=0;4>Y;++Y){var ce=v[N+0]+v[N+8],de=v[N+0]-v[N+8],ge=(35468*v[N+4]>>16)-la(v[N+12]),Ee=la(v[N+4])+(35468*v[N+12]>>16);oe[re+0]=ce+Ee,oe[re+1]=de+ge,oe[re+2]=de-ge,oe[re+3]=ce-Ee,re+=4,N++}for(Y=re=0;4>Y;++Y)ce=(v=oe[re+0]+4)+oe[re+8],de=v-oe[re+8],ge=(35468*oe[re+4]>>16)-la(oe[re+12]),oa(T,U,0,0,ce+(Ee=la(oe[re+4])+(35468*oe[re+12]>>16))),oa(T,U,1,0,de+ge),oa(T,U,2,0,de-ge),oa(T,U,3,0,ce-Ee),re++,U+=32}function ld(v,N,T,U){var Y=v[N+0]+4,re=35468*v[N+4]>>16,oe=la(v[N+4]),ce=35468*v[N+1]>>16;zc(T,U,0,Y+oe,v=la(v[N+1]),ce),zc(T,U,1,Y+re,v,ce),zc(T,U,2,Y-re,v,ce),zc(T,U,3,Y-oe,v,ce)}function cd(v,N,T,U,Y){Hl(v,N,T,U),Y&&Hl(v,N+16,T,U+4)}function rl(v,N,T,U){No(v,N+0,T,U,1),No(v,N+32,T,U+128,1)}function M0(v,N,T,U){var Y;for(v=v[N+0]+4,Y=0;4>Y;++Y)for(N=0;4>N;++N)oa(T,U,N,Y,v)}function Hc(v,N,T,U){v[N+0]&&Ds(v,N+0,T,U),v[N+16]&&Ds(v,N+16,T,U+4),v[N+32]&&Ds(v,N+32,T,U+128),v[N+48]&&Ds(v,N+48,T,U+128+4)}function zr(v,N,T,U){var Y,re=a(16);for(Y=0;4>Y;++Y){var oe=v[N+0+Y]+v[N+12+Y],ce=v[N+4+Y]+v[N+8+Y],de=v[N+4+Y]-v[N+8+Y],ge=v[N+0+Y]-v[N+12+Y];re[0+Y]=oe+ce,re[8+Y]=oe-ce,re[4+Y]=ge+de,re[12+Y]=ge-de}for(Y=0;4>Y;++Y)oe=(v=re[0+4*Y]+3)+re[3+4*Y],ce=re[1+4*Y]+re[2+4*Y],de=re[1+4*Y]-re[2+4*Y],ge=v-re[3+4*Y],T[U+0]=oe+ce>>3,T[U+16]=ge+de>>3,T[U+32]=oe-ce>>3,T[U+48]=ge-de>>3,U+=64}function $c(v,N,T){var U,Y=N-32,re=Js,oe=255-v[Y-1];for(U=0;U<T;++U){var ce,de=re,ge=oe+v[N-1];for(ce=0;ce<T;++ce)v[N+ce]=de[ge+v[Y+ce]];N+=32}}function Sf(v,N){$c(v,N,4)}function ud(v,N){$c(v,N,8)}function kf(v,N){$c(v,N,16)}function Ui(v,N){var T;for(T=0;16>T;++T)n(v,N+32*T,v,N-32,16)}function $l(v,N){var T;for(T=16;0<T;--T)s(v,N,v[N-1],16),N+=32}function nl(v,N,T){var U;for(U=0;16>U;++U)s(N,T+32*U,v,16)}function Wl(v,N){var T,U=16;for(T=0;16>T;++T)U+=v[N-1+32*T]+v[N+T-32];nl(U>>5,v,N)}function Sn(v,N){var T,U=8;for(T=0;16>T;++T)U+=v[N-1+32*T];nl(U>>4,v,N)}function zi(v,N){var T,U=8;for(T=0;16>T;++T)U+=v[N+T-32];nl(U>>4,v,N)}function yi(v,N){nl(128,v,N)}function ir(v,N,T){return v+2*N+T+2>>2}function Vl(v,N){var T,U=N-32;for(U=new Uint8Array([ir(v[U-1],v[U+0],v[U+1]),ir(v[U+0],v[U+1],v[U+2]),ir(v[U+1],v[U+2],v[U+3]),ir(v[U+2],v[U+3],v[U+4])]),T=0;4>T;++T)n(v,N+32*T,U,0,U.length)}function Hi(v,N){var T=v[N-1],U=v[N-1+32],Y=v[N-1+64],re=v[N-1+96];Se(v,N+0,16843009*ir(v[N-1-32],T,U)),Se(v,N+32,16843009*ir(T,U,Y)),Se(v,N+64,16843009*ir(U,Y,re)),Se(v,N+96,16843009*ir(Y,re,re))}function $i(v,N){var T,U=4;for(T=0;4>T;++T)U+=v[N+T-32]+v[N-1+32*T];for(U>>=3,T=0;4>T;++T)s(v,N+32*T,U,4)}function dd(v,N){var T=v[N-1+0],U=v[N-1+32],Y=v[N-1+64],re=v[N-1-32],oe=v[N+0-32],ce=v[N+1-32],de=v[N+2-32],ge=v[N+3-32];v[N+0+96]=ir(U,Y,v[N-1+96]),v[N+1+96]=v[N+0+64]=ir(T,U,Y),v[N+2+96]=v[N+1+64]=v[N+0+32]=ir(re,T,U),v[N+3+96]=v[N+2+64]=v[N+1+32]=v[N+0+0]=ir(oe,re,T),v[N+3+64]=v[N+2+32]=v[N+1+0]=ir(ce,oe,re),v[N+3+32]=v[N+2+0]=ir(de,ce,oe),v[N+3+0]=ir(ge,de,ce)}function sl(v,N){var T=v[N+1-32],U=v[N+2-32],Y=v[N+3-32],re=v[N+4-32],oe=v[N+5-32],ce=v[N+6-32],de=v[N+7-32];v[N+0+0]=ir(v[N+0-32],T,U),v[N+1+0]=v[N+0+32]=ir(T,U,Y),v[N+2+0]=v[N+1+32]=v[N+0+64]=ir(U,Y,re),v[N+3+0]=v[N+2+32]=v[N+1+64]=v[N+0+96]=ir(Y,re,oe),v[N+3+32]=v[N+2+64]=v[N+1+96]=ir(re,oe,ce),v[N+3+64]=v[N+2+96]=ir(oe,ce,de),v[N+3+96]=ir(ce,de,de)}function Wc(v,N){var T=v[N-1+0],U=v[N-1+32],Y=v[N-1+64],re=v[N-1-32],oe=v[N+0-32],ce=v[N+1-32],de=v[N+2-32],ge=v[N+3-32];v[N+0+0]=v[N+1+64]=re+oe+1>>1,v[N+1+0]=v[N+2+64]=oe+ce+1>>1,v[N+2+0]=v[N+3+64]=ce+de+1>>1,v[N+3+0]=de+ge+1>>1,v[N+0+96]=ir(Y,U,T),v[N+0+64]=ir(U,T,re),v[N+0+32]=v[N+1+96]=ir(T,re,oe),v[N+1+32]=v[N+2+96]=ir(re,oe,ce),v[N+2+32]=v[N+3+96]=ir(oe,ce,de),v[N+3+32]=ir(ce,de,ge)}function Vc(v,N){var T=v[N+0-32],U=v[N+1-32],Y=v[N+2-32],re=v[N+3-32],oe=v[N+4-32],ce=v[N+5-32],de=v[N+6-32],ge=v[N+7-32];v[N+0+0]=T+U+1>>1,v[N+1+0]=v[N+0+64]=U+Y+1>>1,v[N+2+0]=v[N+1+64]=Y+re+1>>1,v[N+3+0]=v[N+2+64]=re+oe+1>>1,v[N+0+32]=ir(T,U,Y),v[N+1+32]=v[N+0+96]=ir(U,Y,re),v[N+2+32]=v[N+1+96]=ir(Y,re,oe),v[N+3+32]=v[N+2+96]=ir(re,oe,ce),v[N+3+64]=ir(oe,ce,de),v[N+3+96]=ir(ce,de,ge)}function qc(v,N){var T=v[N-1+0],U=v[N-1+32],Y=v[N-1+64],re=v[N-1+96];v[N+0+0]=T+U+1>>1,v[N+2+0]=v[N+0+32]=U+Y+1>>1,v[N+2+32]=v[N+0+64]=Y+re+1>>1,v[N+1+0]=ir(T,U,Y),v[N+3+0]=v[N+1+32]=ir(U,Y,re),v[N+3+32]=v[N+1+64]=ir(Y,re,re),v[N+3+64]=v[N+2+64]=v[N+0+96]=v[N+1+96]=v[N+2+96]=v[N+3+96]=re}function jf(v,N){var T=v[N-1+0],U=v[N-1+32],Y=v[N-1+64],re=v[N-1+96],oe=v[N-1-32],ce=v[N+0-32],de=v[N+1-32],ge=v[N+2-32];v[N+0+0]=v[N+2+32]=T+oe+1>>1,v[N+0+32]=v[N+2+64]=U+T+1>>1,v[N+0+64]=v[N+2+96]=Y+U+1>>1,v[N+0+96]=re+Y+1>>1,v[N+3+0]=ir(ce,de,ge),v[N+2+0]=ir(oe,ce,de),v[N+1+0]=v[N+3+32]=ir(T,oe,ce),v[N+1+32]=v[N+3+64]=ir(U,T,oe),v[N+1+64]=v[N+3+96]=ir(Y,U,T),v[N+1+96]=ir(re,Y,U)}function B0(v,N){var T;for(T=0;8>T;++T)n(v,N+32*T,v,N-32,8)}function vo(v,N){var T;for(T=0;8>T;++T)s(v,N,v[N-1],8),N+=32}function bi(v,N,T){var U;for(U=0;8>U;++U)s(N,T+32*U,v,8)}function Ma(v,N){var T,U=8;for(T=0;8>T;++T)U+=v[N+T-32]+v[N-1+32*T];bi(U>>4,v,N)}function Gc(v,N){var T,U=4;for(T=0;8>T;++T)U+=v[N+T-32];bi(U>>3,v,N)}function ql(v,N){var T,U=4;for(T=0;8>T;++T)U+=v[N-1+32*T];bi(U>>3,v,N)}function fd(v,N){bi(128,v,N)}function al(v,N,T){var U=v[N-T],Y=v[N+0],re=3*(Y-U)+Xi[1020+v[N-2*T]-v[N+T]],oe=uu[112+(re+4>>3)];v[N-T]=Js[255+U+uu[112+(re+3>>3)]],v[N+0]=Js[255+Y-oe]}function Gl(v,N,T,U){var Y=v[N+0],re=v[N+T];return ei[255+v[N-2*T]-v[N-T]]>U||ei[255+re-Y]>U}function Xc(v,N,T,U){return 4*ei[255+v[N-T]-v[N+0]]+ei[255+v[N-2*T]-v[N+T]]<=U}function hd(v,N,T,U,Y){var re=v[N-3*T],oe=v[N-2*T],ce=v[N-T],de=v[N+0],ge=v[N+T],Ee=v[N+2*T],Oe=v[N+3*T];return 4*ei[255+ce-de]+ei[255+oe-ge]>U?0:ei[255+v[N-4*T]-re]<=Y&&ei[255+re-oe]<=Y&&ei[255+oe-ce]<=Y&&ei[255+Oe-Ee]<=Y&&ei[255+Ee-ge]<=Y&&ei[255+ge-de]<=Y}function wi(v,N,T,U){var Y=2*U+1;for(U=0;16>U;++U)Xc(v,N+U,T,Y)&&al(v,N+U,T)}function Ja(v,N,T,U){var Y=2*U+1;for(U=0;16>U;++U)Xc(v,N+U*T,1,Y)&&al(v,N+U*T,1)}function Qa(v,N,T,U){var Y;for(Y=3;0<Y;--Y)wi(v,N+=4*T,T,U)}function Ef(v,N,T,U){var Y;for(Y=3;0<Y;--Y)Ja(v,N+=4,T,U)}function _i(v,N,T,U,Y,re,oe,ce){for(re=2*re+1;0<Y--;){if(hd(v,N,T,re,oe))if(Gl(v,N,T,ce))al(v,N,T);else{var de=v,ge=N,Ee=T,Oe=de[ge-2*Ee],Me=de[ge-Ee],Le=de[ge+0],ot=de[ge+Ee],Ye=de[ge+2*Ee],Ce=27*(tt=Xi[1020+3*(Le-Me)+Xi[1020+Oe-ot]])+63>>7,Fe=18*tt+63>>7,tt=9*tt+63>>7;de[ge-3*Ee]=Js[255+de[ge-3*Ee]+tt],de[ge-2*Ee]=Js[255+Oe+Fe],de[ge-Ee]=Js[255+Me+Ce],de[ge+0]=Js[255+Le-Ce],de[ge+Ee]=Js[255+ot-Fe],de[ge+2*Ee]=Js[255+Ye-tt]}N+=U}}function ca(v,N,T,U,Y,re,oe,ce){for(re=2*re+1;0<Y--;){if(hd(v,N,T,re,oe))if(Gl(v,N,T,ce))al(v,N,T);else{var de=v,ge=N,Ee=T,Oe=de[ge-Ee],Me=de[ge+0],Le=de[ge+Ee],ot=uu[112+((Ye=3*(Me-Oe))+4>>3)],Ye=uu[112+(Ye+3>>3)],Ce=ot+1>>1;de[ge-2*Ee]=Js[255+de[ge-2*Ee]+Ce],de[ge-Ee]=Js[255+Oe+Ye],de[ge+0]=Js[255+Me-ot],de[ge+Ee]=Js[255+Le-Ce]}N+=U}}function Yc(v,N,T,U,Y,re){_i(v,N,T,1,16,U,Y,re)}function is(v,N,T,U,Y,re){_i(v,N,1,T,16,U,Y,re)}function il(v,N,T,U,Y,re){var oe;for(oe=3;0<oe;--oe)ca(v,N+=4*T,T,1,16,U,Y,re)}function ol(v,N,T,U,Y,re){var oe;for(oe=3;0<oe;--oe)ca(v,N+=4,1,T,16,U,Y,re)}function Xl(v,N,T,U,Y,re,oe,ce){_i(v,N,Y,1,8,re,oe,ce),_i(T,U,Y,1,8,re,oe,ce)}function pd(v,N,T,U,Y,re,oe,ce){_i(v,N,1,Y,8,re,oe,ce),_i(T,U,1,Y,8,re,oe,ce)}function Yl(v,N,T,U,Y,re,oe,ce){ca(v,N+4*Y,Y,1,8,re,oe,ce),ca(T,U+4*Y,Y,1,8,re,oe,ce)}function Kc(v,N,T,U,Y,re,oe,ce){ca(v,N+4,1,Y,8,re,oe,ce),ca(T,U+4,1,Y,8,re,oe,ce)}function Wi(){this.ba=new Sr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new rr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ll(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Jc(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Af(){this.ua=0,this.Wa=new ve,this.vb=new ve,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new G,this.yc=new P}function U0(){this.xb=this.a=0,this.l=new Bi,this.ca=new Sr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new E,this.Pb=0,this.wd=new E,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Af,this.ab=0,this.gc=i(4,Jc),this.Oc=0}function Qc(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Bi,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function yo(v,N,T,U,Y,re,oe){for(v=v==null?0:v[N+0],N=0;N<oe;++N)Y[re+N]=v+T[U+N]&255,v=Y[re+N]}function md(v,N,T,U,Y,re,oe){var ce;if(v==null)yo(null,null,T,U,Y,re,oe);else for(ce=0;ce<oe;++ce)Y[re+ce]=v[N+ce]+T[U+ce]&255}function cl(v,N,T,U,Y,re,oe){if(v==null)yo(null,null,T,U,Y,re,oe);else{var ce,de=v[N+0],ge=de,Ee=de;for(ce=0;ce<oe;++ce)ge=Ee+(de=v[N+ce])-ge,Ee=T[U+ce]+(-256&ge?0>ge?0:255:ge)&255,ge=de,Y[re+ce]=Ee}}function xd(v,N,T,U){var Y=N.width,re=N.o;if(e(v!=null&&N!=null),0>T||0>=U||T+U>re)return null;if(!v.Cc){if(v.ga==null){var oe;if(v.ga=new Qc,(oe=v.ga==null)||(oe=N.width*N.o,e(v.Gb.length==0),v.Gb=a(oe),v.Uc=0,v.Gb==null?oe=0:(v.mb=v.Gb,v.nb=v.Uc,v.rc=null,oe=1),oe=!oe),!oe){oe=v.ga;var ce=v.Fa,de=v.P,ge=v.qc,Ee=v.mb,Oe=v.nb,Me=de+1,Le=ge-1,ot=oe.l;if(e(ce!=null&&Ee!=null&&N!=null),Rs[0]=null,Rs[1]=yo,Rs[2]=md,Rs[3]=cl,oe.ca=Ee,oe.tb=Oe,oe.c=N.width,oe.i=N.height,e(0<oe.c&&0<oe.i),1>=ge)N=0;else if(oe.$a=ce[de+0]>>0&3,oe.Z=ce[de+0]>>2&3,oe.Lc=ce[de+0]>>4&3,de=ce[de+0]>>6&3,0>oe.$a||1<oe.$a||4<=oe.Z||1<oe.Lc||de)N=0;else if(ot.put=pr,ot.ac=yt,ot.bc=hn,ot.ma=oe,ot.width=N.width,ot.height=N.height,ot.Da=N.Da,ot.v=N.v,ot.va=N.va,ot.j=N.j,ot.o=N.o,oe.$a)e:{e(oe.$a==1),N=Je();t:for(;;){if(N==null){N=0;break e}if(e(oe!=null),oe.mc=N,N.c=oe.c,N.i=oe.i,N.l=oe.l,N.l.ma=oe,N.l.width=oe.c,N.l.height=oe.i,N.a=0,le(N.m,ce,Me,Le),!Be(oe.c,oe.i,1,N,null)||(N.ab==1&&N.gc[0].hc==3&&pe(N.s)?(oe.ic=1,ce=N.c*N.i,N.Ta=null,N.Ua=0,N.V=a(ce),N.Ba=0,N.V==null?(N.a=1,N=0):N=1):(oe.ic=0,N=He(N,oe.c)),!N))break t;N=1;break e}oe.mc=null,N=0}else N=Le>=oe.c*oe.i;oe=!N}if(oe)return null;v.ga.Lc!=1?v.Ga=0:U=re-T}e(v.ga!=null),e(T+U<=re);e:{if(N=(ce=v.ga).c,re=ce.l.o,ce.$a==0){if(Me=v.rc,Le=v.Vc,ot=v.Fa,de=v.P+1+T*N,ge=v.mb,Ee=v.nb+T*N,e(de<=v.P+v.qc),ce.Z!=0)for(e(Rs[ce.Z]!=null),oe=0;oe<U;++oe)Rs[ce.Z](Me,Le,ot,de,ge,Ee,N),Me=ge,Le=Ee,Ee+=N,de+=N;else for(oe=0;oe<U;++oe)n(ge,Ee,ot,de,N),Me=ge,Le=Ee,Ee+=N,de+=N;v.rc=Me,v.Vc=Le}else{if(e(ce.mc!=null),N=T+U,e((oe=ce.mc)!=null),e(N<=oe.i),oe.C>=N)N=1;else if(ce.ic||Ie(),ce.ic){ce=oe.V,Me=oe.Ba,Le=oe.c;var Ye=oe.i,Ce=(ot=1,de=oe.$/Le,ge=oe.$%Le,Ee=oe.m,Oe=oe.s,oe.$),Fe=Le*Ye,tt=Le*N,et=Oe.wc,at=Ce<tt?mn(Oe,ge,de):null;e(Ce<=Fe),e(N<=Ye),e(pe(Oe));t:for(;;){for(;!Ee.h&&Ce<tt;){if(ge&et||(at=mn(Oe,ge,de)),e(at!=null),q(Ee),256>(Ye=zn(at.G[0],at.H[0],Ee)))ce[Me+Ce]=Ye,++Ce,++ge>=Le&&(ge=0,++de<=N&&!(de%16)&&be(oe,de));else{if(!(280>Ye)){ot=0;break t}Ye=Un(Ye-256,Ee);var Lt,Et=zn(at.G[4],at.H[4],Ee);if(q(Ee),!(Ce>=(Et=yn(Le,Et=Un(Et,Ee)))&&Fe-Ce>=Ye)){ot=0;break t}for(Lt=0;Lt<Ye;++Lt)ce[Me+Ce+Lt]=ce[Me+Ce+Lt-Et];for(Ce+=Ye,ge+=Ye;ge>=Le;)ge-=Le,++de<=N&&!(de%16)&&be(oe,de);Ce<tt&&ge&et&&(at=mn(Oe,ge,de))}e(Ee.h==L(Ee))}be(oe,de>N?N:de);break t}!ot||Ee.h&&Ce<Fe?(ot=0,oe.a=Ee.h?5:3):oe.$=Ce,N=ot}else N=we(oe,oe.V,oe.Ba,oe.c,oe.i,N,qe);if(!N){U=0;break e}}T+U>=re&&(v.Cc=1),U=1}if(!U)return null;if(v.Cc&&((U=v.ga)!=null&&(U.mc=null),v.ga=null,0<v.Ga))return alert("todo:WebPDequantizeLevels"),null}return v.nb+T*Y}function j(v,N,T,U,Y,re){for(;0<Y--;){var oe,ce=v,de=N+(T?1:0),ge=v,Ee=N+(T?0:3);for(oe=0;oe<U;++oe){var Oe=ge[Ee+4*oe];Oe!=255&&(Oe*=32897,ce[de+4*oe+0]=ce[de+4*oe+0]*Oe>>23,ce[de+4*oe+1]=ce[de+4*oe+1]*Oe>>23,ce[de+4*oe+2]=ce[de+4*oe+2]*Oe>>23)}N+=re}}function J(v,N,T,U,Y){for(;0<U--;){var re;for(re=0;re<T;++re){var oe=v[N+2*re+0],ce=15&(ge=v[N+2*re+1]),de=4369*ce,ge=(240&ge|ge>>4)*de>>16;v[N+2*re+0]=(240&oe|oe>>4)*de>>16&240|(15&oe|oe<<4)*de>>16>>4&15,v[N+2*re+1]=240&ge|ce}N+=Y}}function _e(v,N,T,U,Y,re,oe,ce){var de,ge,Ee=255;for(ge=0;ge<Y;++ge){for(de=0;de<U;++de){var Oe=v[N+de];re[oe+4*de]=Oe,Ee&=Oe}N+=T,oe+=ce}return Ee!=255}function je(v,N,T,U,Y){var re;for(re=0;re<Y;++re)T[U+re]=v[N+re]>>8}function Ie(){ua=j,sn=J,Zr=_e,On=je}function Ze(v,N,T){R[v]=function(U,Y,re,oe,ce,de,ge,Ee,Oe,Me,Le,ot,Ye,Ce,Fe,tt,et){var at,Lt=et-1>>1,Et=ce[de+0]|ge[Ee+0]<<16,Zt=Oe[Me+0]|Le[ot+0]<<16;e(U!=null);var At=3*Et+Zt+131074>>2;for(N(U[Y+0],255&At,At>>16,Ye,Ce),re!=null&&(At=3*Zt+Et+131074>>2,N(re[oe+0],255&At,At>>16,Fe,tt)),at=1;at<=Lt;++at){var Or=ce[de+at]|ge[Ee+at]<<16,Mr=Oe[Me+at]|Le[ot+at]<<16,Pr=Et+Or+Zt+Mr+524296,wr=Pr+2*(Or+Zt)>>3;At=wr+Et>>1,Et=(Pr=Pr+2*(Et+Mr)>>3)+Or>>1,N(U[Y+2*at-1],255&At,At>>16,Ye,Ce+(2*at-1)*T),N(U[Y+2*at-0],255&Et,Et>>16,Ye,Ce+(2*at-0)*T),re!=null&&(At=Pr+Zt>>1,Et=wr+Mr>>1,N(re[oe+2*at-1],255&At,At>>16,Fe,tt+(2*at-1)*T),N(re[oe+2*at+0],255&Et,Et>>16,Fe,tt+(2*at+0)*T)),Et=Or,Zt=Mr}1&et||(At=3*Et+Zt+131074>>2,N(U[Y+et-1],255&At,At>>16,Ye,Ce+(et-1)*T),re!=null&&(At=3*Zt+Et+131074>>2,N(re[oe+et-1],255&At,At>>16,Fe,tt+(et-1)*T)))}}function dt(){fa[Tf]=Eg,fa[pl]=ml,fa[Ip]=Ag,fa[wd]=pu,fa[_d]=oc,fa[an]=Ed,fa[Ff]=W0,fa[du]=ml,fa[sc]=pu,fa[Nd]=oc,fa[Sd]=Ed}function Tt(v){return v&-16384?0>v?0:255:v>>xl}function Jt(v,N){return Tt((19077*v>>8)+(26149*N>>8)-14234)}function yr(v,N,T){return Tt((19077*v>>8)-(6419*N>>8)-(13320*T>>8)+8708)}function vr(v,N){return Tt((19077*v>>8)+(33050*N>>8)-17685)}function Fr(v,N,T,U,Y){U[Y+0]=Jt(v,T),U[Y+1]=yr(v,N,T),U[Y+2]=vr(v,N)}function kn(v,N,T,U,Y){U[Y+0]=vr(v,N),U[Y+1]=yr(v,N,T),U[Y+2]=Jt(v,T)}function Rn(v,N,T,U,Y){var re=yr(v,N,T);N=re<<3&224|vr(v,N)>>3,U[Y+0]=248&Jt(v,T)|re>>5,U[Y+1]=N}function Yn(v,N,T,U,Y){var re=240&vr(v,N)|15;U[Y+0]=240&Jt(v,T)|yr(v,N,T)>>4,U[Y+1]=re}function Ps(v,N,T,U,Y){U[Y+0]=255,Fr(v,N,T,U,Y+1)}function ys(v,N,T,U,Y){kn(v,N,T,U,Y),U[Y+3]=255}function Ni(v,N,T,U,Y){Fr(v,N,T,U,Y),U[Y+3]=255}function Ba(v,N){return 0>v?0:v>N?N:v}function Za(v,N,T){R[v]=function(U,Y,re,oe,ce,de,ge,Ee,Oe){for(var Me=Ee+(-2&Oe)*T;Ee!=Me;)N(U[Y+0],re[oe+0],ce[de+0],ge,Ee),N(U[Y+1],re[oe+0],ce[de+0],ge,Ee+T),Y+=2,++oe,++de,Ee+=2*T;1&Oe&&N(U[Y+0],re[oe+0],ce[de+0],ge,Ee)}}function ul(v,N,T){return T==0?v==0?N==0?6:5:N==0?4:0:T}function gd(v,N,T,U,Y){switch(v>>>30){case 3:No(N,T,U,Y,0);break;case 2:Hr(N,T,U,Y);break;case 1:Ds(N,T,U,Y)}}function Zc(v,N){var T,U,Y=N.M,re=N.Nb,oe=v.oc,ce=v.pc+40,de=v.oc,ge=v.pc+584,Ee=v.oc,Oe=v.pc+600;for(T=0;16>T;++T)oe[ce+32*T-1]=129;for(T=0;8>T;++T)de[ge+32*T-1]=129,Ee[Oe+32*T-1]=129;for(0<Y?oe[ce-1-32]=de[ge-1-32]=Ee[Oe-1-32]=129:(s(oe,ce-32-1,127,21),s(de,ge-32-1,127,9),s(Ee,Oe-32-1,127,9)),U=0;U<v.za;++U){var Me=N.ya[N.aa+U];if(0<U){for(T=-1;16>T;++T)n(oe,ce+32*T-4,oe,ce+32*T+12,4);for(T=-1;8>T;++T)n(de,ge+32*T-4,de,ge+32*T+4,4),n(Ee,Oe+32*T-4,Ee,Oe+32*T+4,4)}var Le=v.Gd,ot=v.Hd+U,Ye=Me.ad,Ce=Me.Hc;if(0<Y&&(n(oe,ce-32,Le[ot].y,0,16),n(de,ge-32,Le[ot].f,0,8),n(Ee,Oe-32,Le[ot].ea,0,8)),Me.Za){var Fe=oe,tt=ce-32+16;for(0<Y&&(U>=v.za-1?s(Fe,tt,Le[ot].y[15],4):n(Fe,tt,Le[ot+1].y,0,4)),T=0;4>T;T++)Fe[tt+128+T]=Fe[tt+256+T]=Fe[tt+384+T]=Fe[tt+0+T];for(T=0;16>T;++T,Ce<<=2)Fe=oe,tt=ce+V0[T],ti[Me.Ob[T]](Fe,tt),gd(Ce,Ye,16*+T,Fe,tt)}else if(Fe=ul(U,Y,Me.Ob[0]),Qs[Fe](oe,ce),Ce!=0)for(T=0;16>T;++T,Ce<<=2)gd(Ce,Ye,16*+T,oe,ce+V0[T]);for(T=Me.Gc,Fe=ul(U,Y,Me.Dd),da[Fe](de,ge),da[Fe](Ee,Oe),Ce=Ye,Fe=de,tt=ge,255&(Me=T>>0)&&(170&Me?So(Ce,256,Fe,tt):Ua(Ce,256,Fe,tt)),Me=Ee,Ce=Oe,255&(T>>=8)&&(170&T?So(Ye,320,Me,Ce):Ua(Ye,320,Me,Ce)),Y<v.Ub-1&&(n(Le[ot].y,0,oe,ce+480,16),n(Le[ot].f,0,de,ge+224,8),n(Le[ot].ea,0,Ee,Oe+224,8)),T=8*re*v.B,Le=v.sa,ot=v.ta+16*U+16*re*v.R,Ye=v.qa,Me=v.ra+8*U+T,Ce=v.Ha,Fe=v.Ia+8*U+T,T=0;16>T;++T)n(Le,ot+T*v.R,oe,ce+32*T,16);for(T=0;8>T;++T)n(Ye,Me+T*v.B,de,ge+32*T,8),n(Ce,Fe+T*v.B,Ee,Oe+32*T,8)}}function Kl(v,N,T,U,Y,re,oe,ce,de){var ge=[0],Ee=[0],Oe=0,Me=de!=null?de.kd:0,Le=de??new ll;if(v==null||12>T)return 7;Le.data=v,Le.w=N,Le.ha=T,N=[N],T=[T],Le.gb=[Le.gb];e:{var ot=N,Ye=T,Ce=Le.gb;if(e(v!=null),e(Ye!=null),e(Ce!=null),Ce[0]=0,12<=Ye[0]&&!r(v,ot[0],"RIFF")){if(r(v,ot[0]+8,"WEBP")){Ce=3;break e}var Fe=nt(v,ot[0]+4);if(12>Fe||4294967286<Fe){Ce=3;break e}if(Me&&Fe>Ye[0]-8){Ce=7;break e}Ce[0]=Fe,ot[0]+=12,Ye[0]-=12}Ce=0}if(Ce!=0)return Ce;for(Fe=0<Le.gb[0],T=T[0];;){e:{var tt=v;Ye=N,Ce=T;var et=ge,at=Ee,Lt=ot=[0];if((At=Oe=[Oe])[0]=0,8>Ce[0])Ce=7;else{if(!r(tt,Ye[0],"VP8X")){if(nt(tt,Ye[0]+4)!=10){Ce=3;break e}if(18>Ce[0]){Ce=7;break e}var Et=nt(tt,Ye[0]+8),Zt=1+ue(tt,Ye[0]+12);if(2147483648<=Zt*(tt=1+ue(tt,Ye[0]+15))){Ce=3;break e}Lt!=null&&(Lt[0]=Et),et!=null&&(et[0]=Zt),at!=null&&(at[0]=tt),Ye[0]+=18,Ce[0]-=18,At[0]=1}Ce=0}}if(Oe=Oe[0],ot=ot[0],Ce!=0)return Ce;if(Ye=!!(2&ot),!Fe&&Oe)return 3;if(re!=null&&(re[0]=!!(16&ot)),oe!=null&&(oe[0]=Ye),ce!=null&&(ce[0]=0),oe=ge[0],ot=Ee[0],Oe&&Ye&&de==null){Ce=0;break}if(4>T){Ce=7;break}if(Fe&&Oe||!Fe&&!Oe&&!r(v,N[0],"ALPH")){T=[T],Le.na=[Le.na],Le.P=[Le.P],Le.Sa=[Le.Sa];e:{Et=v,Ce=N,Fe=T;var At=Le.gb;et=Le.na,at=Le.P,Lt=Le.Sa,Zt=22,e(Et!=null),e(Fe!=null),tt=Ce[0];var Or=Fe[0];for(e(et!=null),e(Lt!=null),et[0]=null,at[0]=null,Lt[0]=0;;){if(Ce[0]=tt,Fe[0]=Or,8>Or){Ce=7;break e}var Mr=nt(Et,tt+4);if(4294967286<Mr){Ce=3;break e}var Pr=8+Mr+1&-2;if(Zt+=Pr,0<At&&Zt>At){Ce=3;break e}if(!r(Et,tt,"VP8 ")||!r(Et,tt,"VP8L")){Ce=0;break e}if(Or[0]<Pr){Ce=7;break e}r(Et,tt,"ALPH")||(et[0]=Et,at[0]=tt+8,Lt[0]=Mr),tt+=Pr,Or-=Pr}}if(T=T[0],Le.na=Le.na[0],Le.P=Le.P[0],Le.Sa=Le.Sa[0],Ce!=0)break}T=[T],Le.Ja=[Le.Ja],Le.xa=[Le.xa];e:if(At=v,Ce=N,Fe=T,et=Le.gb[0],at=Le.Ja,Lt=Le.xa,Et=Ce[0],tt=!r(At,Et,"VP8 "),Zt=!r(At,Et,"VP8L"),e(At!=null),e(Fe!=null),e(at!=null),e(Lt!=null),8>Fe[0])Ce=7;else{if(tt||Zt){if(At=nt(At,Et+4),12<=et&&At>et-12){Ce=3;break e}if(Me&&At>Fe[0]-8){Ce=7;break e}at[0]=At,Ce[0]+=8,Fe[0]-=8,Lt[0]=Zt}else Lt[0]=5<=Fe[0]&&At[Et+0]==47&&!(At[Et+4]>>5),at[0]=Fe[0];Ce=0}if(T=T[0],Le.Ja=Le.Ja[0],Le.xa=Le.xa[0],N=N[0],Ce!=0)break;if(4294967286<Le.Ja)return 3;if(ce==null||Ye||(ce[0]=Le.xa?2:1),oe=[oe],ot=[ot],Le.xa){if(5>T){Ce=7;break}ce=oe,Me=ot,Ye=re,v==null||5>T?v=0:5<=T&&v[N+0]==47&&!(v[N+4]>>5)?(Fe=[0],At=[0],et=[0],le(at=new E,v,N,T),Mt(at,Fe,At,et)?(ce!=null&&(ce[0]=Fe[0]),Me!=null&&(Me[0]=At[0]),Ye!=null&&(Ye[0]=et[0]),v=1):v=0):v=0}else{if(10>T){Ce=7;break}ce=ot,v==null||10>T||!_f(v,N+3,T-3)?v=0:(Me=v[N+0]|v[N+1]<<8|v[N+2]<<16,Ye=16383&(v[N+7]<<8|v[N+6]),v=16383&(v[N+9]<<8|v[N+8]),1&Me||3<(Me>>1&7)||!(Me>>4&1)||Me>>5>=Le.Ja||!Ye||!v?v=0:(oe&&(oe[0]=Ye),ce&&(ce[0]=v),v=1))}if(!v||(oe=oe[0],ot=ot[0],Oe&&(ge[0]!=oe||Ee[0]!=ot)))return 3;de!=null&&(de[0]=Le,de.offset=N-de.w,e(4294967286>N-de.w),e(de.offset==de.ha-T));break}return Ce==0||Ce==7&&Oe&&de==null?(re!=null&&(re[0]|=Le.na!=null&&0<Le.na.length),U!=null&&(U[0]=oe),Y!=null&&(Y[0]=ot),0):Ce}function eu(v,N,T){var U=N.width,Y=N.height,re=0,oe=0,ce=U,de=Y;if(N.Da=v!=null&&0<v.Da,N.Da&&(ce=v.cd,de=v.bd,re=v.v,oe=v.j,11>T||(re&=-2,oe&=-2),0>re||0>oe||0>=ce||0>=de||re+ce>U||oe+de>Y))return 0;if(N.v=re,N.j=oe,N.va=re+ce,N.o=oe+de,N.U=ce,N.T=de,N.da=v!=null&&0<v.da,N.da){if(!Xe(ce,de,T=[v.ib],re=[v.hb]))return 0;N.ib=T[0],N.hb=re[0]}return N.ob=v!=null&&v.ob,N.Kb=v==null||!v.Sd,N.da&&(N.ob=N.ib<3*U/4&&N.hb<3*Y/4,N.Kb=0),1}function tu(v){if(v==null)return 2;if(11>v.S){var N=v.f.RGBA;N.fb+=(v.height-1)*N.A,N.A=-N.A}else N=v.f.kb,v=v.height,N.O+=(v-1)*N.fa,N.fa=-N.fa,N.N+=(v-1>>1)*N.Ab,N.Ab=-N.Ab,N.W+=(v-1>>1)*N.Db,N.Db=-N.Db,N.F!=null&&(N.J+=(v-1)*N.lb,N.lb=-N.lb);return 0}function Jl(v,N,T,U){if(U==null||0>=v||0>=N)return 2;if(T!=null){if(T.Da){var Y=T.cd,re=T.bd,oe=-2&T.v,ce=-2&T.j;if(0>oe||0>ce||0>=Y||0>=re||oe+Y>v||ce+re>N)return 2;v=Y,N=re}if(T.da){if(!Xe(v,N,Y=[T.ib],re=[T.hb]))return 2;v=Y[0],N=re[0]}}U.width=v,U.height=N;e:{var de=U.width,ge=U.height;if(v=U.S,0>=de||0>=ge||!(v>=Tf&&13>v))v=2;else{if(0>=U.Rd&&U.sd==null){oe=re=Y=N=0;var Ee=(ce=de*Ad[v])*ge;if(11>v||(re=(ge+1)/2*(N=(de+1)/2),v==12&&(oe=(Y=de)*ge)),(ge=a(Ee+2*re+oe))==null){v=1;break e}U.sd=ge,11>v?((de=U.f.RGBA).eb=ge,de.fb=0,de.A=ce,de.size=Ee):((de=U.f.kb).y=ge,de.O=0,de.fa=ce,de.Fd=Ee,de.f=ge,de.N=0+Ee,de.Ab=N,de.Cd=re,de.ea=ge,de.W=0+Ee+re,de.Db=N,de.Ed=re,v==12&&(de.F=ge,de.J=0+Ee+2*re),de.Tc=oe,de.lb=Y)}if(N=1,Y=U.S,re=U.width,oe=U.height,Y>=Tf&&13>Y)if(11>Y)v=U.f.RGBA,N&=(ce=Math.abs(v.A))*(oe-1)+re<=v.size,N&=ce>=re*Ad[Y],N&=v.eb!=null;else{v=U.f.kb,ce=(re+1)/2,Ee=(oe+1)/2,de=Math.abs(v.fa),ge=Math.abs(v.Ab);var Oe=Math.abs(v.Db),Me=Math.abs(v.lb),Le=Me*(oe-1)+re;N&=de*(oe-1)+re<=v.Fd,N&=ge*(Ee-1)+ce<=v.Cd,N=(N&=Oe*(Ee-1)+ce<=v.Ed)&de>=re&ge>=ce&Oe>=ce,N&=v.y!=null,N&=v.f!=null,N&=v.ea!=null,Y==12&&(N&=Me>=re,N&=Le<=v.Tc,N&=v.F!=null)}else N=0;v=N?0:2}}return v!=0||T!=null&&T.fd&&(v=tu(U)),v}var In=64,ru=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],nu=24,su=32,au=8,Xs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];it("Predictor0","PredictorAdd0"),R.Predictor0=function(){return 4278190080},R.Predictor1=function(v){return v},R.Predictor2=function(v,N,T){return N[T+0]},R.Predictor3=function(v,N,T){return N[T+1]},R.Predictor4=function(v,N,T){return N[T-1]},R.Predictor5=function(v,N,T){return vt(vt(v,N[T+1]),N[T+0])},R.Predictor6=function(v,N,T){return vt(v,N[T-1])},R.Predictor7=function(v,N,T){return vt(v,N[T+0])},R.Predictor8=function(v,N,T){return vt(N[T-1],N[T+0])},R.Predictor9=function(v,N,T){return vt(N[T+0],N[T+1])},R.Predictor10=function(v,N,T){return vt(vt(v,N[T-1]),vt(N[T+0],N[T+1]))},R.Predictor11=function(v,N,T){var U=N[T+0];return 0>=Ot(U>>24&255,v>>24&255,(N=N[T-1])>>24&255)+Ot(U>>16&255,v>>16&255,N>>16&255)+Ot(U>>8&255,v>>8&255,N>>8&255)+Ot(255&U,255&v,255&N)?U:v},R.Predictor12=function(v,N,T){var U=N[T+0];return(Pt((v>>24&255)+(U>>24&255)-((N=N[T-1])>>24&255))<<24|Pt((v>>16&255)+(U>>16&255)-(N>>16&255))<<16|Pt((v>>8&255)+(U>>8&255)-(N>>8&255))<<8|Pt((255&v)+(255&U)-(255&N)))>>>0},R.Predictor13=function(v,N,T){var U=N[T-1];return(Dt((v=vt(v,N[T+0]))>>24&255,U>>24&255)<<24|Dt(v>>16&255,U>>16&255)<<16|Dt(v>>8&255,U>>8&255)<<8|Dt(v>>0&255,U>>0&255))>>>0};var Ql=R.PredictorAdd0;R.PredictorAdd1=Yt,it("Predictor2","PredictorAdd2"),it("Predictor3","PredictorAdd3"),it("Predictor4","PredictorAdd4"),it("Predictor5","PredictorAdd5"),it("Predictor6","PredictorAdd6"),it("Predictor7","PredictorAdd7"),it("Predictor8","PredictorAdd8"),it("Predictor9","PredictorAdd9"),it("Predictor10","PredictorAdd10"),it("Predictor11","PredictorAdd11"),it("Predictor12","PredictorAdd12"),it("Predictor13","PredictorAdd13");var bo=R.PredictorAdd2;bt("ColorIndexInverseTransform","MapARGB","32b",(function(v){return v>>8&255}),(function(v){return v})),bt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",(function(v){return v}),(function(v){return v>>8&255}));var Cf,Ys=R.ColorIndexInverseTransform,iu=R.MapARGB,vd=R.VP8LColorIndexInverseTransformAlpha,ou=R.MapAlpha,Vi=R.VP8LPredictorsAdd=[];Vi.length=16,(R.VP8LPredictors=[]).length=16,(R.VP8LPredictorsAdd_C=[]).length=16,(R.VP8LPredictors_C=[]).length=16;var dl,Ks,Ls,fl,wo,_o,lu,No,Hr,So,Ds,Ua,Zl,yd,ec,tc,rc,za,ko,qi,jo,Eo,hl,ks,ua,sn,Zr,On,Kn=a(511),Gi=a(2041),cu=a(225),nc=a(767),bd=0,Xi=Gi,uu=cu,Js=nc,ei=Kn,Tf=0,pl=1,Ip=2,wd=3,_d=4,an=5,Ff=6,du=7,sc=8,Nd=9,Sd=10,kd=[2,3,7],Pf=[3,3,11],ac=[280,256,256,256,40],Op=[0,1,1,1,0],Ng=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Sg=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Mp=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Lf=8,fu=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],jd=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ic=null,z0=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],H0=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Bp=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Up=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],kg=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],jg=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],$0=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Qs=[],ti=[],da=[],Yi=1,hu=2,Rs=[],fa=[];Ze("UpsampleRgbLinePair",Fr,3),Ze("UpsampleBgrLinePair",kn,3),Ze("UpsampleRgbaLinePair",Ni,4),Ze("UpsampleBgraLinePair",ys,4),Ze("UpsampleArgbLinePair",Ps,4),Ze("UpsampleRgba4444LinePair",Yn,2),Ze("UpsampleRgb565LinePair",Rn,2);var Eg=R.UpsampleRgbLinePair,Ag=R.UpsampleBgrLinePair,ml=R.UpsampleRgbaLinePair,pu=R.UpsampleBgraLinePair,oc=R.UpsampleArgbLinePair,Ed=R.UpsampleRgba4444LinePair,W0=R.UpsampleRgb565LinePair,Ao=16,Si=1<<Ao-1,en=-227,rn=482,xl=6,js=0,ha=a(256),lc=a(256),mu=a(256),pa=a(256),Df=a(rn-en),zp=a(rn-en);Za("YuvToRgbRow",Fr,3),Za("YuvToBgrRow",kn,3),Za("YuvToRgbaRow",Ni,4),Za("YuvToBgraRow",ys,4),Za("YuvToArgbRow",Ps,4),Za("YuvToRgba4444Row",Yn,2),Za("YuvToRgb565Row",Rn,2);var V0=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],cc=[0,2,8],Hp=[8,7,6,4,4,2,2,2,1,1,1,1],Co=1;this.WebPDecodeRGBA=function(v,N,T,U,Y){var re=pl,oe=new Wi,ce=new Sr;oe.ba=ce,ce.S=re,ce.width=[ce.width],ce.height=[ce.height];var de=ce.width,ge=ce.height,Ee=new Ur;if(Ee==null||v==null)var Oe=2;else e(Ee!=null),Oe=Kl(v,N,T,Ee.width,Ee.height,Ee.Pd,Ee.Qd,Ee.format,null);if(Oe!=0?de=0:(de!=null&&(de[0]=Ee.width[0]),ge!=null&&(ge[0]=Ee.height[0]),de=1),de){ce.width=ce.width[0],ce.height=ce.height[0],U!=null&&(U[0]=ce.width),Y!=null&&(Y[0]=ce.height);e:{if(U=new Bi,(Y=new ll).data=v,Y.w=N,Y.ha=T,Y.kd=1,N=[0],e(Y!=null),((v=Kl(Y.data,Y.w,Y.ha,null,null,null,N,null,Y))==0||v==7)&&N[0]&&(v=4),(N=v)==0){if(e(oe!=null),U.data=Y.data,U.w=Y.w+Y.offset,U.ha=Y.ha-Y.offset,U.put=pr,U.ac=yt,U.bc=hn,U.ma=oe,Y.xa){if((v=Je())==null){oe=1;break e}if((function(Me,Le){var ot=[0],Ye=[0],Ce=[0];t:for(;;){if(Me==null)return 0;if(Le==null)return Me.a=2,0;if(Me.l=Le,Me.a=0,le(Me.m,Le.data,Le.w,Le.ha),!Mt(Me.m,ot,Ye,Ce)){Me.a=3;break t}if(Me.xb=hu,Le.width=ot[0],Le.height=Ye[0],!Be(ot[0],Ye[0],1,Me,null))break t;return 1}return e(Me.a!=0),0})(v,U)){if(U=(N=Jl(U.width,U.height,oe.Oa,oe.ba))==0){t:{U=v;r:for(;;){if(U==null){U=0;break t}if(e(U.s.yc!=null),e(U.s.Ya!=null),e(0<U.s.Wb),e((T=U.l)!=null),e((Y=T.ma)!=null),U.xb!=0){if(U.ca=Y.ba,U.tb=Y.tb,e(U.ca!=null),!eu(Y.Oa,T,wd)){U.a=2;break r}if(!He(U,T.width)||T.da)break r;if((T.da||jt(U.ca.S))&&Ie(),11>U.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),U.ca.f.kb.F!=null&&Ie()),U.Pb&&0<U.s.ua&&U.s.vb.X==null&&!rt(U.s.vb,U.s.Wa.Xa)){U.a=1;break r}U.xb=0}if(!we(U,U.V,U.Ba,U.c,U.i,T.o,ye))break r;Y.Dc=U.Ma,U=1;break t}e(U.a!=0),U=0}U=!U}U&&(N=v.a)}else N=v.a}else{if((v=new Nn)==null){oe=1;break e}if(v.Fa=Y.na,v.P=Y.P,v.qc=Y.Sa,Nf(v,U)){if((N=Jl(U.width,U.height,oe.Oa,oe.ba))==0){if(v.Aa=0,T=oe.Oa,e((Y=v)!=null),T!=null){if(0<(de=0>(de=T.Md)?0:100<de?255:255*de/100)){for(ge=Ee=0;4>ge;++ge)12>(Oe=Y.pb[ge]).lc&&(Oe.ia=de*Hp[0>Oe.lc?0:Oe.lc]>>3),Ee|=Oe.ia;Ee&&(alert("todo:VP8InitRandom"),Y.ia=1)}Y.Ga=T.Id,100<Y.Ga?Y.Ga=100:0>Y.Ga&&(Y.Ga=0)}zl(v,U)||(N=v.a)}}else N=v.a}N==0&&oe.Oa!=null&&oe.Oa.fd&&(N=tu(oe.ba))}oe=N}re=oe!=0?null:11>re?ce.f.RGBA.eb:ce.f.kb.y}else re=null;return re};var Ad=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(R,O){for(var ee="",I=0;I<4;I++)ee+=String.fromCharCode(R[O++]);return ee}function h(R,O){return(R[O+0]<<0|R[O+1]<<8|R[O+2]<<16)>>>0}function p(R,O){return(R[O+0]<<0|R[O+1]<<8|R[O+2]<<16|R[O+3]<<24)>>>0}new c;var x=[0],m=[0],b=[],y=new c,w=t,S=(function(R,O){var ee={},I=0,P=!1,ae=0,G=0;if(ee.frames=[],!(function(W,L,F,q){for(var he=0;he<q;he++)if(W[L+he]!=F.charCodeAt(he))return!0;return!1})(R,O,"RIFF",4)){for(p(R,O+=4),O+=8;O<R.length;){var M=d(R,O),te=p(R,O+=4);O+=4;var ie=te+(1&te);switch(M){case"VP8 ":case"VP8L":ee.frames[I]===void 0&&(ee.frames[I]={}),(fe=ee.frames[I]).src_off=P?G:O-8,fe.src_size=ae+te+8,I++,P&&(P=!1,ae=0,G=0);break;case"VP8X":(fe=ee.header={}).feature_flags=R[O];var le=O+4;fe.canvas_width=1+h(R,le),le+=3,fe.canvas_height=1+h(R,le),le+=3;break;case"ALPH":P=!0,ae=ie+8,G=O-8;break;case"ANIM":(fe=ee.header).bgcolor=p(R,O),le=O+4,fe.loop_count=(K=R)[(E=le)+0]<<0|K[E+1]<<8,le+=2;break;case"ANMF":var X,fe;(fe=ee.frames[I]={}).offset_x=2*h(R,O),O+=3,fe.offset_y=2*h(R,O),O+=3,fe.width=1+h(R,O),O+=3,fe.height=1+h(R,O),O+=3,fe.duration=h(R,O),O+=3,X=R[O++],fe.dispose=1&X,fe.blend=X>>1&1}M!="ANMF"&&(O+=ie)}var K,E;return ee}})(w,0);S.response=w,S.rgbaoutput=!0,S.dataurl=!1;var k=S.header?S.header:null,A=S.frames?S.frames:null;if(k){k.loop_counter=k.loop_count,x=[k.canvas_height],m=[k.canvas_width];for(var z=0;z<A.length&&A[z].blend!=0;z++);}var H=A[0],V=y.WebPDecodeRGBA(w,H.src_off,H.src_size,m,x);H.rgba=V,H.imgwidth=m[0],H.imgheight=x[0];for(var B=0;B<m[0]*x[0]*4;B++)b[B]=V[B];return this.width=m,this.height=x,this.data=b,this}(function(t){var e=function(){return typeof q2=="function"},r=function(x,m,b,y){var w=4,S=i;switch(y){case t.image_compression.FAST:w=1,S=a;break;case t.image_compression.MEDIUM:w=6,S=l;break;case t.image_compression.SLOW:w=9,S=c}x=n(x,m,b,S);var k=q2(x,{level:w});return t.__addimage__.arrayBufferToBinaryString(k)},n=function(x,m,b,y){for(var w,S,k,A=x.length/m,z=new Uint8Array(x.length+A),H=h(),V=0;V<A;V+=1){if(k=V*m,w=x.subarray(k,k+m),y)z.set(y(w,b,S),k+V);else{for(var B,R=H.length,O=[];B<R;B+=1)O[B]=H[B](w,b,S);var ee=p(O.concat());z.set(O[ee],k+V)}S=w}return z},s=function(x){var m=Array.apply([],x);return m.unshift(0),m},a=function(x,m){var b,y=[],w=x.length;y[0]=1;for(var S=0;S<w;S+=1)b=x[S-m]||0,y[S+1]=x[S]-b+256&255;return y},i=function(x,m,b){var y,w=[],S=x.length;w[0]=2;for(var k=0;k<S;k+=1)y=b&&b[k]||0,w[k+1]=x[k]-y+256&255;return w},l=function(x,m,b){var y,w,S=[],k=x.length;S[0]=3;for(var A=0;A<k;A+=1)y=x[A-m]||0,w=b&&b[A]||0,S[A+1]=x[A]+256-(y+w>>>1)&255;return S},c=function(x,m,b){var y,w,S,k,A=[],z=x.length;A[0]=4;for(var H=0;H<z;H+=1)y=x[H-m]||0,w=b&&b[H]||0,S=b&&b[H-m]||0,k=d(y,w,S),A[H+1]=x[H]-k+256&255;return A},d=function(x,m,b){if(x===m&&m===b)return x;var y=Math.abs(m-b),w=Math.abs(x-b),S=Math.abs(x+m-b-b);return y<=w&&y<=S?x:w<=S?m:b},h=function(){return[s,a,i,l,c]},p=function(x){var m=x.map((function(b){return b.reduce((function(y,w){return y+Math.abs(w)}),0)}));return m.indexOf(Math.min.apply(null,m))};t.processPNG=function(x,m,b,y){var w,S,k,A,z,H,V,B,R,O,ee,I,P,ae,G,M=this.decode.FLATE_DECODE,te="";if(this.__addimage__.isArrayBuffer(x)&&(x=new Uint8Array(x)),this.__addimage__.isArrayBufferView(x)){if(x=(k=new RU(x)).imgData,S=k.bits,w=k.colorSpace,z=k.colors,[4,6].indexOf(k.colorType)!==-1){if(k.bits===8){R=(B=k.pixelBitlength==32?new Uint32Array(k.decodePixels().buffer):k.pixelBitlength==16?new Uint16Array(k.decodePixels().buffer):new Uint8Array(k.decodePixels().buffer)).length,ee=new Uint8Array(R*k.colors),O=new Uint8Array(R);var ie,le=k.pixelBitlength-k.bits;for(ae=0,G=0;ae<R;ae++){for(P=B[ae],ie=0;ie<le;)ee[G++]=P>>>ie&255,ie+=k.bits;O[ae]=P>>>ie&255}}if(k.bits===16){R=(B=new Uint32Array(k.decodePixels().buffer)).length,ee=new Uint8Array(R*(32/k.pixelBitlength)*k.colors),O=new Uint8Array(R*(32/k.pixelBitlength)),I=k.colors>1,ae=0,G=0;for(var X=0;ae<R;)P=B[ae++],ee[G++]=P>>>0&255,I&&(ee[G++]=P>>>16&255,P=B[ae++],ee[G++]=P>>>0&255),O[X++]=P>>>16&255;S=8}y!==t.image_compression.NONE&&e()?(x=r(ee,k.width*k.colors,k.colors,y),V=r(O,k.width,1,y)):(x=ee,V=O,M=void 0)}if(k.colorType===3&&(w=this.color_spaces.INDEXED,H=k.palette,k.transparency.indexed)){var fe=k.transparency.indexed,K=0;for(ae=0,R=fe.length;ae<R;++ae)K+=fe[ae];if((K/=255)===R-1&&fe.indexOf(0)!==-1)A=[fe.indexOf(0)];else if(K!==R){for(B=k.decodePixels(),O=new Uint8Array(B.length),ae=0,R=B.length;ae<R;ae++)O[ae]=fe[B[ae]];V=r(O,k.width,1)}}var E=(function(W){var L;switch(W){case t.image_compression.FAST:L=11;break;case t.image_compression.MEDIUM:L=13;break;case t.image_compression.SLOW:L=14;break;default:L=12}return L})(y);return M===this.decode.FLATE_DECODE&&(te="/Predictor "+E+" "),te+="/Colors "+z+" /BitsPerComponent "+S+" /Columns "+k.width,(this.__addimage__.isArrayBuffer(x)||this.__addimage__.isArrayBufferView(x))&&(x=this.__addimage__.arrayBufferToBinaryString(x)),(V&&this.__addimage__.isArrayBuffer(V)||this.__addimage__.isArrayBufferView(V))&&(V=this.__addimage__.arrayBufferToBinaryString(V)),{alias:b,data:x,index:m,filter:M,decodeParameters:te,transparency:A,palette:H,sMask:V,predictor:E,width:k.width,height:k.height,bitsPerComponent:S,colorSpace:w}}}})(or.API),(function(t){t.processGIF89A=function(e,r,n,s){var a=new IU(e),i=a.width,l=a.height,c=[];a.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:i,height:l},h=new W1(100).encode(d,100);return t.processJPEG.call(this,h,r,n,s)},t.processGIF87A=t.processGIF89A})(or.API),zo.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:s,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},zo.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){gn.log("bit decode error:"+r)}},zo.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<e;s++)for(var a=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[a>>7-l&1];this.data[i+4*l]=c.blue,this.data[i+4*l+1]=c.green,this.data[i+4*l+2]=c.red,this.data[i+4*l+3]=255}r!==0&&(this.pos+=4-r)}},zo.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<t;s++){var a=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+2*s*4,l=a>>4,c=15&a,d=this.palette[l];if(this.data[i]=d.blue,this.data[i+1]=d.green,this.data[i+2]=d.red,this.data[i+3]=255,2*s+1>=this.width)break;d=this.palette[c],this.data[i+4]=d.blue,this.data[i+4+1]=d.green,this.data[i+4+2]=d.red,this.data[i+4+3]=255}e!==0&&(this.pos+=4-e)}},zo.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(s<this.palette.length){var i=this.palette[s];this.data[a]=i.red,this.data[a+1]=i.green,this.data[a+2]=i.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},zo.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(a&e)/e*255|0,l=(a>>5&e)/e*255|0,c=(a>>10&e)/e*255|0,d=a>>15?255:0,h=n*this.width*4+4*s;this.data[h]=c,this.data[h+1]=l,this.data[h+2]=i,this.data[h+3]=d}this.pos+=t}},zo.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(i&e)/e*255|0,c=(i>>5&r)/r*255|0,d=(i>>11)/e*255|0,h=s*this.width*4+4*a;this.data[h]=d,this.data[h+1]=c,this.data[h+2]=l,this.data[h+3]=255}this.pos+=t}},zo.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=e*this.width*4+4*r;this.data[i]=a,this.data[i+1]=s,this.data[i+2]=n,this.data[i+3]=255}this.pos+=this.width%4}},zo.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=a,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=i}},zo.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,r,n,s){var a=new zo(e,!1),i=a.width,l=a.height,c={data:a.getData(),width:i,height:l},d=new W1(100).encode(c,100);return t.processJPEG.call(this,d,r,n,s)}})(or.API),e_.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,r,n,s){var a=new e_(e),i=a.width,l=a.height,c={data:a.getData(),width:i,height:l},d=new W1(100).encode(c,100);return t.processJPEG.call(this,d,r,n,s)}})(or.API),or.API.processRGBA=function(t,e,r){for(var n=t.data,s=n.length,a=new Uint8Array(s/4*3),i=new Uint8Array(s/4),l=0,c=0,d=0;d<s;d+=4){var h=n[d],p=n[d+1],x=n[d+2],m=n[d+3];a[l++]=h,a[l++]=p,a[l++]=x,i[c++]=m}var b=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:b,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},or.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",(function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")})),this.internal.languageSettings.isSubscribed=!0)),this},t0=or.API,Lm=t0.getCharWidthsArray=function(t,e){var r,n,s=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),i=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,d=e.kerning?e.kerning:s.metadata.Unicode.kerning,h=d.fof?d.fof:1,p=e.doKerning!==!1,x=0,m=t.length,b=0,y=l[0]||c,w=[];for(r=0;r<m;r++)n=t.charCodeAt(r),typeof s.metadata.widthOfString=="function"?w.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+i*(1e3/a)||0)/1e3):(x=p&&dn(d[n])==="object"&&!isNaN(parseInt(d[n][b],10))?d[n][b]/h:0,w.push((l[n]||y)/c+x)),b=n;return w},Kw=t0.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),s=e.charSpace||this.internal.getCharSpace();return t0.processArabic&&(t=t0.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,s)/r:Lm.apply(this,arguments).reduce((function(a,i){return a+i}),0)},Jw=function(t,e,r,n){for(var s=[],a=0,i=t.length,l=0;a!==i&&l+e[a]<r;)l+=e[a],a++;s.push(t.slice(0,a));var c=a;for(l=0;a!==i;)l+e[a]>n&&(s.push(t.slice(c,a)),l=0,c=a),l+=e[a],a++;return c!==a&&s.push(t.slice(c,a)),s},Qw=function(t,e,r){r||(r={});var n,s,a,i,l,c,d,h=[],p=[h],x=r.textIndent||0,m=0,b=0,y=t.split(" "),w=Lm.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?y[0].length+2:r.lineIndent||0){var S=Array(c).join(" "),k=[];y.map((function(z){(z=z.split(/\s*\n/)).length>1?k=k.concat(z.map((function(H,V){return(V&&H.length?`
`:"")+H}))):k.push(z[0])})),y=k,c=Kw.apply(this,[S,r])}for(a=0,i=y.length;a<i;a++){var A=0;if(n=y[a],c&&n[0]==`
`&&(n=n.substr(1),A=1),x+m+(b=(s=Lm.apply(this,[n,r])).reduce((function(z,H){return z+H}),0))>e||A){if(b>e){for(l=Jw.apply(this,[n,s,e-(x+m),e]),h.push(l.shift()),h=[l.pop()];l.length;)p.push([l.shift()]);b=s.slice(n.length-(h[0]?h[0].length:0)).reduce((function(z,H){return z+H}),0)}else h=[n];p.push(h),x=b+c,m=w}else h.push(n),x+=m+b,m=w}return d=c?function(z,H){return(H?S:"")+z.join(" ")}:function(z){return z.join(" ")},p.map(d)},t0.splitTextToSize=function(t,e,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var p=this.internal.getFont(h.fontName,h.fontStyle);return p.metadata.Unicode?{widths:p.metadata.Unicode.widths||{0:1},kerning:p.metadata.Unicode.kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var i=1*this.internal.scaleFactor*e/s;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,a.lineIndent=r.lineIndent;var l,c,d=[];for(l=0,c=n.length;l<c;l++)d=d.concat(Qw.apply(this,[n[l],i,a]));return d},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",r={},n={},s=0;s<e.length;s++)r[e[s]]="0123456789abcdef"[s],n["0123456789abcdef"[s]]=e[s];var a=function(p){return"0x"+parseInt(p,10).toString(16)},i=t.__fontmetrics__.compress=function(p){var x,m,b,y,w=["{"];for(var S in p){if(x=p[S],isNaN(parseInt(S,10))?m="'"+S+"'":(S=parseInt(S,10),m=(m=a(S).slice(2)).slice(0,-1)+n[m.slice(-1)]),typeof x=="number")x<0?(b=a(x).slice(3),y="-"):(b=a(x).slice(2),y=""),b=y+b.slice(0,-1)+n[b.slice(-1)];else{if(dn(x)!=="object")throw new Error("Don't know what to do with value type "+dn(x)+".");b=i(x)}w.push(m+b)}return w.push("}"),w.join("")},l=t.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var x,m,b,y,w={},S=1,k=w,A=[],z="",H="",V=p.length-1,B=1;B<V;B+=1)(y=p[B])=="'"?x?(b=x.join(""),x=void 0):x=[]:x?x.push(y):y=="{"?(A.push([k,b]),k={},b=void 0):y=="}"?((m=A.pop())[0][m[1]]=k,b=void 0,k=m[0]):y=="-"?S=-1:b===void 0?r.hasOwnProperty(y)?(z+=r[y],b=parseInt(z,16)*S,S=1,z=""):z+=y:r.hasOwnProperty(y)?(H+=r[y],k[b]=parseInt(H,16)*S,S=1,b=void 0,H=""):H+=y;return w},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},h={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(p){var x=p.font,m=h.Unicode[x.postScriptName];m&&(x.metadata.Unicode={},x.metadata.Unicode.widths=m.widths,x.metadata.Unicode.kerning=m.kerning);var b=d.Unicode[x.postScriptName];b&&(x.metadata.Unicode.encoding=b,x.encoding=b.codePages[0])}])})(or.API),(function(t){var e=function(r){for(var n=r.length,s=new Uint8Array(n),a=0;a<n;a++)s[a]=r.charCodeAt(a);return s};t.API.events.push(["addFont",function(r){var n=void 0,s=r.font,a=r.instance;if(!s.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=a.existsFileInVFS(s.postScriptName)===!1?a.loadFile(s.postScriptName):a.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(i,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(Lh(l)),i.metadata=t.API.TTFFont.open(l),i.metadata.Unicode=i.metadata.Unicode||{encoding:{},kerning:{},widths:[]},i.metadata.glyIdsUsed=[0]})(s,n)}}])})(or),(function(t){function e(){return(dr.canvg?Promise.resolve(dr.canvg):Vh(()=>import("./index.es-CT1lZdcc.js"),[])).catch((function(r){return Promise.reject(new Error("Could not load canvg: "+r))})).then((function(r){return r.default?r.default:r}))}or.API.addSvgAsImage=function(r,n,s,a,i,l,c,d){if(isNaN(n)||isNaN(s))throw gn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(i))throw gn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var h=document.createElement("canvas");h.width=a,h.height=i;var p=h.getContext("2d");p.fillStyle="#fff",p.fillRect(0,0,h.width,h.height);var x={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return e().then((function(b){return b.fromString(p,r,x)}),(function(){return Promise.reject(new Error("Could not load canvg."))})).then((function(b){return b.render(x)})).then((function(){m.addImage(h.toDataURL("image/jpeg",1),n,s,a,i,c,d)}))}})(),or.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(e,r);return this},or.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,s,a,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(i),c=[],d=0,h=0,p=0;function x(b,y){var w,S=!1;for(w=0;w<b.length;w+=1)b[w]===y&&(S=!0);return S}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var m=l.length;for(p=0;p<m;p+=1)r[l[p]].value=r[l[p]].defaultValue,r[l[p]].explicitSet=!1}if(dn(t)==="object"){for(s in t)if(a=t[s],x(l,s)&&a!==void 0){if(r[s].type==="boolean"&&typeof a=="boolean")r[s].value=a;else if(r[s].type==="name"&&x(r[s].valueSet,a))r[s].value=a;else if(r[s].type==="integer"&&Number.isInteger(a))r[s].value=a;else if(r[s].type==="array"){for(d=0;d<a.length;d+=1)if(n=!0,a[d].length===1&&typeof a[d][0]=="number")c.push(String(a[d]-1));else if(a[d].length>1){for(h=0;h<a[d].length;h+=1)typeof a[d][h]!="number"&&(n=!1);n===!0&&c.push([a[d][0]-1,a[d][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",(function(){var b,y=[];for(b in r)r[b].explicitSet===!0&&(r[b].type==="name"?y.push("/"+b+" /"+r[b].value):y.push("/"+b+" "+r[b].value));y.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+y.join(`
`)+`
>>`)})),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),i=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=a.length+i.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(s+a+i+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}})(or.API),(function(t){var e=t.API,r=e.pdfEscape16=function(a,i){for(var l,c=i.metadata.Unicode.widths,d=["","0","00","000","0000"],h=[""],p=0,x=a.length;p<x;++p){if(l=i.metadata.characterToGlyph(a.charCodeAt(p)),i.metadata.glyIdsUsed.push(l),i.metadata.toUnicode[l]=a.charCodeAt(p),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(i.metadata.widthOfGlyph(l),10)])),l=="0")return h.join("");l=l.toString(16),h.push(d[4-l.length],l)}return h.join("")},n=function(a){var i,l,c,d,h,p,x;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],p=0,x=(l=Object.keys(a).sort((function(m,b){return m-b}))).length;p<x;p++)i=l[p],c.length>=100&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),a[i]!==void 0&&a[i]!==null&&typeof a[i].toString=="function"&&(d=("0000"+a[i].toString(16)).slice(-4),i=("0000"+(+i).toString(16)).slice(-4),c.push("<"+i+"><"+d+">"));return c.length&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),h+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(i){var l=i.font,c=i.out,d=i.newObject,h=i.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var p=l.metadata.Unicode.widths,x=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),m="",b=0;b<x.length;b++)m+=String.fromCharCode(x[b]);var y=d();h({data:m,addLength1:!0,objectId:y}),c("endobj");var w=d();h({data:n(l.metadata.toUnicode),addLength1:!0,objectId:w}),c("endobj");var S=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+i0(l.fontName)),c("/FontFile2 "+y+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var k=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+i0(l.fontName)),c("/FontDescriptor "+S+" 0 R"),c("/W "+t.API.PDFObject.convert(p)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+w+" 0 R"),c("/BaseFont /"+i0(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+k+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(i){var l=i.font,c=i.out,d=i.newObject,h=i.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var p=l.metadata.rawData,x="",m=0;m<p.length;m++)x+=String.fromCharCode(p[m]);var b=d();h({data:x,addLength1:!0,objectId:b}),c("endobj");var y=d();h({data:n(l.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var w=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+b+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+i0(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var S=0;S<l.metadata.hmtx.widths.length;S++)l.metadata.hmtx.widths[S]=parseInt(l.metadata.hmtx.widths[S]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+y+" 0 R/BaseFont/"+i0(l.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]);var s=function(a){var i,l=a.text||"",c=a.x,d=a.y,h=a.options||{},p=a.mutex||{},x=p.pdfEscape,m=p.activeFontKey,b=p.fonts,y=m,w="",S=0,k="",A=b[y].encoding;if(b[y].encoding!=="Identity-H")return{text:l,x:c,y:d,options:h,mutex:p};for(k=l,y=m,Array.isArray(l)&&(k=l[0]),S=0;S<k.length;S+=1)b[y].metadata.hasOwnProperty("cmap")&&(i=b[y].metadata.cmap.unicode.codeMap[k[S].charCodeAt(0)]),i||k[S].charCodeAt(0)<256&&b[y].metadata.hasOwnProperty("Unicode")?w+=k[S]:w+="";var z="";return parseInt(y.slice(1))<14||A==="WinAnsiEncoding"?z=x(w,y).split("").map((function(H){return H.charCodeAt(0).toString(16)})).join(""):A==="Identity-H"&&(z=r(w,b[y])),p.isHex=!0,{text:z,x:c,y:d,options:h,mutex:p}};e.events.push(["postProcessText",function(a){var i=a.text||"",l=[],c={text:i,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(i)){var d=0;for(d=0;d<i.length;d+=1)Array.isArray(i[d])&&i[d].length===3?l.push([s(Object.assign({},c,{text:i[d][0]})).text,i[d][1],i[d][2]]):l.push(s(Object.assign({},c,{text:i[d]})).text);a.text=l}else a.text=s(Object.assign({},c,{text:i})).text}])})(or),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(or.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var s,a,i,l,c,d,h,p=e,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],b={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},y={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],S=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),k=!1,A=0;this.__bidiEngine__={};var z=function(I){var P=I.charCodeAt(),ae=P>>8,G=y[ae];return G!==void 0?p[256*G+(255&P)]:ae===252||ae===253?"AL":S.test(ae)?"L":ae===8?"R":"N"},H=function(I){for(var P,ae=0;ae<I.length;ae++){if((P=z(I.charAt(ae)))==="L")return!1;if(P==="R")return!0}return!1},V=function(I,P,ae,G){var M,te,ie,le,X=P[G];switch(X){case"L":case"R":k=!1;break;case"N":case"AN":break;case"EN":k&&(X="AN");break;case"AL":k=!0,X="R";break;case"WS":X="N";break;case"CS":G<1||G+1>=P.length||(M=ae[G-1])!=="EN"&&M!=="AN"||(te=P[G+1])!=="EN"&&te!=="AN"?X="N":k&&(te="AN"),X=te===M?te:"N";break;case"ES":X=(M=G>0?ae[G-1]:"B")==="EN"&&G+1<P.length&&P[G+1]==="EN"?"EN":"N";break;case"ET":if(G>0&&ae[G-1]==="EN"){X="EN";break}if(k){X="N";break}for(ie=G+1,le=P.length;ie<le&&P[ie]==="ET";)ie++;X=ie<le&&P[ie]==="EN"?"EN":"N";break;case"NSM":if(i&&!l){for(le=P.length,ie=G+1;ie<le&&P[ie]==="NSM";)ie++;if(ie<le){var fe=I[G],K=fe>=1425&&fe<=2303||fe===64286;if(M=P[ie],K&&(M==="R"||M==="AL")){X="R";break}}}X=G<1||(M=P[G-1])==="B"?"N":ae[G-1];break;case"B":k=!1,s=!0,X=A;break;case"S":a=!0,X="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":k=!1;break;case"BN":X="N"}return X},B=function(I,P,ae){var G=I.split("");return ae&&R(G,ae,{hiLevel:A}),G.reverse(),P&&P.reverse(),G.join("")},R=function(I,P,ae){var G,M,te,ie,le,X=-1,fe=I.length,K=0,E=[],W=A?m:x,L=[];for(k=!1,s=!1,a=!1,M=0;M<fe;M++)L[M]=z(I[M]);for(te=0;te<fe;te++){if(le=K,E[te]=V(I,L,E,te),G=240&(K=W[le][b[E[te]]]),K&=15,P[te]=ie=W[K][5],G>0)if(G===16){for(M=X;M<te;M++)P[M]=1;X=-1}else X=-1;if(W[K][6])X===-1&&(X=te);else if(X>-1){for(M=X;M<te;M++)P[M]=ie;X=-1}L[te]==="B"&&(P[te]=0),ae.hiLevel|=ie}a&&(function(F,q,he){for(var me=0;me<he;me++)if(F[me]==="S"){q[me]=A;for(var Z=me-1;Z>=0&&F[Z]==="WS";Z--)q[Z]=A}})(L,P,fe)},O=function(I,P,ae,G,M){if(!(M.hiLevel<I)){if(I===1&&A===1&&!s)return P.reverse(),void(ae&&ae.reverse());for(var te,ie,le,X,fe=P.length,K=0;K<fe;){if(G[K]>=I){for(le=K+1;le<fe&&G[le]>=I;)le++;for(X=K,ie=le-1;X<ie;X++,ie--)te=P[X],P[X]=P[ie],P[ie]=te,ae&&(te=ae[X],ae[X]=ae[ie],ae[ie]=te);K=le}K++}}},ee=function(I,P,ae){var G=I.split(""),M={hiLevel:A};return ae||(ae=[]),R(G,ae,M),(function(te,ie,le){if(le.hiLevel!==0&&h)for(var X,fe=0;fe<te.length;fe++)ie[fe]===1&&(X=w.indexOf(te[fe]))>=0&&(te[fe]=w[X+1])})(G,ae,M),O(2,G,P,ae,M),O(1,G,P,ae,M),G.join("")};return this.__bidiEngine__.doBidiReorder=function(I,P,ae){if((function(M,te){if(te)for(var ie=0;ie<M.length;ie++)te[ie]=ie;l===void 0&&(l=H(M)),d===void 0&&(d=H(M))})(I,P),i||!c||d)if(i&&c&&l^d)A=l?1:0,I=B(I,P,ae);else if(!i&&c&&d)A=l?1:0,I=ee(I,P,ae),I=B(I,P);else if(!i||l||c||d){if(i&&!c&&l^d)I=B(I,P),l?(A=0,I=ee(I,P,ae)):(A=1,I=ee(I,P,ae),I=B(I,P));else if(i&&l&&!c&&d)A=1,I=ee(I,P,ae),I=B(I,P);else if(!i&&!c&&l^d){var G=h;l?(A=1,I=ee(I,P,ae),A=0,h=!1,I=ee(I,P,ae),h=G):(A=0,I=ee(I,P,ae),I=B(I,P),A=1,h=!1,I=ee(I,P,ae),h=G,I=B(I,P))}}else A=0,I=ee(I,P,ae);else A=l?1:0,I=ee(I,P,ae);return I},this.__bidiEngine__.setOptions=function(I){I&&(i=I.isInputVisual,c=I.isOutputVisual,l=I.isInputRtl,d=I.isOutputRtl,h=I.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var i=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(i=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?i.push([r.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):i.push([r.doBidiReorder(s[l])]);n.text=i}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])})(or),or.API.TTFFont=(function(){function t(e){var r;if(this.rawData=e,r=this.contents=new ed(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new JU(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new OU(this.contents),this.head=new BU(this),this.name=new WU(this),this.cmap=new Sk(this),this.toUnicode={},this.hhea=new UU(this),this.maxp=new VU(this),this.hmtx=new qU(this),this.post=new HU(this),this.os2=new zU(this),this.loca=new KU(this),this.glyf=new GU(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,s,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var i,l,c,d;for(d=[],i=0,l=(c=this.bbox).length;i<l;i++)e=c[i],d.push(Math.round(e*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),(32768&(r=s>>16))!=0&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var s,a,i,l;for(i=0,a=0,l=(e=""+e).length;0<=l?a<l:a>l;a=0<=l?++a:--a)s=e.charCodeAt(a),i+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return i*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t})();var el,ed=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,s;for(s=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(e.charCodeAt(r)));return s},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,s,a,i,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),a=this.readByte(),i=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^a)+65536*(255^i)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*s+16777216*a+65536*i+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,s,a;for(a=[],n=0,s=e.length;n<s;n++)r=e[n],a.push(this.writeByte(r));return a},t})(),OU=(function(){var t;function e(r){var n,s,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,a=this.tableCount;0<=a?s<a:s>a;s=0<=a?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,s,a,i,l,c,d,h,p,x,m,b,y;for(y in m=Object.keys(r).length,c=Math.log(2),p=16*Math.floor(Math.log(m)/c),i=Math.floor(p/c),h=16*m-p,(s=new ed).writeInt(this.scalarType),s.writeShort(m),s.writeShort(p),s.writeShort(i),s.writeShort(h),a=16*m,d=s.pos+a,l=null,b=[],r)for(x=r[y],s.writeString(y),s.writeInt(t(x)),s.writeInt(d),s.writeInt(x.length),b=b.concat(x),y==="head"&&(l=d),d+=x.length;d%4;)b.push(0),d++;return s.write(b),n=2981146554-t(s.data),s.pos=l+8,s.writeUInt32(n),s.data},t=function(r){var n,s,a,i;for(r=kk.call(r);r.length%4;)r.push(0);for(a=new ed(r),s=0,n=0,i=r.length;n<i;n=n+=4)s+=a.readUInt32();return 4294967295&s},e})(),MU={}.hasOwnProperty,Bl=function(t,e){for(var r in e)MU.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};el=(function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var BU=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bl(e,el),e.prototype.tag="head",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},e.prototype.encode=function(r){var n;return(n=new ed).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},e})(),t_=(function(){function t(e,r){var n,s,a,i,l,c,d,h,p,x,m,b,y,w,S,k,A;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),p=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(m=e.readUInt16(),x=m/2,e.pos+=6,a=(function(){var z,H;for(H=[],c=z=0;0<=x?z<x:z>x;c=0<=x?++z:--z)H.push(e.readUInt16());return H})(),e.pos+=2,y=(function(){var z,H;for(H=[],c=z=0;0<=x?z<x:z>x;c=0<=x?++z:--z)H.push(e.readUInt16());return H})(),d=(function(){var z,H;for(H=[],c=z=0;0<=x?z<x:z>x;c=0<=x?++z:--z)H.push(e.readUInt16());return H})(),h=(function(){var z,H;for(H=[],c=z=0;0<=x?z<x:z>x;c=0<=x?++z:--z)H.push(e.readUInt16());return H})(),s=(this.length-e.pos+this.offset)/2,l=(function(){var z,H;for(H=[],c=z=0;0<=s?z<s:z>s;c=0<=s?++z:--z)H.push(e.readUInt16());return H})(),c=S=0,A=a.length;S<A;c=++S)for(w=a[c],n=k=b=y[c];b<=w?k<=w:k>=w;n=b<=w?++k:--k)h[c]===0?i=n+d[c]:(i=l[h[c]/2+(n-b)-(x-c)]||0)!==0&&(i+=d[c]),this.codeMap[n]=65535&i}e.pos=p}return t.encode=function(e,r){var n,s,a,i,l,c,d,h,p,x,m,b,y,w,S,k,A,z,H,V,B,R,O,ee,I,P,ae,G,M,te,ie,le,X,fe,K,E,W,L,F,q,he,me,Z,Se,We,ue;switch(G=new ed,i=Object.keys(e).sort((function(nt,rt){return nt-rt})),r){case"macroman":for(y=0,w=(function(){var nt=[];for(b=0;b<256;++b)nt.push(0);return nt})(),k={0:0},a={},M=0,X=i.length;M<X;M++)k[Z=e[s=i[M]]]==null&&(k[Z]=++y),a[s]={old:e[s],new:k[e[s]]},w[s]=k[e[s]];return G.writeUInt16(1),G.writeUInt16(0),G.writeUInt32(12),G.writeUInt16(0),G.writeUInt16(262),G.writeUInt16(0),G.write(w),{charMap:a,subtable:G.data,maxGlyphID:y+1};case"unicode":for(P=[],p=[],A=0,k={},n={},S=d=null,te=0,fe=i.length;te<fe;te++)k[H=e[s=i[te]]]==null&&(k[H]=++A),n[s]={old:H,new:k[H]},l=k[H]-s,S!=null&&l===d||(S&&p.push(S),P.push(s),d=l),S=s;for(S&&p.push(S),p.push(65535),P.push(65535),ee=2*(O=P.length),R=2*Math.pow(Math.log(O)/Math.LN2,2),x=Math.log(R/2)/Math.LN2,B=2*O-R,c=[],V=[],m=[],b=ie=0,K=P.length;ie<K;b=++ie){if(I=P[b],h=p[b],I===65535){c.push(0),V.push(0);break}if(I-(ae=n[I].new)>=32768)for(c.push(0),V.push(2*(m.length+O-b)),s=le=I;I<=h?le<=h:le>=h;s=I<=h?++le:--le)m.push(n[s].new);else c.push(ae-I),V.push(0)}for(G.writeUInt16(3),G.writeUInt16(1),G.writeUInt32(12),G.writeUInt16(4),G.writeUInt16(16+8*O+2*m.length),G.writeUInt16(0),G.writeUInt16(ee),G.writeUInt16(R),G.writeUInt16(x),G.writeUInt16(B),he=0,E=p.length;he<E;he++)s=p[he],G.writeUInt16(s);for(G.writeUInt16(0),me=0,W=P.length;me<W;me++)s=P[me],G.writeUInt16(s);for(Se=0,L=c.length;Se<L;Se++)l=c[Se],G.writeUInt16(l);for(We=0,F=V.length;We<F;We++)z=V[We],G.writeUInt16(z);for(ue=0,q=m.length;ue<q;ue++)y=m[ue],G.writeUInt16(y);return{charMap:n,subtable:G.data,maxGlyphID:A+1}}},t})(),Sk=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bl(e,el),e.prototype.tag="cmap",e.prototype.parse=function(r){var n,s,a;for(r.pos=this.offset,this.version=r.readUInt16(),a=r.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)n=new t_(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(r,n){var s,a;return n==null&&(n="macroman"),s=t_.encode(r,n),(a=new ed).writeUInt16(0),a.writeUInt16(1),s.table=a.data.concat(s.subtable),s},e})(),UU=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bl(e,el),e.prototype.tag="hhea",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},e})(),zU=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bl(e,el),e.prototype.tag="OS/2",e.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=(function(){var n,s;for(s=[],n=0;n<10;++n)s.push(r.readByte());return s})(),this.charRange=(function(){var n,s;for(s=[],n=0;n<4;++n)s.push(r.readInt());return s})(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=(function(){var n,s;for(s=[],n=0;n<2;n=++n)s.push(r.readInt());return s})(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},e})(),HU=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bl(e,el),e.prototype.tag="post",e.prototype.parse=function(r){var n,s,a;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var i;for(s=r.readUInt16(),this.glyphNameIndex=[],i=0;0<=s?i<s:i>s;i=0<=s?++i:--i)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],a=[];r.pos<this.offset+this.length;)n=r.readByte(),a.push(this.names.push(r.readString(n)));return a;case 151552:return s=r.readUInt16(),this.offsets=r.read(s);case 196608:break;case 262144:return this.map=(function(){var l,c,d;for(d=[],i=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;i=0<=c?++l:--l)d.push(r.readUInt32());return d}).call(this)}},e})(),$U=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},WU=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bl(e,el),e.prototype.tag="name",e.prototype.parse=function(r){var n,s,a,i,l,c,d,h,p,x,m;for(r.pos=this.offset,r.readShort(),n=r.readShort(),c=r.readShort(),s=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)s.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(d={},i=p=0,x=s.length;p<x;i=++p)a=s[i],r.pos=a.offset,h=r.readString(a.length),l=new $U(h,a),d[m=a.nameID]==null&&(d[m]=[]),d[a.nameID].push(l);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},e})(),VU=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bl(e,el),e.prototype.tag="maxp",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},e})(),qU=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bl(e,el),e.prototype.tag="hmtx",e.prototype.parse=function(r){var n,s,a,i,l,c,d;for(r.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var h,p;for(p=[],n=h=0;0<=a?h<a:h>a;n=0<=a?++h:--h)p.push(r.readInt16());return p})(),this.widths=(function(){var h,p,x,m;for(m=[],h=0,p=(x=this.metrics).length;h<p;h++)i=x[h],m.push(i.advance);return m}).call(this),s=this.widths[this.widths.length-1],d=[],n=l=0;0<=a?l<a:l>a;n=0<=a?++l:--l)d.push(this.widths.push(s));return d},e.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},e})(),kk=[].slice,GU=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bl(e,el),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(r){var n,s,a,i,l,c,d,h,p,x;return r in this.cache?this.cache[r]:(i=this.file.loca,n=this.file.contents,s=i.indexOf(r),(a=i.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+s,l=(c=new ed(n.read(a))).readShort(),h=c.readShort(),x=c.readShort(),d=c.readShort(),p=c.readShort(),this.cache[r]=l===-1?new YU(c,h,x,d,p):new XU(c,l,h,x,d,p),this.cache[r]))},e.prototype.encode=function(r,n,s){var a,i,l,c,d;for(l=[],i=[],c=0,d=n.length;c<d;c++)a=r[n[c]],i.push(l.length),a&&(l=l.concat(a.encode(s)));return i.push(l.length),{table:l,offsets:i}},e})(),XU=(function(){function t(e,r,n,s,a,i){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=a,this.yMax=i,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),YU=(function(){function t(e,r,n,s,a){var i,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],i=this.raw;l=i.readShort(),this.glyphOffsets.push(i.pos),this.glyphIDs.push(i.readUInt16()),32&l;)i.pos+=1&l?4:2,128&l?i.pos+=8:64&l?i.pos+=4:8&l&&(i.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new ed(kk.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t})(),KU=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bl(e,el),e.prototype.tag="loca",e.prototype.parse=function(r){var n,s;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var a,i;for(i=[],s=0,a=this.length;s<a;s+=2)i.push(2*r.readUInt16());return i}).call(this):(function(){var a,i;for(i=[],s=0,a=this.length;s<a;s+=4)i.push(r.readUInt32());return i}).call(this)},e.prototype.indexOf=function(r){return this.offsets[r]},e.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},e.prototype.encode=function(r,n){for(var s=new Uint32Array(this.offsets.length),a=0,i=0,l=0;l<s.length;++l)if(s[l]=a,i<n.length&&n[i]==l){++i,s[l]=a;var c=this.offsets[l],d=this.offsets[l+1]-c;d>0&&(a+=d)}for(var h=new Array(4*s.length),p=0;p<s.length;++p)h[4*p+3]=255&s[p],h[4*p+2]=(65280&s[p])>>8,h[4*p+1]=(16711680&s[p])>>16,h[4*p]=(4278190080&s[p])>>24;return h},e})(),JU=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,s,a;for(r in s=this.font.cmap.tables[0].codeMap,e={},a=this.subset)n=a[r],e[r]=s[n];return e},t.prototype.glyphsFor=function(e){var r,n,s,a,i,l,c;for(s={},i=0,l=e.length;i<l;i++)s[a=e[i]]=this.font.glyf.glyphFor(a);for(a in r=[],s)(n=s[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in c=this.glyphsFor(r))n=c[a],s[a]=n;return s},t.prototype.encode=function(e,r){var n,s,a,i,l,c,d,h,p,x,m,b,y,w,S;for(s in n=Sk.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(e),m={0:0},S=n.charMap)m[(c=S[s]).old]=c.new;for(b in x=n.maxGlyphID,i)b in m||(m[b]=x++);return h=(function(k){var A,z;for(A in z={},k)z[k[A]]=A;return z})(m),p=Object.keys(h).sort((function(k,A){return k-A})),y=(function(){var k,A,z;for(z=[],k=0,A=p.length;k<A;k++)l=p[k],z.push(h[l]);return z})(),a=this.font.glyf.encode(i,y,m),d=this.font.loca.encode(a.offsets,y),w={cmap:this.font.cmap.raw(),glyf:a.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},t})();or.API.PDFObject=(function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,s,a,i;if(Array.isArray(r))return"["+(function(){var l,c,d;for(d=[],l=0,c=r.length;l<c;l++)n=r[l],d.push(e.convert(n));return d})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in a=["<<"],r)i=r[s],a.push("/"+s+" "+e.convert(i));return a.push(">>"),a.join(`
`)}return""+r},e})();function jk(t,e,r,n,s){n=n||{};var a=1.15,i=s.internal.scaleFactor,l=s.internal.getFontSize()/i,c=s.getLineHeightFactor?s.getLineHeightFactor():a,d=l*c,h=/\r\n|\r|\n/g,p="",x=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(p=typeof t=="string"?t.split(h):t,x=p.length||1),r+=l*(2-a),n.valign==="middle"?r-=x/2*d:n.valign==="bottom"&&(r-=x*d),n.halign==="center"||n.halign==="right"){var m=l;if(n.halign==="center"&&(m*=.5),p&&x>=1){for(var b=0;b<p.length;b++)s.text(p[b],e-s.getStringUnitWidth(p[b])*m,r),r+=d;return s}e-=s.getStringUnitWidth(t)*m}return n.halign==="justify"?s.text(t,e,r,{maxWidth:n.maxWidth||100,align:"justify"}):s.text(t,e,r),s}var r_={},b0=(function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:r_=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var n,s,a;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var i=this.jsPDFDocument.internal.getFont(),l=i.fontStyle,c=i.fontName;if(e.font&&(c=e.font),e.fontStyle){l=e.fontStyle;var d=this.getFontList()[c];d&&d.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(d[0]),l=d[0])}if(this.jsPDFDocument.setFont(c,l),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var h=t.unifyColor(e.fillColor);h&&(n=this.jsPDFDocument).setFillColor.apply(n,h),h=t.unifyColor(e.textColor),h&&(s=this.jsPDFDocument).setTextColor.apply(s,h),h=t.unifyColor(e.lineColor),h&&(a=this.jsPDFDocument).setDrawColor.apply(a,h),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,n){return this.jsPDFDocument.splitTextToSize(e,r,n)},t.prototype.rect=function(e,r,n,s,a){return this.jsPDFDocument.rect(e,r,n,s,a)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return r_||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t})(),Z2=function(t,e){return Z2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},Z2(t,e)};function Ek(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Z2(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Ak=(function(t){Ek(e,t);function e(r){var n=t.call(this)||this;return n._element=r,n}return e})(Array);function QU(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function ZU(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function Tx(t,e,r){r.applyStyles(e,!0);var n=Array.isArray(t)?t:[t],s=n.map(function(a){return r.getTextWidth(a)}).reduce(function(a,i){return Math.max(a,i)},0);return s}function Ck(t,e,r,n){var s=e.settings.tableLineWidth,a=e.settings.tableLineColor;t.applyStyles({lineWidth:s,lineColor:a});var i=Tk(s,!1);i&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),n.y-r.y,i)}function Tk(t,e){var r=t>0,n=e||e===0;return r&&n?"DF":r?"S":n?"F":null}function mg(t,e){var r,n,s,a;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(n=t.top)!==null&&n!==void 0?n:e,right:(s=t.right)!==null&&s!==void 0?s:e,bottom:(a=t.bottom)!==null&&a!==void 0?a:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function Fk(t,e){var r=mg(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function ez(t,e,r,n,s){var a={},i=1.3333333333333333,l=V1(e,function(A){return s.getComputedStyle(A).backgroundColor});l!=null&&(a.fillColor=l);var c=V1(e,function(A){return s.getComputedStyle(A).color});c!=null&&(a.textColor=c);var d=rz(n,r);d&&(a.cellPadding=d);var h="borderTopColor",p=i*r,x=n.borderTopWidth;if(n.borderBottomWidth===x&&n.borderRightWidth===x&&n.borderLeftWidth===x){var m=(parseFloat(x)||0)/p;m&&(a.lineWidth=m)}else a.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/p,right:(parseFloat(n.borderRightWidth)||0)/p,bottom:(parseFloat(n.borderBottomWidth)||0)/p,left:(parseFloat(n.borderLeftWidth)||0)/p},a.lineWidth.top||(a.lineWidth.right?h="borderRightColor":a.lineWidth.bottom?h="borderBottomColor":a.lineWidth.left&&(h="borderLeftColor"));var b=V1(e,function(A){return s.getComputedStyle(A)[h]});b!=null&&(a.lineColor=b);var y=["left","right","center","justify"];y.indexOf(n.textAlign)!==-1&&(a.halign=n.textAlign),y=["middle","bottom","top"],y.indexOf(n.verticalAlign)!==-1&&(a.valign=n.verticalAlign);var w=parseInt(n.fontSize||"");isNaN(w)||(a.fontSize=w/i);var S=tz(n);S&&(a.fontStyle=S);var k=(n.fontFamily||"").toLowerCase();return t.indexOf(k)!==-1&&(a.font=k),a}function tz(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function V1(t,e){var r=Pk(t,e);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var s=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],a=parseInt(n[4]);return a===0||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?null:s}function Pk(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:Pk(t.parentElement,e):r}function rz(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/e),s=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,a=r.map(function(l){return parseInt(l||"0")/n}),i=mg(a,0);return s>i.top&&(i.top=s),s>i.bottom&&(i.bottom=s),i}function Lk(t,e,r,n,s){var a,i;n===void 0&&(n=!1),s===void 0&&(s=!1);var l;typeof e=="string"?l=r.document.querySelector(e):l=e;var c=Object.keys(t.getFontList()),d=t.scaleFactor(),h=[],p=[],x=[];if(!l)return console.error("Html table could not be found with input: ",e),{head:h,body:p,foot:x};for(var m=0;m<l.rows.length;m++){var b=l.rows[m],y=(i=(a=b?.parentElement)===null||a===void 0?void 0:a.tagName)===null||i===void 0?void 0:i.toLowerCase(),w=nz(c,d,r,b,n,s);w&&(y==="thead"?h.push(w):y==="tfoot"?x.push(w):p.push(w))}return{head:h,body:p,foot:x}}function nz(t,e,r,n,s,a){for(var i=new Ak(n),l=0;l<n.cells.length;l++){var c=n.cells[l],d=r.getComputedStyle(c);if(s||d.display!=="none"){var h=void 0;a&&(h=ez(t,c,e,d,r)),i.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:h,_element:c,content:sz(c)})}}var p=r.getComputedStyle(n);if(i.length>0&&(s||p.display!=="none"))return i}function sz(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function az(t,e,r){for(var n=0,s=[t,e,r];n<s.length;n++){var a=s[n];a&&typeof a!="object"&&console.error("The options parameter should be of type object, is: "+typeof a),a.startY&&typeof a.startY!="number"&&(console.error("Invalid value for startY option",a.startY),delete a.startY)}}function Sc(t,e,r,n,s){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(t),i=1;i<arguments.length;i++){var l=arguments[i];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(a[c]=l[c])}return a}function Dk(t,e){var r=new b0(t),n=r.getDocumentOptions(),s=r.getGlobalOptions();az(s,n,e);var a=Sc({},s,n,e),i;typeof window<"u"&&(i=window);var l=iz(s,n,e),c=oz(s,n,e),d=lz(r,a),h=uz(r,a,i);return{id:e.tableId,content:h,hooks:c,styles:l,settings:d}}function iz(t,e,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},s=function(c){if(c==="columnStyles"){var d=t[c],h=e[c],p=r[c];n.columnStyles=Sc({},d,h,p)}else{var x=[t,e,r],m=x.map(function(b){return b[c]||{}});n[c]=Sc({},m[0],m[1],m[2])}},a=0,i=Object.keys(n);a<i.length;a++){var l=i[a];s(l)}return n}function oz(t,e,r){for(var n=[t,e,r],s={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},a=0,i=n;a<i.length;a++){var l=i[a];l.didParseCell&&s.didParseCell.push(l.didParseCell),l.willDrawCell&&s.willDrawCell.push(l.willDrawCell),l.didDrawCell&&s.didDrawCell.push(l.didDrawCell),l.willDrawPage&&s.willDrawPage.push(l.willDrawPage),l.didDrawPage&&s.didDrawPage.push(l.didDrawPage)}return s}function lz(t,e){var r,n,s,a,i,l,c,d,h,p,x,m,b=mg(e.margin,40/t.scaleFactor()),y=(r=cz(t,e.startY))!==null&&r!==void 0?r:b.top,w;e.showFoot===!0?w="everyPage":e.showFoot===!1?w="never":w=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var S;e.showHead===!0?S="everyPage":e.showHead===!1?S="never":S=(s=e.showHead)!==null&&s!==void 0?s:"everyPage";var k=(a=e.useCss)!==null&&a!==void 0?a:!1,A=e.theme||(k?"plain":"striped"),z=!!e.horizontalPageBreak,H=(i=e.horizontalPageBreakRepeat)!==null&&i!==void 0?i:null;return{includeHiddenHtml:(l=e.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:k,theme:A,startY:y,margin:b,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(d=e.rowPageBreak)!==null&&d!==void 0?d:"auto",tableWidth:(h=e.tableWidth)!==null&&h!==void 0?h:"auto",showHead:S,showFoot:w,tableLineWidth:(p=e.tableLineWidth)!==null&&p!==void 0?p:0,tableLineColor:(x=e.tableLineColor)!==null&&x!==void 0?x:200,horizontalPageBreak:z,horizontalPageBreakRepeat:H,horizontalPageBreakBehaviour:(m=e.horizontalPageBreakBehaviour)!==null&&m!==void 0?m:"afterAllRows"}}function cz(t,e){var r=t.getLastAutoTable(),n=t.scaleFactor(),s=t.pageNumber(),a=!1;if(r&&r.startPageNumber){var i=r.startPageNumber+r.pageNumber-1;a=i===s}return typeof e=="number"?e:(e==null||e===!1)&&a&&r?.finalY!=null?r.finalY+20/n:null}function uz(t,e,r){var n=e.head||[],s=e.body||[],a=e.foot||[];if(e.html){var i=e.includeHiddenHtml;if(r){var l=Lk(t,e.html,r,i,e.useCss)||{};n=l.head||n,s=l.body||n,a=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=e.columns||dz(n,s,a);return{columns:c,head:n,body:s,foot:a}}function dz(t,e,r){var n=t[0]||e[0]||r[0]||[],s=[];return Object.keys(n).filter(function(a){return a!=="_element"}).forEach(function(a){var i=1,l;Array.isArray(n)?l=n[parseInt(a)]:l=n[a],typeof l=="object"&&!Array.isArray(l)&&(i=l?.colSpan||1);for(var c=0;c<i;c++){var d=void 0;Array.isArray(n)?d=s.length:d=a+(c>0?"_".concat(c):"");var h={dataKey:d};s.push(h)}}),s}var ev=(function(){function t(e,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=e.getDocument()}return t})(),fz=(function(t){Ek(e,t);function e(r,n,s,a,i,l){var c=t.call(this,r,n,l)||this;return c.cell=s,c.row=a,c.column=i,c.section=a.section,c}return e})(ev),hz=(function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,n,s,a,i){for(var l=0,c=r;l<c.length;l++){var d=c[l],h=new fz(e,this,n,s,a,i),p=d(h)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],p)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var n=0,s=this.hooks.didDrawPage;n<s.length;n++){var a=s[n];a(new ev(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var n=0,s=this.hooks.willDrawPage;n<s.length;n++){var a=s[n];a(new ev(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(s,a){return s+a.wrappedWidth},0);return r}else{var n=this.settings.margin;return e-n.left-n.right}},t})(),Rk=(function(){function t(e,r,n,s,a){a===void 0&&(a=!1),this.height=0,this.raw=e,e instanceof Ak&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=n,this.cells=s,this.spansMultiplePages=a}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(n,s){var a;return Math.max(n,((a=r.cells[s.index])===null||a===void 0?void 0:a.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(n){var s=r.cells[n.index];return s?s.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var n=this;return e.reduce(function(s,a){var i=n.cells[a.index];if(!i)return 0;var l=r.getLineHeight(i.styles.fontSize),c=i.padding("vertical"),d=c+l;return d>s?d:s},0)},t})(),Ik=(function(){function t(e,r,n){var s;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=e;var a=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,a=(s=e.content)!==null&&s!==void 0?s:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var i=a!=null?""+a:"",l=/\r\n|\r|\n/g;this.text=i.split(l)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var s=this.width-this.padding("horizontal");n=this.x+s/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,s=this.styles.fontSize/e*r,a=n*s+this.padding("vertical");return Math.max(a,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=mg(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t})(),pz=(function(){function t(e,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=n}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,n=0,s=e.allRows();n<s.length;n++){var a=s[n],i=a.cells[this.index];i&&typeof i.styles.cellWidth=="number"&&(r=Math.max(r,i.styles.cellWidth))}return r},t})();function mz(t,e){xz(t,e);var r=[],n=0;e.columns.forEach(function(a){var i=a.getMaxCustomCellWidth(e);i?a.width=i:(a.width=a.wrappedWidth,r.push(a)),n+=a.width});var s=e.getWidth(t.pageSize().width)-n;s&&(s=tv(r,s,function(a){return Math.max(a.minReadableWidth,a.minWidth)})),s&&(s=tv(r,s,function(a){return a.minWidth})),s=Math.abs(s),!e.settings.horizontalPageBreak&&s>.1/t.scaleFactor()&&(s=s<1?s:Math.round(s),console.warn("Of the table content, ".concat(s," units width could not fit page"))),vz(e),yz(e,t),gz(e)}function xz(t,e){var r=t.scaleFactor(),n=e.settings.horizontalPageBreak,s=Fk(t,e);e.allRows().forEach(function(a){for(var i=0,l=e.columns;i<l.length;i++){var c=l[i],d=a.cells[c.index];if(d){var h=e.hooks.didParseCell;e.callCellHooks(t,h,d,a,c,null);var p=d.padding("horizontal");d.contentWidth=Tx(d.text,d.styles,t)+p;var x=Tx(d.text.join(" ").split(/[^\S\u00A0]+/),d.styles,t);if(d.minReadableWidth=x+d.padding("horizontal"),typeof d.styles.cellWidth=="number")d.minWidth=d.styles.cellWidth,d.wrappedWidth=d.styles.cellWidth;else if(d.styles.cellWidth==="wrap"||n===!0)d.contentWidth>s?(d.minWidth=s,d.wrappedWidth=s):(d.minWidth=d.contentWidth,d.wrappedWidth=d.contentWidth);else{var m=10/r;d.minWidth=d.styles.minCellWidth||m,d.wrappedWidth=d.contentWidth,d.minWidth>d.wrappedWidth&&(d.wrappedWidth=d.minWidth)}}}}),e.allRows().forEach(function(a){for(var i=0,l=e.columns;i<l.length;i++){var c=l[i],d=a.cells[c.index];if(d&&d.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,d.wrappedWidth),c.minWidth=Math.max(c.minWidth,d.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,d.minReadableWidth);else{var h=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},p=h.cellWidth||h.minCellWidth;p&&typeof p=="number"&&(c.minWidth=p,c.wrappedWidth=p)}d&&(d.colSpan>1&&!c.minWidth&&(c.minWidth=d.minWidth),d.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=d.minWidth))}})}function tv(t,e,r){for(var n=e,s=t.reduce(function(m,b){return m+b.wrappedWidth},0),a=0;a<t.length;a++){var i=t[a],l=i.wrappedWidth/s,c=n*l,d=i.width+c,h=r(i),p=d<h?h:d;e-=p-i.width,i.width=p}if(e=Math.round(e*1e10)/1e10,e){var x=t.filter(function(m){return e<0?m.width>r(m):!0});x.length&&(e=tv(x,e,r))}return e}function gz(t){for(var e={},r=1,n=t.allRows(),s=0;s<n.length;s++)for(var a=n[s],i=0,l=t.columns;i<l.length;i++){var c=l[i],d=e[c.index];if(r>1)r--,delete a.cells[c.index];else if(d)d.cell.height+=a.height,r=d.cell.colSpan,delete a.cells[c.index],d.left--,d.left<=1&&delete e[c.index];else{var h=a.cells[c.index];if(!h)continue;if(h.height=a.height,h.rowSpan>1){var p=n.length-s,x=h.rowSpan>p?p:h.rowSpan;e[c.index]={cell:h,left:x,row:a}}}}}function vz(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var n=e[r],s=null,a=0,i=0,l=0;l<t.columns.length;l++){var c=t.columns[l];if(i-=1,i>1&&t.columns[l+1])a+=c.width,delete n.cells[c.index];else if(s){var d=s;delete n.cells[c.index],s=null,d.width=c.width+a}else{var d=n.cells[c.index];if(!d)continue;if(i=d.colSpan,a=0,d.colSpan>1){s=d,a+=c.width;continue}d.width=c.width+a}}}function yz(t,e){for(var r={count:0,height:0},n=0,s=t.allRows();n<s.length;n++){for(var a=s[n],i=0,l=t.columns;i<l.length;i++){var c=l[i],d=a.cells[c.index];if(d){e.applyStyles(d.styles,!0);var h=d.width-d.padding("horizontal");if(d.styles.overflow==="linebreak")d.text=e.splitTextToSize(d.text,h+1/e.scaleFactor(),{fontSize:d.styles.fontSize});else if(d.styles.overflow==="ellipsize")d.text=n_(d.text,h,d.styles,e,"...");else if(d.styles.overflow==="hidden")d.text=n_(d.text,h,d.styles,e,"");else if(typeof d.styles.overflow=="function"){var p=d.styles.overflow(d.text,h);typeof p=="string"?d.text=[p]:d.text=p}d.contentHeight=d.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var x=d.contentHeight/d.rowSpan;d.rowSpan>1&&r.count*r.height<x*d.rowSpan?r={height:x,count:d.rowSpan}:r&&r.count>0&&r.height>x&&(x=r.height),x>a.height&&(a.height=x)}}r.count--}}function n_(t,e,r,n,s){return t.map(function(a){return bz(a,e,r,n,s)})}function bz(t,e,r,n,s){var a=1e4*n.scaleFactor();if(e=Math.ceil(e*a)/a,e>=Tx(t,r,n))return t;for(;e<Tx(t+s,r,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+s}function Ok(t,e){var r=new b0(t),n=wz(e,r.scaleFactor()),s=new hz(e,n);return mz(r,s),r.applyStyles(r.userStyles),s}function wz(t,e){var r=t.content,n=Nz(r.columns);if(r.head.length===0){var s=s_(n,"head");s&&r.head.push(s)}if(r.foot.length===0){var s=s_(n,"foot");s&&r.foot.push(s)}var a=t.settings.theme,i=t.styles;return{columns:n,head:q1("head",r.head,n,i,a,e),body:q1("body",r.body,n,i,a,e),foot:q1("foot",r.foot,n,i,a,e)}}function q1(t,e,r,n,s,a){var i={},l=e.map(function(c,d){for(var h=0,p={},x=0,m=0,b=0,y=r;b<y.length;b++){var w=y[b];if(i[w.index]==null||i[w.index].left===0)if(m===0){var S=void 0;Array.isArray(c)?S=c[w.index-x-h]:S=c[w.dataKey];var k={};typeof S=="object"&&!Array.isArray(S)&&(k=S?.styles||{});var A=Sz(t,w,d,s,n,a,k),z=new Ik(S,A,t);p[w.dataKey]=z,p[w.index]=z,m=z.colSpan-1,i[w.index]={left:z.rowSpan-1,times:m}}else m--,x++;else i[w.index].left--,m=i[w.index].times,h++}return new Rk(c,d,t,p)});return l}function s_(t,e){var r={};return t.forEach(function(n){if(n.raw!=null){var s=_z(e,n.raw);s!=null&&(r[n.dataKey]=s)}}),Object.keys(r).length>0?r:null}function _z(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function Nz(t){return t.map(function(e,r){var n,s;return typeof e=="object"?s=(n=e.dataKey)!==null&&n!==void 0?n:r:s=r,new pz(s,e,r)})}function Sz(t,e,r,n,s,a,i){var l=ZU(n),c;t==="head"?c=s.headStyles:t==="body"?c=s.bodyStyles:t==="foot"&&(c=s.footStyles);var d=Sc({},l.table,l[t],s.styles,c),h=s.columnStyles[e.dataKey]||s.columnStyles[e.index]||{},p=t==="body"?h:{},x=t==="body"&&r%2===0?Sc({},l.alternateRow,s.alternateRowStyles):{},m=QU(a),b=Sc({},m,d,x,p);return Sc(b,i)}function kz(t,e,r){var n;r===void 0&&(r={});var s=Fk(t,e),a=new Map,i=[],l=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(x){var m=e.columns.find(function(b){return b.dataKey===x||b.index===x});m&&!a.has(m.index)&&(a.set(m.index,!0),i.push(m.index),l.push(e.columns[m.index]),s-=m.wrappedWidth)});for(var d=!0,h=(n=r?.start)!==null&&n!==void 0?n:0;h<e.columns.length;){if(a.has(h)){h++;continue}var p=e.columns[h].wrappedWidth;if(d||s>=p)d=!1,i.push(h),l.push(e.columns[h]),s-=p;else break;h++}return{colIndexes:i,columns:l,lastIndex:h-1}}function jz(t,e){for(var r=[],n=0;n<e.columns.length;n++){var s=kz(t,e,{start:n});s.columns.length&&(r.push(s),n=s.lastIndex)}return r}function Mk(t,e){var r=e.settings,n=r.startY,s=r.margin,a={x:s.left,y:n},i=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),l=n+s.bottom+i;if(r.pageBreak==="avoid"){var c=e.body,d=c.reduce(function(x,m){return x+m.height},0);l+=d}var h=new b0(t);(r.pageBreak==="always"||r.startY!=null&&l>h.pageSize().height)&&(Uk(h),a.y=s.top),e.callWillDrawPageHooks(h,a);var p=Sc({},a);e.startPageNumber=h.pageNumber(),r.horizontalPageBreak?Ez(h,e,p,a):(h.applyStyles(h.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(x){return Rc(h,e,x,a,e.columns)}),h.applyStyles(h.userStyles),e.body.forEach(function(x,m){var b=m===e.body.length-1;Fx(h,e,x,b,p,a,e.columns)}),h.applyStyles(h.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(x){return Rc(h,e,x,a,e.columns)})),Ck(h,e,p,a),e.callEndPageHooks(h,a),e.finalY=a.y,t.lastAutoTable=e,h.applyStyles(h.userStyles)}function Ez(t,e,r,n){var s=jz(t,e),a=e.settings;if(a.horizontalPageBreakBehaviour==="afterAllRows")s.forEach(function(d,h){t.applyStyles(t.userStyles),h>0?Dh(t,e,r,n,d.columns,!0):a_(t,e,n,d.columns),Az(t,e,r,n,d.columns),G1(t,e,n,d.columns)});else for(var i=-1,l=s[0],c=function(){var d=i;if(l){t.applyStyles(t.userStyles);var h=l.columns;i>=0?Dh(t,e,r,n,h,!0):a_(t,e,n,h),d=i_(t,e,i+1,n,h),G1(t,e,n,h)}var p=d-i;s.slice(1).forEach(function(x){t.applyStyles(t.userStyles),Dh(t,e,r,n,x.columns,!0),i_(t,e,i+1,n,x.columns,p),G1(t,e,n,x.columns)}),i=d};i<e.body.length-1;)c()}function a_(t,e,r,n){var s=e.settings;t.applyStyles(t.userStyles),(s.showHead==="firstPage"||s.showHead==="everyPage")&&e.head.forEach(function(a){return Rc(t,e,a,r,n)})}function Az(t,e,r,n,s){t.applyStyles(t.userStyles),e.body.forEach(function(a,i){var l=i===e.body.length-1;Fx(t,e,a,l,r,n,s)})}function i_(t,e,r,n,s,a){t.applyStyles(t.userStyles),a=a??e.body.length;var i=Math.min(r+a,e.body.length),l=-1;return e.body.slice(r,i).forEach(function(c,d){var h=r+d===e.body.length-1,p=Bk(t,e,h,n);c.canEntireRowFit(p,s)&&(Rc(t,e,c,n,s),l=r+d)}),l}function G1(t,e,r,n){var s=e.settings;t.applyStyles(t.userStyles),(s.showFoot==="lastPage"||s.showFoot==="everyPage")&&e.foot.forEach(function(a){return Rc(t,e,a,r,n)})}function Cz(t,e,r){var n=r.getLineHeight(t.styles.fontSize),s=t.padding("vertical"),a=Math.floor((e-s)/n);return Math.max(0,a)}function Tz(t,e,r,n){var s={};t.spansMultiplePages=!0,t.height=0;for(var a=0,i=0,l=r.columns;i<l.length;i++){var c=l[i],d=t.cells[c.index];if(d){Array.isArray(d.text)||(d.text=[d.text]);var h=new Ik(d.raw,d.styles,d.section);h=Sc(h,d),h.text=[];var p=Cz(d,e,n);d.text.length>p&&(h.text=d.text.splice(p,d.text.length));var x=n.scaleFactor(),m=n.getLineHeightFactor();d.contentHeight=d.getContentHeight(x,m),d.contentHeight>=e&&(d.contentHeight=e,h.styles.minCellHeight-=e),d.contentHeight>t.height&&(t.height=d.contentHeight),h.contentHeight=h.getContentHeight(x,m),h.contentHeight>a&&(a=h.contentHeight),s[c.index]=h}}var b=new Rk(t.raw,-1,t.section,s,!0);b.height=a;for(var y=0,w=r.columns;y<w.length;y++){var c=w[y],h=b.cells[c.index];h&&(h.height=b.height);var d=t.cells[c.index];d&&(d.height=t.height)}return b}function Fz(t,e,r,n){var s=t.pageSize().height,a=n.settings.margin,i=a.top+a.bottom,l=s-i;e.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=e.getMinimumRowHeight(n.columns,t),d=c<r;if(c>l)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!d)return!1;var h=e.hasRowSpan(n.columns),p=e.getMaxCellHeight(n.columns)>l;return p?(h&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(h||n.settings.rowPageBreak==="avoid")}function Fx(t,e,r,n,s,a,i){var l=Bk(t,e,n,a);if(r.canEntireRowFit(l,i))Rc(t,e,r,a,i);else if(Fz(t,r,l,e)){var c=Tz(r,l,e,t);Rc(t,e,r,a,i),Dh(t,e,s,a,i),Fx(t,e,c,n,s,a,i)}else Dh(t,e,s,a,i),Fx(t,e,r,n,s,a,i)}function Rc(t,e,r,n,s){n.x=e.settings.margin.left;for(var a=0,i=s;a<i.length;a++){var l=i[a],c=r.cells[l.index];if(!c){n.x+=l.width;continue}t.applyStyles(c.styles),c.x=n.x,c.y=n.y;var d=e.callCellHooks(t,e.hooks.willDrawCell,c,r,l,n);if(d===!1){n.x+=l.width;continue}Pz(t,c,n);var h=c.getTextPos();jk(c.text,h.x,h.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function Pz(t,e,r){var n=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var s=Tk(n.lineWidth,n.fillColor);s&&t.rect(e.x,r.y,e.width,e.height,s)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),Lz(t,e,r,n.lineWidth))}function Lz(t,e,r,n){var s,a,i,l;n.top&&(s=r.x,a=r.y,i=r.x+e.width,l=r.y,n.right&&(i+=.5*n.right),n.left&&(s-=.5*n.left),c(n.top,s,a,i,l)),n.bottom&&(s=r.x,a=r.y+e.height,i=r.x+e.width,l=r.y+e.height,n.right&&(i+=.5*n.right),n.left&&(s-=.5*n.left),c(n.bottom,s,a,i,l)),n.left&&(s=r.x,a=r.y,i=r.x,l=r.y+e.height,n.top&&(a-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,s,a,i,l)),n.right&&(s=r.x+e.width,a=r.y,i=r.x+e.width,l=r.y+e.height,n.top&&(a-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,s,a,i,l));function c(d,h,p,x,m){t.getDocument().setLineWidth(d),t.getDocument().line(h,p,x,m,"S")}}function Bk(t,e,r,n){var s=e.settings.margin.bottom,a=e.settings.showFoot;return(a==="everyPage"||a==="lastPage"&&r)&&(s+=e.getFootHeight(e.columns)),t.pageSize().height-n.y-s}function Dh(t,e,r,n,s,a){s===void 0&&(s=[]),a===void 0&&(a=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!a&&e.foot.forEach(function(l){return Rc(t,e,l,n,s)}),e.callEndPageHooks(t,n);var i=e.settings.margin;Ck(t,e,r,n),Uk(t),e.pageNumber++,n.x=i.left,n.y=i.top,r.y=i.top,e.callWillDrawPageHooks(t,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(l){return Rc(t,e,l,n,s)}),t.applyStyles(t.userStyles))}function Uk(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function Dz(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e[0],s=Dk(this,n),a=Ok(this,s);return Mk(this,a),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,n,s){jk(e,r,n,s,this)},t.API.autoTableSetDefaults=function(e){return b0.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){b0.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var s=new b0(this),a=Lk(s,e,window,r,!1),i=a.head,l=a.body,c=((n=i[0])===null||n===void 0?void 0:n.map(function(d){return d.content}))||[];return{columns:c,rows:l,data:l}}}var X1;function Rz(t,e){var r=Dk(t,e),n=Ok(t,r);Mk(t,n)}try{if(typeof window<"u"&&window){var o_=window,l_=o_.jsPDF||((X1=o_.jspdf)===null||X1===void 0?void 0:X1.jsPDF);l_&&Dz(l_)}}catch(t){console.error("Could not apply autoTable plugin",t)}const Iz=()=>{const{user:t,isAdmin:e}=Jr(),r=t?.username==="davidlopez10",n=Jo(),s=Oi(),[a,i]=Q.useState([]),[l,c]=Q.useState([]),[d,h]=Q.useState(!0),[p,x]=Q.useState(""),[m,b]=Q.useState("all"),[y,w]=Q.useState("all"),[S,k]=Q.useState(!1),[A,z]=Q.useState(null),[H,V]=Q.useState([]),[B,R]=Q.useState(!1),[O,ee]=Q.useState({departamento:"",sede:""}),[I,P]=Q.useState(!1);Q.useEffect(()=>{const L=new URLSearchParams(n.search),F=L.get("sede"),q=L.get("departamento");(F||q)&&(P(!0),ee({sede:F||"",departamento:q||""})),ae()},[n.search]),Q.useEffect(()=>{te()},[a,p,m,y]);const ae=async()=>{try{h(!0);const L={};O.departamento&&(L.departamento=O.departamento),O.sede&&e&&(L.sede=O.sede);const F=await Kt.getApproved(L);i(F.data)}catch(L){console.error("Error cargando incidencias aprobadas:",L)}finally{h(!1)}},G=()=>{s("/dashboard")},M=()=>{if(!I)return"";const L=[];if(O.sede){const F=O.sede==="bogota"?"Bogot":O.sede==="barranquilla"?"Barranquilla":O.sede==="villavicencio"?"Villavicencio":O.sede;L.push(`Ciudad: ${F}`)}if(O.departamento){const F=O.departamento==="obama"?"Obama":O.departamento==="majority"?"Majority":O.departamento==="claro"?"Claro":O.departamento;L.push(`Departamento: ${F}`)}return L.length>0?` (Filtrado por: ${L.join(", ")})`:""},te=()=>{let L=a;if(p&&(L=L.filter(F=>F.station_code.toLowerCase().includes(p.toLowerCase())||F.description.toLowerCase().includes(p.toLowerCase())||F.technician_name.toLowerCase().includes(p.toLowerCase())||F.reported_by_name.toLowerCase().includes(p.toLowerCase()))),m!=="all"){const F=new Date,q=new Date(F.getFullYear(),F.getMonth(),F.getDate());L=L.filter(he=>{const me=new Date(he.updated_at);switch(m){case"today":return me>=q;case"week":const Z=new Date(q.getTime()-10080*60*1e3);return me>=Z;case"month":const Se=new Date(q.getTime()-720*60*60*1e3);return me>=Se;default:return!0}})}y!=="all"&&(L=L.filter(F=>F.failure_type===y)),c(L)},ie=L=>({pantalla:"Pantalla",perifericos:"Perifricos",internet:"Internet",software:"Software",otro:"Otro"})[L]||L,le=L=>{const F={pantalla:"bg-blue-100 text-blue-800",perifericos:"bg-purple-100 text-purple-800",internet:"bg-red-100 text-red-800",software:"bg-green-100 text-green-800",otro:"bg-gray-100 text-gray-800"};return F[L]||F.otro},X=async L=>{z(L),R(!0),k(!0);try{const F=await Kt.getHistory(L.id);V(F.data)}catch(F){console.error("Error cargando historial:",F),alert("Error al cargar el historial")}finally{R(!1)}},fe=()=>{window.confirm(`Exportar ${l.length} incidencia(s) a Excel?

Filtros aplicados:
- Bsqueda: ${p||"Ninguno"}
- Fecha: ${m==="all"?"Todas":m==="today"?"Hoy":m==="week"?"ltima semana":"ltimo mes"}
- Tipo: ${y==="all"?"Todos":ie(y)}`)&&K()},K=()=>{const L=l.map((rt,De)=>({ID:rt.id,Nmero:De+1,"Estacin de Trabajo":rt.station_code,Ubicacin:rt.location_details||"N/A","Tipo de Falla":ie(rt.failure_type),"Descripcin del Problema":rt.description,"Tcnico Asignado":rt.technician_name,"Supervisor que Report":rt.reported_by_name,"Fecha de Creacin":new Date(rt.created_at).toLocaleDateString("es-ES"),"Hora de Creacin":new Date(rt.created_at).toLocaleTimeString("es-ES"),"Fecha de Resolucin":new Date(rt.updated_at).toLocaleDateString("es-ES"),"Hora de Resolucin":new Date(rt.updated_at).toLocaleTimeString("es-ES"),Estado:"APROBADO","Das para Resolucin":Math.ceil((new Date(rt.updated_at)-new Date(rt.created_at))/864e5)})),F={"Total de Incidencias":l.length,"Incidencias de Pantalla":l.filter(rt=>rt.failure_type==="pantalla").length,"Incidencias de Perifricos":l.filter(rt=>rt.failure_type==="perifericos").length,"Incidencias de Internet":l.filter(rt=>rt.failure_type==="internet").length,"Incidencias de Software":l.filter(rt=>rt.failure_type==="software").length,"Otras Incidencias":l.filter(rt=>rt.failure_type==="otro").length},q=na.book_new(),he=[["REPORTE DE INCIDENCIAS APROBADAS - CALL CENTER SUPPORT"],[""],["Generado el:",new Date().toLocaleDateString("es-ES")],["Hora de generacin:",new Date().toLocaleTimeString("es-ES")],["Total de registros:",l.length],[""],["ESTADSTICAS POR TIPO DE FALLA:"],["Pantalla:",F["Incidencias de Pantalla"]],["Perifricos:",F["Incidencias de Perifricos"]],["Internet:",F["Incidencias de Internet"]],["Software:",F["Incidencias de Software"]],["Otros:",F["Otras Incidencias"]],[""],["FILTROS APLICADOS:"],["Filtro de bsqueda:",p||"Ninguno"],["Filtro de fecha:",m==="all"?"Todas las fechas":m==="today"?"Hoy":m==="week"?"ltima semana":"ltimo mes"],["Filtro de tipo:",y==="all"?"Todos los tipos":ie(y)]],me=na.aoa_to_sheet(he);me["!cols"]=[{wch:40},{wch:20}],me.A1&&(me.A1.s={font:{bold:!0,sz:14}}),na.book_append_sheet(q,me,"Informacin del Reporte");const Z=na.json_to_sheet(L);Z["!cols"]=[{wch:8},{wch:8},{wch:15},{wch:25},{wch:15},{wch:50},{wch:20},{wch:20},{wch:15},{wch:15},{wch:15},{wch:15},{wch:12},{wch:12}],na.book_append_sheet(q,Z,"Incidencias Detalladas");const Se={};l.forEach(rt=>{const De=rt.technician_name;Se[De]||(Se[De]={Tcnico:De,"Total Incidencias":0,Pantalla:0,Perifricos:0,Internet:0,Software:0,Otros:0}),Se[De]["Total Incidencias"]++,Se[De][ie(rt.failure_type)]++});const We=Object.values(Se),ue=na.json_to_sheet(We);ue["!cols"]=[{wch:25},{wch:15},{wch:12},{wch:15},{wch:12},{wch:12},{wch:10}],na.book_append_sheet(q,ue,"Resumen por Tcnico");const nt=`Reporte_Incidencias_Aprobadas_${new Date().toISOString().split("T")[0]}.xlsx`;jx(q,nt)},E=async L=>{if(window.confirm(`Generar reporte PDF de la incidencia ${L.id}?

Estacin: ${L.station_code}
Tipo: ${ie(L.failure_type)}
Tcnico: ${L.technician_name}`))try{await W(L)}catch(q){console.error("Error generando PDF:",q),alert("Error al generar el reporte PDF")}},W=async L=>{const F=new or("portrait");F.setFont("helvetica"),F.setFontSize(16),F.text("REPORTE DETALLADO DE INCIDENCIA",20,20),F.text("CALL CENTER SUPPORT",20,28),F.setFontSize(10),F.text(`Generado el: ${new Date().toLocaleDateString("es-ES")} a las ${new Date().toLocaleTimeString("es-ES")}`,20,40),F.setFontSize(12),F.text("DETALLES DE LA INCIDENCIA:",20,50),F.setFontSize(10),F.text(`ID: ${L.id}`,20,57),F.text(`Estacin de Trabajo: ${L.station_code}`,20,62),F.text(`Tipo de Falla: ${ie(L.failure_type)}`,20,67),F.text(`Tcnico Asignado: ${L.technician_name}`,20,72),F.text(`Supervisor que Report: ${L.reported_by_name}`,20,77),F.text(`Fecha de Creacin: ${new Date(L.created_at).toLocaleDateString("es-ES")}`,20,82),F.text(`Fecha de Aprobacin: ${new Date(L.updated_at).toLocaleDateString("es-ES")}`,20,87),F.setFontSize(12),F.text("DESCRIPCIN DEL PROBLEMA:",20,97),F.setFontSize(10);const q=F.splitTextToSize(L.description,170);F.text(q,20,104);let he=104+q.length*5+10;try{const Se=(await Kt.getHistory(L.id)).data;if(F.setFontSize(12),F.text("HISTORIAL COMPLETO DE LA INCIDENCIA:",20,he),he+=10,Se&&Se.length>0){const We=Se.map(ue=>[new Date(ue.timestamp).toLocaleDateString("es-ES"),new Date(ue.timestamp).toLocaleTimeString("es-ES"),ue.action,ue.user_name,ue.details||"Sin comentarios adicionales"]);Rz(F,{startY:he,head:[["Fecha","Hora","Accin Realizada","Usuario","Detalles/Comentarios"]],body:We,styles:{fontSize:8,cellPadding:2,overflow:"linebreak",halign:"left"},headStyles:{fillColor:[66,139,202],textColor:255,fontStyle:"bold",fontSize:8},columnStyles:{0:{cellWidth:20},1:{cellWidth:15},2:{cellWidth:35},3:{cellWidth:25},4:{cellWidth:45}},tableWidth:"auto",margin:{top:10,right:10,bottom:20,left:10},didDrawPage:function(ue){F.setFontSize(10),F.text(`Reporte Detallado - Incidencia #${L.id}`,20,10);const nt=F.internal.getNumberOfPages(),rt=ue.pageNumber;F.text(`Pgina ${rt} de ${nt}`,20,F.internal.pageSize.height-10)}})}else F.setFontSize(10),F.text("No hay historial disponible para esta incidencia.",20,he)}catch(Z){console.warn(`Error obteniendo historial para incidencia ${L.id}:`,Z),F.setFontSize(10),F.text("Error al cargar el historial de la incidencia.",20,he)}const me=`Incidencia_${L.id}_${L.station_code}_${new Date().toISOString().split("T")[0]}.pdf`;F.save(me)};return d?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[o.jsx("div",{className:"flex-1",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[I&&o.jsxs("button",{onClick:G,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[o.jsx(Gx,{className:"h-4 w-4 mr-1"}),"Volver al Dashboard"]}),o.jsxs("div",{children:[o.jsxs("h1",{className:`text-xl sm:text-2xl font-bold ${r?"text-[#E5E7EB] ironman-glow":"text-gray-900"}`,children:["Historial de Incidencias Aprobadas",M()]}),o.jsx("p",{className:`text-sm sm:text-base mt-1 ${r?"text-[#94A3B8]":"text-gray-600"}`,children:"Registro completo de todas las incidencias resueltas y aprobadas"})]})]})}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-3",children:[o.jsx("div",{className:"bg-green-50 px-3 sm:px-4 py-2 rounded-lg",children:o.jsxs("span",{className:"text-green-700 font-medium text-sm",children:[l.length," de ",a.length," incidencia(s)"]})}),l.length>0&&o.jsxs("button",{onClick:fe,className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 w-full sm:w-auto justify-center",children:[o.jsx(yp,{className:"h-4 w-4 mr-1"}),"Excel (",l.length,")"]})]})]}),o.jsx("div",{className:"bg-white shadow rounded-lg p-4",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsx("div",{className:"md:col-span-2",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Lc,{className:"h-5 w-5 text-gray-400"})}),o.jsx("input",{type:"text",value:p,onChange:L=>x(L.target.value),placeholder:"Buscar incidencias...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})}),o.jsx("div",{children:o.jsxs("select",{value:m,onChange:L=>b(L.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"Todas las fechas"}),o.jsx("option",{value:"today",children:"Hoy"}),o.jsx("option",{value:"week",children:"ltima semana"}),o.jsx("option",{value:"month",children:"ltimo mes"})]})}),o.jsx("div",{children:o.jsxs("select",{value:y,onChange:L=>w(L.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"Todos los tipos"}),o.jsx("option",{value:"pantalla",children:"Pantalla"}),o.jsx("option",{value:"perifericos",children:"Perifricos"}),o.jsx("option",{value:"internet",children:"Internet"}),o.jsx("option",{value:"software",children:"Software"}),o.jsx("option",{value:"otro",children:"Otro"})]})})]})}),l.length===0?o.jsx("div",{className:"text-center py-12 bg-white rounded-lg shadow",children:a.length===0?o.jsxs(o.Fragment,{children:[o.jsx(Ws,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay incidencias aprobadas"}),o.jsx("p",{className:"text-gray-500",children:"Las incidencias aprobadas aparecern aqu."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Lc,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron resultados"}),o.jsx("p",{className:"text-gray-500",children:"Intenta ajustar los filtros de bsqueda."})]})}):o.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsx("div",{className:"space-y-4",children:l.map(L=>o.jsx("div",{className:"border border-green-200 rounded-lg p-4 bg-green-50",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-3 sm:space-y-0",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-4 mb-2",children:[o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(Fn,{className:"h-4 w-4 mr-1"}),o.jsx("span",{className:"font-medium",children:L.station_code}),o.jsxs("span",{className:"ml-2 text-xs bg-gray-100 px-2 py-1 rounded",children:[L.sede?.toUpperCase()," - ",L.departamento?.toUpperCase()]})]}),o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full w-fit ${le(L.failure_type)}`,children:ie(L.failure_type)}),L.is_recently_reassigned&&o.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-orange-100 text-orange-800 border border-orange-200",children:[o.jsx(ho,{className:"h-3 w-3 mr-1"}),"Reasignado"]}),o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(Bn,{className:"h-4 w-4 mr-1"}),o.jsxs("span",{className:"text-xs sm:text-sm",children:["Tcnico: ",L.technician_name]})]})]}),o.jsxs("div",{className:"flex items-start space-x-2 mb-2",children:[o.jsx(qn,{className:"h-4 w-4 text-gray-400 mt-0.5 flex-shrink-0"}),o.jsx("p",{className:"text-gray-900 font-medium",children:L.description})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-6 text-sm text-gray-500",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(ia,{className:"h-4 w-4 mr-1"}),o.jsxs("span",{className:"text-xs sm:text-sm",children:["Aprobado: ",new Date(L.updated_at).toLocaleDateString(),o.jsxs("span",{className:"hidden sm:inline",children:[" a las ",new Date(L.updated_at).toLocaleTimeString()]})]})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx(Bn,{className:"h-4 w-4 mr-1"}),o.jsxs("span",{className:"text-xs sm:text-sm",children:["Supervisor: ",L.reported_by_name]})]}),o.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 w-fit",children:[o.jsx(Ws,{className:"h-3 w-3 mr-1"}),"Aprobado"]})]})]}),o.jsxs("div",{className:"ml-0 sm:ml-4 flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 mt-3 sm:mt-0",children:[o.jsxs("button",{onClick:()=>X(L),className:"inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 justify-center",children:[o.jsx(Ec,{className:"h-4 w-4 mr-1"}),o.jsx("span",{className:"hidden sm:inline",children:"Ver Historial"}),o.jsx("span",{className:"sm:hidden",children:"Historial"})]}),o.jsxs("button",{onClick:()=>E(L),className:"inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 justify-center",children:[o.jsx(qn,{className:"h-4 w-4 mr-1"}),"PDF"]})]})]})},L.id))})})}),a.length>0&&o.jsxs("div",{className:"bg-white shadow rounded-lg p-4 sm:p-6",children:[o.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 mb-4",children:"Estadsticas"}),o.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-600",children:a.length}),o.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"Total Aprobadas"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-xl sm:text-2xl font-bold text-blue-600",children:a.filter(L=>L.failure_type==="perifericos").length}),o.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"Perifricos"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-xl sm:text-2xl font-bold text-purple-600",children:a.filter(L=>L.failure_type==="pantalla").length}),o.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"Pantalla"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-xl sm:text-2xl font-bold text-red-600",children:a.filter(L=>L.failure_type==="internet").length}),o.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:"Internet"})]})]})]}),S&&o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:o.jsx("div",{className:"relative top-4 sm:top-10 mx-auto p-4 sm:p-5 border max-w-2xl shadow-lg rounded-md bg-white m-4",children:o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Ec,{className:"h-6 w-6 text-blue-600 mr-2"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Historial de Incidencia"})]}),o.jsx("button",{onClick:()=>k(!1),className:"text-gray-400 hover:text-gray-600",children:o.jsx(Cc,{className:"h-6 w-6"})})]}),o.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded",children:[o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Estacin:"})," ",A?.station_code]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Tipo:"})," ",ie(A?.failure_type)]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Descripcin:"})," ",A?.description]}),A?.anydesk_address&&o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"AnyDesk:"})," ",o.jsx("span",{className:"font-mono text-blue-600",children:A.anydesk_address})]}),A?.advisor_cedula&&o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Cdula del Agente:"})," ",o.jsx("span",{className:"font-mono",children:A.advisor_cedula})]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Tcnico Asignado:"})," ",A?.technician_name]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("h4",{className:"text-sm sm:text-md font-medium text-gray-900 mb-3",children:"Historial de Acciones:"}),B?o.jsx("div",{className:"flex items-center justify-center py-4",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):H.length===0?o.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No hay historial disponible"}):o.jsx("div",{className:"space-y-3 max-h-48 sm:max-h-64 overflow-y-auto",children:H.map((L,F)=>o.jsx("div",{className:"border-l-4 border-blue-200 pl-4",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[L.action.includes("Rechazado")?o.jsx(Cc,{className:"h-4 w-4 text-red-500"}):L.action.includes("Aprobado")?o.jsx(Ws,{className:"h-4 w-4 text-green-500"}):L.action.includes("resuelto")||L.action.includes("Marcado")?o.jsx(ho,{className:"h-4 w-4 text-blue-500"}):L.action.includes("Asignacin")?o.jsx(Bn,{className:"h-4 w-4 text-purple-500"}):o.jsx(qu,{className:"h-4 w-4 text-gray-500"}),o.jsx("span",{className:"text-sm font-medium text-gray-900",children:L.action})]}),o.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["Por: ",o.jsx("strong",{children:L.user_name})]}),L.details&&o.jsxs("div",{className:`text-sm p-2 rounded mt-2 ${L.action.includes("Rechazado")?"bg-red-50 text-red-700 border border-red-200":L.action.includes("resuelto")||L.action.includes("Marcado")?"bg-blue-50 text-blue-700 border border-blue-200":"bg-gray-50 text-gray-700"}`,children:[o.jsx("strong",{children:L.action.includes("Rechazado")?"Motivo del rechazo: ":L.action.includes("resuelto")||L.action.includes("Marcado")?"Notas del tcnico: ":"Detalles: "}),L.details]}),e&&L.action.includes("Aprobado")&&L.technician_rating&&o.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mt-2",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx(Dc,{className:"h-4 w-4 text-yellow-600"}),o.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Calificacin del Tcnico"})]}),o.jsx("div",{className:"flex items-center space-x-2 mb-1",children:o.jsx(Xu,{rating:L.technician_rating,readonly:!0,size:"sm"})}),o.jsxs("p",{className:"text-xs text-gray-600",children:["Calificado por: ",o.jsx("strong",{children:L.rated_by_name})]}),L.rating_feedback&&o.jsxs("p",{className:"text-sm text-gray-700 mt-2",children:[o.jsx("strong",{children:"Comentarios:"})," ",L.rating_feedback]})]})]}),o.jsxs("span",{className:"text-xs text-gray-500 ml-2 text-right",children:[o.jsx("span",{className:"block",children:new Date(L.timestamp).toLocaleDateString()}),o.jsx("span",{className:"block sm:hidden",children:new Date(L.timestamp).toLocaleTimeString()}),o.jsx("span",{className:"hidden sm:block",children:new Date(L.timestamp).toLocaleTimeString()})]})]})},L.id||F))})]}),o.jsx("div",{className:"flex justify-end",children:o.jsx("button",{onClick:()=>k(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cerrar"})})]})})})]})},Oz=()=>{const{user:t,isAdmin:e}=Jr(),r=t?.username==="davidlopez10";Oi();const[n,s]=Q.useState([]),[a,i]=Q.useState([]),[l,c]=Q.useState(!0),[d,h]=Q.useState(""),[p,x]=Q.useState("all"),[m,b]=Q.useState(null),[y,w]=Q.useState(!1),[S,k]=Q.useState(!1),[A,z]=Q.useState(!1),[H,V]=Q.useState(""),[B,R]=Q.useState(""),[O,ee]=Q.useState(""),[I,P]=Q.useState(""),[ae,G]=Q.useState(""),M=()=>{t&&localStorage.setItem(`returned_incidents_viewed_${t.id}`,"true")};Q.useEffect(()=>{te(),M()},[]),Q.useEffect(()=>{ie()},[n,d,p]);const te=async()=>{try{c(!0);const F=await Kt.getReturnedIncidents();console.log("Response from API:",F);const q=F.data||F||[];console.log("Incidents data:",q);const he=Array.isArray(q)?q:[];s(he)}catch(F){console.error("Error obteniendo incidencias devueltas:",F),s([])}finally{c(!1)}},ie=()=>{if(!Array.isArray(n)){console.warn("incidents is not an array:",n),i([]);return}let F=n;d&&(F=F.filter(q=>(q.station_code||"").toLowerCase().includes(d.toLowerCase())||(q.description||"").toLowerCase().includes(d.toLowerCase())||(q.return_reason||"").toLowerCase().includes(d.toLowerCase()))),p!=="all"&&(F=F.filter(q=>q.failure_type===p)),i(F)},le=F=>{const q={pantalla:"bg-red-100 text-red-800",perifericos:"bg-yellow-100 text-yellow-800",internet:"bg-blue-100 text-blue-800",software:"bg-green-100 text-green-800",otro:"bg-gray-100 text-gray-800"};return q[F]||q.otro},X=F=>new Date(F).toLocaleString("es-CO",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"}),fe=F=>{b(F),w(!0)},K=F=>{b(F),V(F.description||""),R(F.anydesk_address||""),ee(F.advisor_cedula||""),P(F.puesto_numero||""),G(F.failure_type||""),k(!0)},E=async()=>{if(!m)return;const F={};if(H.trim()!==(m.description||"")&&(F.description=H.trim()),B.trim()!==(m.anydesk_address||"")&&(F.anydesk_address=B.trim()),O.trim()!==(m.advisor_cedula||"")&&(F.advisor_cedula=O.trim()),I!==(m.puesto_numero||"")&&(F.puesto_numero=parseInt(I)||null),ae!==(m.failure_type||"")&&(F.failure_type=ae),Object.keys(F).length===0){alert("No has realizado cambios en la informacin");return}z(!0);try{await Kt.correctIncident(m.id,F),k(!1),alert("Incidencia corregida y reenviada exitosamente. Ahora est disponible para asignacin."),await te()}catch(q){console.error("Error corrigiendo incidencia:",q),alert(q.response?.data?.msg||"Error al corregir la incidencia")}finally{z(!1)}},W=()=>{w(!1),b(null)},L=()=>{k(!1),b(null),V(""),R(""),ee(""),P(""),G("")};return l?o.jsx("div",{className:"flex justify-center items-center min-h-screen",children:o.jsx("div",{className:`animate-spin rounded-full h-32 w-32 border-b-2 ${r?"border-[#00E5FF]":"border-indigo-500"}`})}):o.jsxs("div",{className:`p-6 min-h-screen ${r?"bg-[#0B0F14]":"bg-white"}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(uo,{className:`w-8 h-8 ${r?"text-[#FF6A00]":"text-orange-600"}`}),o.jsxs("div",{children:[o.jsx("h1",{className:`text-2xl font-bold ${r?"text-[#E5E7EB] ironman-glow":"text-gray-900"}`,children:"Incidencias Devueltas"}),o.jsx("p",{className:r?"text-[#94A3B8]":"text-gray-600",children:"Casos devueltos por los tcnicos que requieren correcciones"})]})]}),o.jsxs("button",{onClick:te,className:`flex items-center space-x-2 text-white px-4 py-2 rounded-lg transition duration-200 ${r?"bg-gradient-to-r from-[#E10600] to-[#FF6A00] hover:from-[#FF6A00] hover:to-[#E10600]":"bg-orange-600 hover:bg-orange-700"}`,children:[o.jsx(Pc,{className:"w-4 h-4"}),o.jsx("span",{children:"Actualizar"})]})]}),o.jsx("div",{className:`p-4 rounded-lg mb-6 ${r?"bg-[#0F172A] border border-cyan-500/20":"bg-gray-50"}`,children:o.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[o.jsx("div",{className:"flex-1",children:o.jsxs("div",{className:"relative",children:[o.jsx(Lc,{className:"w-5 h-5 absolute left-3 top-3 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Buscar por cdigo, descripcin o motivo de devolucin...",value:d,onChange:F=>h(F.target.value),className:`w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:border-transparent ${r?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50":"border-gray-300 focus:ring-orange-500"}`})]})}),o.jsxs("select",{value:p,onChange:F=>x(F.target.value),className:`px-4 py-2 border rounded-lg focus:ring-2 ${r?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50":"border-gray-300 focus:ring-orange-500"}`,children:[o.jsx("option",{value:"all",children:"Todos los tipos"}),o.jsx("option",{value:"pantalla",children:"Pantalla"}),o.jsx("option",{value:"perifericos",children:"Perifricos"}),o.jsx("option",{value:"internet",children:"Internet"}),o.jsx("option",{value:"software",children:"Software"}),o.jsx("option",{value:"otro",children:"Otro"})]})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[o.jsx("div",{className:`p-4 rounded-lg border ${r?"bg-orange-500/10 border-orange-500/30":"bg-orange-50 border-orange-200"}`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:`font-medium ${r?"text-[#FF6A00]":"text-orange-600"}`,children:"Total Devueltas"}),o.jsx("p",{className:`text-2xl font-bold ${r?"text-[#FF6A00]":"text-orange-800"}`,children:n.length})]}),o.jsx(uo,{className:`w-8 h-8 ${r?"text-[#FF6A00]":"text-orange-600"}`})]})}),o.jsx("div",{className:`p-4 rounded-lg border ${r?"bg-red-500/10 border-red-500/30":"bg-yellow-50 border-yellow-200"}`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:`font-medium ${r?"text-[#E10600]":"text-yellow-600"}`,children:"Reincidencias"}),o.jsx("p",{className:`text-2xl font-bold ${r?"text-[#E10600]":"text-yellow-800"}`,children:n.filter(F=>F.return_count>1).length})]}),o.jsx(Di,{className:`w-8 h-8 ${r?"text-[#E10600]":"text-yellow-600"}`})]})}),o.jsx("div",{className:`p-4 rounded-lg border ${r?"bg-cyan-500/10 border-cyan-500/30":"bg-blue-50 border-blue-200"}`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:`font-medium ${r?"text-[#00E5FF]":"text-blue-600"}`,children:"Filtradas"}),o.jsx("p",{className:`text-2xl font-bold ${r?"text-[#00E5FF]":"text-blue-800"}`,children:a.length})]}),o.jsx(Lc,{className:`w-8 h-8 ${r?"text-[#00E5FF]":"text-blue-600"}`})]})})]}),a.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(uo,{className:`w-16 h-16 mx-auto mb-4 ${r?"text-[#94A3B8]":"text-gray-300"}`}),o.jsx("h3",{className:`text-lg font-medium mb-2 ${r?"text-[#E5E7EB]":"text-gray-900"}`,children:"No hay incidencias devueltas"}),o.jsx("p",{className:r?"text-[#94A3B8]":"text-gray-500",children:n.length===0?"No tienes incidencias devueltas en este momento.":"No se encontraron incidencias que coincidan con los filtros."})]}):o.jsx("div",{className:"space-y-3",children:a.map(F=>o.jsxs("div",{className:`rounded-lg p-4 shadow-sm hover:shadow-md transition duration-200 cursor-pointer ${r?"bg-[#0F172A] border border-cyan-500/20":"bg-white border border-orange-200"}`,onClick:()=>fe(F),children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${r?"bg-orange-500/20 text-[#FF6A00]":"bg-orange-100 text-orange-800"}`,children:[o.jsx(uo,{className:"w-3 h-3 mr-1"}),"Devuelto"]}),o.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${le(F.failure_type)}`,children:F.failure_type}),F.return_count>1&&o.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[F.return_count,"x"]})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("div",{className:`flex items-center text-sm ${r?"text-[#E5E7EB]":"text-gray-600"}`,children:[o.jsx(Fn,{className:"w-4 h-4 mr-1"}),o.jsx("span",{className:"font-mono font-medium",children:F.station_code})]}),o.jsxs("div",{className:`flex items-center text-sm ${r?"text-[#94A3B8]":"text-gray-500"}`,children:[o.jsx(qs,{className:"w-4 h-4 mr-1"}),o.jsx("span",{children:X(F.returned_at)})]})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("button",{onClick:q=>{q.stopPropagation(),fe(F)},className:`flex items-center space-x-1 px-2 py-1 rounded transition duration-200 ${r?"text-[#00E5FF] hover:text-[#00B4D8]":"text-blue-600 hover:text-blue-700"}`,children:[o.jsx(Dl,{className:"w-4 h-4"}),o.jsx("span",{className:"text-sm",children:"Ver"})]}),!e&&o.jsxs("button",{onClick:q=>{q.stopPropagation(),K(F)},className:`flex items-center space-x-1 text-white px-3 py-1 rounded transition duration-200 ${r?"bg-gradient-to-r from-[#E10600] to-[#FF6A00] hover:from-[#FF6A00] hover:to-[#E10600]":"bg-orange-600 hover:bg-orange-700"}`,children:[o.jsx(Sh,{className:"w-4 h-4"}),o.jsx("span",{className:"text-sm",children:"Corregir"})]})]})]}),o.jsx("div",{className:"mt-2",children:o.jsx("p",{className:`text-sm line-clamp-1 ${r?"text-[#94A3B8]":"text-gray-600"}`,children:F.description})})]},F.id))}),y&&m&&o.jsx("div",{className:`fixed inset-0 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4 ${r?"bg-black bg-opacity-70":"bg-gray-600 bg-opacity-50"}`,children:o.jsxs("div",{className:`rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-xl ${r?"bg-[#0F172A] border border-cyan-500/30":"bg-white"}`,children:[o.jsxs("div",{className:`flex items-center justify-between p-6 border-b ${r?"border-cyan-500/20":"border-gray-200"}`,children:[o.jsxs("h3",{className:`text-lg font-semibold flex items-center ${r?"text-[#E5E7EB]":"text-gray-900"}`,children:[o.jsx(uo,{className:`w-5 h-5 mr-2 ${r?"text-[#FF6A00]":"text-orange-600"}`}),"Detalles de Incidencia Devuelta"]}),o.jsx("button",{onClick:W,className:`transition duration-200 ${r?"text-[#94A3B8] hover:text-[#E5E7EB]":"text-gray-400 hover:text-gray-600"}`,children:o.jsx(gs,{className:"w-6 h-6"})})]}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[o.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-orange-100 text-orange-800",children:[o.jsx(uo,{className:"w-4 h-4 mr-1"}),"Devuelto"]}),o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${le(m.failure_type)}`,children:m.failure_type}),m.return_count>1&&o.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:["Reincidencia (",m.return_count,"x)"]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center text-sm",children:[o.jsx(Fn,{className:`w-4 h-4 mr-2 ${r?"text-[#00E5FF]":"text-gray-400"}`}),o.jsx("span",{className:`font-medium ${r?"text-[#E5E7EB]":"text-gray-700"}`,children:"Estacin:"}),o.jsx("span",{className:"ml-2 font-mono",children:m.station_code})]}),o.jsxs("div",{className:"flex items-center text-sm",children:[o.jsx(Bn,{className:`w-4 h-4 mr-2 ${r?"text-[#00E5FF]":"text-gray-400"}`}),o.jsx("span",{className:`font-medium ${r?"text-[#E5E7EB]":"text-gray-700"}`,children:"Devuelto por:"}),o.jsx("span",{className:"ml-2",children:m.returned_by_name})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center text-sm",children:[o.jsx(ia,{className:`w-4 h-4 mr-2 ${r?"text-[#00E5FF]":"text-gray-400"}`}),o.jsx("span",{className:`font-medium ${r?"text-[#E5E7EB]":"text-gray-700"}`,children:"Creado:"}),o.jsx("span",{className:"ml-2",children:X(m.created_at)})]}),o.jsxs("div",{className:"flex items-center text-sm",children:[o.jsx(qs,{className:`w-4 h-4 mr-2 ${r?"text-[#00E5FF]":"text-gray-400"}`}),o.jsx("span",{className:`font-medium ${r?"text-[#E5E7EB]":"text-gray-700"}`,children:"Devuelto:"}),o.jsx("span",{className:"ml-2",children:X(m.returned_at)})]})]})]}),o.jsx("div",{className:"mb-6",children:o.jsxs("div",{className:"flex items-start",children:[o.jsx(qn,{className:`w-4 h-4 mr-2 mt-0.5 ${r?"text-[#00E5FF]":"text-gray-400"}`}),o.jsxs("div",{className:"flex-1",children:[o.jsx("span",{className:`text-sm font-medium ${r?"text-[#E5E7EB]":"text-gray-700"}`,children:"Descripcin del problema:"}),o.jsx("p",{className:`text-sm mt-1 p-3 rounded-md ${r?"text-[#94A3B8] bg-[#0B0F14]":"text-gray-600 bg-gray-50"}`,children:m.description})]})]})}),o.jsx("div",{className:"mb-6",children:o.jsx("div",{className:`p-4 rounded-lg border ${r?"bg-orange-500/10 border-orange-500/30":"bg-orange-50 border-orange-200"}`,children:o.jsxs("div",{className:"flex items-start",children:[o.jsx(qu,{className:`w-5 h-5 mr-2 mt-0.5 ${r?"text-[#FF6A00]":"text-orange-600"}`}),o.jsxs("div",{className:"flex-1",children:[o.jsx("span",{className:`text-sm font-medium ${r?"text-[#FF6A00]":"text-orange-800"}`,children:"Motivo de devolucin:"}),o.jsx("p",{className:`text-sm mt-2 ${r?"text-[#FF6A00]":"text-orange-700"}`,children:m.return_reason})]})]})})}),m.sede==="barranquilla"&&(m.anydesk_address||m.advisor_cedula)&&o.jsxs("div",{className:"mb-6",children:[o.jsx("h4",{className:`text-sm font-medium mb-3 ${r?"text-[#E5E7EB]":"text-gray-700"}`,children:"Informacin de trabajo remoto:"}),o.jsx("div",{className:`p-3 rounded-lg border ${r?"bg-cyan-500/10 border-cyan-500/30":"bg-blue-50 border-blue-200"}`,children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m.anydesk_address&&o.jsxs("div",{className:"text-sm",children:[o.jsx("span",{className:"font-medium text-blue-800",children:"AnyDesk:"}),o.jsx("span",{className:"ml-2 font-mono text-blue-700",children:m.anydesk_address})]}),m.advisor_cedula&&o.jsxs("div",{className:"text-sm",children:[o.jsx("span",{className:"font-medium text-blue-800",children:"Cdula del asesor:"}),o.jsx("span",{className:"ml-2 font-mono text-blue-700",children:m.advisor_cedula})]})]})})]}),o.jsxs("div",{className:`flex justify-end space-x-3 pt-4 border-t ${r?"border-cyan-500/20":"border-gray-200"}`,children:[o.jsx("button",{onClick:W,className:`px-4 py-2 text-sm font-medium rounded-md hover:bg-gray-200 transition duration-200 ${r?"text-[#94A3B8] bg-[#0B0F14] border border-cyan-500/30":"text-gray-700 bg-gray-100 border border-gray-300"}`,children:"Cerrar"}),!e&&o.jsxs("button",{onClick:()=>{W(),K(m)},className:`flex items-center space-x-2 px-4 py-2 text-sm font-medium text-white border border-transparent rounded-md transition duration-200 ${r?"bg-gradient-to-r from-[#E10600] to-[#FF6A00] hover:from-[#FF6A00] hover:to-[#E10600]":"bg-orange-600 hover:bg-orange-700"}`,children:[o.jsx(Sh,{className:"w-4 h-4"}),o.jsx("span",{children:"Corregir Incidencia"})]})]})]})]})}),S&&m&&o.jsx("div",{className:`fixed inset-0 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4 ${r?"bg-black bg-opacity-70":"bg-gray-600 bg-opacity-50"}`,children:o.jsxs("div",{className:`rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-xl ${r?"bg-[#0F172A] border border-cyan-500/30":"bg-white"}`,children:[o.jsxs("div",{className:`flex items-center justify-between p-6 border-b ${r?"border-cyan-500/20":"border-gray-200"}`,children:[o.jsxs("h3",{className:`text-lg font-semibold flex items-center ${r?"text-[#E5E7EB]":"text-gray-900"}`,children:[o.jsx(Sh,{className:`w-5 h-5 mr-2 ${r?"text-[#FF6A00]":"text-orange-600"}`}),"Corregir Incidencia Devuelta"]}),o.jsx("button",{onClick:L,className:`transition duration-200 ${r?"text-[#94A3B8] hover:text-[#E5E7EB]":"text-gray-400 hover:text-gray-600"}`,disabled:A,children:o.jsx(gs,{className:"w-6 h-6"})})]}),o.jsxs("div",{className:"p-6",children:[o.jsx("div",{className:`mb-6 p-4 rounded-lg border ${r?"bg-orange-500/10 border-orange-500/30":"bg-orange-50 border-orange-200"}`,children:o.jsxs("div",{className:"flex items-start",children:[o.jsx(Di,{className:`w-5 h-5 mr-2 mt-0.5 ${r?"text-[#FF6A00]":"text-orange-600"}`}),o.jsxs("div",{children:[o.jsx("h4",{className:`text-sm font-medium ${r?"text-[#FF6A00]":"text-orange-800"}`,children:"Motivo de devolucin:"}),o.jsx("p",{className:`text-sm mt-1 ${r?"text-[#FF6A00]":"text-orange-700"}`,children:m.return_reason})]})]})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:`block text-sm font-medium mb-1 ${r?"text-[#E5E7EB]":"text-gray-700"}`,children:"Descripcin del problema"}),o.jsx("textarea",{value:H,onChange:F=>V(F.target.value),placeholder:"Describe detalladamente el problema...",className:`w-full px-3 py-2 border rounded-md focus:ring-2 focus:border-transparent ${r?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50":"border-gray-300 focus:ring-orange-500"}`,rows:"3",disabled:A})]}),o.jsxs("div",{children:[o.jsx("label",{className:`block text-sm font-medium mb-1 ${r?"text-[#E5E7EB]":"text-gray-700"}`,children:"Tipo de falla"}),o.jsxs("select",{value:ae,onChange:F=>G(F.target.value),className:`w-full px-3 py-2 border rounded-md focus:ring-2 ${r?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50":"border-gray-300 focus:ring-orange-500"}`,disabled:A,children:[o.jsx("option",{value:"",children:"Seleccionar tipo"}),o.jsx("option",{value:"pantalla",children:"Pantalla"}),o.jsx("option",{value:"perifericos",children:"Perifricos"}),o.jsx("option",{value:"internet",children:"Internet"}),o.jsx("option",{value:"software",children:"Software"}),o.jsx("option",{value:"otro",children:"Otro"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:`block text-sm font-medium mb-1 ${r?"text-[#E5E7EB]":"text-gray-700"}`,children:"Nmero de puesto"}),o.jsx("input",{type:"number",value:I,onChange:F=>P(F.target.value),placeholder:"Ej: 45",min:"1",max:"300",className:`w-full px-3 py-2 border rounded-md focus:ring-2 ${r?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50":"border-gray-300 focus:ring-orange-500"}`,disabled:A})]}),m.sede==="barranquilla"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:`block text-sm font-medium mb-1 ${r?"text-[#E5E7EB]":"text-gray-700"}`,children:"Direccin AnyDesk"}),o.jsx("input",{type:"text",value:B,onChange:F=>R(F.target.value),placeholder:"Ej: 123456789",className:`w-full px-3 py-2 border rounded-md focus:ring-2 ${r?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50":"border-gray-300 focus:ring-orange-500"}`,disabled:A})]}),o.jsxs("div",{children:[o.jsx("label",{className:`block text-sm font-medium mb-1 ${r?"text-[#E5E7EB]":"text-gray-700"}`,children:"Cdula del asesor"}),o.jsx("input",{type:"text",value:O,onChange:F=>ee(F.target.value),placeholder:"Ej: 1234567890",className:`w-full px-3 py-2 border rounded-md focus:ring-2 ${r?"border-cyan-500/30 bg-[#0B0F14] text-[#E5E7EB] focus:ring-cyan-500/50":"border-gray-300 focus:ring-orange-500"}`,disabled:A})]})]})]}),o.jsxs("div",{className:`flex justify-end space-x-3 pt-6 border-t mt-6 ${r?"border-cyan-500/20":"border-gray-200"}`,children:[o.jsx("button",{onClick:L,disabled:A,className:`px-4 py-2 text-sm font-medium rounded-md hover:bg-gray-200 transition duration-200 disabled:opacity-50 ${r?"text-[#94A3B8] bg-[#0B0F14] border border-cyan-500/30":"text-gray-700 bg-gray-100 border border-gray-300"}`,children:"Cancelar"}),o.jsx("button",{onClick:E,disabled:A,className:`flex items-center space-x-2 px-4 py-2 text-sm font-medium text-white border border-transparent rounded-md transition duration-200 disabled:opacity-50 ${r?"bg-gradient-to-r from-[#E10600] to-[#FF6A00] hover:from-[#FF6A00] hover:to-[#E10600]":"bg-orange-600 hover:bg-orange-700"}`,children:A?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),o.jsx("span",{children:"Guardando..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(bp,{className:"w-4 h-4"}),o.jsx("span",{children:"Corregir y Reenviar"})]})})]})]})]})})]})},Mz=()=>{const{user:t}=Jr(),[e,r]=Q.useState([]),[n,s]=Q.useState(!0),[a,i]=Q.useState(null),[l,c]=Q.useState(!1),[d,h]=Q.useState(""),[p,x]=Q.useState(""),[m,b]=Q.useState(!1),[y,w]=Q.useState(0),[S,k]=Q.useState(""),[A,z]=Q.useState(!1),[H,V]=Q.useState([]),[B,R]=Q.useState(!1);Q.useEffect(()=>{O()},[]);const O=async()=>{try{s(!0);const te=(await Kt.getInSupervision()).data.filter(ie=>ie.reported_by_name===t.full_name);r(te)}catch(M){console.error("Error cargando mis incidencias:",M)}finally{s(!1)}},ee=(M,te)=>{i(M),h(te),c(!0),x(""),w(0),k("")},I=async M=>{try{R(!0),i(M);const te=await Kt.getHistory(M.id);V(te.data),z(!0)}catch(te){console.error("Error cargando historial:",te),alert("Error cargando el historial de la incidencia")}finally{R(!1)}},P=async()=>{if(a){if(d==="approve"&&y===0){alert("Debes calificar al tcnico antes de aprobar la incidencia");return}try{b(!0);const M={notes:p};d==="approve"&&y>0&&(M.rating=y,M.feedback=S),d==="approve"?(await Kt.approve(a.id,M),alert("Incidencia aprobada exitosamente")):(await Kt.reject(a.id,p),alert("Incidencia rechazada")),c(!1),O()}catch(M){console.error("Error procesando accin:",M),alert("Error al procesar la accin")}finally{b(!1)}}},ae=M=>new Date(M).toLocaleString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),G=M=>({pantalla:"Pantalla",perifericos:"Perifricos",internet:"Internet",software:"Software",otro:"Otro"})[M]||M;return n?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Mis Incidencias en Supervisin"}),o.jsx("p",{className:"text-gray-600",children:"Revisa y aprueba tus incidencias resueltas por los tcnicos"})]}),o.jsx("div",{className:"bg-purple-50 px-4 py-2 rounded-lg",children:o.jsxs("span",{className:"text-purple-700 font-medium",children:[e.length," incidencia(s) ma(s)"]})})]}),e.length===0?o.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow",children:[o.jsx(Ws,{className:"h-12 w-12 text-green-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Todo al da!"}),o.jsx("p",{className:"text-gray-500",children:"No tienes incidencias esperando tu supervisin en este momento."})]}):o.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsx("div",{className:"space-y-4",children:e.map(M=>o.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[o.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[o.jsx(Fn,{className:"h-4 w-4 mr-1"}),o.jsx("span",{className:"font-medium",children:M.station_code}),o.jsxs("span",{className:"ml-2 text-xs bg-gray-100 px-2 py-1 rounded",children:[M.sede?.toUpperCase()," - ",M.departamento?.toUpperCase()]})]}),o.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[o.jsx(Di,{className:"h-4 w-4 mr-1"}),o.jsx("span",{className:"font-medium",children:G(M.failure_type)})]}),o.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[o.jsx(qs,{className:"h-4 w-4 mr-1"}),ae(M.created_at)]})]}),o.jsx("p",{className:"text-gray-700 mb-2",children:M.description}),o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(Bn,{className:"h-4 w-4 mr-1"}),o.jsxs("span",{children:["Tcnico: ",o.jsx("span",{className:"font-medium",children:M.assigned_to_name})]})]})]}),o.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[o.jsxs("button",{onClick:()=>I(M),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[o.jsx(Ec,{className:"h-4 w-4 mr-1"}),"Ver Historial"]}),o.jsxs("button",{onClick:()=>ee(M,"approve"),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[o.jsx($h,{className:"h-4 w-4 mr-1"}),"Aprobar"]}),o.jsxs("button",{onClick:()=>ee(M,"reject"),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[o.jsx(gs,{className:"h-4 w-4 mr-1"}),"Rechazar"]})]})]})},M.id))})})}),l&&o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:o.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:o.jsxs("div",{className:"mt-3",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:d==="approve"?"Aprobar Incidencia":"Rechazar Incidencia"}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:d==="approve"?"Comentarios de aprobacin:":"Motivo del rechazo:"}),o.jsx("textarea",{value:p,onChange:M=>x(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"3",placeholder:d==="approve"?"Agregar comentarios (opcional)":"Especificar el motivo del rechazo"})]}),d==="approve"&&o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Calificar al Tcnico: ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Xu,{rating:y,onRatingChange:w,size:"large"}),o.jsxs("span",{className:"text-sm text-gray-600",children:["(",y,"/5)"]})]}),o.jsx("textarea",{value:S,onChange:M=>k(M.target.value),className:"mt-2 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"2",placeholder:"Feedback para el tcnico (opcional)"})]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>c(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancelar"}),o.jsx("button",{onClick:P,disabled:m,className:`px-4 py-2 text-sm font-medium text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 ${d==="approve"?"bg-green-600 hover:bg-green-700 focus:ring-green-500":"bg-red-600 hover:bg-red-700 focus:ring-red-500"} ${m?"opacity-50 cursor-not-allowed":""}`,children:m?"Procesando...":d==="approve"?"Aprobar":"Rechazar"})]})]})})}),A&&o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:o.jsx("div",{className:"relative top-10 mx-auto p-5 border w-4/5 max-w-4xl shadow-lg rounded-md bg-white",children:o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Historial de Incidencia #",a?.id]}),o.jsx("button",{onClick:()=>z(!1),className:"text-gray-400 hover:text-gray-600",children:o.jsx(gs,{className:"h-6 w-6"})})]}),B?o.jsx("div",{className:"flex justify-center py-4",children:o.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"})}):o.jsx("div",{className:"max-h-96 overflow-y-auto",children:o.jsx("div",{className:"space-y-4",children:H.map((M,te)=>o.jsxs("div",{className:"border-l-4 border-blue-200 pl-4 py-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"font-medium text-gray-900",children:M.action}),M.technician_rating&&o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(Dc,{className:"h-4 w-4 text-yellow-400 fill-current"}),o.jsxs("span",{className:"text-sm text-gray-600",children:[M.technician_rating,"/5"]})]})]}),o.jsx("span",{className:"text-sm text-gray-500",children:ae(M.timestamp)})]}),o.jsx("p",{className:"text-gray-600 text-sm mt-1",children:M.user_name}),M.details&&o.jsx("p",{className:"text-gray-700 mt-2",children:M.details}),M.rating_feedback&&o.jsxs("p",{className:"text-gray-600 text-sm mt-1 italic",children:["Feedback: ",M.rating_feedback]})]},te))})})]})})})]})},Bz=()=>{const{user:t}=Jr(),[e,r]=Q.useState([]),[n,s]=Q.useState({}),[a,i]=Q.useState([]),[l,c]=Q.useState(!0),[d,h]=Q.useState(""),[p,x]=Q.useState("all"),[m,b]=Q.useState(null),[y,w]=Q.useState(!1);Q.useEffect(()=>{S()},[]),Q.useEffect(()=>{k()},[e,d,p]);const S=async()=>{try{c(!0);const R=await Kt.getMyReports();r(R.data.incidents),s(R.data.stats)}catch(R){console.error("Error obteniendo mis reportes:",R),r([]),s({})}finally{c(!1)}},k=()=>{let R=e;d&&(R=R.filter(O=>(O.station_code||"").toLowerCase().includes(d.toLowerCase())||(O.description||"").toLowerCase().includes(d.toLowerCase())||(O.technician_name||"").toLowerCase().includes(d.toLowerCase()))),p!=="all"&&(R=R.filter(O=>O.status===p)),i(R)},A=R=>{const O={pendiente:{label:"Pendiente",color:"bg-yellow-100 text-yellow-800 border-yellow-200",icon:qs,description:"Esperando asignacin de tcnico"},en_proceso:{label:"En Proceso",color:"bg-blue-100 text-blue-800 border-blue-200",icon:ho,description:"Tcnico trabajando en el caso"},en_supervision:{label:"En Supervisin",color:"bg-purple-100 text-purple-800 border-purple-200",icon:Dl,description:"Esperando tu aprobacin"},aprobado:{label:"Aprobado",color:"bg-green-100 text-green-800 border-green-200",icon:Ws,description:"Caso resuelto y aprobado"},rechazado:{label:"Rechazado",color:"bg-red-100 text-red-800 border-red-200",icon:Di,description:"Regresado al tcnico para revisin"},devuelto:{label:"Devuelto",color:"bg-orange-100 text-orange-800 border-orange-200",icon:uo,description:"Requiere correcciones de tu parte"}};return O[R]||O.pendiente},z=R=>{const O={pantalla:"bg-red-100 text-red-800",perifericos:"bg-yellow-100 text-yellow-800",internet:"bg-blue-100 text-blue-800",software:"bg-green-100 text-green-800",otro:"bg-gray-100 text-gray-800"};return O[R]||O.otro},H=R=>new Date(R).toLocaleString("es-CO",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"}),V=R=>{b(R),w(!0)},B=()=>{w(!1),b(null)};return l?o.jsx("div",{className:"flex justify-center items-center min-h-screen",children:o.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-indigo-500"})}):o.jsxs("div",{className:"p-6 bg-white min-h-screen",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(qn,{className:"w-8 h-8 text-blue-600"}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Mis Casos Reportados"}),o.jsx("p",{className:"text-gray-600",children:"Seguimiento completo de las incidencias que has reportado"})]})]}),o.jsxs("button",{onClick:S,className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-200",children:[o.jsx(Pc,{className:"w-4 h-4"}),o.jsx("span",{children:"Actualizar"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6",children:[o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-gray-600 font-medium",children:"Total"}),o.jsx("p",{className:"text-2xl font-bold text-gray-800",children:n.total||0})]})}),o.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-yellow-600 font-medium",children:"Pendiente"}),o.jsx("p",{className:"text-2xl font-bold text-yellow-800",children:n.pendiente||0})]})}),o.jsx("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-blue-600 font-medium",children:"En Proceso"}),o.jsx("p",{className:"text-2xl font-bold text-blue-800",children:n.en_proceso||0})]})}),o.jsx("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-purple-600 font-medium",children:"Supervisin"}),o.jsx("p",{className:"text-2xl font-bold text-purple-800",children:n.en_supervision||0})]})}),o.jsx("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-green-600 font-medium",children:"Aprobado"}),o.jsx("p",{className:"text-2xl font-bold text-green-800",children:n.aprobado||0})]})}),o.jsx("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-orange-600 font-medium",children:"Devuelto"}),o.jsx("p",{className:"text-2xl font-bold text-orange-800",children:n.devuelto||0})]})})]}),o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:o.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[o.jsx("div",{className:"flex-1",children:o.jsxs("div",{className:"relative",children:[o.jsx(Lc,{className:"w-5 h-5 absolute left-3 top-3 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Buscar por cdigo, descripcin o tcnico...",value:d,onChange:R=>h(R.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),o.jsxs("select",{value:p,onChange:R=>x(R.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"all",children:"Todos los estados"}),o.jsx("option",{value:"pendiente",children:"Pendiente"}),o.jsx("option",{value:"en_proceso",children:"En Proceso"}),o.jsx("option",{value:"en_supervision",children:"En Supervisin"}),o.jsx("option",{value:"aprobado",children:"Aprobado"}),o.jsx("option",{value:"rechazado",children:"Rechazado"}),o.jsx("option",{value:"devuelto",children:"Devuelto"})]})]})}),a.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(qn,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay reportes"}),o.jsx("p",{className:"text-gray-500",children:e.length===0?"No has reportado ninguna incidencia an.":"No se encontraron reportes que coincidan con los filtros."})]}):o.jsx("div",{className:"space-y-3",children:a.map(R=>{const O=A(R.status),ee=O.icon;return o.jsxs("div",{className:`bg-white border rounded-lg p-4 shadow-sm hover:shadow-md transition duration-200 cursor-pointer ${O.color.includes("border")?O.color:"border-gray-200"}`,onClick:()=>V(R),children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4 flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${O.color}`,children:[o.jsx(ee,{className:"w-4 h-4 mr-1"}),O.label]}),o.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${z(R.failure_type)}`,children:R.failure_type}),R.return_count>0&&o.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[R.return_count,"x devuelto"]})]}),o.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-600",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Fn,{className:"w-4 h-4 mr-1"}),o.jsx("span",{className:"font-mono font-medium",children:R.station_code})]}),R.technician_name&&o.jsxs("div",{className:"flex items-center",children:[o.jsx(Bn,{className:"w-4 h-4 mr-1"}),o.jsx("span",{children:R.technician_name})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx(ia,{className:"w-4 h-4 mr-1"}),o.jsx("span",{children:H(R.updated_at)})]})]})]}),o.jsx("div",{className:"flex items-center",children:o.jsx(m3,{className:"w-5 h-5 text-gray-400"})})]}),o.jsx("div",{className:"mt-2 text-sm text-gray-600 line-clamp-1",children:R.description}),o.jsx("div",{className:"mt-2 text-xs text-gray-500",children:O.description})]},R.id)})}),y&&m&&o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-xl",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[o.jsx(qn,{className:"w-5 h-5 mr-2 text-blue-600"}),"Detalles del Caso #",m.id]}),o.jsx("button",{onClick:B,className:"text-gray-400 hover:text-gray-600 transition duration-200",children:o.jsx(gs,{className:"w-6 h-6"})})]}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[(()=>{const R=A(m.status),O=R.icon;return o.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${R.color}`,children:[o.jsx(O,{className:"w-4 h-4 mr-1"}),R.label]})})(),o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${z(m.failure_type)}`,children:m.failure_type}),m.return_count>0&&o.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:["Devuelto ",m.return_count," veces"]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center text-sm",children:[o.jsx(Fn,{className:"w-4 h-4 mr-2 text-gray-400"}),o.jsx("span",{className:"font-medium text-gray-700",children:"Estacin:"}),o.jsx("span",{className:"ml-2 font-mono",children:m.station_code})]}),o.jsxs("div",{className:"flex items-center text-sm",children:[o.jsx(qn,{className:"w-4 h-4 mr-2 text-gray-400"}),o.jsx("span",{className:"font-medium text-gray-700",children:"Sede:"}),o.jsx("span",{className:"ml-2 capitalize",children:m.sede})]}),o.jsxs("div",{className:"flex items-center text-sm",children:[o.jsx(Bn,{className:"w-4 h-4 mr-2 text-gray-400"}),o.jsx("span",{className:"font-medium text-gray-700",children:"Tcnico:"}),o.jsx("span",{className:"ml-2",children:m.technician_name||"Sin asignar"})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center text-sm",children:[o.jsx(ia,{className:"w-4 h-4 mr-2 text-gray-400"}),o.jsx("span",{className:"font-medium text-gray-700",children:"Creado:"}),o.jsx("span",{className:"ml-2",children:H(m.created_at)})]}),o.jsxs("div",{className:"flex items-center text-sm",children:[o.jsx(qs,{className:"w-4 h-4 mr-2 text-gray-400"}),o.jsx("span",{className:"font-medium text-gray-700",children:"Actualizado:"}),o.jsx("span",{className:"ml-2",children:H(m.updated_at)})]})]})]}),o.jsx("div",{className:"mb-6",children:o.jsxs("div",{className:"flex items-start",children:[o.jsx(qn,{className:"w-4 h-4 mr-2 mt-0.5 text-gray-400"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Descripcin del problema:"}),o.jsx("p",{className:"text-sm text-gray-600 mt-1 bg-gray-50 p-3 rounded-md",children:m.description})]})]})}),m.sede==="barranquilla"&&(m.anydesk_address||m.advisor_cedula)&&o.jsxs("div",{className:"mb-6",children:[o.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Informacin de trabajo remoto:"}),o.jsx("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m.anydesk_address&&o.jsxs("div",{className:"text-sm",children:[o.jsx("span",{className:"font-medium text-blue-800",children:"AnyDesk:"}),o.jsx("span",{className:"ml-2 font-mono text-blue-700",children:m.anydesk_address})]}),m.advisor_cedula&&o.jsxs("div",{className:"text-sm",children:[o.jsx("span",{className:"font-medium text-blue-800",children:"Cdula del asesor:"}),o.jsx("span",{className:"ml-2 font-mono text-blue-700",children:m.advisor_cedula})]})]})})]}),m.status==="devuelto"&&m.return_reason&&o.jsx("div",{className:"mb-6",children:o.jsx("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:o.jsxs("div",{className:"flex items-start",children:[o.jsx(uo,{className:"w-5 h-5 mr-2 mt-0.5 text-orange-600"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("span",{className:"text-sm font-medium text-orange-800",children:"Motivo de devolucin:"}),o.jsx("p",{className:"text-sm text-orange-700 mt-2",children:m.return_reason}),o.jsxs("p",{className:"text-xs text-orange-600 mt-1",children:["Devuelto por: ",m.returned_by_name,"  ",H(m.returned_at)]})]})]})})}),o.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:o.jsx("button",{onClick:B,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 transition duration-200",children:"Cerrar"})})]})]})})]})},Uz=()=>{const{user:t}=Jr(),e=t?.username==="davidlopez10",[r,n]=Q.useState([]),[s,a]=Q.useState([]),[i,l]=Q.useState(!0),[c,d]=Q.useState(""),[h,p]=Q.useState("all"),[x,m]=Q.useState("all"),[b,y]=Q.useState(!1),[w,S]=Q.useState(!1),[k,A]=Q.useState(null),[z,H]=Q.useState(""),[V,B]=Q.useState(""),[R,O]=Q.useState({username:"",password:"",full_name:"",role:"",sede:"bogota",departamento:"claro"}),[ee,I]=Q.useState(!1),P=[{value:"coordinador",label:"Coordinador",color:"bg-blue-100 text-blue-800"},{value:"technician",label:"Tcnico",color:"bg-green-100 text-green-800"},{value:"jefe_operaciones",label:"Jefe de Operaciones",color:"bg-purple-100 text-purple-800"},{value:"administrativo",label:"Administrativo",color:"bg-orange-100 text-orange-800"},{value:"gestorActivos",label:"Gestor de Activos",color:"bg-indigo-100 text-indigo-800"}],ae=[{value:"bogota",label:"Bogot"},{value:"barranquilla",label:"Barranquilla"},{value:"villavicencio",label:"Villavicencio"}],G=F=>{const q=[{value:"obama",label:"Obama"},{value:"claro",label:"Claro"}];return F==="bogota"&&q.splice(1,0,{value:"majority",label:"Majority"}),q},M=G(R.sede),te=F=>{const q=G(F),he=R.departamento,me=q.some(Z=>Z.value===he);O({...R,sede:F,departamento:me?he:"obama"})};Q.useEffect(()=>{ie()},[]),Q.useEffect(()=>{le()},[r,c,h,x]);const ie=async()=>{try{l(!0);const F=await _c.getAll();n(F.data)}catch(F){console.error("Error cargando usuarios:",F),H("Error al cargar los usuarios")}finally{l(!1)}},le=()=>{let F=r;c&&(F=F.filter(q=>q.full_name.toLowerCase().includes(c.toLowerCase())||q.username.toLowerCase().includes(c.toLowerCase()))),h!=="all"&&(F=F.filter(q=>q.role===h)),x!=="all"&&(F=F.filter(q=>q.sede===x)),a(F)},X=F=>{const q=P.find(he=>he.value===F);return q||(F==="admin"?{label:"Administrador",color:"bg-red-100 text-red-800"}:F==="supervisor"?{label:"Coordinador",color:"bg-blue-100 text-blue-800"}:F==="jefe_operaciones"?{label:"Jefe de Operaciones",color:"bg-purple-100 text-purple-800"}:{label:F,color:"bg-gray-100 text-gray-800"})},fe=()=>{O({username:"",password:"",full_name:"",role:"",sede:"bogota",departamento:"claro"}),y(!0),H(""),B("")},K=F=>{A(F),O({username:F.username,password:"",full_name:F.full_name,role:F.role,sede:F.sede||"bogota",departamento:F.departamento||"claro"}),S(!0),H(""),B("")},E=async F=>{if(F.preventDefault(),!R.username||!R.full_name||!R.role){H("Todos los campos son requeridos");return}if(b&&!R.password){H("La contrasea es requerida");return}if(R.password&&R.password.length<6){H("La contrasea debe tener al menos 6 caracteres");return}try{l(!0);const q={...R};if((q.role==="technician"||q.role==="administrativo")&&(q.departamento=null),q.role==="gestorActivos"&&(q.sede=null,q.departamento=null),b)await _c.create(q),B("Usuario creado exitosamente");else{const he={...q};he.password||delete he.password,await _c.update(k.id,he),B("Usuario actualizado exitosamente")}y(!1),S(!1),ie()}catch(q){console.error("Error guardando usuario:",q),H(q.response?.data?.msg||"Error al guardar el usuario")}finally{l(!1)}},W=async(F,q)=>{if(window.confirm(`Ests seguro de que quieres eliminar al usuario "${q}"?

Esta accin no se puede deshacer.`))try{l(!0),await _c.delete(F),B("Usuario eliminado exitosamente"),ie()}catch(me){console.error("Error eliminando usuario:",me),H(me.response?.data?.msg||"Error al eliminar el usuario")}finally{l(!1)}},L=()=>{y(!1),S(!1),A(null),H(""),B("")};return i?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("h1",{className:`text-xl sm:text-2xl font-bold ${e?"text-[#E5E7EB] ironman-glow":"text-gray-900"}`,children:"Gestin de Usuarios"}),o.jsx("p",{className:`text-sm sm:text-base mt-1 ${e?"text-[#94A3B8]":"text-gray-600"}`,children:"Administrar coordinadores y tcnicos del sistema"})]}),o.jsxs("button",{onClick:fe,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[o.jsx(Vo,{className:"h-4 w-4 mr-2"}),"Crear Usuario"]})]}),z&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:o.jsx("p",{className:"text-sm text-red-700",children:z})}),V&&o.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-3",children:o.jsx("p",{className:"text-sm text-green-700",children:V})}),o.jsx("div",{className:"bg-white shadow rounded-lg p-4",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsx("div",{className:"md:col-span-2",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Lc,{className:"h-5 w-5 text-gray-400"})}),o.jsx("input",{type:"text",value:c,onChange:F=>d(F.target.value),placeholder:"Buscar por nombre o usuario...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})}),o.jsx("div",{children:o.jsxs("select",{value:h,onChange:F=>p(F.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"Todos los roles"}),o.jsx("option",{value:"coordinador",children:"Coordinadores"}),o.jsx("option",{value:"technician",children:"Tcnicos"}),o.jsx("option",{value:"jefe_operaciones",children:"Jefes de Operaciones"}),o.jsx("option",{value:"gestorActivos",children:"Gestores de Activos"})]})}),o.jsx("div",{children:o.jsxs("select",{value:x,onChange:F=>m(F.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"Todas las sedes"}),ae.map(F=>o.jsx("option",{value:F.value,children:F.label},F.value))]})})]})}),o.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:o.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[o.jsxs("div",{className:"flex items-center mb-4",children:[o.jsx(Gu,{className:"h-5 w-5 text-gray-400 mr-2"}),o.jsxs("span",{className:"text-sm text-gray-600",children:["Mostrando ",s.length," de ",r.length," usuarios"]})]}),s.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Gu,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:r.length===0?"No hay usuarios":"No se encontraron usuarios"}),o.jsx("p",{className:"text-gray-500",children:r.length===0?"Crea el primer usuario del sistema":"Intenta ajustar los filtros de bsqueda"})]}):o.jsx("div",{className:"space-y-4",children:s.map(F=>o.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-3 sm:space-y-0",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-4 mb-2",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Yd,{className:"h-4 w-4 mr-2 text-gray-400"}),o.jsx("span",{className:"font-medium text-gray-900",children:F.full_name}),o.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["@",F.username]})]}),o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${X(F.role).color}`,children:X(F.role).label})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-4 text-sm text-gray-500",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Ac,{className:"h-4 w-4 mr-1"}),o.jsx("span",{children:F.role==="gestorActivos"?"Gestin de Activos - Sin sede especfica":`${ae.find(q=>q.value===F.sede)?.label||F.sede}${F.departamento?` - ${M.find(q=>q.value===F.departamento)?.label||F.departamento}`:""}`})]}),o.jsxs("span",{children:["Creado: ",new Date(F.created_at).toLocaleDateString()]})]})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs("button",{onClick:()=>K(F),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[o.jsx(Sh,{className:"h-4 w-4 mr-1"}),"Editar"]}),F.role!=="admin"&&o.jsxs("button",{onClick:()=>W(F.id,F.username),className:"inline-flex items-center px-3 py-1 border border-red-300 text-sm font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[o.jsx(Kx,{className:"h-4 w-4 mr-1"}),"Eliminar"]})]})]})},F.id))})]})}),(b||w)&&o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:o.jsx("div",{className:"relative top-10 mx-auto p-5 border max-w-md shadow-lg rounded-md bg-white",children:o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:b?"Crear Usuario":"Editar Usuario"}),o.jsx("button",{onClick:L,className:"text-gray-400 hover:text-gray-600",children:o.jsx(gs,{className:"h-6 w-6"})})]}),o.jsxs("form",{onSubmit:E,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre Completo *"}),o.jsx("input",{type:"text",required:!0,value:R.full_name,onChange:F=>O({...R,full_name:F.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ej: Juan Prez"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de Usuario *"}),o.jsx("input",{type:"text",required:!0,value:R.username,onChange:F=>O({...R,username:F.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ej: jperez"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Contrasea ",b?"*":"(dejar vaco para no cambiar)"]}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:ee?"text":"password",required:b,value:R.password,onChange:F=>O({...R,password:F.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Mnimo 6 caracteres"}),o.jsx("button",{type:"button",onClick:()=>I(!ee),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:ee?o.jsx(v3,{className:"h-4 w-4 text-gray-400"}):o.jsx(Dl,{className:"h-4 w-4 text-gray-400"})})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol *"}),o.jsxs("select",{required:!0,value:R.role,onChange:F=>O({...R,role:F.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Seleccionar rol..."}),P.map(F=>o.jsx("option",{value:F.value,children:F.label},F.value))]})]}),R.role!=="gestorActivos"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sede *"}),o.jsx("select",{required:!0,value:R.sede,onChange:F=>te(F.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:ae.map(F=>o.jsx("option",{value:F.value,children:F.label},F.value))})]}),(R.role==="coordinador"||R.role==="jefe_operaciones")&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento *"}),o.jsx("select",{required:!0,value:R.departamento,onChange:F=>O({...R,departamento:F.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:M.map(F=>o.jsx("option",{value:F.value,children:F.label},F.value))})]}),R.role==="technician"&&o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:o.jsxs("p",{className:"text-sm text-blue-700",children:[o.jsx("strong",{children:"Nota:"})," Los tcnicos no tienen departamento asignado especfico. Pueden trabajar en cualquier departamento segn las necesidades."]})}),R.role==="gestorActivos"&&o.jsx("div",{className:"bg-indigo-50 border border-indigo-200 rounded-md p-3",children:o.jsxs("p",{className:"text-sm text-indigo-700",children:[o.jsx("strong",{children:"Nota:"})," Los gestores de activos tienen acceso exclusivo al mdulo de gestin de activos. No requieren sede ni departamento especfico."]})}),R.role==="administrativo"&&o.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-md p-3",children:o.jsxs("p",{className:"text-sm text-orange-700",children:[o.jsx("strong",{children:"Nota:"})," Los administrativos manejan tareas generales de su sede y no tienen departamento especfico asignado."]})}),R.role==="jefe_operaciones"&&o.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-md p-3",children:o.jsxs("p",{className:"text-sm text-purple-700",children:[o.jsx("strong",{children:"Nota:"})," Los jefes de operaciones supervisan incidencias de su departamento especfico en su sede."]})}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o.jsx("button",{type:"button",onClick:L,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancelar"}),o.jsxs("button",{type:"submit",disabled:i,className:"flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[o.jsx(bp,{className:"h-4 w-4 mr-2"}),i?"Guardando...":b?"Crear":"Actualizar"]})]})]})]})})})]})},zz=()=>{const{user:t}=Jr(),e=t?.username==="davidlopez10",[r,n]=Q.useState([]),[s,a]=Q.useState([]),[i,l]=Q.useState({}),[c,d]=Q.useState(!0),[h,p]=Q.useState(""),[x,m]=Q.useState("all"),[b,y]=Q.useState("all"),[w,S]=Q.useState("failures_desc"),[k,A]=Q.useState("all"),[z,H]=Q.useState(""),V=[{value:"bogota",label:"Bogot"},{value:"barranquilla",label:"Barranquilla"},{value:"villavicencio",label:"Villavicencio"}],B=[{value:"obama",label:"Obama"},{value:"majority",label:"Majority"},{value:"claro",label:"Claro"},{value:"contratacion",label:"Contratacin"},{value:"seleccion",label:"Seleccin"},{value:"reclutamiento",label:"Reclutamiento"},{value:"area_financiera",label:"rea Financiera"}],R=[{value:"failures_desc",label:"Ms fallas primero"},{value:"failures_asc",label:"Menos fallas primero"},{value:"station_code",label:"Cdigo de estacin"},{value:"created_date",label:"Fecha de creacin"}];Q.useEffect(()=>{O()},[]),Q.useEffect(()=>{I()},[r,i,h,x,b,w,k]);const O=async()=>{try{d(!0),H("");const[M,te]=await Promise.all([E3.getAll(),Kt.getAll()]),ie=M.data,le=te.data,X=ee(le);n(ie),l(X)}catch(M){console.error("Error cargando datos:",M),H("Error al cargar los datos de las estaciones")}finally{d(!1)}},ee=M=>{const te={};return M.forEach(ie=>{const le=ie.workstation_id;te[le]||(te[le]={totalIncidents:0,pendingIncidents:0,resolvedIncidents:0,approvedIncidents:0,rejectedIncidents:0,failureTypes:{},averageResolutionTime:0,lastIncidentDate:null,riskScore:0});const X=te[le];switch(X.totalIncidents++,ie.status){case"pendiente":X.pendingIncidents++;break;case"en_proceso":case"en_supervision":X.pendingIncidents++;break;case"aprobado":X.approvedIncidents++,X.resolvedIncidents++;break;case"rechazado":X.rejectedIncidents++;break}const fe=ie.failure_type;X.failureTypes[fe]=(X.failureTypes[fe]||0)+1;const K=new Date(ie.created_at);if((!X.lastIncidentDate||K>X.lastIncidentDate)&&(X.lastIncidentDate=K),ie.status==="aprobado"){const E=new Date(ie.created_at),L=(new Date(ie.updated_at)-E)/(1e3*60*60);X.averageResolutionTime=(X.averageResolutionTime*(X.approvedIncidents-1)+L)/X.approvedIncidents}}),Object.keys(te).forEach(ie=>{const le=te[ie],X=Math.min(le.totalIncidents*2,40),fe=(le.failureTypes.pantalla||0)+(le.failureTypes.internet||0),K=Math.min(fe*5,30),E=Math.min(le.pendingIncidents*3,20);let W=0;if(le.lastIncidentDate){const L=(new Date-le.lastIncidentDate)/864e5;L<7?W=10:L<30&&(W=5)}le.riskScore=X+K+E+W}),te},I=()=>{let M=r;if(h&&(M=M.filter(te=>te.station_code.toLowerCase().includes(h.toLowerCase())||te.location_details&&te.location_details.toLowerCase().includes(h.toLowerCase()))),x!=="all"&&(M=M.filter(te=>te.sede===x)),b!=="all"&&(M=M.filter(te=>te.departamento===b)),k!=="all"){console.log("Aplicando filtro de riesgo:",k),console.log("Estadsticas disponibles:",i);const te=M.length;M=M.filter(ie=>{const le=i[ie.id]||{riskScore:0};let X=!1;switch(k){case"high":X=le.riskScore>=70;break;case"medium":X=le.riskScore>=40&&le.riskScore<70;break;case"low":X=le.riskScore>0&&le.riskScore<40;break;default:X=!0}return X&&console.log(`Estacin ${ie.station_code} coincide con filtro ${k}, riskScore: ${le.riskScore}`),X}),console.log(`Filtro ${k}: ${te} estaciones -> ${M.length} estaciones despus del filtro`)}M.sort((te,ie)=>{const le=i[te.id]||{totalIncidents:0},X=i[ie.id]||{totalIncidents:0};switch(w){case"failures_desc":return X.totalIncidents-le.totalIncidents;case"failures_asc":return le.totalIncidents-X.totalIncidents;case"station_code":return te.station_code.localeCompare(ie.station_code);case"created_date":return new Date(ie.created_at)-new Date(te.created_at);default:return 0}}),a(M)},P=M=>M>=70?{level:"Alto",color:"bg-red-100 text-red-800 border-red-200",icon:""}:M>=40?{level:"Medio",color:"bg-yellow-100 text-yellow-800 border-yellow-200",icon:""}:M>0?{level:"Bajo",color:"bg-green-100 text-green-800 border-green-200",icon:""}:{level:"Sin datos",color:"bg-gray-100 text-gray-800 border-gray-200",icon:""},ae=M=>({pantalla:"Pantalla",perifericos:"Perifricos",internet:"Internet",software:"Software",otro:"Otro"})[M]||M,G=()=>{const M=s.map(fe=>{const K=i[fe.id]||{},E=P(K.riskScore||0);return{Cdigo:fe.station_code,Ubicacin:fe.location_details||"N/A",Sede:V.find(W=>W.value===fe.sede)?.label||fe.sede,Departamento:B.find(W=>W.value===fe.departamento)?.label||fe.departamento,AnyDesk:fe.sede==="barranquilla"&&fe.anydesk_address||"N/A","Cdula Asesor":fe.sede==="barranquilla"&&fe.advisor_cedula||"N/A","Total Incidencias":K.totalIncidents||0,"Incidencias Pendientes":K.pendingIncidents||0,"Incidencias Resueltas":K.resolvedIncidents||0,"Nivel de Riesgo":E.level,"Puntuacin de Riesgo":Math.round(K.riskScore||0),"Tiempo Promedio Resolucin (hrs)":Math.round(K.averageResolutionTime||0),"ltima Incidencia":K.lastIncidentDate?K.lastIncidentDate.toLocaleDateString():"Nunca"}}),te=[Object.keys(M[0]||{}).join(","),...M.map(fe=>Object.values(fe).join(","))].join(`
`),ie=new Blob([te],{type:"text/csv"}),le=window.URL.createObjectURL(ie),X=document.createElement("a");X.href=le,X.download=`estaciones_estadisticas_${new Date().toISOString().split("T")[0]}.csv`,X.click(),window.URL.revokeObjectURL(le)};return c?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("h1",{className:`text-xl sm:text-2xl font-bold ${e?"text-[#E5E7EB] ironman-glow":"text-gray-900"}`,children:"Gestin de Estaciones"}),o.jsx("p",{className:`text-sm sm:text-base mt-1 ${e?"text-[#94A3B8]":"text-gray-600"}`,children:"Monitoreo de estaciones de trabajo y anlisis de fallas"})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3",children:[o.jsx("div",{className:"bg-blue-50 px-3 sm:px-4 py-2 rounded-lg",children:o.jsxs("span",{className:"text-blue-700 font-medium text-sm",children:[s.length," de ",r.length," estacin(es)"]})}),s.length>0&&o.jsxs("button",{onClick:G,className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[o.jsx(yp,{className:"h-4 w-4 mr-1"}),"Exportar CSV"]})]})]}),z&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:o.jsx("p",{className:"text-sm text-red-700",children:z})}),o.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[o.jsx("div",{className:"bg-white p-4 rounded-lg shadow border",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(Fn,{className:"h-8 w-8 text-blue-600"}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Estaciones"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]})]})}),o.jsx("div",{className:`bg-white p-4 rounded-lg shadow border cursor-pointer transition-all hover:shadow-md hover:bg-red-50 ${k==="high"?"ring-2 ring-red-500 bg-red-50":""}`,onClick:()=>A(k==="high"?"all":"high"),children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(mi,{className:"h-8 w-8 text-red-600"}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Alto Riesgo"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(()=>{const M=r.filter(te=>(i[te.id]||{riskScore:0}).riskScore>=70).length;return console.log("Conteo Alto Riesgo (corregido):",M),console.log("Total workstations:",r.length),console.log("IncidentStats keys:",Object.keys(i)),M})()})]})]})}),o.jsx("div",{className:`bg-white p-4 rounded-lg shadow border cursor-pointer transition-all hover:shadow-md hover:bg-yellow-50 ${k==="medium"?"ring-2 ring-yellow-500 bg-yellow-50":""}`,onClick:()=>A(k==="medium"?"all":"medium"),children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(Wh,{className:"h-8 w-8 text-yellow-600"}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Riesgo Medio"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(()=>{const M=r.filter(te=>{const ie=i[te.id]||{riskScore:0};return ie.riskScore>=40&&ie.riskScore<70}).length;return console.log("Conteo Riesgo Medio:",M),M})()})]})]})}),o.jsx("div",{className:"bg-white p-4 rounded-lg shadow border",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(vp,{className:"h-8 w-8 text-green-600"}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Incidencias"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Object.values(i).reduce((M,te)=>M+(te.totalIncidents||0),0)})]})]})})]}),o.jsx("div",{className:"bg-white shadow rounded-lg p-4",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[o.jsx("div",{className:"md:col-span-2",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Lc,{className:"h-5 w-5 text-gray-400"})}),o.jsx("input",{type:"text",value:h,onChange:M=>p(M.target.value),placeholder:"Buscar por cdigo o ubicacin...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})}),o.jsx("div",{children:o.jsxs("select",{value:x,onChange:M=>m(M.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"Todas las sedes"}),V.map(M=>o.jsx("option",{value:M.value,children:M.label},M.value))]})}),o.jsx("div",{children:o.jsxs("select",{value:b,onChange:M=>y(M.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"all",children:"Todos los departamentos"}),B.map(M=>o.jsx("option",{value:M.value,children:M.label},M.value))]})}),o.jsx("div",{children:o.jsx("select",{value:w,onChange:M=>S(M.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:R.map(M=>o.jsx("option",{value:M.value,children:M.label},M.value))})})]})}),s.length===0?o.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow",children:[o.jsx(Fn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:r.length===0?"No hay estaciones registradas":"No se encontraron estaciones"}),o.jsx("p",{className:"text-gray-500",children:r.length===0?"Las estaciones se crean automticamente al reportar incidencias":"Intenta ajustar los filtros de bsqueda"})]}):o.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:o.jsx("div",{className:"px-4 py-5 sm:p-6",children:o.jsx("div",{className:"space-y-4",children:s.map(M=>{const te=i[M.id]||{totalIncidents:0,pendingIncidents:0,resolvedIncidents:0,riskScore:0,failureTypes:{},averageResolutionTime:0,lastIncidentDate:null},ie=P(te.riskScore);return o.jsx("div",{className:`border rounded-lg p-4 ${ie.color.includes("red")?"border-red-200 bg-red-50":ie.color.includes("yellow")?"border-yellow-200 bg-yellow-50":ie.color.includes("green")?"border-green-200 bg-green-50":"border-gray-200"}`,children:o.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between space-y-4 lg:space-y-0",children:o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-4 mb-3",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Fn,{className:"h-5 w-5 mr-2 text-gray-600"}),o.jsx("span",{className:"text-lg font-bold text-gray-900",children:M.station_code})]}),o.jsxs("span",{className:`inline-flex items-center px-3 py-1 text-sm font-medium rounded-full border ${ie.color}`,children:[o.jsx("span",{className:"mr-1",children:ie.icon}),ie.level," Riesgo (",Math.round(te.riskScore),")"]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-6 text-sm text-gray-600 mb-3",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Ac,{className:"h-4 w-4 mr-1"}),o.jsxs("span",{children:[V.find(le=>le.value===M.sede)?.label||M.sede,M.departamento&&` - ${B.find(le=>le.value===M.departamento)?.label||M.departamento}`]})]}),M.location_details&&o.jsx("span",{children:M.location_details})]}),M.sede==="barranquilla"&&(M.anydesk_address||M.advisor_cedula)&&o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-3",children:[o.jsxs("h4",{className:"text-sm font-semibold text-blue-900 mb-2 flex items-center",children:[o.jsx(Fn,{className:"h-4 w-4 mr-2"}),"Trabajo Remoto"]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[M.anydesk_address&&o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-gray-700",children:"AnyDesk:"}),o.jsx("span",{className:"ml-2 font-mono bg-gray-100 px-2 py-1 rounded text-blue-800",children:M.anydesk_address})]}),M.advisor_cedula&&o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-gray-700",children:"Cdula Asesor:"}),o.jsx("span",{className:"ml-2 font-mono bg-gray-100 px-2 py-1 rounded text-blue-800",children:M.advisor_cedula})]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-gray-900",children:"Total Incidencias:"}),o.jsx("span",{className:"ml-1 text-blue-600 font-bold",children:te.totalIncidents})]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-gray-900",children:"Pendientes:"}),o.jsx("span",{className:"ml-1 text-orange-600 font-bold",children:te.pendingIncidents})]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-gray-900",children:"Resueltas:"}),o.jsx("span",{className:"ml-1 text-green-600 font-bold",children:te.resolvedIncidents})]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-gray-900",children:"Tiempo Promedio:"}),o.jsxs("span",{className:"ml-1 text-purple-600 font-bold",children:[Math.round(te.averageResolutionTime||0),"h"]})]})]}),Object.keys(te.failureTypes).length>0&&o.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Fallas ms comunes:"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(te.failureTypes).sort((le,X)=>X[1]-le[1]).slice(0,3).map(([le,X])=>o.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs bg-gray-100 text-gray-800 rounded-full",children:[ae(le),": ",X]},le))})]}),te.lastIncidentDate&&o.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[o.jsx(ia,{className:"h-3 w-3 inline mr-1"}),"ltima incidencia: ",te.lastIncidentDate.toLocaleDateString()]})]})})},M.id)})})})})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Fp(t){return t+.5|0}const Uu=(t,e,r)=>Math.max(Math.min(t,r),e);function bh(t){return Uu(Fp(t*2.55),0,255)}function Vu(t){return Uu(Fp(t*255),0,255)}function yc(t){return Uu(Fp(t/2.55)/100,0,1)}function c_(t){return Uu(Fp(t*100),0,100)}const so={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},rv=[..."0123456789ABCDEF"],Hz=t=>rv[t&15],$z=t=>rv[(t&240)>>4]+rv[t&15],Dm=t=>(t&240)>>4===(t&15),Wz=t=>Dm(t.r)&&Dm(t.g)&&Dm(t.b)&&Dm(t.a);function Vz(t){var e=t.length,r;return t[0]==="#"&&(e===4||e===5?r={r:255&so[t[1]]*17,g:255&so[t[2]]*17,b:255&so[t[3]]*17,a:e===5?so[t[4]]*17:255}:(e===7||e===9)&&(r={r:so[t[1]]<<4|so[t[2]],g:so[t[3]]<<4|so[t[4]],b:so[t[5]]<<4|so[t[6]],a:e===9?so[t[7]]<<4|so[t[8]]:255})),r}const qz=(t,e)=>t<255?e(t):"";function Gz(t){var e=Wz(t)?Hz:$z;return t?"#"+e(t.r)+e(t.g)+e(t.b)+qz(t.a,e):void 0}const Xz=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function zk(t,e,r){const n=e*Math.min(r,1-r),s=(a,i=(a+t/30)%12)=>r-n*Math.max(Math.min(i-3,9-i,1),-1);return[s(0),s(8),s(4)]}function Yz(t,e,r){const n=(s,a=(s+t/60)%6)=>r-r*e*Math.max(Math.min(a,4-a,1),0);return[n(5),n(3),n(1)]}function Kz(t,e,r){const n=zk(t,1,.5);let s;for(e+r>1&&(s=1/(e+r),e*=s,r*=s),s=0;s<3;s++)n[s]*=1-e-r,n[s]+=e;return n}function Jz(t,e,r,n,s){return t===s?(e-r)/n+(e<r?6:0):e===s?(r-t)/n+2:(t-e)/n+4}function jy(t){const r=t.r/255,n=t.g/255,s=t.b/255,a=Math.max(r,n,s),i=Math.min(r,n,s),l=(a+i)/2;let c,d,h;return a!==i&&(h=a-i,d=l>.5?h/(2-a-i):h/(a+i),c=Jz(r,n,s,h,a),c=c*60+.5),[c|0,d||0,l]}function Ey(t,e,r,n){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,r,n)).map(Vu)}function Ay(t,e,r){return Ey(zk,t,e,r)}function Qz(t,e,r){return Ey(Kz,t,e,r)}function Zz(t,e,r){return Ey(Yz,t,e,r)}function Hk(t){return(t%360+360)%360}function eH(t){const e=Xz.exec(t);let r=255,n;if(!e)return;e[5]!==n&&(r=e[6]?bh(+e[5]):Vu(+e[5]));const s=Hk(+e[2]),a=+e[3]/100,i=+e[4]/100;return e[1]==="hwb"?n=Qz(s,a,i):e[1]==="hsv"?n=Zz(s,a,i):n=Ay(s,a,i),{r:n[0],g:n[1],b:n[2],a:r}}function tH(t,e){var r=jy(t);r[0]=Hk(r[0]+e),r=Ay(r),t.r=r[0],t.g=r[1],t.b=r[2]}function rH(t){if(!t)return;const e=jy(t),r=e[0],n=c_(e[1]),s=c_(e[2]);return t.a<255?`hsla(${r}, ${n}%, ${s}%, ${yc(t.a)})`:`hsl(${r}, ${n}%, ${s}%)`}const u_={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},d_={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function nH(){const t={},e=Object.keys(d_),r=Object.keys(u_);let n,s,a,i,l;for(n=0;n<e.length;n++){for(i=l=e[n],s=0;s<r.length;s++)a=r[s],l=l.replace(a,u_[a]);a=parseInt(d_[i],16),t[l]=[a>>16&255,a>>8&255,a&255]}return t}let Rm;function sH(t){Rm||(Rm=nH(),Rm.transparent=[0,0,0,0]);const e=Rm[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const aH=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function iH(t){const e=aH.exec(t);let r=255,n,s,a;if(e){if(e[7]!==n){const i=+e[7];r=e[8]?bh(i):Uu(i*255,0,255)}return n=+e[1],s=+e[3],a=+e[5],n=255&(e[2]?bh(n):Uu(n,0,255)),s=255&(e[4]?bh(s):Uu(s,0,255)),a=255&(e[6]?bh(a):Uu(a,0,255)),{r:n,g:s,b:a,a:r}}}function oH(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${yc(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const Y1=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,r0=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function lH(t,e,r){const n=r0(yc(t.r)),s=r0(yc(t.g)),a=r0(yc(t.b));return{r:Vu(Y1(n+r*(r0(yc(e.r))-n))),g:Vu(Y1(s+r*(r0(yc(e.g))-s))),b:Vu(Y1(a+r*(r0(yc(e.b))-a))),a:t.a+r*(e.a-t.a)}}function Im(t,e,r){if(t){let n=jy(t);n[e]=Math.max(0,Math.min(n[e]+n[e]*r,e===0?360:1)),n=Ay(n),t.r=n[0],t.g=n[1],t.b=n[2]}}function $k(t,e){return t&&Object.assign(e||{},t)}function f_(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=Vu(t[3]))):(e=$k(t,{r:0,g:0,b:0,a:1}),e.a=Vu(e.a)),e}function cH(t){return t.charAt(0)==="r"?iH(t):eH(t)}class op{constructor(e){if(e instanceof op)return e;const r=typeof e;let n;r==="object"?n=f_(e):r==="string"&&(n=Vz(e)||sH(e)||cH(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=$k(this._rgb);return e&&(e.a=yc(e.a)),e}set rgb(e){this._rgb=f_(e)}rgbString(){return this._valid?oH(this._rgb):void 0}hexString(){return this._valid?Gz(this._rgb):void 0}hslString(){return this._valid?rH(this._rgb):void 0}mix(e,r){if(e){const n=this.rgb,s=e.rgb;let a;const i=r===a?.5:r,l=2*i-1,c=n.a-s.a,d=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;a=1-d,n.r=255&d*n.r+a*s.r+.5,n.g=255&d*n.g+a*s.g+.5,n.b=255&d*n.b+a*s.b+.5,n.a=i*n.a+(1-i)*s.a,this.rgb=n}return this}interpolate(e,r){return e&&(this._rgb=lH(this._rgb,e._rgb,r)),this}clone(){return new op(this.rgb)}alpha(e){return this._rgb.a=Vu(e),this}clearer(e){const r=this._rgb;return r.a*=1-e,this}greyscale(){const e=this._rgb,r=Fp(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=r,this}opaquer(e){const r=this._rgb;return r.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Im(this._rgb,2,e),this}darken(e){return Im(this._rgb,2,-e),this}saturate(e){return Im(this._rgb,1,e),this}desaturate(e){return Im(this._rgb,1,-e),this}rotate(e){return tH(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function xc(){}const uH=(()=>{let t=0;return()=>t++})();function Vr(t){return t==null}function Mn(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Lr(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Gs(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function Nl(t,e){return Gs(t)?t:e}function jr(t,e){return typeof t>"u"?e:t}const dH=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,Wk=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function wn(t,e,r){if(t&&typeof t.call=="function")return t.apply(r,e)}function cn(t,e,r,n){let s,a,i;if(Mn(t))for(a=t.length,s=0;s<a;s++)e.call(r,t[s],s);else if(Lr(t))for(i=Object.keys(t),a=i.length,s=0;s<a;s++)e.call(r,t[i[s]],i[s])}function Px(t,e){let r,n,s,a;if(!t||!e||t.length!==e.length)return!1;for(r=0,n=t.length;r<n;++r)if(s=t[r],a=e[r],s.datasetIndex!==a.datasetIndex||s.index!==a.index)return!1;return!0}function Lx(t){if(Mn(t))return t.map(Lx);if(Lr(t)){const e=Object.create(null),r=Object.keys(t),n=r.length;let s=0;for(;s<n;++s)e[r[s]]=Lx(t[r[s]]);return e}return t}function Vk(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function fH(t,e,r,n){if(!Vk(t))return;const s=e[t],a=r[t];Lr(s)&&Lr(a)?lp(s,a,n):e[t]=Lx(a)}function lp(t,e,r){const n=Mn(e)?e:[e],s=n.length;if(!Lr(t))return t;r=r||{};const a=r.merger||fH;let i;for(let l=0;l<s;++l){if(i=n[l],!Lr(i))continue;const c=Object.keys(i);for(let d=0,h=c.length;d<h;++d)a(c[d],t,i,r)}return t}function Rh(t,e){return lp(t,e,{merger:hH})}function hH(t,e,r){if(!Vk(t))return;const n=e[t],s=r[t];Lr(n)&&Lr(s)?Rh(n,s):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=Lx(s))}const h_={"":t=>t,x:t=>t.x,y:t=>t.y};function pH(t){const e=t.split("."),r=[];let n="";for(const s of e)n+=s,n.endsWith("\\")?n=n.slice(0,-1)+".":(r.push(n),n="");return r}function mH(t){const e=pH(t);return r=>{for(const n of e){if(n==="")break;r=r&&r[n]}return r}}function td(t,e){return(h_[e]||(h_[e]=mH(e)))(t)}function Cy(t){return t.charAt(0).toUpperCase()+t.slice(1)}const cp=t=>typeof t<"u",rd=t=>typeof t=="function",p_=(t,e)=>{if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0};function xH(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const Kr=Math.PI,Ln=2*Kr,gH=Ln+Kr,Dx=Number.POSITIVE_INFINITY,vH=Kr/180,ms=Kr/2,Od=Kr/4,m_=Kr*2/3,qk=Math.log10,Ll=Math.sign;function Ih(t,e,r){return Math.abs(t-e)<r}function x_(t){const e=Math.round(t);t=Ih(t,e,t/1e3)?e:t;const r=Math.pow(10,Math.floor(qk(t))),n=t/r;return(n<=1?1:n<=2?2:n<=5?5:10)*r}function yH(t){const e=[],r=Math.sqrt(t);let n;for(n=1;n<r;n++)t%n===0&&(e.push(n),e.push(t/n));return r===(r|0)&&e.push(r),e.sort((s,a)=>s-a).pop(),e}function bH(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function up(t){return!bH(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function wH(t,e){const r=Math.round(t);return r-e<=t&&r+e>=t}function _H(t,e,r){let n,s,a;for(n=0,s=t.length;n<s;n++)a=t[n][r],isNaN(a)||(e.min=Math.min(e.min,a),e.max=Math.max(e.max,a))}function Go(t){return t*(Kr/180)}function Ty(t){return t*(180/Kr)}function g_(t){if(!Gs(t))return;let e=1,r=0;for(;Math.round(t*e)/e!==t;)e*=10,r++;return r}function Gk(t,e){const r=e.x-t.x,n=e.y-t.y,s=Math.sqrt(r*r+n*n);let a=Math.atan2(n,r);return a<-.5*Kr&&(a+=Ln),{angle:a,distance:s}}function nv(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function NH(t,e){return(t-e+gH)%Ln-Kr}function ja(t){return(t%Ln+Ln)%Ln}function dp(t,e,r,n){const s=ja(t),a=ja(e),i=ja(r),l=ja(a-s),c=ja(i-s),d=ja(s-a),h=ja(s-i);return s===a||s===i||n&&a===i||l>c&&d<h}function Fa(t,e,r){return Math.max(e,Math.min(r,t))}function SH(t){return Fa(t,-32768,32767)}function kc(t,e,r,n=1e-6){return t>=Math.min(e,r)-n&&t<=Math.max(e,r)+n}function Fy(t,e,r){r=r||(i=>t[i]<e);let n=t.length-1,s=0,a;for(;n-s>1;)a=s+n>>1,r(a)?s=a:n=a;return{lo:s,hi:n}}const Gd=(t,e,r,n)=>Fy(t,r,n?s=>{const a=t[s][e];return a<r||a===r&&t[s+1][e]===r}:s=>t[s][e]<r),kH=(t,e,r)=>Fy(t,r,n=>t[n][e]>=r);function jH(t,e,r){let n=0,s=t.length;for(;n<s&&t[n]<e;)n++;for(;s>n&&t[s-1]>r;)s--;return n>0||s<t.length?t.slice(n,s):t}const Xk=["push","pop","shift","splice","unshift"];function EH(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),Xk.forEach(r=>{const n="_onData"+Cy(r),s=t[r];Object.defineProperty(t,r,{configurable:!0,enumerable:!1,value(...a){const i=s.apply(this,a);return t._chartjs.listeners.forEach(l=>{typeof l[n]=="function"&&l[n](...a)}),i}})})}function v_(t,e){const r=t._chartjs;if(!r)return;const n=r.listeners,s=n.indexOf(e);s!==-1&&n.splice(s,1),!(n.length>0)&&(Xk.forEach(a=>{delete t[a]}),delete t._chartjs)}function Yk(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const Kk=(function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame})();function Jk(t,e){let r=[],n=!1;return function(...s){r=s,n||(n=!0,Kk.call(window,()=>{n=!1,t.apply(e,r)}))}}function AH(t,e){let r;return function(...n){return e?(clearTimeout(r),r=setTimeout(t,e,n)):t.apply(this,n),e}}const Py=t=>t==="start"?"left":t==="end"?"right":"center",Na=(t,e,r)=>t==="start"?e:t==="end"?r:(e+r)/2,CH=(t,e,r,n)=>t===(n?"left":"right")?r:t==="center"?(e+r)/2:e;function TH(t,e,r){const n=e.length;let s=0,a=n;if(t._sorted){const{iScale:i,vScale:l,_parsed:c}=t,d=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null,h=i.axis,{min:p,max:x,minDefined:m,maxDefined:b}=i.getUserBounds();if(m){if(s=Math.min(Gd(c,h,p).lo,r?n:Gd(e,h,i.getPixelForValue(p)).lo),d){const y=c.slice(0,s+1).reverse().findIndex(w=>!Vr(w[l.axis]));s-=Math.max(0,y)}s=Fa(s,0,n-1)}if(b){let y=Math.max(Gd(c,i.axis,x,!0).hi+1,r?0:Gd(e,h,i.getPixelForValue(x),!0).hi+1);if(d){const w=c.slice(y-1).findIndex(S=>!Vr(S[l.axis]));y+=Math.max(0,w)}a=Fa(y,s,n)-s}else a=n-s}return{start:s,count:a}}function FH(t){const{xScale:e,yScale:r,_scaleRanges:n}=t,s={xmin:e.min,xmax:e.max,ymin:r.min,ymax:r.max};if(!n)return t._scaleRanges=s,!0;const a=n.xmin!==e.min||n.xmax!==e.max||n.ymin!==r.min||n.ymax!==r.max;return Object.assign(n,s),a}const Om=t=>t===0||t===1,y_=(t,e,r)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Ln/r)),b_=(t,e,r)=>Math.pow(2,-10*t)*Math.sin((t-e)*Ln/r)+1,Oh={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*ms)+1,easeOutSine:t=>Math.sin(t*ms),easeInOutSine:t=>-.5*(Math.cos(Kr*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Om(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Om(t)?t:y_(t,.075,.3),easeOutElastic:t=>Om(t)?t:b_(t,.075,.3),easeInOutElastic(t){return Om(t)?t:t<.5?.5*y_(t*2,.1125,.45):.5+.5*b_(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-Oh.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?Oh.easeInBounce(t*2)*.5:Oh.easeOutBounce(t*2-1)*.5+.5};function Ly(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function w_(t){return Ly(t)?t:new op(t)}function K1(t){return Ly(t)?t:new op(t).saturate(.5).darken(.1).hexString()}const PH=["x","y","borderWidth","radius","tension"],LH=["color","borderColor","backgroundColor"];function DH(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:LH},numbers:{type:"number",properties:PH}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function RH(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const __=new Map;function IH(t,e){e=e||{};const r=t+JSON.stringify(e);let n=__.get(r);return n||(n=new Intl.NumberFormat(t,e),__.set(r,n)),n}function xg(t,e,r){return IH(e,r).format(t)}const OH={values(t){return Mn(t)?t:""+t},numeric(t,e,r){if(t===0)return"0";const n=this.chart.options.locale;let s,a=t;if(r.length>1){const d=Math.max(Math.abs(r[0].value),Math.abs(r[r.length-1].value));(d<1e-4||d>1e15)&&(s="scientific"),a=MH(t,r)}const i=qk(Math.abs(a)),l=isNaN(i)?1:Math.max(Math.min(-1*Math.floor(i),20),0),c={notation:s,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),xg(t,n,c)}};function MH(t,e){let r=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(r)>=1&&t!==Math.floor(t)&&(r=t-Math.floor(t)),r}var Dy={formatters:OH};function BH(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,r)=>r.lineWidth,tickColor:(e,r)=>r.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Dy.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const ff=Object.create(null),sv=Object.create(null);function Mh(t,e){if(!e)return t;const r=e.split(".");for(let n=0,s=r.length;n<s;++n){const a=r[n];t=t[a]||(t[a]=Object.create(null))}return t}function J1(t,e,r){return typeof e=="string"?lp(Mh(t,e),r):lp(Mh(t,""),e)}class UH{constructor(e,r){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,s)=>K1(s.backgroundColor),this.hoverBorderColor=(n,s)=>K1(s.borderColor),this.hoverColor=(n,s)=>K1(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(r)}set(e,r){return J1(this,e,r)}get(e){return Mh(this,e)}describe(e,r){return J1(sv,e,r)}override(e,r){return J1(ff,e,r)}route(e,r,n,s){const a=Mh(this,e),i=Mh(this,n),l="_"+r;Object.defineProperties(a,{[l]:{value:a[r],writable:!0},[r]:{enumerable:!0,get(){const c=this[l],d=i[s];return Lr(c)?Object.assign({},d,c):jr(c,d)},set(c){this[l]=c}}})}apply(e){e.forEach(r=>r(this))}}var rs=new UH({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[DH,RH,BH]);function zH(t){return!t||Vr(t.size)||Vr(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function Rx(t,e,r,n,s){let a=e[s];return a||(a=e[s]=t.measureText(s).width,r.push(s)),a>n&&(n=a),n}function HH(t,e,r,n){n=n||{};let s=n.data=n.data||{},a=n.garbageCollect=n.garbageCollect||[];n.font!==e&&(s=n.data={},a=n.garbageCollect=[],n.font=e),t.save(),t.font=e;let i=0;const l=r.length;let c,d,h,p,x;for(c=0;c<l;c++)if(p=r[c],p!=null&&!Mn(p))i=Rx(t,s,a,i,p);else if(Mn(p))for(d=0,h=p.length;d<h;d++)x=p[d],x!=null&&!Mn(x)&&(i=Rx(t,s,a,i,x));t.restore();const m=a.length/2;if(m>r.length){for(c=0;c<m;c++)delete s[a[c]];a.splice(0,m)}return i}function Md(t,e,r){const n=t.currentDevicePixelRatio,s=r!==0?Math.max(r/2,.5):0;return Math.round((e-s)*n)/n+s}function N_(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function av(t,e,r,n){Qk(t,e,r,n,null)}function Qk(t,e,r,n,s){let a,i,l,c,d,h,p,x;const m=e.pointStyle,b=e.rotation,y=e.radius;let w=(b||0)*vH;if(m&&typeof m=="object"&&(a=m.toString(),a==="[object HTMLImageElement]"||a==="[object HTMLCanvasElement]")){t.save(),t.translate(r,n),t.rotate(w),t.drawImage(m,-m.width/2,-m.height/2,m.width,m.height),t.restore();return}if(!(isNaN(y)||y<=0)){switch(t.beginPath(),m){default:s?t.ellipse(r,n,s/2,y,0,0,Ln):t.arc(r,n,y,0,Ln),t.closePath();break;case"triangle":h=s?s/2:y,t.moveTo(r+Math.sin(w)*h,n-Math.cos(w)*y),w+=m_,t.lineTo(r+Math.sin(w)*h,n-Math.cos(w)*y),w+=m_,t.lineTo(r+Math.sin(w)*h,n-Math.cos(w)*y),t.closePath();break;case"rectRounded":d=y*.516,c=y-d,i=Math.cos(w+Od)*c,p=Math.cos(w+Od)*(s?s/2-d:c),l=Math.sin(w+Od)*c,x=Math.sin(w+Od)*(s?s/2-d:c),t.arc(r-p,n-l,d,w-Kr,w-ms),t.arc(r+x,n-i,d,w-ms,w),t.arc(r+p,n+l,d,w,w+ms),t.arc(r-x,n+i,d,w+ms,w+Kr),t.closePath();break;case"rect":if(!b){c=Math.SQRT1_2*y,h=s?s/2:c,t.rect(r-h,n-c,2*h,2*c);break}w+=Od;case"rectRot":p=Math.cos(w)*(s?s/2:y),i=Math.cos(w)*y,l=Math.sin(w)*y,x=Math.sin(w)*(s?s/2:y),t.moveTo(r-p,n-l),t.lineTo(r+x,n-i),t.lineTo(r+p,n+l),t.lineTo(r-x,n+i),t.closePath();break;case"crossRot":w+=Od;case"cross":p=Math.cos(w)*(s?s/2:y),i=Math.cos(w)*y,l=Math.sin(w)*y,x=Math.sin(w)*(s?s/2:y),t.moveTo(r-p,n-l),t.lineTo(r+p,n+l),t.moveTo(r+x,n-i),t.lineTo(r-x,n+i);break;case"star":p=Math.cos(w)*(s?s/2:y),i=Math.cos(w)*y,l=Math.sin(w)*y,x=Math.sin(w)*(s?s/2:y),t.moveTo(r-p,n-l),t.lineTo(r+p,n+l),t.moveTo(r+x,n-i),t.lineTo(r-x,n+i),w+=Od,p=Math.cos(w)*(s?s/2:y),i=Math.cos(w)*y,l=Math.sin(w)*y,x=Math.sin(w)*(s?s/2:y),t.moveTo(r-p,n-l),t.lineTo(r+p,n+l),t.moveTo(r+x,n-i),t.lineTo(r-x,n+i);break;case"line":i=s?s/2:Math.cos(w)*y,l=Math.sin(w)*y,t.moveTo(r-i,n-l),t.lineTo(r+i,n+l);break;case"dash":t.moveTo(r,n),t.lineTo(r+Math.cos(w)*(s?s/2:y),n+Math.sin(w)*y);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function jc(t,e,r){return r=r||.5,!e||t&&t.x>e.left-r&&t.x<e.right+r&&t.y>e.top-r&&t.y<e.bottom+r}function gg(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function vg(t){t.restore()}function $H(t,e,r,n,s){if(!e)return t.lineTo(r.x,r.y);if(s==="middle"){const a=(e.x+r.x)/2;t.lineTo(a,e.y),t.lineTo(a,r.y)}else s==="after"!=!!n?t.lineTo(e.x,r.y):t.lineTo(r.x,e.y);t.lineTo(r.x,r.y)}function WH(t,e,r,n){if(!e)return t.lineTo(r.x,r.y);t.bezierCurveTo(n?e.cp1x:e.cp2x,n?e.cp1y:e.cp2y,n?r.cp2x:r.cp1x,n?r.cp2y:r.cp1y,r.x,r.y)}function VH(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),Vr(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function qH(t,e,r,n,s){if(s.strikethrough||s.underline){const a=t.measureText(n),i=e-a.actualBoundingBoxLeft,l=e+a.actualBoundingBoxRight,c=r-a.actualBoundingBoxAscent,d=r+a.actualBoundingBoxDescent,h=s.strikethrough?(c+d)/2:d;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=s.decorationWidth||2,t.moveTo(i,h),t.lineTo(l,h),t.stroke()}}function GH(t,e){const r=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=r}function hf(t,e,r,n,s,a={}){const i=Mn(e)?e:[e],l=a.strokeWidth>0&&a.strokeColor!=="";let c,d;for(t.save(),t.font=s.string,VH(t,a),c=0;c<i.length;++c)d=i[c],a.backdrop&&GH(t,a.backdrop),l&&(a.strokeColor&&(t.strokeStyle=a.strokeColor),Vr(a.strokeWidth)||(t.lineWidth=a.strokeWidth),t.strokeText(d,r,n,a.maxWidth)),t.fillText(d,r,n,a.maxWidth),qH(t,r,n,d,a),n+=Number(s.lineHeight);t.restore()}function fp(t,e){const{x:r,y:n,w:s,h:a,radius:i}=e;t.arc(r+i.topLeft,n+i.topLeft,i.topLeft,1.5*Kr,Kr,!0),t.lineTo(r,n+a-i.bottomLeft),t.arc(r+i.bottomLeft,n+a-i.bottomLeft,i.bottomLeft,Kr,ms,!0),t.lineTo(r+s-i.bottomRight,n+a),t.arc(r+s-i.bottomRight,n+a-i.bottomRight,i.bottomRight,ms,0,!0),t.lineTo(r+s,n+i.topRight),t.arc(r+s-i.topRight,n+i.topRight,i.topRight,0,-ms,!0),t.lineTo(r+i.topLeft,n)}const XH=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,YH=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function KH(t,e){const r=(""+t).match(XH);if(!r||r[1]==="normal")return e*1.2;switch(t=+r[2],r[3]){case"px":return t;case"%":t/=100;break}return e*t}const JH=t=>+t||0;function Ry(t,e){const r={},n=Lr(e),s=n?Object.keys(e):e,a=Lr(t)?n?i=>jr(t[i],t[e[i]]):i=>t[i]:()=>t;for(const i of s)r[i]=JH(a(i));return r}function Zk(t){return Ry(t,{top:"y",right:"x",bottom:"y",left:"x"})}function tf(t){return Ry(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Ra(t){const e=Zk(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Ts(t,e){t=t||{},e=e||rs.font;let r=jr(t.size,e.size);typeof r=="string"&&(r=parseInt(r,10));let n=jr(t.style,e.style);n&&!(""+n).match(YH)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const s={family:jr(t.family,e.family),lineHeight:KH(jr(t.lineHeight,e.lineHeight),r),size:r,style:n,weight:jr(t.weight,e.weight),string:""};return s.string=zH(s),s}function Mm(t,e,r,n){let s,a,i;for(s=0,a=t.length;s<a;++s)if(i=t[s],i!==void 0&&i!==void 0)return i}function QH(t,e,r){const{min:n,max:s}=t,a=Wk(e,(s-n)/2),i=(l,c)=>r&&l===0?0:l+c;return{min:i(n,-Math.abs(a)),max:i(s,a)}}function od(t,e){return Object.assign(Object.create(t),e)}function Iy(t,e=[""],r,n,s=()=>t[0]){const a=r||t;typeof n>"u"&&(n=n6("_fallback",t));const i={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:a,_fallback:n,_getTarget:s,override:l=>Iy([l,...t],e,a,n)};return new Proxy(i,{deleteProperty(l,c){return delete l[c],delete l._keys,delete t[0][c],!0},get(l,c){return t6(l,c,()=>i$(c,e,t,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(l,c){return k_(l).includes(c)},ownKeys(l){return k_(l)},set(l,c,d){const h=l._storage||(l._storage=s());return l[c]=h[c]=d,delete l._keys,!0}})}function j0(t,e,r,n){const s={_cacheable:!1,_proxy:t,_context:e,_subProxy:r,_stack:new Set,_descriptors:e6(t,n),setContext:a=>j0(t,a,r,n),override:a=>j0(t.override(a),e,r,n)};return new Proxy(s,{deleteProperty(a,i){return delete a[i],delete t[i],!0},get(a,i,l){return t6(a,i,()=>e$(a,i,l))},getOwnPropertyDescriptor(a,i){return a._descriptors.allKeys?Reflect.has(t,i)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,i)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(a,i){return Reflect.has(t,i)},ownKeys(){return Reflect.ownKeys(t)},set(a,i,l){return t[i]=l,delete a[i],!0}})}function e6(t,e={scriptable:!0,indexable:!0}){const{_scriptable:r=e.scriptable,_indexable:n=e.indexable,_allKeys:s=e.allKeys}=t;return{allKeys:s,scriptable:r,indexable:n,isScriptable:rd(r)?r:()=>r,isIndexable:rd(n)?n:()=>n}}const ZH=(t,e)=>t?t+Cy(e):e,Oy=(t,e)=>Lr(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function t6(t,e,r){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const n=r();return t[e]=n,n}function e$(t,e,r){const{_proxy:n,_context:s,_subProxy:a,_descriptors:i}=t;let l=n[e];return rd(l)&&i.isScriptable(e)&&(l=t$(e,l,t,r)),Mn(l)&&l.length&&(l=r$(e,l,t,i.isIndexable)),Oy(e,l)&&(l=j0(l,s,a&&a[e],i)),l}function t$(t,e,r,n){const{_proxy:s,_context:a,_subProxy:i,_stack:l}=r;if(l.has(t))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+t);l.add(t);let c=e(a,i||n);return l.delete(t),Oy(t,c)&&(c=My(s._scopes,s,t,c)),c}function r$(t,e,r,n){const{_proxy:s,_context:a,_subProxy:i,_descriptors:l}=r;if(typeof a.index<"u"&&n(t))return e[a.index%e.length];if(Lr(e[0])){const c=e,d=s._scopes.filter(h=>h!==c);e=[];for(const h of c){const p=My(d,s,t,h);e.push(j0(p,a,i&&i[t],l))}}return e}function r6(t,e,r){return rd(t)?t(e,r):t}const n$=(t,e)=>t===!0?e:typeof t=="string"?td(e,t):void 0;function s$(t,e,r,n,s){for(const a of e){const i=n$(r,a);if(i){t.add(i);const l=r6(i._fallback,r,s);if(typeof l<"u"&&l!==r&&l!==n)return l}else if(i===!1&&typeof n<"u"&&r!==n)return null}return!1}function My(t,e,r,n){const s=e._rootScopes,a=r6(e._fallback,r,n),i=[...t,...s],l=new Set;l.add(n);let c=S_(l,i,r,a||r,n);return c===null||typeof a<"u"&&a!==r&&(c=S_(l,i,a,c,n),c===null)?!1:Iy(Array.from(l),[""],s,a,()=>a$(e,r,n))}function S_(t,e,r,n,s){for(;r;)r=s$(t,e,r,n,s);return r}function a$(t,e,r){const n=t._getTarget();e in n||(n[e]={});const s=n[e];return Mn(s)&&Lr(r)?r:s||{}}function i$(t,e,r,n){let s;for(const a of e)if(s=n6(ZH(a,t),r),typeof s<"u")return Oy(t,s)?My(r,n,t,s):s}function n6(t,e){for(const r of e){if(!r)continue;const n=r[t];if(typeof n<"u")return n}}function k_(t){let e=t._keys;return e||(e=t._keys=o$(t._scopes)),e}function o$(t){const e=new Set;for(const r of t)for(const n of Object.keys(r).filter(s=>!s.startsWith("_")))e.add(n);return Array.from(e)}function l$(t,e,r,n){const{iScale:s}=t,{key:a="r"}=this._parsing,i=new Array(n);let l,c,d,h;for(l=0,c=n;l<c;++l)d=l+r,h=e[d],i[l]={r:s.parse(td(h,a),d)};return i}const c$=Number.EPSILON||1e-14,E0=(t,e)=>e<t.length&&!t[e].skip&&t[e],s6=t=>t==="x"?"y":"x";function u$(t,e,r,n){const s=t.skip?e:t,a=e,i=r.skip?e:r,l=nv(a,s),c=nv(i,a);let d=l/(l+c),h=c/(l+c);d=isNaN(d)?0:d,h=isNaN(h)?0:h;const p=n*d,x=n*h;return{previous:{x:a.x-p*(i.x-s.x),y:a.y-p*(i.y-s.y)},next:{x:a.x+x*(i.x-s.x),y:a.y+x*(i.y-s.y)}}}function d$(t,e,r){const n=t.length;let s,a,i,l,c,d=E0(t,0);for(let h=0;h<n-1;++h)if(c=d,d=E0(t,h+1),!(!c||!d)){if(Ih(e[h],0,c$)){r[h]=r[h+1]=0;continue}s=r[h]/e[h],a=r[h+1]/e[h],l=Math.pow(s,2)+Math.pow(a,2),!(l<=9)&&(i=3/Math.sqrt(l),r[h]=s*i*e[h],r[h+1]=a*i*e[h])}}function f$(t,e,r="x"){const n=s6(r),s=t.length;let a,i,l,c=E0(t,0);for(let d=0;d<s;++d){if(i=l,l=c,c=E0(t,d+1),!l)continue;const h=l[r],p=l[n];i&&(a=(h-i[r])/3,l[`cp1${r}`]=h-a,l[`cp1${n}`]=p-a*e[d]),c&&(a=(c[r]-h)/3,l[`cp2${r}`]=h+a,l[`cp2${n}`]=p+a*e[d])}}function h$(t,e="x"){const r=s6(e),n=t.length,s=Array(n).fill(0),a=Array(n);let i,l,c,d=E0(t,0);for(i=0;i<n;++i)if(l=c,c=d,d=E0(t,i+1),!!c){if(d){const h=d[e]-c[e];s[i]=h!==0?(d[r]-c[r])/h:0}a[i]=l?d?Ll(s[i-1])!==Ll(s[i])?0:(s[i-1]+s[i])/2:s[i-1]:s[i]}d$(t,s,a),f$(t,a,e)}function Bm(t,e,r){return Math.max(Math.min(t,r),e)}function p$(t,e){let r,n,s,a,i,l=jc(t[0],e);for(r=0,n=t.length;r<n;++r)i=a,a=l,l=r<n-1&&jc(t[r+1],e),a&&(s=t[r],i&&(s.cp1x=Bm(s.cp1x,e.left,e.right),s.cp1y=Bm(s.cp1y,e.top,e.bottom)),l&&(s.cp2x=Bm(s.cp2x,e.left,e.right),s.cp2y=Bm(s.cp2y,e.top,e.bottom)))}function m$(t,e,r,n,s){let a,i,l,c;if(e.spanGaps&&(t=t.filter(d=>!d.skip)),e.cubicInterpolationMode==="monotone")h$(t,s);else{let d=n?t[t.length-1]:t[0];for(a=0,i=t.length;a<i;++a)l=t[a],c=u$(d,l,t[Math.min(a+1,i-(n?0:1))%i],e.tension),l.cp1x=c.previous.x,l.cp1y=c.previous.y,l.cp2x=c.next.x,l.cp2y=c.next.y,d=l}e.capBezierPoints&&p$(t,r)}function By(){return typeof window<"u"&&typeof document<"u"}function Uy(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Ix(t,e,r){let n;return typeof t=="string"?(n=parseInt(t,10),t.indexOf("%")!==-1&&(n=n/100*e.parentNode[r])):n=t,n}const yg=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function x$(t,e){return yg(t).getPropertyValue(e)}const g$=["top","right","bottom","left"];function rf(t,e,r){const n={};r=r?"-"+r:"";for(let s=0;s<4;s++){const a=g$[s];n[a]=parseFloat(t[e+"-"+a+r])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const v$=(t,e,r)=>(t>0||e>0)&&(!r||!r.shadowRoot);function y$(t,e){const r=t.touches,n=r&&r.length?r[0]:t,{offsetX:s,offsetY:a}=n;let i=!1,l,c;if(v$(s,a,t.target))l=s,c=a;else{const d=e.getBoundingClientRect();l=n.clientX-d.left,c=n.clientY-d.top,i=!0}return{x:l,y:c,box:i}}function zd(t,e){if("native"in t)return t;const{canvas:r,currentDevicePixelRatio:n}=e,s=yg(r),a=s.boxSizing==="border-box",i=rf(s,"padding"),l=rf(s,"border","width"),{x:c,y:d,box:h}=y$(t,r),p=i.left+(h&&l.left),x=i.top+(h&&l.top);let{width:m,height:b}=e;return a&&(m-=i.width+l.width,b-=i.height+l.height),{x:Math.round((c-p)/m*r.width/n),y:Math.round((d-x)/b*r.height/n)}}function b$(t,e,r){let n,s;if(e===void 0||r===void 0){const a=t&&Uy(t);if(!a)e=t.clientWidth,r=t.clientHeight;else{const i=a.getBoundingClientRect(),l=yg(a),c=rf(l,"border","width"),d=rf(l,"padding");e=i.width-d.width-c.width,r=i.height-d.height-c.height,n=Ix(l.maxWidth,a,"clientWidth"),s=Ix(l.maxHeight,a,"clientHeight")}}return{width:e,height:r,maxWidth:n||Dx,maxHeight:s||Dx}}const zu=t=>Math.round(t*10)/10;function w$(t,e,r,n){const s=yg(t),a=rf(s,"margin"),i=Ix(s.maxWidth,t,"clientWidth")||Dx,l=Ix(s.maxHeight,t,"clientHeight")||Dx,c=b$(t,e,r);let{width:d,height:h}=c;if(s.boxSizing==="content-box"){const x=rf(s,"border","width"),m=rf(s,"padding");d-=m.width+x.width,h-=m.height+x.height}return d=Math.max(0,d-a.width),h=Math.max(0,n?d/n:h-a.height),d=zu(Math.min(d,i,c.maxWidth)),h=zu(Math.min(h,l,c.maxHeight)),d&&!h&&(h=zu(d/2)),(e!==void 0||r!==void 0)&&n&&c.height&&h>c.height&&(h=c.height,d=zu(Math.floor(h*n))),{width:d,height:h}}function j_(t,e,r){const n=e||1,s=zu(t.height*n),a=zu(t.width*n);t.height=zu(t.height),t.width=zu(t.width);const i=t.canvas;return i.style&&(r||!i.style.height&&!i.style.width)&&(i.style.height=`${t.height}px`,i.style.width=`${t.width}px`),t.currentDevicePixelRatio!==n||i.height!==s||i.width!==a?(t.currentDevicePixelRatio=n,i.height=s,i.width=a,t.ctx.setTransform(n,0,0,n,0,0),!0):!1}const _$=(function(){let t=!1;try{const e={get passive(){return t=!0,!1}};By()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t})();function E_(t,e){const r=x$(t,e),n=r&&r.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function Hd(t,e,r,n){return{x:t.x+r*(e.x-t.x),y:t.y+r*(e.y-t.y)}}function N$(t,e,r,n){return{x:t.x+r*(e.x-t.x),y:n==="middle"?r<.5?t.y:e.y:n==="after"?r<1?t.y:e.y:r>0?e.y:t.y}}function S$(t,e,r,n){const s={x:t.cp2x,y:t.cp2y},a={x:e.cp1x,y:e.cp1y},i=Hd(t,s,r),l=Hd(s,a,r),c=Hd(a,e,r),d=Hd(i,l,r),h=Hd(l,c,r);return Hd(d,h,r)}const k$=function(t,e){return{x(r){return t+t+e-r},setWidth(r){e=r},textAlign(r){return r==="center"?r:r==="right"?"left":"right"},xPlus(r,n){return r-n},leftForLtr(r,n){return r-n}}},j$=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function w0(t,e,r){return t?k$(e,r):j$()}function a6(t,e){let r,n;(e==="ltr"||e==="rtl")&&(r=t.canvas.style,n=[r.getPropertyValue("direction"),r.getPropertyPriority("direction")],r.setProperty("direction",e,"important"),t.prevTextDirection=n)}function i6(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function o6(t){return t==="angle"?{between:dp,compare:NH,normalize:ja}:{between:kc,compare:(e,r)=>e-r,normalize:e=>e}}function A_({start:t,end:e,count:r,loop:n,style:s}){return{start:t%r,end:e%r,loop:n&&(e-t+1)%r===0,style:s}}function E$(t,e,r){const{property:n,start:s,end:a}=r,{between:i,normalize:l}=o6(n),c=e.length;let{start:d,end:h,loop:p}=t,x,m;if(p){for(d+=c,h+=c,x=0,m=c;x<m&&i(l(e[d%c][n]),s,a);++x)d--,h--;d%=c,h%=c}return h<d&&(h+=c),{start:d,end:h,loop:p,style:t.style}}function l6(t,e,r){if(!r)return[t];const{property:n,start:s,end:a}=r,i=e.length,{compare:l,between:c,normalize:d}=o6(n),{start:h,end:p,loop:x,style:m}=E$(t,e,r),b=[];let y=!1,w=null,S,k,A;const z=()=>c(s,A,S)&&l(s,A)!==0,H=()=>l(a,S)===0||c(a,A,S),V=()=>y||z(),B=()=>!y||H();for(let R=h,O=h;R<=p;++R)k=e[R%i],!k.skip&&(S=d(k[n]),S!==A&&(y=c(S,s,a),w===null&&V()&&(w=l(S,s)===0?R:O),w!==null&&B()&&(b.push(A_({start:w,end:R,loop:x,count:i,style:m})),w=null),O=R,A=S));return w!==null&&b.push(A_({start:w,end:p,loop:x,count:i,style:m})),b}function c6(t,e){const r=[],n=t.segments;for(let s=0;s<n.length;s++){const a=l6(n[s],t.points,e);a.length&&r.push(...a)}return r}function A$(t,e,r,n){let s=0,a=e-1;if(r&&!n)for(;s<e&&!t[s].skip;)s++;for(;s<e&&t[s].skip;)s++;for(s%=e,r&&(a+=s);a>s&&t[a%e].skip;)a--;return a%=e,{start:s,end:a}}function C$(t,e,r,n){const s=t.length,a=[];let i=e,l=t[e],c;for(c=e+1;c<=r;++c){const d=t[c%s];d.skip||d.stop?l.skip||(n=!1,a.push({start:e%s,end:(c-1)%s,loop:n}),e=i=d.stop?c:null):(i=c,l.skip&&(e=c)),l=d}return i!==null&&a.push({start:e%s,end:i%s,loop:n}),a}function T$(t,e){const r=t.points,n=t.options.spanGaps,s=r.length;if(!s)return[];const a=!!t._loop,{start:i,end:l}=A$(r,s,a,n);if(n===!0)return C_(t,[{start:i,end:l,loop:a}],r,e);const c=l<i?l+s:l,d=!!t._fullLoop&&i===0&&l===s-1;return C_(t,C$(r,i,c,d),r,e)}function C_(t,e,r,n){return!n||!n.setContext||!r?e:F$(t,e,r,n)}function F$(t,e,r,n){const s=t._chart.getContext(),a=T_(t.options),{_datasetIndex:i,options:{spanGaps:l}}=t,c=r.length,d=[];let h=a,p=e[0].start,x=p;function m(b,y,w,S){const k=l?-1:1;if(b!==y){for(b+=c;r[b%c].skip;)b-=k;for(;r[y%c].skip;)y+=k;b%c!==y%c&&(d.push({start:b%c,end:y%c,loop:w,style:S}),h=S,p=y%c)}}for(const b of e){p=l?p:b.start;let y=r[p%c],w;for(x=p+1;x<=b.end;x++){const S=r[x%c];w=T_(n.setContext(od(s,{type:"segment",p0:y,p1:S,p0DataIndex:(x-1)%c,p1DataIndex:x%c,datasetIndex:i}))),P$(w,h)&&m(p,x-1,b.loop,h),y=S,h=w}p<x-1&&m(p,x-1,b.loop,h)}return d}function T_(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function P$(t,e){if(!e)return!1;const r=[],n=function(s,a){return Ly(a)?(r.includes(a)||r.push(a),r.indexOf(a)):a};return JSON.stringify(t,n)!==JSON.stringify(e,n)}function Um(t,e,r){return t.options.clip?t[r]:e[r]}function L$(t,e){const{xScale:r,yScale:n}=t;return r&&n?{left:Um(r,e,"left"),right:Um(r,e,"right"),top:Um(n,e,"top"),bottom:Um(n,e,"bottom")}:e}function u6(t,e){const r=e._clip;if(r.disabled)return!1;const n=L$(e,t.chartArea);return{left:r.left===!1?0:n.left-(r.left===!0?0:r.left),right:r.right===!1?t.width:n.right+(r.right===!0?0:r.right),top:r.top===!1?0:n.top-(r.top===!0?0:r.top),bottom:r.bottom===!1?t.height:n.bottom+(r.bottom===!0?0:r.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class D${constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,r,n,s){const a=r.listeners[s],i=r.duration;a.forEach(l=>l({chart:e,initial:r.initial,numSteps:i,currentStep:Math.min(n-r.start,i)}))}_refresh(){this._request||(this._running=!0,this._request=Kk.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let r=0;this._charts.forEach((n,s)=>{if(!n.running||!n.items.length)return;const a=n.items;let i=a.length-1,l=!1,c;for(;i>=0;--i)c=a[i],c._active?(c._total>n.duration&&(n.duration=c._total),c.tick(e),l=!0):(a[i]=a[a.length-1],a.pop());l&&(s.draw(),this._notify(s,n,e,"progress")),a.length||(n.running=!1,this._notify(s,n,e,"complete"),n.initial=!1),r+=a.length}),this._lastDate=e,r===0&&(this._running=!1)}_getAnims(e){const r=this._charts;let n=r.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},r.set(e,n)),n}listen(e,r,n){this._getAnims(e).listeners[r].push(n)}add(e,r){!r||!r.length||this._getAnims(e).items.push(...r)}has(e){return this._getAnims(e).items.length>0}start(e){const r=this._charts.get(e);r&&(r.running=!0,r.start=Date.now(),r.duration=r.items.reduce((n,s)=>Math.max(n,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const r=this._charts.get(e);return!(!r||!r.running||!r.items.length)}stop(e){const r=this._charts.get(e);if(!r||!r.items.length)return;const n=r.items;let s=n.length-1;for(;s>=0;--s)n[s].cancel();r.items=[],this._notify(e,r,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var gc=new D$;const F_="transparent",R$={boolean(t,e,r){return r>.5?e:t},color(t,e,r){const n=w_(t||F_),s=n.valid&&w_(e||F_);return s&&s.valid?s.mix(n,r).hexString():e},number(t,e,r){return t+(e-t)*r}};class I${constructor(e,r,n,s){const a=r[n];s=Mm([e.to,s,a,e.from]);const i=Mm([e.from,a,s]);this._active=!0,this._fn=e.fn||R$[e.type||typeof i],this._easing=Oh[e.easing]||Oh.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=r,this._prop=n,this._from=i,this._to=s,this._promises=void 0}active(){return this._active}update(e,r,n){if(this._active){this._notify(!1);const s=this._target[this._prop],a=n-this._start,i=this._duration-a;this._start=n,this._duration=Math.floor(Math.max(i,e.duration)),this._total+=a,this._loop=!!e.loop,this._to=Mm([e.to,r,s,e.from]),this._from=Mm([e.from,s,r])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const r=e-this._start,n=this._duration,s=this._prop,a=this._from,i=this._loop,l=this._to;let c;if(this._active=a!==l&&(i||r<n),!this._active){this._target[s]=l,this._notify(!0);return}if(r<0){this._target[s]=a;return}c=r/n%2,c=i&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[s]=this._fn(a,l,c)}wait(){const e=this._promises||(this._promises=[]);return new Promise((r,n)=>{e.push({res:r,rej:n})})}_notify(e){const r=e?"res":"rej",n=this._promises||[];for(let s=0;s<n.length;s++)n[s][r]()}}class d6{constructor(e,r){this._chart=e,this._properties=new Map,this.configure(r)}configure(e){if(!Lr(e))return;const r=Object.keys(rs.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const a=e[s];if(!Lr(a))return;const i={};for(const l of r)i[l]=a[l];(Mn(a.properties)&&a.properties||[s]).forEach(l=>{(l===s||!n.has(l))&&n.set(l,i)})})}_animateOptions(e,r){const n=r.options,s=M$(e,n);if(!s)return[];const a=this._createAnimations(s,n);return n.$shared&&O$(e.options.$animations,n).then(()=>{e.options=n},()=>{}),a}_createAnimations(e,r){const n=this._properties,s=[],a=e.$animations||(e.$animations={}),i=Object.keys(r),l=Date.now();let c;for(c=i.length-1;c>=0;--c){const d=i[c];if(d.charAt(0)==="$")continue;if(d==="options"){s.push(...this._animateOptions(e,r));continue}const h=r[d];let p=a[d];const x=n.get(d);if(p)if(x&&p.active()){p.update(x,h,l);continue}else p.cancel();if(!x||!x.duration){e[d]=h;continue}a[d]=p=new I$(x,e,d,h),s.push(p)}return s}update(e,r){if(this._properties.size===0){Object.assign(e,r);return}const n=this._createAnimations(e,r);if(n.length)return gc.add(this._chart,n),!0}}function O$(t,e){const r=[],n=Object.keys(e);for(let s=0;s<n.length;s++){const a=t[n[s]];a&&a.active()&&r.push(a.wait())}return Promise.all(r)}function M$(t,e){if(!e)return;let r=t.options;if(!r){t.options=e;return}return r.$shared&&(t.options=r=Object.assign({},r,{$shared:!1,$animations:{}})),r}function P_(t,e){const r=t&&t.options||{},n=r.reverse,s=r.min===void 0?e:0,a=r.max===void 0?e:0;return{start:n?a:s,end:n?s:a}}function B$(t,e,r){if(r===!1)return!1;const n=P_(t,r),s=P_(e,r);return{top:s.end,right:n.end,bottom:s.start,left:n.start}}function U$(t){let e,r,n,s;return Lr(t)?(e=t.top,r=t.right,n=t.bottom,s=t.left):e=r=n=s=t,{top:e,right:r,bottom:n,left:s,disabled:t===!1}}function f6(t,e){const r=[],n=t._getSortedDatasetMetas(e);let s,a;for(s=0,a=n.length;s<a;++s)r.push(n[s].index);return r}function L_(t,e,r,n={}){const s=t.keys,a=n.mode==="single";let i,l,c,d;if(e===null)return;let h=!1;for(i=0,l=s.length;i<l;++i){if(c=+s[i],c===r){if(h=!0,n.all)continue;break}d=t.values[c],Gs(d)&&(a||e===0||Ll(e)===Ll(d))&&(e+=d)}return!h&&!n.all?0:e}function z$(t,e){const{iScale:r,vScale:n}=e,s=r.axis==="x"?"x":"y",a=n.axis==="x"?"x":"y",i=Object.keys(t),l=new Array(i.length);let c,d,h;for(c=0,d=i.length;c<d;++c)h=i[c],l[c]={[s]:h,[a]:t[h]};return l}function Q1(t,e){const r=t&&t.options.stacked;return r||r===void 0&&e.stack!==void 0}function H$(t,e,r){return`${t.id}.${e.id}.${r.stack||r.type}`}function $$(t){const{min:e,max:r,minDefined:n,maxDefined:s}=t.getUserBounds();return{min:n?e:Number.NEGATIVE_INFINITY,max:s?r:Number.POSITIVE_INFINITY}}function W$(t,e,r){const n=t[e]||(t[e]={});return n[r]||(n[r]={})}function D_(t,e,r,n){for(const s of e.getMatchingVisibleMetas(n).reverse()){const a=t[s.index];if(r&&a>0||!r&&a<0)return s.index}return null}function R_(t,e){const{chart:r,_cachedMeta:n}=t,s=r._stacks||(r._stacks={}),{iScale:a,vScale:i,index:l}=n,c=a.axis,d=i.axis,h=H$(a,i,n),p=e.length;let x;for(let m=0;m<p;++m){const b=e[m],{[c]:y,[d]:w}=b,S=b._stacks||(b._stacks={});x=S[d]=W$(s,h,y),x[l]=w,x._top=D_(x,i,!0,n.type),x._bottom=D_(x,i,!1,n.type);const k=x._visualValues||(x._visualValues={});k[l]=w}}function Z1(t,e){const r=t.scales;return Object.keys(r).filter(n=>r[n].axis===e).shift()}function V$(t,e){return od(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function q$(t,e,r){return od(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:r,index:e,mode:"default",type:"data"})}function dh(t,e){const r=t.controller.index,n=t.vScale&&t.vScale.axis;if(n){e=e||t._parsed;for(const s of e){const a=s._stacks;if(!a||a[n]===void 0||a[n][r]===void 0)return;delete a[n][r],a[n]._visualValues!==void 0&&a[n]._visualValues[r]!==void 0&&delete a[n]._visualValues[r]}}}const e2=t=>t==="reset"||t==="none",I_=(t,e)=>e?t:Object.assign({},t),G$=(t,e,r)=>t&&!e.hidden&&e._stacked&&{keys:f6(r,!0),values:null};class Pp{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,r){this.chart=e,this._ctx=e.ctx,this.index=r,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Q1(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&dh(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,r=this._cachedMeta,n=this.getDataset(),s=(p,x,m,b)=>p==="x"?x:p==="r"?b:m,a=r.xAxisID=jr(n.xAxisID,Z1(e,"x")),i=r.yAxisID=jr(n.yAxisID,Z1(e,"y")),l=r.rAxisID=jr(n.rAxisID,Z1(e,"r")),c=r.indexAxis,d=r.iAxisID=s(c,a,i,l),h=r.vAxisID=s(c,i,a,l);r.xScale=this.getScaleForId(a),r.yScale=this.getScaleForId(i),r.rScale=this.getScaleForId(l),r.iScale=this.getScaleForId(d),r.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const r=this._cachedMeta;return e===r.iScale?r.vScale:r.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&v_(this._data,this),e._stacked&&dh(e)}_dataCheck(){const e=this.getDataset(),r=e.data||(e.data=[]),n=this._data;if(Lr(r)){const s=this._cachedMeta;this._data=z$(r,s)}else if(n!==r){if(n){v_(n,this);const s=this._cachedMeta;dh(s),s._parsed=[]}r&&Object.isExtensible(r)&&EH(r,this),this._syncList=[],this._data=r}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const r=this._cachedMeta,n=this.getDataset();let s=!1;this._dataCheck();const a=r._stacked;r._stacked=Q1(r.vScale,r),r.stack!==n.stack&&(s=!0,dh(r),r.stack=n.stack),this._resyncElements(e),(s||a!==r._stacked)&&(R_(this,r._parsed),r._stacked=Q1(r.vScale,r))}configure(){const e=this.chart.config,r=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),r,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,r){const{_cachedMeta:n,_data:s}=this,{iScale:a,_stacked:i}=n,l=a.axis;let c=e===0&&r===s.length?!0:n._sorted,d=e>0&&n._parsed[e-1],h,p,x;if(this._parsing===!1)n._parsed=s,n._sorted=!0,x=s;else{Mn(s[e])?x=this.parseArrayData(n,s,e,r):Lr(s[e])?x=this.parseObjectData(n,s,e,r):x=this.parsePrimitiveData(n,s,e,r);const m=()=>p[l]===null||d&&p[l]<d[l];for(h=0;h<r;++h)n._parsed[h+e]=p=x[h],c&&(m()&&(c=!1),d=p);n._sorted=c}i&&R_(this,x)}parsePrimitiveData(e,r,n,s){const{iScale:a,vScale:i}=e,l=a.axis,c=i.axis,d=a.getLabels(),h=a===i,p=new Array(s);let x,m,b;for(x=0,m=s;x<m;++x)b=x+n,p[x]={[l]:h||a.parse(d[b],b),[c]:i.parse(r[b],b)};return p}parseArrayData(e,r,n,s){const{xScale:a,yScale:i}=e,l=new Array(s);let c,d,h,p;for(c=0,d=s;c<d;++c)h=c+n,p=r[h],l[c]={x:a.parse(p[0],h),y:i.parse(p[1],h)};return l}parseObjectData(e,r,n,s){const{xScale:a,yScale:i}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=new Array(s);let h,p,x,m;for(h=0,p=s;h<p;++h)x=h+n,m=r[x],d[h]={x:a.parse(td(m,l),x),y:i.parse(td(m,c),x)};return d}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,r,n){const s=this.chart,a=this._cachedMeta,i=r[e.axis],l={keys:f6(s,!0),values:r._stacks[e.axis]._visualValues};return L_(l,i,a.index,{mode:n})}updateRangeFromParsed(e,r,n,s){const a=n[r.axis];let i=a===null?NaN:a;const l=s&&n._stacks[r.axis];s&&l&&(s.values=l,i=L_(s,a,this._cachedMeta.index)),e.min=Math.min(e.min,i),e.max=Math.max(e.max,i)}getMinMax(e,r){const n=this._cachedMeta,s=n._parsed,a=n._sorted&&e===n.iScale,i=s.length,l=this._getOtherScale(e),c=G$(r,n,this.chart),d={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:p}=$$(l);let x,m;function b(){m=s[x];const y=m[l.axis];return!Gs(m[e.axis])||h>y||p<y}for(x=0;x<i&&!(!b()&&(this.updateRangeFromParsed(d,e,m,c),a));++x);if(a){for(x=i-1;x>=0;--x)if(!b()){this.updateRangeFromParsed(d,e,m,c);break}}return d}getAllParsedValues(e){const r=this._cachedMeta._parsed,n=[];let s,a,i;for(s=0,a=r.length;s<a;++s)i=r[s][e.axis],Gs(i)&&n.push(i);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const r=this._cachedMeta,n=r.iScale,s=r.vScale,a=this.getParsed(e);return{label:n?""+n.getLabelForValue(a[n.axis]):"",value:s?""+s.getLabelForValue(a[s.axis]):""}}_update(e){const r=this._cachedMeta;this.update(e||"default"),r._clip=U$(jr(this.options.clip,B$(r.xScale,r.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,r=this.chart,n=this._cachedMeta,s=n.data||[],a=r.chartArea,i=[],l=this._drawStart||0,c=this._drawCount||s.length-l,d=this.options.drawActiveElementsOnTop;let h;for(n.dataset&&n.dataset.draw(e,a,l,c),h=l;h<l+c;++h){const p=s[h];p.hidden||(p.active&&d?i.push(p):p.draw(e,a))}for(h=0;h<i.length;++h)i[h].draw(e,a)}getStyle(e,r){const n=r?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,r,n){const s=this.getDataset();let a;if(e>=0&&e<this._cachedMeta.data.length){const i=this._cachedMeta.data[e];a=i.$context||(i.$context=q$(this.getContext(),e,i)),a.parsed=this.getParsed(e),a.raw=s.data[e],a.index=a.dataIndex=e}else a=this.$context||(this.$context=V$(this.chart.getContext(),this.index)),a.dataset=s,a.index=a.datasetIndex=this.index;return a.active=!!r,a.mode=n,a}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,r){return this._resolveElementOptions(this.dataElementType.id,r,e)}_resolveElementOptions(e,r="default",n){const s=r==="active",a=this._cachedDataOpts,i=e+"-"+r,l=a[i],c=this.enableOptionSharing&&cp(n);if(l)return I_(l,c);const d=this.chart.config,h=d.datasetElementScopeKeys(this._type,e),p=s?[`${e}Hover`,"hover",e,""]:[e,""],x=d.getOptionScopes(this.getDataset(),h),m=Object.keys(rs.elements[e]),b=()=>this.getContext(n,s,r),y=d.resolveNamedOptions(x,m,b,p);return y.$shared&&(y.$shared=c,a[i]=Object.freeze(I_(y,c))),y}_resolveAnimations(e,r,n){const s=this.chart,a=this._cachedDataOpts,i=`animation-${r}`,l=a[i];if(l)return l;let c;if(s.options.animation!==!1){const h=this.chart.config,p=h.datasetAnimationScopeKeys(this._type,r),x=h.getOptionScopes(this.getDataset(),p);c=h.createResolver(x,this.getContext(e,n,r))}const d=new d6(s,c&&c.animations);return c&&c._cacheable&&(a[i]=Object.freeze(d)),d}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,r){return!r||e2(e)||this.chart._animationsDisabled}_getSharedOptions(e,r){const n=this.resolveDataElementOptions(e,r),s=this._sharedOptions,a=this.getSharedOptions(n),i=this.includeOptions(r,a)||a!==s;return this.updateSharedOptions(a,r,n),{sharedOptions:a,includeOptions:i}}updateElement(e,r,n,s){e2(s)?Object.assign(e,n):this._resolveAnimations(r,s).update(e,n)}updateSharedOptions(e,r,n){e&&!e2(r)&&this._resolveAnimations(void 0,r).update(e,n)}_setStyle(e,r,n,s){e.active=s;const a=this.getStyle(r,s);this._resolveAnimations(r,n,s).update(e,{options:!s&&this.getSharedOptions(a)||a})}removeHoverStyle(e,r,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,r,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const r=this._data,n=this._cachedMeta.data;for(const[l,c,d]of this._syncList)this[l](c,d);this._syncList=[];const s=n.length,a=r.length,i=Math.min(a,s);i&&this.parse(0,i),a>s?this._insertElements(s,a-s,e):a<s&&this._removeElements(a,s-a)}_insertElements(e,r,n=!0){const s=this._cachedMeta,a=s.data,i=e+r;let l;const c=d=>{for(d.length+=r,l=d.length-1;l>=i;l--)d[l]=d[l-r]};for(c(a),l=e;l<i;++l)a[l]=new this.dataElementType;this._parsing&&c(s._parsed),this.parse(e,r),n&&this.updateElements(a,e,r,"reset")}updateElements(e,r,n,s){}_removeElements(e,r){const n=this._cachedMeta;if(this._parsing){const s=n._parsed.splice(e,r);n._stacked&&dh(n,s)}n.data.splice(e,r)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[r,n,s]=e;this[r](n,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,r){r&&this._sync(["_removeElements",e,r]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function X$(t,e){if(!t._cache.$bar){const r=t.getMatchingVisibleMetas(e);let n=[];for(let s=0,a=r.length;s<a;s++)n=n.concat(r[s].controller.getAllParsedValues(t));t._cache.$bar=Yk(n.sort((s,a)=>s-a))}return t._cache.$bar}function Y$(t){const e=t.iScale,r=X$(e,t.type);let n=e._length,s,a,i,l;const c=()=>{i===32767||i===-32768||(cp(l)&&(n=Math.min(n,Math.abs(i-l)||n)),l=i)};for(s=0,a=r.length;s<a;++s)i=e.getPixelForValue(r[s]),c();for(l=void 0,s=0,a=e.ticks.length;s<a;++s)i=e.getPixelForTick(s),c();return n}function K$(t,e,r,n){const s=r.barThickness;let a,i;return Vr(s)?(a=e.min*r.categoryPercentage,i=r.barPercentage):(a=s*n,i=1),{chunk:a/n,ratio:i,start:e.pixels[t]-a/2}}function J$(t,e,r,n){const s=e.pixels,a=s[t];let i=t>0?s[t-1]:null,l=t<s.length-1?s[t+1]:null;const c=r.categoryPercentage;i===null&&(i=a-(l===null?e.end-e.start:l-a)),l===null&&(l=a+a-i);const d=a-(a-Math.min(i,l))/2*c;return{chunk:Math.abs(l-i)/2*c/n,ratio:r.barPercentage,start:d}}function Q$(t,e,r,n){const s=r.parse(t[0],n),a=r.parse(t[1],n),i=Math.min(s,a),l=Math.max(s,a);let c=i,d=l;Math.abs(i)>Math.abs(l)&&(c=l,d=i),e[r.axis]=d,e._custom={barStart:c,barEnd:d,start:s,end:a,min:i,max:l}}function h6(t,e,r,n){return Mn(t)?Q$(t,e,r,n):e[r.axis]=r.parse(t,n),e}function O_(t,e,r,n){const s=t.iScale,a=t.vScale,i=s.getLabels(),l=s===a,c=[];let d,h,p,x;for(d=r,h=r+n;d<h;++d)x=e[d],p={},p[s.axis]=l||s.parse(i[d],d),c.push(h6(x,p,a,d));return c}function t2(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function Z$(t,e,r){return t!==0?Ll(t):(e.isHorizontal()?1:-1)*(e.min>=r?1:-1)}function eW(t){let e,r,n,s,a;return t.horizontal?(e=t.base>t.x,r="left",n="right"):(e=t.base<t.y,r="bottom",n="top"),e?(s="end",a="start"):(s="start",a="end"),{start:r,end:n,reverse:e,top:s,bottom:a}}function tW(t,e,r,n){let s=e.borderSkipped;const a={};if(!s){t.borderSkipped=a;return}if(s===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:i,end:l,reverse:c,top:d,bottom:h}=eW(t);s==="middle"&&r&&(t.enableBorderRadius=!0,(r._top||0)===n?s=d:(r._bottom||0)===n?s=h:(a[M_(h,i,l,c)]=!0,s=d)),a[M_(s,i,l,c)]=!0,t.borderSkipped=a}function M_(t,e,r,n){return n?(t=rW(t,e,r),t=B_(t,r,e)):t=B_(t,e,r),t}function rW(t,e,r){return t===e?r:t===r?e:t}function B_(t,e,r){return t==="start"?e:t==="end"?r:t}function nW(t,{inflateAmount:e},r){t.inflateAmount=e==="auto"?r===1?.33:0:e}class sW extends Pp{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,r,n,s){return O_(e,r,n,s)}parseArrayData(e,r,n,s){return O_(e,r,n,s)}parseObjectData(e,r,n,s){const{iScale:a,vScale:i}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=a.axis==="x"?l:c,h=i.axis==="x"?l:c,p=[];let x,m,b,y;for(x=n,m=n+s;x<m;++x)y=r[x],b={},b[a.axis]=a.parse(td(y,d),x),p.push(h6(td(y,h),b,i,x));return p}updateRangeFromParsed(e,r,n,s){super.updateRangeFromParsed(e,r,n,s);const a=n._custom;a&&r===this._cachedMeta.vScale&&(e.min=Math.min(e.min,a.min),e.max=Math.max(e.max,a.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const r=this._cachedMeta,{iScale:n,vScale:s}=r,a=this.getParsed(e),i=a._custom,l=t2(i)?"["+i.start+", "+i.end+"]":""+s.getLabelForValue(a[s.axis]);return{label:""+n.getLabelForValue(a[n.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const r=this._cachedMeta;this.updateElements(r.data,0,r.data.length,e)}updateElements(e,r,n,s){const a=s==="reset",{index:i,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),d=l.isHorizontal(),h=this._getRuler(),{sharedOptions:p,includeOptions:x}=this._getSharedOptions(r,s);for(let m=r;m<r+n;m++){const b=this.getParsed(m),y=a||Vr(b[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(m),w=this._calculateBarIndexPixels(m,h),S=(b._stacks||{})[l.axis],k={horizontal:d,base:y.base,enableBorderRadius:!S||t2(b._custom)||i===S._top||i===S._bottom,x:d?y.head:w.center,y:d?w.center:y.head,height:d?w.size:Math.abs(y.size),width:d?Math.abs(y.size):w.size};x&&(k.options=p||this.resolveDataElementOptions(m,e[m].active?"active":s));const A=k.options||e[m].options;tW(k,A,S,i),nW(k,A,h.ratio),this.updateElement(e[m],m,k,s)}}_getStacks(e,r){const{iScale:n}=this._cachedMeta,s=n.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),a=n.options.stacked,i=[],l=this._cachedMeta.controller.getParsed(r),c=l&&l[n.axis],d=h=>{const p=h._parsed.find(m=>m[n.axis]===c),x=p&&p[h.vScale.axis];if(Vr(x)||isNaN(x))return!0};for(const h of s)if(!(r!==void 0&&d(h))&&((a===!1||i.indexOf(h.stack)===-1||a===void 0&&h.stack===void 0)&&i.push(h.stack),h.index===e))break;return i.length||i.push(void 0),i}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,r=this.chart.options.indexAxis;return Object.keys(e).filter(n=>e[n].axis===r).shift()}_getAxis(){const e={},r=this.getFirstScaleIdForIndexAxis();for(const n of this.chart.data.datasets)e[jr(this.chart.options.indexAxis==="x"?n.xAxisID:n.yAxisID,r)]=!0;return Object.keys(e)}_getStackIndex(e,r,n){const s=this._getStacks(e,n),a=r!==void 0?s.indexOf(r):-1;return a===-1?s.length-1:a}_getRuler(){const e=this.options,r=this._cachedMeta,n=r.iScale,s=[];let a,i;for(a=0,i=r.data.length;a<i;++a)s.push(n.getPixelForValue(this.getParsed(a)[n.axis],a));const l=e.barThickness;return{min:l||Y$(r),pixels:s,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:e.grouped,ratio:l?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:r,_stacked:n,index:s},options:{base:a,minBarLength:i}}=this,l=a||0,c=this.getParsed(e),d=c._custom,h=t2(d);let p=c[r.axis],x=0,m=n?this.applyStack(r,c,n):p,b,y;m!==p&&(x=m-p,m=p),h&&(p=d.barStart,m=d.barEnd-d.barStart,p!==0&&Ll(p)!==Ll(d.barEnd)&&(x=0),x+=p);const w=!Vr(a)&&!h?a:x;let S=r.getPixelForValue(w);if(this.chart.getDataVisibility(e)?b=r.getPixelForValue(x+m):b=S,y=b-S,Math.abs(y)<i){y=Z$(y,r,l)*i,p===l&&(S-=y/2);const k=r.getPixelForDecimal(0),A=r.getPixelForDecimal(1),z=Math.min(k,A),H=Math.max(k,A);S=Math.max(Math.min(S,H),z),b=S+y,n&&!h&&(c._stacks[r.axis]._visualValues[s]=r.getValueForPixel(b)-r.getValueForPixel(S))}if(S===r.getPixelForValue(l)){const k=Ll(y)*r.getLineWidthForValue(l)/2;S+=k,y-=k}return{size:y,base:S,head:b,center:b+y/2}}_calculateBarIndexPixels(e,r){const n=r.scale,s=this.options,a=s.skipNull,i=jr(s.maxBarThickness,1/0);let l,c;const d=this._getAxisCount();if(r.grouped){const h=a?this._getStackCount(e):r.stackCount,p=s.barThickness==="flex"?J$(e,r,s,h*d):K$(e,r,s,h*d),x=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,m=this._getAxis().indexOf(jr(x,this.getFirstScaleIdForIndexAxis())),b=this._getStackIndex(this.index,this._cachedMeta.stack,a?e:void 0)+m;l=p.start+p.chunk*b+p.chunk/2,c=Math.min(i,p.chunk*p.ratio)}else l=n.getPixelForValue(this.getParsed(e)[n.axis],e),c=Math.min(i,r.min*r.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){const e=this._cachedMeta,r=e.vScale,n=e.data,s=n.length;let a=0;for(;a<s;++a)this.getParsed(a)[r.axis]!==null&&!n[a].hidden&&n[a].draw(this._ctx)}}function aW(t,e,r){let n=1,s=1,a=0,i=0;if(e<Ln){const l=t,c=l+e,d=Math.cos(l),h=Math.sin(l),p=Math.cos(c),x=Math.sin(c),m=(A,z,H)=>dp(A,l,c,!0)?1:Math.max(z,z*r,H,H*r),b=(A,z,H)=>dp(A,l,c,!0)?-1:Math.min(z,z*r,H,H*r),y=m(0,d,p),w=m(ms,h,x),S=b(Kr,d,p),k=b(Kr+ms,h,x);n=(y-S)/2,s=(w-k)/2,a=-(y+S)/2,i=-(w+k)/2}return{ratioX:n,ratioY:s,offsetX:a,offsetY:i}}class p6 extends Pp{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const r=e.data,{labels:{pointStyle:n,textAlign:s,color:a,useBorderRadius:i,borderRadius:l}}=e.legend.options;return r.labels.length&&r.datasets.length?r.labels.map((c,d)=>{const p=e.getDatasetMeta(0).controller.getStyle(d);return{text:c,fillStyle:p.backgroundColor,fontColor:a,hidden:!e.getDataVisibility(d),lineDash:p.borderDash,lineDashOffset:p.borderDashOffset,lineJoin:p.borderJoinStyle,lineWidth:p.borderWidth,strokeStyle:p.borderColor,textAlign:s,pointStyle:n,borderRadius:i&&(l||p.borderRadius),index:d}}):[]}},onClick(e,r,n){n.chart.toggleDataVisibility(r.index),n.chart.update()}}}};constructor(e,r){super(e,r),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,r){const n=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=n;else{let a=c=>+n[c];if(Lr(n[e])){const{key:c="value"}=this._parsing;a=d=>+td(n[d],c)}let i,l;for(i=e,l=e+r;i<l;++i)s._parsed[i]=a(i)}}_getRotation(){return Go(this.options.rotation-90)}_getCircumference(){return Go(this.options.circumference)}_getRotationExtents(){let e=Ln,r=-Ln;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const s=this.chart.getDatasetMeta(n).controller,a=s._getRotation(),i=s._getCircumference();e=Math.min(e,a),r=Math.max(r,a+i)}return{rotation:e,circumference:r-e}}update(e){const r=this.chart,{chartArea:n}=r,s=this._cachedMeta,a=s.data,i=this.getMaxBorderWidth()+this.getMaxOffset(a)+this.options.spacing,l=Math.max((Math.min(n.width,n.height)-i)/2,0),c=Math.min(dH(this.options.cutout,l),1),d=this._getRingWeight(this.index),{circumference:h,rotation:p}=this._getRotationExtents(),{ratioX:x,ratioY:m,offsetX:b,offsetY:y}=aW(p,h,c),w=(n.width-i)/x,S=(n.height-i)/m,k=Math.max(Math.min(w,S)/2,0),A=Wk(this.options.radius,k),z=Math.max(A*c,0),H=(A-z)/this._getVisibleDatasetWeightTotal();this.offsetX=b*A,this.offsetY=y*A,s.total=this.calculateTotal(),this.outerRadius=A-H*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-H*d,0),this.updateElements(a,0,a.length,e)}_circumference(e,r){const n=this.options,s=this._cachedMeta,a=this._getCircumference();return r&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||s._parsed[e]===null||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*a/Ln)}updateElements(e,r,n,s){const a=s==="reset",i=this.chart,l=i.chartArea,d=i.options.animation,h=(l.left+l.right)/2,p=(l.top+l.bottom)/2,x=a&&d.animateScale,m=x?0:this.innerRadius,b=x?0:this.outerRadius,{sharedOptions:y,includeOptions:w}=this._getSharedOptions(r,s);let S=this._getRotation(),k;for(k=0;k<r;++k)S+=this._circumference(k,a);for(k=r;k<r+n;++k){const A=this._circumference(k,a),z=e[k],H={x:h+this.offsetX,y:p+this.offsetY,startAngle:S,endAngle:S+A,circumference:A,outerRadius:b,innerRadius:m};w&&(H.options=y||this.resolveDataElementOptions(k,z.active?"active":s)),S+=A,this.updateElement(z,k,H,s)}}calculateTotal(){const e=this._cachedMeta,r=e.data;let n=0,s;for(s=0;s<r.length;s++){const a=e._parsed[s];a!==null&&!isNaN(a)&&this.chart.getDataVisibility(s)&&!r[s].hidden&&(n+=Math.abs(a))}return n}calculateCircumference(e){const r=this._cachedMeta.total;return r>0&&!isNaN(e)?Ln*(Math.abs(e)/r):0}getLabelAndValue(e){const r=this._cachedMeta,n=this.chart,s=n.data.labels||[],a=xg(r._parsed[e],n.options.locale);return{label:s[e]||"",value:a}}getMaxBorderWidth(e){let r=0;const n=this.chart;let s,a,i,l,c;if(!e){for(s=0,a=n.data.datasets.length;s<a;++s)if(n.isDatasetVisible(s)){i=n.getDatasetMeta(s),e=i.data,l=i.controller;break}}if(!e)return 0;for(s=0,a=e.length;s<a;++s)c=l.resolveDataElementOptions(s),c.borderAlign!=="inner"&&(r=Math.max(r,c.borderWidth||0,c.hoverBorderWidth||0));return r}getMaxOffset(e){let r=0;for(let n=0,s=e.length;n<s;++n){const a=this.resolveDataElementOptions(n);r=Math.max(r,a.offset||0,a.hoverOffset||0)}return r}_getRingWeightOffset(e){let r=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(r+=this._getRingWeight(n));return r}_getRingWeight(e){return Math.max(jr(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class iW extends Pp{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const r=this._cachedMeta,{dataset:n,data:s=[],_dataset:a}=r,i=this.chart._animationsDisabled;let{start:l,count:c}=TH(r,s,i);this._drawStart=l,this._drawCount=c,FH(r)&&(l=0,c=s.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!a._decimated,n.points=s;const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0),d.segment=this.options.segment,this.updateElement(n,void 0,{animated:!i,options:d},e),this.updateElements(s,l,c,e)}updateElements(e,r,n,s){const a=s==="reset",{iScale:i,vScale:l,_stacked:c,_dataset:d}=this._cachedMeta,{sharedOptions:h,includeOptions:p}=this._getSharedOptions(r,s),x=i.axis,m=l.axis,{spanGaps:b,segment:y}=this.options,w=up(b)?b:Number.POSITIVE_INFINITY,S=this.chart._animationsDisabled||a||s==="none",k=r+n,A=e.length;let z=r>0&&this.getParsed(r-1);for(let H=0;H<A;++H){const V=e[H],B=S?V:{};if(H<r||H>=k){B.skip=!0;continue}const R=this.getParsed(H),O=Vr(R[m]),ee=B[x]=i.getPixelForValue(R[x],H),I=B[m]=a||O?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,R,c):R[m],H);B.skip=isNaN(ee)||isNaN(I)||O,B.stop=H>0&&Math.abs(R[x]-z[x])>w,y&&(B.parsed=R,B.raw=d.data[H]),p&&(B.options=h||this.resolveDataElementOptions(H,V.active?"active":s)),S||this.updateElement(V,H,B,s),z=R}}getMaxOverflow(){const e=this._cachedMeta,r=e.dataset,n=r.options&&r.options.borderWidth||0,s=e.data||[];if(!s.length)return n;const a=s[0].size(this.resolveDataElementOptions(0)),i=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(n,a,i)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}class oW extends Pp{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const r=e.data;if(r.labels.length&&r.datasets.length){const{labels:{pointStyle:n,color:s}}=e.legend.options;return r.labels.map((a,i)=>{const c=e.getDatasetMeta(0).controller.getStyle(i);return{text:a,fillStyle:c.backgroundColor,strokeStyle:c.borderColor,fontColor:s,lineWidth:c.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(i),index:i}})}return[]}},onClick(e,r,n){n.chart.toggleDataVisibility(r.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(e,r){super(e,r),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const r=this._cachedMeta,n=this.chart,s=n.data.labels||[],a=xg(r._parsed[e].r,n.options.locale);return{label:s[e]||"",value:a}}parseObjectData(e,r,n,s){return l$.bind(this)(e,r,n,s)}update(e){const r=this._cachedMeta.data;this._updateRadius(),this.updateElements(r,0,r.length,e)}getMinMax(){const e=this._cachedMeta,r={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((n,s)=>{const a=this.getParsed(s).r;!isNaN(a)&&this.chart.getDataVisibility(s)&&(a<r.min&&(r.min=a),a>r.max&&(r.max=a))}),r}_updateRadius(){const e=this.chart,r=e.chartArea,n=e.options,s=Math.min(r.right-r.left,r.bottom-r.top),a=Math.max(s/2,0),i=Math.max(n.cutoutPercentage?a/100*n.cutoutPercentage:1,0),l=(a-i)/e.getVisibleDatasetCount();this.outerRadius=a-l*this.index,this.innerRadius=this.outerRadius-l}updateElements(e,r,n,s){const a=s==="reset",i=this.chart,c=i.options.animation,d=this._cachedMeta.rScale,h=d.xCenter,p=d.yCenter,x=d.getIndexAngle(0)-.5*Kr;let m=x,b;const y=360/this.countVisibleElements();for(b=0;b<r;++b)m+=this._computeAngle(b,s,y);for(b=r;b<r+n;b++){const w=e[b];let S=m,k=m+this._computeAngle(b,s,y),A=i.getDataVisibility(b)?d.getDistanceFromCenterForValue(this.getParsed(b).r):0;m=k,a&&(c.animateScale&&(A=0),c.animateRotate&&(S=k=x));const z={x:h,y:p,innerRadius:0,outerRadius:A,startAngle:S,endAngle:k,options:this.resolveDataElementOptions(b,w.active?"active":s)};this.updateElement(w,b,z,s)}}countVisibleElements(){const e=this._cachedMeta;let r=0;return e.data.forEach((n,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&r++}),r}_computeAngle(e,r,n){return this.chart.getDataVisibility(e)?Go(this.resolveDataElementOptions(e,r).angle||n):0}}class lW extends p6{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}function Bd(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class zy{static override(e){Object.assign(zy.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Bd()}parse(){return Bd()}format(){return Bd()}add(){return Bd()}diff(){return Bd()}startOf(){return Bd()}endOf(){return Bd()}}var cW={_date:zy};function uW(t,e,r,n){const{controller:s,data:a,_sorted:i}=t,l=s._cachedMeta.iScale,c=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(l&&e===l.axis&&e!=="r"&&i&&a.length){const d=l._reversePixels?kH:Gd;if(n){if(s._sharedOptions){const h=a[0],p=typeof h.getRange=="function"&&h.getRange(e);if(p){const x=d(a,e,r-p),m=d(a,e,r+p);return{lo:x.lo,hi:m.hi}}}}else{const h=d(a,e,r);if(c){const{vScale:p}=s._cachedMeta,{_parsed:x}=t,m=x.slice(0,h.lo+1).reverse().findIndex(y=>!Vr(y[p.axis]));h.lo-=Math.max(0,m);const b=x.slice(h.hi).findIndex(y=>!Vr(y[p.axis]));h.hi+=Math.max(0,b)}return h}}return{lo:0,hi:a.length-1}}function bg(t,e,r,n,s){const a=t.getSortedVisibleDatasetMetas(),i=r[e];for(let l=0,c=a.length;l<c;++l){const{index:d,data:h}=a[l],{lo:p,hi:x}=uW(a[l],e,i,s);for(let m=p;m<=x;++m){const b=h[m];b.skip||n(b,d,m)}}}function dW(t){const e=t.indexOf("x")!==-1,r=t.indexOf("y")!==-1;return function(n,s){const a=e?Math.abs(n.x-s.x):0,i=r?Math.abs(n.y-s.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(i,2))}}function r2(t,e,r,n,s){const a=[];return!s&&!t.isPointInArea(e)||bg(t,r,e,function(l,c,d){!s&&!jc(l,t.chartArea,0)||l.inRange(e.x,e.y,n)&&a.push({element:l,datasetIndex:c,index:d})},!0),a}function fW(t,e,r,n){let s=[];function a(i,l,c){const{startAngle:d,endAngle:h}=i.getProps(["startAngle","endAngle"],n),{angle:p}=Gk(i,{x:e.x,y:e.y});dp(p,d,h)&&s.push({element:i,datasetIndex:l,index:c})}return bg(t,r,e,a),s}function hW(t,e,r,n,s,a){let i=[];const l=dW(r);let c=Number.POSITIVE_INFINITY;function d(h,p,x){const m=h.inRange(e.x,e.y,s);if(n&&!m)return;const b=h.getCenterPoint(s);if(!(!!a||t.isPointInArea(b))&&!m)return;const w=l(e,b);w<c?(i=[{element:h,datasetIndex:p,index:x}],c=w):w===c&&i.push({element:h,datasetIndex:p,index:x})}return bg(t,r,e,d),i}function n2(t,e,r,n,s,a){return!a&&!t.isPointInArea(e)?[]:r==="r"&&!n?fW(t,e,r,s):hW(t,e,r,n,s,a)}function U_(t,e,r,n,s){const a=[],i=r==="x"?"inXRange":"inYRange";let l=!1;return bg(t,r,e,(c,d,h)=>{c[i]&&c[i](e[r],s)&&(a.push({element:c,datasetIndex:d,index:h}),l=l||c.inRange(e.x,e.y,s))}),n&&!l?[]:a}var pW={modes:{index(t,e,r,n){const s=zd(e,t),a=r.axis||"x",i=r.includeInvisible||!1,l=r.intersect?r2(t,s,a,n,i):n2(t,s,a,!1,n,i),c=[];return l.length?(t.getSortedVisibleDatasetMetas().forEach(d=>{const h=l[0].index,p=d.data[h];p&&!p.skip&&c.push({element:p,datasetIndex:d.index,index:h})}),c):[]},dataset(t,e,r,n){const s=zd(e,t),a=r.axis||"xy",i=r.includeInvisible||!1;let l=r.intersect?r2(t,s,a,n,i):n2(t,s,a,!1,n,i);if(l.length>0){const c=l[0].datasetIndex,d=t.getDatasetMeta(c).data;l=[];for(let h=0;h<d.length;++h)l.push({element:d[h],datasetIndex:c,index:h})}return l},point(t,e,r,n){const s=zd(e,t),a=r.axis||"xy",i=r.includeInvisible||!1;return r2(t,s,a,n,i)},nearest(t,e,r,n){const s=zd(e,t),a=r.axis||"xy",i=r.includeInvisible||!1;return n2(t,s,a,r.intersect,n,i)},x(t,e,r,n){const s=zd(e,t);return U_(t,s,"x",r.intersect,n)},y(t,e,r,n){const s=zd(e,t);return U_(t,s,"y",r.intersect,n)}}};const m6=["left","top","right","bottom"];function fh(t,e){return t.filter(r=>r.pos===e)}function z_(t,e){return t.filter(r=>m6.indexOf(r.pos)===-1&&r.box.axis===e)}function hh(t,e){return t.sort((r,n)=>{const s=e?n:r,a=e?r:n;return s.weight===a.weight?s.index-a.index:s.weight-a.weight})}function mW(t){const e=[];let r,n,s,a,i,l;for(r=0,n=(t||[]).length;r<n;++r)s=t[r],{position:a,options:{stack:i,stackWeight:l=1}}=s,e.push({index:r,box:s,pos:a,horizontal:s.isHorizontal(),weight:s.weight,stack:i&&a+i,stackWeight:l});return e}function xW(t){const e={};for(const r of t){const{stack:n,pos:s,stackWeight:a}=r;if(!n||!m6.includes(s))continue;const i=e[n]||(e[n]={count:0,placed:0,weight:0,size:0});i.count++,i.weight+=a}return e}function gW(t,e){const r=xW(t),{vBoxMaxWidth:n,hBoxMaxHeight:s}=e;let a,i,l;for(a=0,i=t.length;a<i;++a){l=t[a];const{fullSize:c}=l.box,d=r[l.stack],h=d&&l.stackWeight/d.weight;l.horizontal?(l.width=h?h*n:c&&e.availableWidth,l.height=s):(l.width=n,l.height=h?h*s:c&&e.availableHeight)}return r}function vW(t){const e=mW(t),r=hh(e.filter(d=>d.box.fullSize),!0),n=hh(fh(e,"left"),!0),s=hh(fh(e,"right")),a=hh(fh(e,"top"),!0),i=hh(fh(e,"bottom")),l=z_(e,"x"),c=z_(e,"y");return{fullSize:r,leftAndTop:n.concat(a),rightAndBottom:s.concat(c).concat(i).concat(l),chartArea:fh(e,"chartArea"),vertical:n.concat(s).concat(c),horizontal:a.concat(i).concat(l)}}function H_(t,e,r,n){return Math.max(t[r],e[r])+Math.max(t[n],e[n])}function x6(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function yW(t,e,r,n){const{pos:s,box:a}=r,i=t.maxPadding;if(!Lr(s)){r.size&&(t[s]-=r.size);const p=n[r.stack]||{size:0,count:1};p.size=Math.max(p.size,r.horizontal?a.height:a.width),r.size=p.size/p.count,t[s]+=r.size}a.getPadding&&x6(i,a.getPadding());const l=Math.max(0,e.outerWidth-H_(i,t,"left","right")),c=Math.max(0,e.outerHeight-H_(i,t,"top","bottom")),d=l!==t.w,h=c!==t.h;return t.w=l,t.h=c,r.horizontal?{same:d,other:h}:{same:h,other:d}}function bW(t){const e=t.maxPadding;function r(n){const s=Math.max(e[n]-t[n],0);return t[n]+=s,s}t.y+=r("top"),t.x+=r("left"),r("right"),r("bottom")}function wW(t,e){const r=e.maxPadding;function n(s){const a={left:0,top:0,right:0,bottom:0};return s.forEach(i=>{a[i]=Math.max(e[i],r[i])}),a}return n(t?["left","right"]:["top","bottom"])}function wh(t,e,r,n){const s=[];let a,i,l,c,d,h;for(a=0,i=t.length,d=0;a<i;++a){l=t[a],c=l.box,c.update(l.width||e.w,l.height||e.h,wW(l.horizontal,e));const{same:p,other:x}=yW(e,r,l,n);d|=p&&s.length,h=h||x,c.fullSize||s.push(l)}return d&&wh(s,e,r,n)||h}function zm(t,e,r,n,s){t.top=r,t.left=e,t.right=e+n,t.bottom=r+s,t.width=n,t.height=s}function $_(t,e,r,n){const s=r.padding;let{x:a,y:i}=e;for(const l of t){const c=l.box,d=n[l.stack]||{placed:0,weight:1},h=l.stackWeight/d.weight||1;if(l.horizontal){const p=e.w*h,x=d.size||c.height;cp(d.start)&&(i=d.start),c.fullSize?zm(c,s.left,i,r.outerWidth-s.right-s.left,x):zm(c,e.left+d.placed,i,p,x),d.start=i,d.placed+=p,i=c.bottom}else{const p=e.h*h,x=d.size||c.width;cp(d.start)&&(a=d.start),c.fullSize?zm(c,a,s.top,x,r.outerHeight-s.bottom-s.top):zm(c,a,e.top+d.placed,x,p),d.start=a,d.placed+=p,a=c.right}}e.x=a,e.y=i}var mo={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(r){e.draw(r)}}]},t.boxes.push(e)},removeBox(t,e){const r=t.boxes?t.boxes.indexOf(e):-1;r!==-1&&t.boxes.splice(r,1)},configure(t,e,r){e.fullSize=r.fullSize,e.position=r.position,e.weight=r.weight},update(t,e,r,n){if(!t)return;const s=Ra(t.options.layout.padding),a=Math.max(e-s.width,0),i=Math.max(r-s.height,0),l=vW(t.boxes),c=l.vertical,d=l.horizontal;cn(t.boxes,y=>{typeof y.beforeLayout=="function"&&y.beforeLayout()});const h=c.reduce((y,w)=>w.box.options&&w.box.options.display===!1?y:y+1,0)||1,p=Object.freeze({outerWidth:e,outerHeight:r,padding:s,availableWidth:a,availableHeight:i,vBoxMaxWidth:a/2/h,hBoxMaxHeight:i/2}),x=Object.assign({},s);x6(x,Ra(n));const m=Object.assign({maxPadding:x,w:a,h:i,x:s.left,y:s.top},s),b=gW(c.concat(d),p);wh(l.fullSize,m,p,b),wh(c,m,p,b),wh(d,m,p,b)&&wh(c,m,p,b),bW(m),$_(l.leftAndTop,m,p,b),m.x+=m.w,m.y+=m.h,$_(l.rightAndBottom,m,p,b),t.chartArea={left:m.left,top:m.top,right:m.left+m.w,bottom:m.top+m.h,height:m.h,width:m.w},cn(l.chartArea,y=>{const w=y.box;Object.assign(w,t.chartArea),w.update(m.w,m.h,{left:0,top:0,right:0,bottom:0})})}};class g6{acquireContext(e,r){}releaseContext(e){return!1}addEventListener(e,r,n){}removeEventListener(e,r,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,r,n,s){return r=Math.max(0,r||e.width),n=n||e.height,{width:r,height:Math.max(0,s?Math.floor(r/s):n)}}isAttached(e){return!0}updateConfig(e){}}class _W extends g6{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const ax="$chartjs",NW={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},W_=t=>t===null||t==="";function SW(t,e){const r=t.style,n=t.getAttribute("height"),s=t.getAttribute("width");if(t[ax]={initial:{height:n,width:s,style:{display:r.display,height:r.height,width:r.width}}},r.display=r.display||"block",r.boxSizing=r.boxSizing||"border-box",W_(s)){const a=E_(t,"width");a!==void 0&&(t.width=a)}if(W_(n))if(t.style.height==="")t.height=t.width/(e||2);else{const a=E_(t,"height");a!==void 0&&(t.height=a)}return t}const v6=_$?{passive:!0}:!1;function kW(t,e,r){t&&t.addEventListener(e,r,v6)}function jW(t,e,r){t&&t.canvas&&t.canvas.removeEventListener(e,r,v6)}function EW(t,e){const r=NW[t.type]||t.type,{x:n,y:s}=zd(t,e);return{type:r,chart:e,native:t,x:n!==void 0?n:null,y:s!==void 0?s:null}}function Ox(t,e){for(const r of t)if(r===e||r.contains(e))return!0}function AW(t,e,r){const n=t.canvas,s=new MutationObserver(a=>{let i=!1;for(const l of a)i=i||Ox(l.addedNodes,n),i=i&&!Ox(l.removedNodes,n);i&&r()});return s.observe(document,{childList:!0,subtree:!0}),s}function CW(t,e,r){const n=t.canvas,s=new MutationObserver(a=>{let i=!1;for(const l of a)i=i||Ox(l.removedNodes,n),i=i&&!Ox(l.addedNodes,n);i&&r()});return s.observe(document,{childList:!0,subtree:!0}),s}const hp=new Map;let V_=0;function y6(){const t=window.devicePixelRatio;t!==V_&&(V_=t,hp.forEach((e,r)=>{r.currentDevicePixelRatio!==t&&e()}))}function TW(t,e){hp.size||window.addEventListener("resize",y6),hp.set(t,e)}function FW(t){hp.delete(t),hp.size||window.removeEventListener("resize",y6)}function PW(t,e,r){const n=t.canvas,s=n&&Uy(n);if(!s)return;const a=Jk((l,c)=>{const d=s.clientWidth;r(l,c),d<s.clientWidth&&r()},window),i=new ResizeObserver(l=>{const c=l[0],d=c.contentRect.width,h=c.contentRect.height;d===0&&h===0||a(d,h)});return i.observe(s),TW(t,a),i}function s2(t,e,r){r&&r.disconnect(),e==="resize"&&FW(t)}function LW(t,e,r){const n=t.canvas,s=Jk(a=>{t.ctx!==null&&r(EW(a,t))},t);return kW(n,e,s),s}class DW extends g6{acquireContext(e,r){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(SW(e,r),n):null}releaseContext(e){const r=e.canvas;if(!r[ax])return!1;const n=r[ax].initial;["height","width"].forEach(a=>{const i=n[a];Vr(i)?r.removeAttribute(a):r.setAttribute(a,i)});const s=n.style||{};return Object.keys(s).forEach(a=>{r.style[a]=s[a]}),r.width=r.width,delete r[ax],!0}addEventListener(e,r,n){this.removeEventListener(e,r);const s=e.$proxies||(e.$proxies={}),i={attach:AW,detach:CW,resize:PW}[r]||LW;s[r]=i(e,r,n)}removeEventListener(e,r){const n=e.$proxies||(e.$proxies={}),s=n[r];if(!s)return;({attach:s2,detach:s2,resize:s2}[r]||jW)(e,r,s),n[r]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,r,n,s){return w$(e,r,n,s)}isAttached(e){const r=e&&Uy(e);return!!(r&&r.isConnected)}}function RW(t){return!By()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?_W:DW}class Uc{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:r,y:n}=this.getProps(["x","y"],e);return{x:r,y:n}}hasValue(){return up(this.x)&&up(this.y)}getProps(e,r){const n=this.$animations;if(!r||!n)return this;const s={};return e.forEach(a=>{s[a]=n[a]&&n[a].active()?n[a]._to:this[a]}),s}}function IW(t,e){const r=t.options.ticks,n=OW(t),s=Math.min(r.maxTicksLimit||n,n),a=r.major.enabled?BW(e):[],i=a.length,l=a[0],c=a[i-1],d=[];if(i>s)return UW(e,d,a,i/s),d;const h=MW(a,e,s);if(i>0){let p,x;const m=i>1?Math.round((c-l)/(i-1)):null;for(Hm(e,d,h,Vr(m)?0:l-m,l),p=0,x=i-1;p<x;p++)Hm(e,d,h,a[p],a[p+1]);return Hm(e,d,h,c,Vr(m)?e.length:c+m),d}return Hm(e,d,h),d}function OW(t){const e=t.options.offset,r=t._tickSize(),n=t._length/r+(e?0:1),s=t._maxLength/r;return Math.floor(Math.min(n,s))}function MW(t,e,r){const n=zW(t),s=e.length/r;if(!n)return Math.max(s,1);const a=yH(n);for(let i=0,l=a.length-1;i<l;i++){const c=a[i];if(c>s)return c}return Math.max(s,1)}function BW(t){const e=[];let r,n;for(r=0,n=t.length;r<n;r++)t[r].major&&e.push(r);return e}function UW(t,e,r,n){let s=0,a=r[0],i;for(n=Math.ceil(n),i=0;i<t.length;i++)i===a&&(e.push(t[i]),s++,a=r[s*n])}function Hm(t,e,r,n,s){const a=jr(n,0),i=Math.min(jr(s,t.length),t.length);let l=0,c,d,h;for(r=Math.ceil(r),s&&(c=s-n,r=c/Math.floor(c/r)),h=a;h<0;)l++,h=Math.round(a+l*r);for(d=Math.max(a,0);d<i;d++)d===h&&(e.push(t[d]),l++,h=Math.round(a+l*r))}function zW(t){const e=t.length;let r,n;if(e<2)return!1;for(n=t[0],r=1;r<e;++r)if(t[r]-t[r-1]!==n)return!1;return n}const HW=t=>t==="left"?"right":t==="right"?"left":t,q_=(t,e,r)=>e==="top"||e==="left"?t[e]+r:t[e]-r,G_=(t,e)=>Math.min(e||t,t);function X_(t,e){const r=[],n=t.length/e,s=t.length;let a=0;for(;a<s;a+=n)r.push(t[Math.floor(a)]);return r}function $W(t,e,r){const n=t.ticks.length,s=Math.min(e,n-1),a=t._startPixel,i=t._endPixel,l=1e-6;let c=t.getPixelForTick(s),d;if(!(r&&(n===1?d=Math.max(c-a,i-c):e===0?d=(t.getPixelForTick(1)-c)/2:d=(c-t.getPixelForTick(s-1))/2,c+=s<e?d:-d,c<a-l||c>i+l)))return c}function WW(t,e){cn(t,r=>{const n=r.gc,s=n.length/2;let a;if(s>e){for(a=0;a<s;++a)delete r.data[n[a]];n.splice(0,s)}})}function ph(t){return t.drawTicks?t.tickLength:0}function Y_(t,e){if(!t.display)return 0;const r=Ts(t.font,e),n=Ra(t.padding);return(Mn(t.text)?t.text.length:1)*r.lineHeight+n.height}function VW(t,e){return od(t,{scale:e,type:"scale"})}function qW(t,e,r){return od(t,{tick:r,index:e,type:"tick"})}function GW(t,e,r){let n=Py(t);return(r&&e!=="right"||!r&&e==="right")&&(n=HW(n)),n}function XW(t,e,r,n){const{top:s,left:a,bottom:i,right:l,chart:c}=t,{chartArea:d,scales:h}=c;let p=0,x,m,b;const y=i-s,w=l-a;if(t.isHorizontal()){if(m=Na(n,a,l),Lr(r)){const S=Object.keys(r)[0],k=r[S];b=h[S].getPixelForValue(k)+y-e}else r==="center"?b=(d.bottom+d.top)/2+y-e:b=q_(t,r,e);x=l-a}else{if(Lr(r)){const S=Object.keys(r)[0],k=r[S];m=h[S].getPixelForValue(k)-w+e}else r==="center"?m=(d.left+d.right)/2-w+e:m=q_(t,r,e);b=Na(n,i,s),p=r==="left"?-ms:ms}return{titleX:m,titleY:b,maxWidth:x,rotation:p}}class O0 extends Uc{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,r){return e}getUserBounds(){let{_userMin:e,_userMax:r,_suggestedMin:n,_suggestedMax:s}=this;return e=Nl(e,Number.POSITIVE_INFINITY),r=Nl(r,Number.NEGATIVE_INFINITY),n=Nl(n,Number.POSITIVE_INFINITY),s=Nl(s,Number.NEGATIVE_INFINITY),{min:Nl(e,n),max:Nl(r,s),minDefined:Gs(e),maxDefined:Gs(r)}}getMinMax(e){let{min:r,max:n,minDefined:s,maxDefined:a}=this.getUserBounds(),i;if(s&&a)return{min:r,max:n};const l=this.getMatchingVisibleMetas();for(let c=0,d=l.length;c<d;++c)i=l[c].controller.getMinMax(this,e),s||(r=Math.min(r,i.min)),a||(n=Math.max(n,i.max));return r=a&&r>n?n:r,n=s&&r>n?r:n,{min:Nl(r,Nl(n,r)),max:Nl(n,Nl(r,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){wn(this.options.beforeUpdate,[this])}update(e,r,n){const{beginAtZero:s,grace:a,ticks:i}=this.options,l=i.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=r,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=QH(this,a,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?X_(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),i.display&&(i.autoSkip||i.source==="auto")&&(this.ticks=IW(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,r,n;this.isHorizontal()?(r=this.left,n=this.right):(r=this.top,n=this.bottom,e=!e),this._startPixel=r,this._endPixel=n,this._reversePixels=e,this._length=n-r,this._alignToPixels=this.options.alignToPixels}afterUpdate(){wn(this.options.afterUpdate,[this])}beforeSetDimensions(){wn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){wn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),wn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){wn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const r=this.options.ticks;let n,s,a;for(n=0,s=e.length;n<s;n++)a=e[n],a.label=wn(r.callback,[a.value,n,e],this)}afterTickToLabelConversion(){wn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){wn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,r=e.ticks,n=G_(this.ticks.length,e.ticks.maxTicksLimit),s=r.minRotation||0,a=r.maxRotation;let i=s,l,c,d;if(!this._isVisible()||!r.display||s>=a||n<=1||!this.isHorizontal()){this.labelRotation=s;return}const h=this._getLabelSizes(),p=h.widest.width,x=h.highest.height,m=Fa(this.chart.width-p,0,this.maxWidth);l=e.offset?this.maxWidth/n:m/(n-1),p+6>l&&(l=m/(n-(e.offset?.5:1)),c=this.maxHeight-ph(e.grid)-r.padding-Y_(e.title,this.chart.options.font),d=Math.sqrt(p*p+x*x),i=Ty(Math.min(Math.asin(Fa((h.highest.height+6)/l,-1,1)),Math.asin(Fa(c/d,-1,1))-Math.asin(Fa(x/d,-1,1)))),i=Math.max(s,Math.min(a,i))),this.labelRotation=i}afterCalculateLabelRotation(){wn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){wn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:r,options:{ticks:n,title:s,grid:a}}=this,i=this._isVisible(),l=this.isHorizontal();if(i){const c=Y_(s,r.options.font);if(l?(e.width=this.maxWidth,e.height=ph(a)+c):(e.height=this.maxHeight,e.width=ph(a)+c),n.display&&this.ticks.length){const{first:d,last:h,widest:p,highest:x}=this._getLabelSizes(),m=n.padding*2,b=Go(this.labelRotation),y=Math.cos(b),w=Math.sin(b);if(l){const S=n.mirror?0:w*p.width+y*x.height;e.height=Math.min(this.maxHeight,e.height+S+m)}else{const S=n.mirror?0:y*p.width+w*x.height;e.width=Math.min(this.maxWidth,e.width+S+m)}this._calculatePadding(d,h,w,y)}}this._handleMargins(),l?(this.width=this._length=r.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=r.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,r,n,s){const{ticks:{align:a,padding:i},position:l}=this.options,c=this.labelRotation!==0,d=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,p=this.right-this.getPixelForTick(this.ticks.length-1);let x=0,m=0;c?d?(x=s*e.width,m=n*r.height):(x=n*e.height,m=s*r.width):a==="start"?m=r.width:a==="end"?x=e.width:a!=="inner"&&(x=e.width/2,m=r.width/2),this.paddingLeft=Math.max((x-h+i)*this.width/(this.width-h),0),this.paddingRight=Math.max((m-p+i)*this.width/(this.width-p),0)}else{let h=r.height/2,p=e.height/2;a==="start"?(h=0,p=e.height):a==="end"&&(h=r.height,p=0),this.paddingTop=h+i,this.paddingBottom=p+i}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){wn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:r}=this.options;return r==="top"||r==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let r,n;for(r=0,n=e.length;r<n;r++)Vr(e[r].label)&&(e.splice(r,1),n--,r--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const r=this.options.ticks.sampleSize;let n=this.ticks;r<n.length&&(n=X_(n,r)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,r,n){const{ctx:s,_longestTextCache:a}=this,i=[],l=[],c=Math.floor(r/G_(r,n));let d=0,h=0,p,x,m,b,y,w,S,k,A,z,H;for(p=0;p<r;p+=c){if(b=e[p].label,y=this._resolveTickFontOptions(p),s.font=w=y.string,S=a[w]=a[w]||{data:{},gc:[]},k=y.lineHeight,A=z=0,!Vr(b)&&!Mn(b))A=Rx(s,S.data,S.gc,A,b),z=k;else if(Mn(b))for(x=0,m=b.length;x<m;++x)H=b[x],!Vr(H)&&!Mn(H)&&(A=Rx(s,S.data,S.gc,A,H),z+=k);i.push(A),l.push(z),d=Math.max(A,d),h=Math.max(z,h)}WW(a,r);const V=i.indexOf(d),B=l.indexOf(h),R=O=>({width:i[O]||0,height:l[O]||0});return{first:R(0),last:R(r-1),widest:R(V),highest:R(B),widths:i,heights:l}}getLabelForValue(e){return e}getPixelForValue(e,r){return NaN}getValueForPixel(e){}getPixelForTick(e){const r=this.ticks;return e<0||e>r.length-1?null:this.getPixelForValue(r[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const r=this._startPixel+e*this._length;return SH(this._alignToPixels?Md(this.chart,r,0):r)}getDecimalForPixel(e){const r=(e-this._startPixel)/this._length;return this._reversePixels?1-r:r}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:r}=this;return e<0&&r<0?r:e>0&&r>0?e:0}getContext(e){const r=this.ticks||[];if(e>=0&&e<r.length){const n=r[e];return n.$context||(n.$context=qW(this.getContext(),e,n))}return this.$context||(this.$context=VW(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,r=Go(this.labelRotation),n=Math.abs(Math.cos(r)),s=Math.abs(Math.sin(r)),a=this._getLabelSizes(),i=e.autoSkipPadding||0,l=a?a.widest.width+i:0,c=a?a.highest.height+i:0;return this.isHorizontal()?c*n>l*s?l/n:c/s:c*s<l*n?c/n:l/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const r=this.axis,n=this.chart,s=this.options,{grid:a,position:i,border:l}=s,c=a.offset,d=this.isHorizontal(),p=this.ticks.length+(c?1:0),x=ph(a),m=[],b=l.setContext(this.getContext()),y=b.display?b.width:0,w=y/2,S=function(te){return Md(n,te,y)};let k,A,z,H,V,B,R,O,ee,I,P,ae;if(i==="top")k=S(this.bottom),B=this.bottom-x,O=k-w,I=S(e.top)+w,ae=e.bottom;else if(i==="bottom")k=S(this.top),I=e.top,ae=S(e.bottom)-w,B=k+w,O=this.top+x;else if(i==="left")k=S(this.right),V=this.right-x,R=k-w,ee=S(e.left)+w,P=e.right;else if(i==="right")k=S(this.left),ee=e.left,P=S(e.right)-w,V=k+w,R=this.left+x;else if(r==="x"){if(i==="center")k=S((e.top+e.bottom)/2+.5);else if(Lr(i)){const te=Object.keys(i)[0],ie=i[te];k=S(this.chart.scales[te].getPixelForValue(ie))}I=e.top,ae=e.bottom,B=k+w,O=B+x}else if(r==="y"){if(i==="center")k=S((e.left+e.right)/2);else if(Lr(i)){const te=Object.keys(i)[0],ie=i[te];k=S(this.chart.scales[te].getPixelForValue(ie))}V=k-w,R=V-x,ee=e.left,P=e.right}const G=jr(s.ticks.maxTicksLimit,p),M=Math.max(1,Math.ceil(p/G));for(A=0;A<p;A+=M){const te=this.getContext(A),ie=a.setContext(te),le=l.setContext(te),X=ie.lineWidth,fe=ie.color,K=le.dash||[],E=le.dashOffset,W=ie.tickWidth,L=ie.tickColor,F=ie.tickBorderDash||[],q=ie.tickBorderDashOffset;z=$W(this,A,c),z!==void 0&&(H=Md(n,z,X),d?V=R=ee=P=H:B=O=I=ae=H,m.push({tx1:V,ty1:B,tx2:R,ty2:O,x1:ee,y1:I,x2:P,y2:ae,width:X,color:fe,borderDash:K,borderDashOffset:E,tickWidth:W,tickColor:L,tickBorderDash:F,tickBorderDashOffset:q}))}return this._ticksLength=p,this._borderValue=k,m}_computeLabelItems(e){const r=this.axis,n=this.options,{position:s,ticks:a}=n,i=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:d,padding:h,mirror:p}=a,x=ph(n.grid),m=x+h,b=p?-h:m,y=-Go(this.labelRotation),w=[];let S,k,A,z,H,V,B,R,O,ee,I,P,ae="middle";if(s==="top")V=this.bottom-b,B=this._getXAxisLabelAlignment();else if(s==="bottom")V=this.top+b,B=this._getXAxisLabelAlignment();else if(s==="left"){const M=this._getYAxisLabelAlignment(x);B=M.textAlign,H=M.x}else if(s==="right"){const M=this._getYAxisLabelAlignment(x);B=M.textAlign,H=M.x}else if(r==="x"){if(s==="center")V=(e.top+e.bottom)/2+m;else if(Lr(s)){const M=Object.keys(s)[0],te=s[M];V=this.chart.scales[M].getPixelForValue(te)+m}B=this._getXAxisLabelAlignment()}else if(r==="y"){if(s==="center")H=(e.left+e.right)/2-m;else if(Lr(s)){const M=Object.keys(s)[0],te=s[M];H=this.chart.scales[M].getPixelForValue(te)}B=this._getYAxisLabelAlignment(x).textAlign}r==="y"&&(c==="start"?ae="top":c==="end"&&(ae="bottom"));const G=this._getLabelSizes();for(S=0,k=l.length;S<k;++S){A=l[S],z=A.label;const M=a.setContext(this.getContext(S));R=this.getPixelForTick(S)+a.labelOffset,O=this._resolveTickFontOptions(S),ee=O.lineHeight,I=Mn(z)?z.length:1;const te=I/2,ie=M.color,le=M.textStrokeColor,X=M.textStrokeWidth;let fe=B;i?(H=R,B==="inner"&&(S===k-1?fe=this.options.reverse?"left":"right":S===0?fe=this.options.reverse?"right":"left":fe="center"),s==="top"?d==="near"||y!==0?P=-I*ee+ee/2:d==="center"?P=-G.highest.height/2-te*ee+ee:P=-G.highest.height+ee/2:d==="near"||y!==0?P=ee/2:d==="center"?P=G.highest.height/2-te*ee:P=G.highest.height-I*ee,p&&(P*=-1),y!==0&&!M.showLabelBackdrop&&(H+=ee/2*Math.sin(y))):(V=R,P=(1-I)*ee/2);let K;if(M.showLabelBackdrop){const E=Ra(M.backdropPadding),W=G.heights[S],L=G.widths[S];let F=P-E.top,q=0-E.left;switch(ae){case"middle":F-=W/2;break;case"bottom":F-=W;break}switch(B){case"center":q-=L/2;break;case"right":q-=L;break;case"inner":S===k-1?q-=L:S>0&&(q-=L/2);break}K={left:q,top:F,width:L+E.width,height:W+E.height,color:M.backdropColor}}w.push({label:z,font:O,textOffset:P,options:{rotation:y,color:ie,strokeColor:le,strokeWidth:X,textAlign:fe,textBaseline:ae,translation:[H,V],backdrop:K}})}return w}_getXAxisLabelAlignment(){const{position:e,ticks:r}=this.options;if(-Go(this.labelRotation))return e==="top"?"left":"right";let s="center";return r.align==="start"?s="left":r.align==="end"?s="right":r.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:r,ticks:{crossAlign:n,mirror:s,padding:a}}=this.options,i=this._getLabelSizes(),l=e+a,c=i.widest.width;let d,h;return r==="left"?s?(h=this.right+a,n==="near"?d="left":n==="center"?(d="center",h+=c/2):(d="right",h+=c)):(h=this.right-l,n==="near"?d="right":n==="center"?(d="center",h-=c/2):(d="left",h=this.left)):r==="right"?s?(h=this.left+a,n==="near"?d="right":n==="center"?(d="center",h-=c/2):(d="left",h-=c)):(h=this.left+l,n==="near"?d="left":n==="center"?(d="center",h+=c/2):(d="right",h=this.right)):d="right",{textAlign:d,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,r=this.options.position;if(r==="left"||r==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(r==="top"||r==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:r},left:n,top:s,width:a,height:i}=this;r&&(e.save(),e.fillStyle=r,e.fillRect(n,s,a,i),e.restore())}getLineWidthForValue(e){const r=this.options.grid;if(!this._isVisible()||!r.display)return 0;const s=this.ticks.findIndex(a=>a.value===e);return s>=0?r.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const r=this.options.grid,n=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let a,i;const l=(c,d,h)=>{!h.width||!h.color||(n.save(),n.lineWidth=h.width,n.strokeStyle=h.color,n.setLineDash(h.borderDash||[]),n.lineDashOffset=h.borderDashOffset,n.beginPath(),n.moveTo(c.x,c.y),n.lineTo(d.x,d.y),n.stroke(),n.restore())};if(r.display)for(a=0,i=s.length;a<i;++a){const c=s[a];r.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),r.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:r,options:{border:n,grid:s}}=this,a=n.setContext(this.getContext()),i=n.display?a.width:0;if(!i)return;const l=s.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let d,h,p,x;this.isHorizontal()?(d=Md(e,this.left,i)-i/2,h=Md(e,this.right,l)+l/2,p=x=c):(p=Md(e,this.top,i)-i/2,x=Md(e,this.bottom,l)+l/2,d=h=c),r.save(),r.lineWidth=a.width,r.strokeStyle=a.color,r.beginPath(),r.moveTo(d,p),r.lineTo(h,x),r.stroke(),r.restore()}drawLabels(e){if(!this.options.ticks.display)return;const n=this.ctx,s=this._computeLabelArea();s&&gg(n,s);const a=this.getLabelItems(e);for(const i of a){const l=i.options,c=i.font,d=i.label,h=i.textOffset;hf(n,d,0,h,c,l)}s&&vg(n)}drawTitle(){const{ctx:e,options:{position:r,title:n,reverse:s}}=this;if(!n.display)return;const a=Ts(n.font),i=Ra(n.padding),l=n.align;let c=a.lineHeight/2;r==="bottom"||r==="center"||Lr(r)?(c+=i.bottom,Mn(n.text)&&(c+=a.lineHeight*(n.text.length-1))):c+=i.top;const{titleX:d,titleY:h,maxWidth:p,rotation:x}=XW(this,c,r,l);hf(e,n.text,0,0,a,{color:n.color,maxWidth:p,rotation:x,textAlign:GW(l,r,s),textBaseline:"middle",translation:[d,h]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,r=e.ticks&&e.ticks.z||0,n=jr(e.grid&&e.grid.z,-1),s=jr(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==O0.prototype.draw?[{z:r,draw:a=>{this.draw(a)}}]:[{z:n,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:r,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(e){const r=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",s=[];let a,i;for(a=0,i=r.length;a<i;++a){const l=r[a];l[n]===this.id&&(!e||l.type===e)&&s.push(l)}return s}_resolveTickFontOptions(e){const r=this.options.ticks.setContext(this.getContext(e));return Ts(r.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class $m{constructor(e,r,n){this.type=e,this.scope=r,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const r=Object.getPrototypeOf(e);let n;JW(r)&&(n=this.register(r));const s=this.items,a=e.id,i=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+e);return a in s||(s[a]=e,YW(e,i,n),this.override&&rs.override(e.id,e.overrides)),i}get(e){return this.items[e]}unregister(e){const r=this.items,n=e.id,s=this.scope;n in r&&delete r[n],s&&n in rs[s]&&(delete rs[s][n],this.override&&delete ff[n])}}function YW(t,e,r){const n=lp(Object.create(null),[r?rs.get(r):{},rs.get(e),t.defaults]);rs.set(e,n),t.defaultRoutes&&KW(e,t.defaultRoutes),t.descriptors&&rs.describe(e,t.descriptors)}function KW(t,e){Object.keys(e).forEach(r=>{const n=r.split("."),s=n.pop(),a=[t].concat(n).join("."),i=e[r].split("."),l=i.pop(),c=i.join(".");rs.route(a,s,c,l)})}function JW(t){return"id"in t&&"defaults"in t}class QW{constructor(){this.controllers=new $m(Pp,"datasets",!0),this.elements=new $m(Uc,"elements"),this.plugins=new $m(Object,"plugins"),this.scales=new $m(O0,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,r,n){[...r].forEach(s=>{const a=n||this._getRegistryForType(s);n||a.isForType(s)||a===this.plugins&&s.id?this._exec(e,a,s):cn(s,i=>{const l=n||this._getRegistryForType(i);this._exec(e,l,i)})})}_exec(e,r,n){const s=Cy(e);wn(n["before"+s],[],n),r[e](n),wn(n["after"+s],[],n)}_getRegistryForType(e){for(let r=0;r<this._typedRegistries.length;r++){const n=this._typedRegistries[r];if(n.isForType(e))return n}return this.plugins}_get(e,r,n){const s=r.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+n+".");return s}}var Al=new QW;class ZW{constructor(){this._init=void 0}notify(e,r,n,s){if(r==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const a=s?this._descriptors(e).filter(s):this._descriptors(e),i=this._notify(a,e,r,n);return r==="afterDestroy"&&(this._notify(a,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),i}_notify(e,r,n,s){s=s||{};for(const a of e){const i=a.plugin,l=i[n],c=[r,s,a.options];if(wn(l,c,i)===!1&&s.cancelable)return!1}return!0}invalidate(){Vr(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const r=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),r}_createDescriptors(e,r){const n=e&&e.config,s=jr(n.options&&n.options.plugins,{}),a=eV(n);return s===!1&&!r?[]:rV(e,a,s,r)}_notifyStateChanges(e){const r=this._oldCache||[],n=this._cache,s=(a,i)=>a.filter(l=>!i.some(c=>l.plugin.id===c.plugin.id));this._notify(s(r,n),e,"stop"),this._notify(s(n,r),e,"start")}}function eV(t){const e={},r=[],n=Object.keys(Al.plugins.items);for(let a=0;a<n.length;a++)r.push(Al.getPlugin(n[a]));const s=t.plugins||[];for(let a=0;a<s.length;a++){const i=s[a];r.indexOf(i)===-1&&(r.push(i),e[i.id]=!0)}return{plugins:r,localIds:e}}function tV(t,e){return!e&&t===!1?null:t===!0?{}:t}function rV(t,{plugins:e,localIds:r},n,s){const a=[],i=t.getContext();for(const l of e){const c=l.id,d=tV(n[c],s);d!==null&&a.push({plugin:l,options:nV(t.config,{plugin:l,local:r[c]},d,i)})}return a}function nV(t,{plugin:e,local:r},n,s){const a=t.pluginScopeKeys(e),i=t.getOptionScopes(n,a);return r&&e.defaults&&i.push(e.defaults),t.createResolver(i,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function iv(t,e){const r=rs.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||r.indexAxis||"x"}function sV(t,e){let r=t;return t==="_index_"?r=e:t==="_value_"&&(r=e==="x"?"y":"x"),r}function aV(t,e){return t===e?"_index_":"_value_"}function K_(t){if(t==="x"||t==="y"||t==="r")return t}function iV(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function ov(t,...e){if(K_(t))return t;for(const r of e){const n=r.axis||iV(r.position)||t.length>1&&K_(t[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function J_(t,e,r){if(r[e+"AxisID"]===t)return{axis:e}}function oV(t,e){if(e.data&&e.data.datasets){const r=e.data.datasets.filter(n=>n.xAxisID===t||n.yAxisID===t);if(r.length)return J_(t,"x",r[0])||J_(t,"y",r[0])}return{}}function lV(t,e){const r=ff[t.type]||{scales:{}},n=e.scales||{},s=iv(t.type,e),a=Object.create(null);return Object.keys(n).forEach(i=>{const l=n[i];if(!Lr(l))return console.error(`Invalid scale configuration for scale: ${i}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${i}`);const c=ov(i,l,oV(i,t),rs.scales[l.type]),d=aV(c,s),h=r.scales||{};a[i]=Rh(Object.create(null),[{axis:c},l,h[c],h[d]])}),t.data.datasets.forEach(i=>{const l=i.type||t.type,c=i.indexAxis||iv(l,e),h=(ff[l]||{}).scales||{};Object.keys(h).forEach(p=>{const x=sV(p,c),m=i[x+"AxisID"]||x;a[m]=a[m]||Object.create(null),Rh(a[m],[{axis:x},n[m],h[p]])})}),Object.keys(a).forEach(i=>{const l=a[i];Rh(l,[rs.scales[l.type],rs.scale])}),a}function b6(t){const e=t.options||(t.options={});e.plugins=jr(e.plugins,{}),e.scales=lV(t,e)}function w6(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function cV(t){return t=t||{},t.data=w6(t.data),b6(t),t}const Q_=new Map,_6=new Set;function Wm(t,e){let r=Q_.get(t);return r||(r=e(),Q_.set(t,r),_6.add(r)),r}const mh=(t,e,r)=>{const n=td(e,r);n!==void 0&&t.add(n)};class uV{constructor(e){this._config=cV(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=w6(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),b6(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Wm(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,r){return Wm(`${e}.transition.${r}`,()=>[[`datasets.${e}.transitions.${r}`,`transitions.${r}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,r){return Wm(`${e}-${r}`,()=>[[`datasets.${e}.elements.${r}`,`datasets.${e}`,`elements.${r}`,""]])}pluginScopeKeys(e){const r=e.id,n=this.type;return Wm(`${n}-plugin-${r}`,()=>[[`plugins.${r}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,r){const n=this._scopeCache;let s=n.get(e);return(!s||r)&&(s=new Map,n.set(e,s)),s}getOptionScopes(e,r,n){const{options:s,type:a}=this,i=this._cachedScopes(e,n),l=i.get(r);if(l)return l;const c=new Set;r.forEach(h=>{e&&(c.add(e),h.forEach(p=>mh(c,e,p))),h.forEach(p=>mh(c,s,p)),h.forEach(p=>mh(c,ff[a]||{},p)),h.forEach(p=>mh(c,rs,p)),h.forEach(p=>mh(c,sv,p))});const d=Array.from(c);return d.length===0&&d.push(Object.create(null)),_6.has(r)&&i.set(r,d),d}chartOptionScopes(){const{options:e,type:r}=this;return[e,ff[r]||{},rs.datasets[r]||{},{type:r},rs,sv]}resolveNamedOptions(e,r,n,s=[""]){const a={$shared:!0},{resolver:i,subPrefixes:l}=Z_(this._resolverCache,e,s);let c=i;if(fV(i,r)){a.$shared=!1,n=rd(n)?n():n;const d=this.createResolver(e,n,l);c=j0(i,n,d)}for(const d of r)a[d]=c[d];return a}createResolver(e,r,n=[""],s){const{resolver:a}=Z_(this._resolverCache,e,n);return Lr(r)?j0(a,r,void 0,s):a}}function Z_(t,e,r){let n=t.get(e);n||(n=new Map,t.set(e,n));const s=r.join();let a=n.get(s);return a||(a={resolver:Iy(e,r),subPrefixes:r.filter(l=>!l.toLowerCase().includes("hover"))},n.set(s,a)),a}const dV=t=>Lr(t)&&Object.getOwnPropertyNames(t).some(e=>rd(t[e]));function fV(t,e){const{isScriptable:r,isIndexable:n}=e6(t);for(const s of e){const a=r(s),i=n(s),l=(i||a)&&t[s];if(a&&(rd(l)||dV(l))||i&&Mn(l))return!0}return!1}var hV="4.5.1";const pV=["top","bottom","left","right","chartArea"];function e4(t,e){return t==="top"||t==="bottom"||pV.indexOf(t)===-1&&e==="x"}function t4(t,e){return function(r,n){return r[t]===n[t]?r[e]-n[e]:r[t]-n[t]}}function r4(t){const e=t.chart,r=e.options.animation;e.notifyPlugins("afterRender"),wn(r&&r.onComplete,[t],e)}function mV(t){const e=t.chart,r=e.options.animation;wn(r&&r.onProgress,[t],e)}function N6(t){return By()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const ix={},n4=t=>{const e=N6(t);return Object.values(ix).filter(r=>r.canvas===e).pop()};function xV(t,e,r){const n=Object.keys(t);for(const s of n){const a=+s;if(a>=e){const i=t[s];delete t[s],(r>0||a>e)&&(t[a+r]=i)}}}function gV(t,e,r,n){return!r||t.type==="mouseout"?null:n?e:t}let Lp=class{static defaults=rs;static instances=ix;static overrides=ff;static registry=Al;static version=hV;static getChart=n4;static register(...e){Al.add(...e),s4()}static unregister(...e){Al.remove(...e),s4()}constructor(e,r){const n=this.config=new uV(r),s=N6(e),a=n4(s);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const i=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||RW(s)),this.platform.updateConfig(n);const l=this.platform.acquireContext(s,i.aspectRatio),c=l&&l.canvas,d=c&&c.height,h=c&&c.width;if(this.id=uH(),this.ctx=l,this.canvas=c,this.width=h,this.height=d,this._options=i,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new ZW,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=AH(p=>this.update(p),i.resizeDelay||0),this._dataChanges=[],ix[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}gc.listen(this,"complete",r4),gc.listen(this,"progress",mV),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:r},width:n,height:s,_aspectRatio:a}=this;return Vr(e)?r&&a?a:s?n/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Al}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():j_(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return N_(this.canvas,this.ctx),this}stop(){return gc.stop(this),this}resize(e,r){gc.running(this)?this._resizeBeforeDraw={width:e,height:r}:this._resize(e,r)}_resize(e,r){const n=this.options,s=this.canvas,a=n.maintainAspectRatio&&this.aspectRatio,i=this.platform.getMaximumSize(s,e,r,a),l=n.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=i.width,this.height=i.height,this._aspectRatio=this.aspectRatio,j_(this,l,!0)&&(this.notifyPlugins("resize",{size:i}),wn(n.onResize,[this,i],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const r=this.options.scales||{};cn(r,(n,s)=>{n.id=s})}buildOrUpdateScales(){const e=this.options,r=e.scales,n=this.scales,s=Object.keys(n).reduce((i,l)=>(i[l]=!1,i),{});let a=[];r&&(a=a.concat(Object.keys(r).map(i=>{const l=r[i],c=ov(i,l),d=c==="r",h=c==="x";return{options:l,dposition:d?"chartArea":h?"bottom":"left",dtype:d?"radialLinear":h?"category":"linear"}}))),cn(a,i=>{const l=i.options,c=l.id,d=ov(c,l),h=jr(l.type,i.dtype);(l.position===void 0||e4(l.position,d)!==e4(i.dposition))&&(l.position=i.dposition),s[c]=!0;let p=null;if(c in n&&n[c].type===h)p=n[c];else{const x=Al.getScale(h);p=new x({id:c,type:h,ctx:this.ctx,chart:this}),n[p.id]=p}p.init(l,e)}),cn(s,(i,l)=>{i||delete n[l]}),cn(n,i=>{mo.configure(this,i,i.options),mo.addBox(this,i)})}_updateMetasets(){const e=this._metasets,r=this.data.datasets.length,n=e.length;if(e.sort((s,a)=>s.index-a.index),n>r){for(let s=r;s<n;++s)this._destroyDatasetMeta(s);e.splice(r,n-r)}this._sortedMetasets=e.slice(0).sort(t4("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:r}}=this;e.length>r.length&&delete this._stacks,e.forEach((n,s)=>{r.filter(a=>a===n._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],r=this.data.datasets;let n,s;for(this._removeUnreferencedMetasets(),n=0,s=r.length;n<s;n++){const a=r[n];let i=this.getDatasetMeta(n);const l=a.type||this.config.type;if(i.type&&i.type!==l&&(this._destroyDatasetMeta(n),i=this.getDatasetMeta(n)),i.type=l,i.indexAxis=a.indexAxis||iv(l,this.options),i.order=a.order||0,i.index=n,i.label=""+a.label,i.visible=this.isDatasetVisible(n),i.controller)i.controller.updateIndex(n),i.controller.linkScales();else{const c=Al.getController(l),{datasetElementType:d,dataElementType:h}=rs.datasets[l];Object.assign(c,{dataElementType:Al.getElement(h),datasetElementType:d&&Al.getElement(d)}),i.controller=new c(this,n),e.push(i.controller)}}return this._updateMetasets(),e}_resetElements(){cn(this.data.datasets,(e,r)=>{this.getDatasetMeta(r).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const r=this.config;r.update();const n=this._options=r.createResolver(r.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let i=0;for(let d=0,h=this.data.datasets.length;d<h;d++){const{controller:p}=this.getDatasetMeta(d),x=!s&&a.indexOf(p)===-1;p.buildOrUpdateElements(x),i=Math.max(+p.getMaxOverflow(),i)}i=this._minPadding=n.layout.autoPadding?i:0,this._updateLayout(i),s||cn(a,d=>{d.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(t4("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){cn(this.scales,e=>{mo.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,r=new Set(Object.keys(this._listeners)),n=new Set(e.events);(!p_(r,n)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,r=this._getUniformDataChanges()||[];for(const{method:n,start:s,count:a}of r){const i=n==="_removeElements"?-a:a;xV(e,s,i)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const r=this.data.datasets.length,n=a=>new Set(e.filter(i=>i[0]===a).map((i,l)=>l+","+i.splice(1).join(","))),s=n(0);for(let a=1;a<r;a++)if(!p_(s,n(a)))return;return Array.from(s).map(a=>a.split(",")).map(a=>({method:a[1],start:+a[2],count:+a[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;mo.update(this,this.width,this.height,e);const r=this.chartArea,n=r.width<=0||r.height<=0;this._layers=[],cn(this.boxes,s=>{n&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,a)=>{s._idx=a}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let r=0,n=this.data.datasets.length;r<n;++r)this.getDatasetMeta(r).controller.configure();for(let r=0,n=this.data.datasets.length;r<n;++r)this._updateDataset(r,rd(e)?e({datasetIndex:r}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,r){const n=this.getDatasetMeta(e),s={meta:n,index:e,mode:r,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(n.controller._update(r),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(gc.has(this)?this.attached&&!gc.running(this)&&gc.start(this):(this.draw(),r4({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:n,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const r=this._layers;for(e=0;e<r.length&&r[e].z<=0;++e)r[e].draw(this.chartArea);for(this._drawDatasets();e<r.length;++e)r[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const r=this._sortedMetasets,n=[];let s,a;for(s=0,a=r.length;s<a;++s){const i=r[s];(!e||i.visible)&&n.push(i)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let r=e.length-1;r>=0;--r)this._drawDataset(e[r]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const r=this.ctx,n={meta:e,index:e.index,cancelable:!0},s=u6(this,e);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(s&&gg(r,s),e.controller.draw(),s&&vg(r),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(e){return jc(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,r,n,s){const a=pW.modes[r];return typeof a=="function"?a(this,e,n,s):[]}getDatasetMeta(e){const r=this.data.datasets[e],n=this._metasets;let s=n.filter(a=>a&&a._dataset===r).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:r&&r.order||0,index:e,_dataset:r,_parsed:[],_sorted:!1},n.push(s)),s}getContext(){return this.$context||(this.$context=od(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const r=this.data.datasets[e];if(!r)return!1;const n=this.getDatasetMeta(e);return typeof n.hidden=="boolean"?!n.hidden:!r.hidden}setDatasetVisibility(e,r){const n=this.getDatasetMeta(e);n.hidden=!r}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,r,n){const s=n?"show":"hide",a=this.getDatasetMeta(e),i=a.controller._resolveAnimations(void 0,s);cp(r)?(a.data[r].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),i.update(a,{visible:n}),this.update(l=>l.datasetIndex===e?s:void 0))}hide(e,r){this._updateVisibility(e,r,!1)}show(e,r){this._updateVisibility(e,r,!0)}_destroyDatasetMeta(e){const r=this._metasets[e];r&&r.controller&&r.controller._destroy(),delete this._metasets[e]}_stop(){let e,r;for(this.stop(),gc.remove(this),e=0,r=this.data.datasets.length;e<r;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:r}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),N_(e,r),this.platform.releaseContext(r),this.canvas=null,this.ctx=null),delete ix[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,r=this.platform,n=(a,i)=>{r.addEventListener(this,a,i),e[a]=i},s=(a,i,l)=>{a.offsetX=i,a.offsetY=l,this._eventHandler(a)};cn(this.options.events,a=>n(a,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,r=this.platform,n=(c,d)=>{r.addEventListener(this,c,d),e[c]=d},s=(c,d)=>{e[c]&&(r.removeEventListener(this,c,d),delete e[c])},a=(c,d)=>{this.canvas&&this.resize(c,d)};let i;const l=()=>{s("attach",l),this.attached=!0,this.resize(),n("resize",a),n("detach",i)};i=()=>{this.attached=!1,s("resize",a),this._stop(),this._resize(0,0),n("attach",l)},r.isAttached(this.canvas)?l():i()}unbindEvents(){cn(this._listeners,(e,r)=>{this.platform.removeEventListener(this,r,e)}),this._listeners={},cn(this._responsiveListeners,(e,r)=>{this.platform.removeEventListener(this,r,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,r,n){const s=n?"set":"remove";let a,i,l,c;for(r==="dataset"&&(a=this.getDatasetMeta(e[0].datasetIndex),a.controller["_"+s+"DatasetHoverStyle"]()),l=0,c=e.length;l<c;++l){i=e[l];const d=i&&this.getDatasetMeta(i.datasetIndex).controller;d&&d[s+"HoverStyle"](i.element,i.datasetIndex,i.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const r=this._active||[],n=e.map(({datasetIndex:a,index:i})=>{const l=this.getDatasetMeta(a);if(!l)throw new Error("No dataset found at index "+a);return{datasetIndex:a,element:l.data[i],index:i}});!Px(n,r)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,r))}notifyPlugins(e,r,n){return this._plugins.notify(this,e,r,n)}isPluginEnabled(e){return this._plugins._cache.filter(r=>r.plugin.id===e).length===1}_updateHoverStyles(e,r,n){const s=this.options.hover,a=(c,d)=>c.filter(h=>!d.some(p=>h.datasetIndex===p.datasetIndex&&h.index===p.index)),i=a(r,e),l=n?e:a(e,r);i.length&&this.updateHoverStyle(i,s.mode,!1),l.length&&s.mode&&this.updateHoverStyle(l,s.mode,!0)}_eventHandler(e,r){const n={event:e,replay:r,cancelable:!0,inChartArea:this.isPointInArea(e)},s=i=>(i.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",n,s)===!1)return;const a=this._handleEvent(e,r,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,s),(a||n.changed)&&this.render(),this}_handleEvent(e,r,n){const{_active:s=[],options:a}=this,i=r,l=this._getActiveElements(e,s,n,i),c=xH(e),d=gV(e,this._lastEvent,n,c);n&&(this._lastEvent=null,wn(a.onHover,[e,l,this],this),c&&wn(a.onClick,[e,l,this],this));const h=!Px(l,s);return(h||r)&&(this._active=l,this._updateHoverStyles(l,s,r)),this._lastEvent=d,h}_getActiveElements(e,r,n,s){if(e.type==="mouseout")return[];if(!n)return r;const a=this.options.hover;return this.getElementsAtEventForMode(e,a.mode,a,s)}};function s4(){return cn(Lp.instances,t=>t._plugins.invalidate())}function vV(t,e,r){const{startAngle:n,x:s,y:a,outerRadius:i,innerRadius:l,options:c}=e,{borderWidth:d,borderJoinStyle:h}=c,p=Math.min(d/i,ja(n-r));if(t.beginPath(),t.arc(s,a,i-d/2,n+p/2,r-p/2),l>0){const x=Math.min(d/l,ja(n-r));t.arc(s,a,l+d/2,r-x/2,n+x/2,!0)}else{const x=Math.min(d/2,i*ja(n-r));if(h==="round")t.arc(s,a,x,r-Kr/2,n+Kr/2,!0);else if(h==="bevel"){const m=2*x*x,b=-m*Math.cos(r+Kr/2)+s,y=-m*Math.sin(r+Kr/2)+a,w=m*Math.cos(n+Kr/2)+s,S=m*Math.sin(n+Kr/2)+a;t.lineTo(b,y),t.lineTo(w,S)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function yV(t,e,r){const{startAngle:n,pixelMargin:s,x:a,y:i,outerRadius:l,innerRadius:c}=e;let d=s/l;t.beginPath(),t.arc(a,i,l,n-d,r+d),c>s?(d=s/c,t.arc(a,i,c,r+d,n-d,!0)):t.arc(a,i,s,r+ms,n-ms),t.closePath(),t.clip()}function bV(t){return Ry(t,["outerStart","outerEnd","innerStart","innerEnd"])}function wV(t,e,r,n){const s=bV(t.options.borderRadius),a=(r-e)/2,i=Math.min(a,n*e/2),l=c=>{const d=(r-Math.min(a,c))*n/2;return Fa(c,0,Math.min(a,d))};return{outerStart:l(s.outerStart),outerEnd:l(s.outerEnd),innerStart:Fa(s.innerStart,0,i),innerEnd:Fa(s.innerEnd,0,i)}}function n0(t,e,r,n){return{x:r+t*Math.cos(e),y:n+t*Math.sin(e)}}function Mx(t,e,r,n,s,a){const{x:i,y:l,startAngle:c,pixelMargin:d,innerRadius:h}=e,p=Math.max(e.outerRadius+n+r-d,0),x=h>0?h+n+r+d:0;let m=0;const b=s-c;if(n){const M=h>0?h-n:0,te=p>0?p-n:0,ie=(M+te)/2,le=ie!==0?b*ie/(ie+n):b;m=(b-le)/2}const y=Math.max(.001,b*p-r/Kr)/p,w=(b-y)/2,S=c+w+m,k=s-w-m,{outerStart:A,outerEnd:z,innerStart:H,innerEnd:V}=wV(e,x,p,k-S),B=p-A,R=p-z,O=S+A/B,ee=k-z/R,I=x+H,P=x+V,ae=S+H/I,G=k-V/P;if(t.beginPath(),a){const M=(O+ee)/2;if(t.arc(i,l,p,O,M),t.arc(i,l,p,M,ee),z>0){const X=n0(R,ee,i,l);t.arc(X.x,X.y,z,ee,k+ms)}const te=n0(P,k,i,l);if(t.lineTo(te.x,te.y),V>0){const X=n0(P,G,i,l);t.arc(X.x,X.y,V,k+ms,G+Math.PI)}const ie=(k-V/x+(S+H/x))/2;if(t.arc(i,l,x,k-V/x,ie,!0),t.arc(i,l,x,ie,S+H/x,!0),H>0){const X=n0(I,ae,i,l);t.arc(X.x,X.y,H,ae+Math.PI,S-ms)}const le=n0(B,S,i,l);if(t.lineTo(le.x,le.y),A>0){const X=n0(B,O,i,l);t.arc(X.x,X.y,A,S-ms,O)}}else{t.moveTo(i,l);const M=Math.cos(O)*p+i,te=Math.sin(O)*p+l;t.lineTo(M,te);const ie=Math.cos(ee)*p+i,le=Math.sin(ee)*p+l;t.lineTo(ie,le)}t.closePath()}function _V(t,e,r,n,s){const{fullCircles:a,startAngle:i,circumference:l}=e;let c=e.endAngle;if(a){Mx(t,e,r,n,c,s);for(let d=0;d<a;++d)t.fill();isNaN(l)||(c=i+(l%Ln||Ln))}return Mx(t,e,r,n,c,s),t.fill(),c}function NV(t,e,r,n,s){const{fullCircles:a,startAngle:i,circumference:l,options:c}=e,{borderWidth:d,borderJoinStyle:h,borderDash:p,borderDashOffset:x,borderRadius:m}=c,b=c.borderAlign==="inner";if(!d)return;t.setLineDash(p||[]),t.lineDashOffset=x,b?(t.lineWidth=d*2,t.lineJoin=h||"round"):(t.lineWidth=d,t.lineJoin=h||"bevel");let y=e.endAngle;if(a){Mx(t,e,r,n,y,s);for(let w=0;w<a;++w)t.stroke();isNaN(l)||(y=i+(l%Ln||Ln))}b&&yV(t,e,y),c.selfJoin&&y-i>=Kr&&m===0&&h!=="miter"&&vV(t,e,y),a||(Mx(t,e,r,n,y,s),t.stroke())}class S6 extends Uc{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,r,n){const s=this.getProps(["x","y"],n),{angle:a,distance:i}=Gk(s,{x:e,y:r}),{startAngle:l,endAngle:c,innerRadius:d,outerRadius:h,circumference:p}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),x=(this.options.spacing+this.options.borderWidth)/2,m=jr(p,c-l),b=dp(a,l,c)&&l!==c,y=m>=Ln||b,w=kc(i,d+x,h+x);return y&&w}getCenterPoint(e){const{x:r,y:n,startAngle:s,endAngle:a,innerRadius:i,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:c,spacing:d}=this.options,h=(s+a)/2,p=(i+l+d+c)/2;return{x:r+Math.cos(h)*p,y:n+Math.sin(h)*p}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:r,circumference:n}=this,s=(r.offset||0)/4,a=(r.spacing||0)/2,i=r.circular;if(this.pixelMargin=r.borderAlign==="inner"?.33:0,this.fullCircles=n>Ln?Math.floor(n/Ln):0,n===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const l=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(l)*s,Math.sin(l)*s);const c=1-Math.sin(Math.min(Kr,n||0)),d=s*c;e.fillStyle=r.backgroundColor,e.strokeStyle=r.borderColor,_V(e,this,d,a,i),NV(e,this,d,a,i),e.restore()}}function k6(t,e,r=e){t.lineCap=jr(r.borderCapStyle,e.borderCapStyle),t.setLineDash(jr(r.borderDash,e.borderDash)),t.lineDashOffset=jr(r.borderDashOffset,e.borderDashOffset),t.lineJoin=jr(r.borderJoinStyle,e.borderJoinStyle),t.lineWidth=jr(r.borderWidth,e.borderWidth),t.strokeStyle=jr(r.borderColor,e.borderColor)}function SV(t,e,r){t.lineTo(r.x,r.y)}function kV(t){return t.stepped?$H:t.tension||t.cubicInterpolationMode==="monotone"?WH:SV}function j6(t,e,r={}){const n=t.length,{start:s=0,end:a=n-1}=r,{start:i,end:l}=e,c=Math.max(s,i),d=Math.min(a,l),h=s<i&&a<i||s>l&&a>l;return{count:n,start:c,loop:e.loop,ilen:d<c&&!h?n+d-c:d-c}}function jV(t,e,r,n){const{points:s,options:a}=e,{count:i,start:l,loop:c,ilen:d}=j6(s,r,n),h=kV(a);let{move:p=!0,reverse:x}=n||{},m,b,y;for(m=0;m<=d;++m)b=s[(l+(x?d-m:m))%i],!b.skip&&(p?(t.moveTo(b.x,b.y),p=!1):h(t,y,b,x,a.stepped),y=b);return c&&(b=s[(l+(x?d:0))%i],h(t,y,b,x,a.stepped)),!!c}function EV(t,e,r,n){const s=e.points,{count:a,start:i,ilen:l}=j6(s,r,n),{move:c=!0,reverse:d}=n||{};let h=0,p=0,x,m,b,y,w,S;const k=z=>(i+(d?l-z:z))%a,A=()=>{y!==w&&(t.lineTo(h,w),t.lineTo(h,y),t.lineTo(h,S))};for(c&&(m=s[k(0)],t.moveTo(m.x,m.y)),x=0;x<=l;++x){if(m=s[k(x)],m.skip)continue;const z=m.x,H=m.y,V=z|0;V===b?(H<y?y=H:H>w&&(w=H),h=(p*h+z)/++p):(A(),t.lineTo(z,H),b=V,p=0,y=w=H),S=H}A()}function lv(t){const e=t.options,r=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!r?EV:jV}function AV(t){return t.stepped?N$:t.tension||t.cubicInterpolationMode==="monotone"?S$:Hd}function CV(t,e,r,n){let s=e._path;s||(s=e._path=new Path2D,e.path(s,r,n)&&s.closePath()),k6(t,e.options),t.stroke(s)}function TV(t,e,r,n){const{segments:s,options:a}=e,i=lv(e);for(const l of s)k6(t,a,l.style),t.beginPath(),i(t,e,l,{start:r,end:r+n-1})&&t.closePath(),t.stroke()}const FV=typeof Path2D=="function";function PV(t,e,r,n){FV&&!e.options.segment?CV(t,e,r,n):TV(t,e,r,n)}class Dp extends Uc{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,r){const n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){const s=n.spanGaps?this._loop:this._fullLoop;m$(this._points,n,e,s,r),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=T$(this,this.options.segment))}first(){const e=this.segments,r=this.points;return e.length&&r[e[0].start]}last(){const e=this.segments,r=this.points,n=e.length;return n&&r[e[n-1].end]}interpolate(e,r){const n=this.options,s=e[r],a=this.points,i=c6(this,{property:r,start:s,end:s});if(!i.length)return;const l=[],c=AV(n);let d,h;for(d=0,h=i.length;d<h;++d){const{start:p,end:x}=i[d],m=a[p],b=a[x];if(m===b){l.push(m);continue}const y=Math.abs((s-m[r])/(b[r]-m[r])),w=c(m,b,y,n.stepped);w[r]=e[r],l.push(w)}return l.length===1?l[0]:l}pathSegment(e,r,n){return lv(this)(e,this,r,n)}path(e,r,n){const s=this.segments,a=lv(this);let i=this._loop;r=r||0,n=n||this.points.length-r;for(const l of s)i&=a(e,this,l,{start:r,end:r+n-1});return!!i}draw(e,r,n,s){const a=this.options||{};(this.points||[]).length&&a.borderWidth&&(e.save(),PV(e,this,n,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function a4(t,e,r,n){const s=t.options,{[r]:a}=t.getProps([r],n);return Math.abs(e-a)<s.radius+s.hitRadius}class E6 extends Uc{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,r,n){const s=this.options,{x:a,y:i}=this.getProps(["x","y"],n);return Math.pow(e-a,2)+Math.pow(r-i,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(e,r){return a4(this,e,"x",r)}inYRange(e,r){return a4(this,e,"y",r)}getCenterPoint(e){const{x:r,y:n}=this.getProps(["x","y"],e);return{x:r,y:n}}size(e){e=e||this.options||{};let r=e.radius||0;r=Math.max(r,r&&e.hoverRadius||0);const n=r&&e.borderWidth||0;return(r+n)*2}draw(e,r){const n=this.options;this.skip||n.radius<.1||!jc(this,r,this.size(n)/2)||(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.fillStyle=n.backgroundColor,av(e,n,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function A6(t,e){const{x:r,y:n,base:s,width:a,height:i}=t.getProps(["x","y","base","width","height"],e);let l,c,d,h,p;return t.horizontal?(p=i/2,l=Math.min(r,s),c=Math.max(r,s),d=n-p,h=n+p):(p=a/2,l=r-p,c=r+p,d=Math.min(n,s),h=Math.max(n,s)),{left:l,top:d,right:c,bottom:h}}function Hu(t,e,r,n){return t?0:Fa(e,r,n)}function LV(t,e,r){const n=t.options.borderWidth,s=t.borderSkipped,a=Zk(n);return{t:Hu(s.top,a.top,0,r),r:Hu(s.right,a.right,0,e),b:Hu(s.bottom,a.bottom,0,r),l:Hu(s.left,a.left,0,e)}}function DV(t,e,r){const{enableBorderRadius:n}=t.getProps(["enableBorderRadius"]),s=t.options.borderRadius,a=tf(s),i=Math.min(e,r),l=t.borderSkipped,c=n||Lr(s);return{topLeft:Hu(!c||l.top||l.left,a.topLeft,0,i),topRight:Hu(!c||l.top||l.right,a.topRight,0,i),bottomLeft:Hu(!c||l.bottom||l.left,a.bottomLeft,0,i),bottomRight:Hu(!c||l.bottom||l.right,a.bottomRight,0,i)}}function RV(t){const e=A6(t),r=e.right-e.left,n=e.bottom-e.top,s=LV(t,r/2,n/2),a=DV(t,r/2,n/2);return{outer:{x:e.left,y:e.top,w:r,h:n,radius:a},inner:{x:e.left+s.l,y:e.top+s.t,w:r-s.l-s.r,h:n-s.t-s.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,a.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(s.b,s.r))}}}}function a2(t,e,r,n){const s=e===null,a=r===null,l=t&&!(s&&a)&&A6(t,n);return l&&(s||kc(e,l.left,l.right))&&(a||kc(r,l.top,l.bottom))}function IV(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function OV(t,e){t.rect(e.x,e.y,e.w,e.h)}function i2(t,e,r={}){const n=t.x!==r.x?-e:0,s=t.y!==r.y?-e:0,a=(t.x+t.w!==r.x+r.w?e:0)-n,i=(t.y+t.h!==r.y+r.h?e:0)-s;return{x:t.x+n,y:t.y+s,w:t.w+a,h:t.h+i,radius:t.radius}}class C6 extends Uc{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:r,options:{borderColor:n,backgroundColor:s}}=this,{inner:a,outer:i}=RV(this),l=IV(i.radius)?fp:OV;e.save(),(i.w!==a.w||i.h!==a.h)&&(e.beginPath(),l(e,i2(i,r,a)),e.clip(),l(e,i2(a,-r,i)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),l(e,i2(a,r)),e.fillStyle=s,e.fill(),e.restore()}inRange(e,r,n){return a2(this,e,r,n)}inXRange(e,r){return a2(this,e,null,r)}inYRange(e,r){return a2(this,null,e,r)}getCenterPoint(e){const{x:r,y:n,base:s,horizontal:a}=this.getProps(["x","y","base","horizontal"],e);return{x:a?(r+s)/2:r,y:a?n:(n+s)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}function MV(t,e,r){const n=t.segments,s=t.points,a=e.points,i=[];for(const l of n){let{start:c,end:d}=l;d=wg(c,d,s);const h=cv(r,s[c],s[d],l.loop);if(!e.segments){i.push({source:l,target:h,start:s[c],end:s[d]});continue}const p=c6(e,h);for(const x of p){const m=cv(r,a[x.start],a[x.end],x.loop),b=l6(l,s,m);for(const y of b)i.push({source:y,target:x,start:{[r]:i4(h,m,"start",Math.max)},end:{[r]:i4(h,m,"end",Math.min)}})}}return i}function cv(t,e,r,n){if(n)return;let s=e[t],a=r[t];return t==="angle"&&(s=ja(s),a=ja(a)),{property:t,start:s,end:a}}function BV(t,e){const{x:r=null,y:n=null}=t||{},s=e.points,a=[];return e.segments.forEach(({start:i,end:l})=>{l=wg(i,l,s);const c=s[i],d=s[l];n!==null?(a.push({x:c.x,y:n}),a.push({x:d.x,y:n})):r!==null&&(a.push({x:r,y:c.y}),a.push({x:r,y:d.y}))}),a}function wg(t,e,r){for(;e>t;e--){const n=r[e];if(!isNaN(n.x)&&!isNaN(n.y))break}return e}function i4(t,e,r,n){return t&&e?n(t[r],e[r]):t?t[r]:e?e[r]:0}function T6(t,e){let r=[],n=!1;return Mn(t)?(n=!0,r=t):r=BV(t,e),r.length?new Dp({points:r,options:{tension:0},_loop:n,_fullLoop:n}):null}function o4(t){return t&&t.fill!==!1}function UV(t,e,r){let s=t[e].fill;const a=[e];let i;if(!r)return s;for(;s!==!1&&a.indexOf(s)===-1;){if(!Gs(s))return s;if(i=t[s],!i)return!1;if(i.visible)return s;a.push(s),s=i.fill}return!1}function zV(t,e,r){const n=VV(t);if(Lr(n))return isNaN(n.value)?!1:n;let s=parseFloat(n);return Gs(s)&&Math.floor(s)===s?HV(n[0],e,s,r):["origin","start","end","stack","shape"].indexOf(n)>=0&&n}function HV(t,e,r,n){return(t==="-"||t==="+")&&(r=e+r),r===e||r<0||r>=n?!1:r}function $V(t,e){let r=null;return t==="start"?r=e.bottom:t==="end"?r=e.top:Lr(t)?r=e.getPixelForValue(t.value):e.getBasePixel&&(r=e.getBasePixel()),r}function WV(t,e,r){let n;return t==="start"?n=r:t==="end"?n=e.options.reverse?e.min:e.max:Lr(t)?n=t.value:n=e.getBaseValue(),n}function VV(t){const e=t.options,r=e.fill;let n=jr(r&&r.target,r);return n===void 0&&(n=!!e.backgroundColor),n===!1||n===null?!1:n===!0?"origin":n}function qV(t){const{scale:e,index:r,line:n}=t,s=[],a=n.segments,i=n.points,l=GV(e,r);l.push(T6({x:null,y:e.bottom},n));for(let c=0;c<a.length;c++){const d=a[c];for(let h=d.start;h<=d.end;h++)XV(s,i[h],l)}return new Dp({points:s,options:{}})}function GV(t,e){const r=[],n=t.getMatchingVisibleMetas("line");for(let s=0;s<n.length;s++){const a=n[s];if(a.index===e)break;a.hidden||r.unshift(a.dataset)}return r}function XV(t,e,r){const n=[];for(let s=0;s<r.length;s++){const a=r[s],{first:i,last:l,point:c}=YV(a,e,"x");if(!(!c||i&&l)){if(i)n.unshift(c);else if(t.push(c),!l)break}}t.push(...n)}function YV(t,e,r){const n=t.interpolate(e,r);if(!n)return{};const s=n[r],a=t.segments,i=t.points;let l=!1,c=!1;for(let d=0;d<a.length;d++){const h=a[d],p=i[h.start][r],x=i[h.end][r];if(kc(s,p,x)){l=s===p,c=s===x;break}}return{first:l,last:c,point:n}}class F6{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,r,n){const{x:s,y:a,radius:i}=this;return r=r||{start:0,end:Ln},e.arc(s,a,i,r.end,r.start,!0),!n.bounds}interpolate(e){const{x:r,y:n,radius:s}=this,a=e.angle;return{x:r+Math.cos(a)*s,y:n+Math.sin(a)*s,angle:a}}}function KV(t){const{chart:e,fill:r,line:n}=t;if(Gs(r))return JV(e,r);if(r==="stack")return qV(t);if(r==="shape")return!0;const s=QV(t);return s instanceof F6?s:T6(s,n)}function JV(t,e){const r=t.getDatasetMeta(e);return r&&t.isDatasetVisible(e)?r.dataset:null}function QV(t){return(t.scale||{}).getPointPositionForValue?eq(t):ZV(t)}function ZV(t){const{scale:e={},fill:r}=t,n=$V(r,e);if(Gs(n)){const s=e.isHorizontal();return{x:s?n:null,y:s?null:n}}return null}function eq(t){const{scale:e,fill:r}=t,n=e.options,s=e.getLabels().length,a=n.reverse?e.max:e.min,i=WV(r,e,a),l=[];if(n.grid.circular){const c=e.getPointPositionForValue(0,a);return new F6({x:c.x,y:c.y,radius:e.getDistanceFromCenterForValue(i)})}for(let c=0;c<s;++c)l.push(e.getPointPositionForValue(c,i));return l}function o2(t,e,r){const n=KV(e),{chart:s,index:a,line:i,scale:l,axis:c}=e,d=i.options,h=d.fill,p=d.backgroundColor,{above:x=p,below:m=p}=h||{},b=s.getDatasetMeta(a),y=u6(s,b);n&&i.points.length&&(gg(t,r),tq(t,{line:i,target:n,above:x,below:m,area:r,scale:l,axis:c,clip:y}),vg(t))}function tq(t,e){const{line:r,target:n,above:s,below:a,area:i,scale:l,clip:c}=e,d=r._loop?"angle":e.axis;t.save();let h=a;a!==s&&(d==="x"?(l4(t,n,i.top),l2(t,{line:r,target:n,color:s,scale:l,property:d,clip:c}),t.restore(),t.save(),l4(t,n,i.bottom)):d==="y"&&(c4(t,n,i.left),l2(t,{line:r,target:n,color:a,scale:l,property:d,clip:c}),t.restore(),t.save(),c4(t,n,i.right),h=s)),l2(t,{line:r,target:n,color:h,scale:l,property:d,clip:c}),t.restore()}function l4(t,e,r){const{segments:n,points:s}=e;let a=!0,i=!1;t.beginPath();for(const l of n){const{start:c,end:d}=l,h=s[c],p=s[wg(c,d,s)];a?(t.moveTo(h.x,h.y),a=!1):(t.lineTo(h.x,r),t.lineTo(h.x,h.y)),i=!!e.pathSegment(t,l,{move:i}),i?t.closePath():t.lineTo(p.x,r)}t.lineTo(e.first().x,r),t.closePath(),t.clip()}function c4(t,e,r){const{segments:n,points:s}=e;let a=!0,i=!1;t.beginPath();for(const l of n){const{start:c,end:d}=l,h=s[c],p=s[wg(c,d,s)];a?(t.moveTo(h.x,h.y),a=!1):(t.lineTo(r,h.y),t.lineTo(h.x,h.y)),i=!!e.pathSegment(t,l,{move:i}),i?t.closePath():t.lineTo(r,p.y)}t.lineTo(r,e.first().y),t.closePath(),t.clip()}function l2(t,e){const{line:r,target:n,property:s,color:a,scale:i,clip:l}=e,c=MV(r,n,s);for(const{source:d,target:h,start:p,end:x}of c){const{style:{backgroundColor:m=a}={}}=d,b=n!==!0;t.save(),t.fillStyle=m,rq(t,i,l,b&&cv(s,p,x)),t.beginPath();const y=!!r.pathSegment(t,d);let w;if(b){y?t.closePath():u4(t,n,x,s);const S=!!n.pathSegment(t,h,{move:y,reverse:!0});w=y&&S,w||u4(t,n,p,s)}t.closePath(),t.fill(w?"evenodd":"nonzero"),t.restore()}}function rq(t,e,r,n){const s=e.chart.chartArea,{property:a,start:i,end:l}=n||{};if(a==="x"||a==="y"){let c,d,h,p;a==="x"?(c=i,d=s.top,h=l,p=s.bottom):(c=s.left,d=i,h=s.right,p=l),t.beginPath(),r&&(c=Math.max(c,r.left),h=Math.min(h,r.right),d=Math.max(d,r.top),p=Math.min(p,r.bottom)),t.rect(c,d,h-c,p-d),t.clip()}}function u4(t,e,r,n){const s=e.interpolate(r,n);s&&t.lineTo(s.x,s.y)}var P6={id:"filler",afterDatasetsUpdate(t,e,r){const n=(t.data.datasets||[]).length,s=[];let a,i,l,c;for(i=0;i<n;++i)a=t.getDatasetMeta(i),l=a.dataset,c=null,l&&l.options&&l instanceof Dp&&(c={visible:t.isDatasetVisible(i),index:i,fill:zV(l,i,n),chart:t,axis:a.controller.options.indexAxis,scale:a.vScale,line:l}),a.$filler=c,s.push(c);for(i=0;i<n;++i)c=s[i],!(!c||c.fill===!1)&&(c.fill=UV(s,i,r.propagate))},beforeDraw(t,e,r){const n=r.drawTime==="beforeDraw",s=t.getSortedVisibleDatasetMetas(),a=t.chartArea;for(let i=s.length-1;i>=0;--i){const l=s[i].$filler;l&&(l.line.updateControlPoints(a,l.axis),n&&l.fill&&o2(t.ctx,l,a))}},beforeDatasetsDraw(t,e,r){if(r.drawTime!=="beforeDatasetsDraw")return;const n=t.getSortedVisibleDatasetMetas();for(let s=n.length-1;s>=0;--s){const a=n[s].$filler;o4(a)&&o2(t.ctx,a,t.chartArea)}},beforeDatasetDraw(t,e,r){const n=e.meta.$filler;!o4(n)||r.drawTime!=="beforeDatasetDraw"||o2(t.ctx,n,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const d4=(t,e)=>{let{boxHeight:r=e,boxWidth:n=e}=t;return t.usePointStyle&&(r=Math.min(r,e),n=t.pointStyleWidth||Math.min(n,e)),{boxWidth:n,boxHeight:r,itemHeight:Math.max(e,r)}},nq=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class f4 extends Uc{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,r,n){this.maxWidth=e,this.maxHeight=r,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let r=wn(e.generateLabels,[this.chart],this)||[];e.filter&&(r=r.filter(n=>e.filter(n,this.chart.data))),e.sort&&(r=r.sort((n,s)=>e.sort(n,s,this.chart.data))),this.options.reverse&&r.reverse(),this.legendItems=r}fit(){const{options:e,ctx:r}=this;if(!e.display){this.width=this.height=0;return}const n=e.labels,s=Ts(n.font),a=s.size,i=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=d4(n,a);let d,h;r.font=s.string,this.isHorizontal()?(d=this.maxWidth,h=this._fitRows(i,a,l,c)+10):(h=this.maxHeight,d=this._fitCols(i,s,l,c)+10),this.width=Math.min(d,e.maxWidth||this.maxWidth),this.height=Math.min(h,e.maxHeight||this.maxHeight)}_fitRows(e,r,n,s){const{ctx:a,maxWidth:i,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.lineWidths=[0],h=s+l;let p=e;a.textAlign="left",a.textBaseline="middle";let x=-1,m=-h;return this.legendItems.forEach((b,y)=>{const w=n+r/2+a.measureText(b.text).width;(y===0||d[d.length-1]+w+2*l>i)&&(p+=h,d[d.length-(y>0?0:1)]=0,m+=h,x++),c[y]={left:0,top:m,row:x,width:w,height:s},d[d.length-1]+=w+l}),p}_fitCols(e,r,n,s){const{ctx:a,maxHeight:i,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.columnSizes=[],h=i-e;let p=l,x=0,m=0,b=0,y=0;return this.legendItems.forEach((w,S)=>{const{itemWidth:k,itemHeight:A}=sq(n,r,a,w,s);S>0&&m+A+2*l>h&&(p+=x+l,d.push({width:x,height:m}),b+=x+l,y++,x=m=0),c[S]={left:b,top:m,col:y,width:k,height:A},x=Math.max(x,k),m+=A+l}),p+=x,d.push({width:x,height:m}),p}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:r,options:{align:n,labels:{padding:s},rtl:a}}=this,i=w0(a,this.left,this.width);if(this.isHorizontal()){let l=0,c=Na(n,this.left+s,this.right-this.lineWidths[l]);for(const d of r)l!==d.row&&(l=d.row,c=Na(n,this.left+s,this.right-this.lineWidths[l])),d.top+=this.top+e+s,d.left=i.leftForLtr(i.x(c),d.width),c+=d.width+s}else{let l=0,c=Na(n,this.top+e+s,this.bottom-this.columnSizes[l].height);for(const d of r)d.col!==l&&(l=d.col,c=Na(n,this.top+e+s,this.bottom-this.columnSizes[l].height)),d.top=c,d.left+=this.left+s,d.left=i.leftForLtr(i.x(d.left),d.width),c+=d.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;gg(e,this),this._draw(),vg(e)}}_draw(){const{options:e,columnSizes:r,lineWidths:n,ctx:s}=this,{align:a,labels:i}=e,l=rs.color,c=w0(e.rtl,this.left,this.width),d=Ts(i.font),{padding:h}=i,p=d.size,x=p/2;let m;this.drawTitle(),s.textAlign=c.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=d.string;const{boxWidth:b,boxHeight:y,itemHeight:w}=d4(i,p),S=function(V,B,R){if(isNaN(b)||b<=0||isNaN(y)||y<0)return;s.save();const O=jr(R.lineWidth,1);if(s.fillStyle=jr(R.fillStyle,l),s.lineCap=jr(R.lineCap,"butt"),s.lineDashOffset=jr(R.lineDashOffset,0),s.lineJoin=jr(R.lineJoin,"miter"),s.lineWidth=O,s.strokeStyle=jr(R.strokeStyle,l),s.setLineDash(jr(R.lineDash,[])),i.usePointStyle){const ee={radius:y*Math.SQRT2/2,pointStyle:R.pointStyle,rotation:R.rotation,borderWidth:O},I=c.xPlus(V,b/2),P=B+x;Qk(s,ee,I,P,i.pointStyleWidth&&b)}else{const ee=B+Math.max((p-y)/2,0),I=c.leftForLtr(V,b),P=tf(R.borderRadius);s.beginPath(),Object.values(P).some(ae=>ae!==0)?fp(s,{x:I,y:ee,w:b,h:y,radius:P}):s.rect(I,ee,b,y),s.fill(),O!==0&&s.stroke()}s.restore()},k=function(V,B,R){hf(s,R.text,V,B+w/2,d,{strikethrough:R.hidden,textAlign:c.textAlign(R.textAlign)})},A=this.isHorizontal(),z=this._computeTitleHeight();A?m={x:Na(a,this.left+h,this.right-n[0]),y:this.top+h+z,line:0}:m={x:this.left+h,y:Na(a,this.top+z+h,this.bottom-r[0].height),line:0},a6(this.ctx,e.textDirection);const H=w+h;this.legendItems.forEach((V,B)=>{s.strokeStyle=V.fontColor,s.fillStyle=V.fontColor;const R=s.measureText(V.text).width,O=c.textAlign(V.textAlign||(V.textAlign=i.textAlign)),ee=b+x+R;let I=m.x,P=m.y;c.setWidth(this.width),A?B>0&&I+ee+h>this.right&&(P=m.y+=H,m.line++,I=m.x=Na(a,this.left+h,this.right-n[m.line])):B>0&&P+H>this.bottom&&(I=m.x=I+r[m.line].width+h,m.line++,P=m.y=Na(a,this.top+z+h,this.bottom-r[m.line].height));const ae=c.x(I);if(S(ae,P,V),I=CH(O,I+b+x,A?I+ee:this.right,e.rtl),k(c.x(I),P,V),A)m.x+=ee+h;else if(typeof V.text!="string"){const G=d.lineHeight;m.y+=L6(V,G)+h}else m.y+=H}),i6(this.ctx,e.textDirection)}drawTitle(){const e=this.options,r=e.title,n=Ts(r.font),s=Ra(r.padding);if(!r.display)return;const a=w0(e.rtl,this.left,this.width),i=this.ctx,l=r.position,c=n.size/2,d=s.top+c;let h,p=this.left,x=this.width;if(this.isHorizontal())x=Math.max(...this.lineWidths),h=this.top+d,p=Na(e.align,p,this.right-x);else{const b=this.columnSizes.reduce((y,w)=>Math.max(y,w.height),0);h=d+Na(e.align,this.top,this.bottom-b-e.labels.padding-this._computeTitleHeight())}const m=Na(l,p,p+x);i.textAlign=a.textAlign(Py(l)),i.textBaseline="middle",i.strokeStyle=r.color,i.fillStyle=r.color,i.font=n.string,hf(i,r.text,m,h,n)}_computeTitleHeight(){const e=this.options.title,r=Ts(e.font),n=Ra(e.padding);return e.display?r.lineHeight+n.height:0}_getLegendItemAt(e,r){let n,s,a;if(kc(e,this.left,this.right)&&kc(r,this.top,this.bottom)){for(a=this.legendHitBoxes,n=0;n<a.length;++n)if(s=a[n],kc(e,s.left,s.left+s.width)&&kc(r,s.top,s.top+s.height))return this.legendItems[n]}return null}handleEvent(e){const r=this.options;if(!oq(e.type,r))return;const n=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,a=nq(s,n);s&&!a&&wn(r.onLeave,[e,s,this],this),this._hoveredItem=n,n&&!a&&wn(r.onHover,[e,n,this],this)}else n&&wn(r.onClick,[e,n,this],this)}}function sq(t,e,r,n,s){const a=aq(n,t,e,r),i=iq(s,n,e.lineHeight);return{itemWidth:a,itemHeight:i}}function aq(t,e,r,n){let s=t.text;return s&&typeof s!="string"&&(s=s.reduce((a,i)=>a.length>i.length?a:i)),e+r.size/2+n.measureText(s).width}function iq(t,e,r){let n=t;return typeof e.text!="string"&&(n=L6(e,r)),n}function L6(t,e){const r=t.text?t.text.length:0;return e*r}function oq(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var D6={id:"legend",_element:f4,start(t,e,r){const n=t.legend=new f4({ctx:t.ctx,options:r,chart:t});mo.configure(t,n,r),mo.addBox(t,n)},stop(t){mo.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,r){const n=t.legend;mo.configure(t,n,r),n.options=r},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,r){const n=e.datasetIndex,s=r.chart;s.isDatasetVisible(n)?(s.hide(n),e.hidden=!0):(s.show(n),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:r,pointStyle:n,textAlign:s,color:a,useBorderRadius:i,borderRadius:l}}=t.legend.options;return t._getSortedDatasetMetas().map(c=>{const d=c.controller.getStyle(r?0:void 0),h=Ra(d.borderWidth);return{text:e[c.index].label,fillStyle:d.backgroundColor,fontColor:a,hidden:!c.visible,lineCap:d.borderCapStyle,lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:d.borderColor,pointStyle:n||d.pointStyle,rotation:d.rotation,textAlign:s||d.textAlign,borderRadius:i&&(l||d.borderRadius),datasetIndex:c.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class R6 extends Uc{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,r){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=r;const s=Mn(n.text)?n.text.length:1;this._padding=Ra(n.padding);const a=s*Ts(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=a:this.width=a}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:r,left:n,bottom:s,right:a,options:i}=this,l=i.align;let c=0,d,h,p;return this.isHorizontal()?(h=Na(l,n,a),p=r+e,d=a-n):(i.position==="left"?(h=n+e,p=Na(l,s,r),c=Kr*-.5):(h=a-e,p=Na(l,r,s),c=Kr*.5),d=s-r),{titleX:h,titleY:p,maxWidth:d,rotation:c}}draw(){const e=this.ctx,r=this.options;if(!r.display)return;const n=Ts(r.font),a=n.lineHeight/2+this._padding.top,{titleX:i,titleY:l,maxWidth:c,rotation:d}=this._drawArgs(a);hf(e,r.text,0,0,n,{color:r.color,maxWidth:c,rotation:d,textAlign:Py(r.align),textBaseline:"middle",translation:[i,l]})}}function lq(t,e){const r=new R6({ctx:t.ctx,options:e,chart:t});mo.configure(t,r,e),mo.addBox(t,r),t.titleBlock=r}var I6={id:"title",_element:R6,start(t,e,r){lq(t,r)},stop(t){const e=t.titleBlock;mo.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,r){const n=t.titleBlock;mo.configure(t,n,r),n.options=r},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const _h={average(t){if(!t.length)return!1;let e,r,n=new Set,s=0,a=0;for(e=0,r=t.length;e<r;++e){const l=t[e].element;if(l&&l.hasValue()){const c=l.tooltipPosition();n.add(c.x),s+=c.y,++a}}return a===0||n.size===0?!1:{x:[...n].reduce((l,c)=>l+c)/n.size,y:s/a}},nearest(t,e){if(!t.length)return!1;let r=e.x,n=e.y,s=Number.POSITIVE_INFINITY,a,i,l;for(a=0,i=t.length;a<i;++a){const c=t[a].element;if(c&&c.hasValue()){const d=c.getCenterPoint(),h=nv(e,d);h<s&&(s=h,l=c)}}if(l){const c=l.tooltipPosition();r=c.x,n=c.y}return{x:r,y:n}}};function El(t,e){return e&&(Mn(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function vc(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function cq(t,e){const{element:r,datasetIndex:n,index:s}=e,a=t.getDatasetMeta(n).controller,{label:i,value:l}=a.getLabelAndValue(s);return{chart:t,label:i,parsed:a.getParsed(s),raw:t.data.datasets[n].data[s],formattedValue:l,dataset:a.getDataset(),dataIndex:s,datasetIndex:n,element:r}}function h4(t,e){const r=t.chart.ctx,{body:n,footer:s,title:a}=t,{boxWidth:i,boxHeight:l}=e,c=Ts(e.bodyFont),d=Ts(e.titleFont),h=Ts(e.footerFont),p=a.length,x=s.length,m=n.length,b=Ra(e.padding);let y=b.height,w=0,S=n.reduce((z,H)=>z+H.before.length+H.lines.length+H.after.length,0);if(S+=t.beforeBody.length+t.afterBody.length,p&&(y+=p*d.lineHeight+(p-1)*e.titleSpacing+e.titleMarginBottom),S){const z=e.displayColors?Math.max(l,c.lineHeight):c.lineHeight;y+=m*z+(S-m)*c.lineHeight+(S-1)*e.bodySpacing}x&&(y+=e.footerMarginTop+x*h.lineHeight+(x-1)*e.footerSpacing);let k=0;const A=function(z){w=Math.max(w,r.measureText(z).width+k)};return r.save(),r.font=d.string,cn(t.title,A),r.font=c.string,cn(t.beforeBody.concat(t.afterBody),A),k=e.displayColors?i+2+e.boxPadding:0,cn(n,z=>{cn(z.before,A),cn(z.lines,A),cn(z.after,A)}),k=0,r.font=h.string,cn(t.footer,A),r.restore(),w+=b.width,{width:w,height:y}}function uq(t,e){const{y:r,height:n}=e;return r<n/2?"top":r>t.height-n/2?"bottom":"center"}function dq(t,e,r,n){const{x:s,width:a}=n,i=r.caretSize+r.caretPadding;if(t==="left"&&s+a+i>e.width||t==="right"&&s-a-i<0)return!0}function fq(t,e,r,n){const{x:s,width:a}=r,{width:i,chartArea:{left:l,right:c}}=t;let d="center";return n==="center"?d=s<=(l+c)/2?"left":"right":s<=a/2?d="left":s>=i-a/2&&(d="right"),dq(d,t,e,r)&&(d="center"),d}function p4(t,e,r){const n=r.yAlign||e.yAlign||uq(t,r);return{xAlign:r.xAlign||e.xAlign||fq(t,e,r,n),yAlign:n}}function hq(t,e){let{x:r,width:n}=t;return e==="right"?r-=n:e==="center"&&(r-=n/2),r}function pq(t,e,r){let{y:n,height:s}=t;return e==="top"?n+=r:e==="bottom"?n-=s+r:n-=s/2,n}function m4(t,e,r,n){const{caretSize:s,caretPadding:a,cornerRadius:i}=t,{xAlign:l,yAlign:c}=r,d=s+a,{topLeft:h,topRight:p,bottomLeft:x,bottomRight:m}=tf(i);let b=hq(e,l);const y=pq(e,c,d);return c==="center"?l==="left"?b+=d:l==="right"&&(b-=d):l==="left"?b-=Math.max(h,x)+s:l==="right"&&(b+=Math.max(p,m)+s),{x:Fa(b,0,n.width-e.width),y:Fa(y,0,n.height-e.height)}}function Vm(t,e,r){const n=Ra(r.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-n.right:t.x+n.left}function x4(t){return El([],vc(t))}function mq(t,e,r){return od(t,{tooltip:e,tooltipItems:r,type:"tooltip"})}function g4(t,e){const r=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return r?t.override(r):t}const O6={beforeTitle:xc,title(t){if(t.length>0){const e=t[0],r=e.chart.data.labels,n=r?r.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(n>0&&e.dataIndex<n)return r[e.dataIndex]}return""},afterTitle:xc,beforeBody:xc,beforeLabel:xc,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const r=t.formattedValue;return Vr(r)||(e+=r),e},labelColor(t){const r=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:r.borderColor,backgroundColor:r.backgroundColor,borderWidth:r.borderWidth,borderDash:r.borderDash,borderDashOffset:r.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const r=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:r.pointStyle,rotation:r.rotation}},afterLabel:xc,afterBody:xc,beforeFooter:xc,footer:xc,afterFooter:xc};function ui(t,e,r,n){const s=t[e].call(r,n);return typeof s>"u"?O6[e].call(r,n):s}class v4 extends Uc{static positioners=_h;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const r=this.chart,n=this.options.setContext(this.getContext()),s=n.enabled&&r.options.animation&&n.animations,a=new d6(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=mq(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,r){const{callbacks:n}=r,s=ui(n,"beforeTitle",this,e),a=ui(n,"title",this,e),i=ui(n,"afterTitle",this,e);let l=[];return l=El(l,vc(s)),l=El(l,vc(a)),l=El(l,vc(i)),l}getBeforeBody(e,r){return x4(ui(r.callbacks,"beforeBody",this,e))}getBody(e,r){const{callbacks:n}=r,s=[];return cn(e,a=>{const i={before:[],lines:[],after:[]},l=g4(n,a);El(i.before,vc(ui(l,"beforeLabel",this,a))),El(i.lines,ui(l,"label",this,a)),El(i.after,vc(ui(l,"afterLabel",this,a))),s.push(i)}),s}getAfterBody(e,r){return x4(ui(r.callbacks,"afterBody",this,e))}getFooter(e,r){const{callbacks:n}=r,s=ui(n,"beforeFooter",this,e),a=ui(n,"footer",this,e),i=ui(n,"afterFooter",this,e);let l=[];return l=El(l,vc(s)),l=El(l,vc(a)),l=El(l,vc(i)),l}_createItems(e){const r=this._active,n=this.chart.data,s=[],a=[],i=[];let l=[],c,d;for(c=0,d=r.length;c<d;++c)l.push(cq(this.chart,r[c]));return e.filter&&(l=l.filter((h,p,x)=>e.filter(h,p,x,n))),e.itemSort&&(l=l.sort((h,p)=>e.itemSort(h,p,n))),cn(l,h=>{const p=g4(e.callbacks,h);s.push(ui(p,"labelColor",this,h)),a.push(ui(p,"labelPointStyle",this,h)),i.push(ui(p,"labelTextColor",this,h))}),this.labelColors=s,this.labelPointStyles=a,this.labelTextColors=i,this.dataPoints=l,l}update(e,r){const n=this.options.setContext(this.getContext()),s=this._active;let a,i=[];if(!s.length)this.opacity!==0&&(a={opacity:0});else{const l=_h[n.position].call(this,s,this._eventPosition);i=this._createItems(n),this.title=this.getTitle(i,n),this.beforeBody=this.getBeforeBody(i,n),this.body=this.getBody(i,n),this.afterBody=this.getAfterBody(i,n),this.footer=this.getFooter(i,n);const c=this._size=h4(this,n),d=Object.assign({},l,c),h=p4(this.chart,n,d),p=m4(n,d,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,a={opacity:1,x:p.x,y:p.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=i,this.$context=void 0,a&&this._resolveAnimations().update(this,a),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:r})}drawCaret(e,r,n,s){const a=this.getCaretPosition(e,n,s);r.lineTo(a.x1,a.y1),r.lineTo(a.x2,a.y2),r.lineTo(a.x3,a.y3)}getCaretPosition(e,r,n){const{xAlign:s,yAlign:a}=this,{caretSize:i,cornerRadius:l}=n,{topLeft:c,topRight:d,bottomLeft:h,bottomRight:p}=tf(l),{x,y:m}=e,{width:b,height:y}=r;let w,S,k,A,z,H;return a==="center"?(z=m+y/2,s==="left"?(w=x,S=w-i,A=z+i,H=z-i):(w=x+b,S=w+i,A=z-i,H=z+i),k=w):(s==="left"?S=x+Math.max(c,h)+i:s==="right"?S=x+b-Math.max(d,p)-i:S=this.caretX,a==="top"?(A=m,z=A-i,w=S-i,k=S+i):(A=m+y,z=A+i,w=S+i,k=S-i),H=A),{x1:w,x2:S,x3:k,y1:A,y2:z,y3:H}}drawTitle(e,r,n){const s=this.title,a=s.length;let i,l,c;if(a){const d=w0(n.rtl,this.x,this.width);for(e.x=Vm(this,n.titleAlign,n),r.textAlign=d.textAlign(n.titleAlign),r.textBaseline="middle",i=Ts(n.titleFont),l=n.titleSpacing,r.fillStyle=n.titleColor,r.font=i.string,c=0;c<a;++c)r.fillText(s[c],d.x(e.x),e.y+i.lineHeight/2),e.y+=i.lineHeight+l,c+1===a&&(e.y+=n.titleMarginBottom-l)}}_drawColorBox(e,r,n,s,a){const i=this.labelColors[n],l=this.labelPointStyles[n],{boxHeight:c,boxWidth:d}=a,h=Ts(a.bodyFont),p=Vm(this,"left",a),x=s.x(p),m=c<h.lineHeight?(h.lineHeight-c)/2:0,b=r.y+m;if(a.usePointStyle){const y={radius:Math.min(d,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},w=s.leftForLtr(x,d)+d/2,S=b+c/2;e.strokeStyle=a.multiKeyBackground,e.fillStyle=a.multiKeyBackground,av(e,y,w,S),e.strokeStyle=i.borderColor,e.fillStyle=i.backgroundColor,av(e,y,w,S)}else{e.lineWidth=Lr(i.borderWidth)?Math.max(...Object.values(i.borderWidth)):i.borderWidth||1,e.strokeStyle=i.borderColor,e.setLineDash(i.borderDash||[]),e.lineDashOffset=i.borderDashOffset||0;const y=s.leftForLtr(x,d),w=s.leftForLtr(s.xPlus(x,1),d-2),S=tf(i.borderRadius);Object.values(S).some(k=>k!==0)?(e.beginPath(),e.fillStyle=a.multiKeyBackground,fp(e,{x:y,y:b,w:d,h:c,radius:S}),e.fill(),e.stroke(),e.fillStyle=i.backgroundColor,e.beginPath(),fp(e,{x:w,y:b+1,w:d-2,h:c-2,radius:S}),e.fill()):(e.fillStyle=a.multiKeyBackground,e.fillRect(y,b,d,c),e.strokeRect(y,b,d,c),e.fillStyle=i.backgroundColor,e.fillRect(w,b+1,d-2,c-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,r,n){const{body:s}=this,{bodySpacing:a,bodyAlign:i,displayColors:l,boxHeight:c,boxWidth:d,boxPadding:h}=n,p=Ts(n.bodyFont);let x=p.lineHeight,m=0;const b=w0(n.rtl,this.x,this.width),y=function(R){r.fillText(R,b.x(e.x+m),e.y+x/2),e.y+=x+a},w=b.textAlign(i);let S,k,A,z,H,V,B;for(r.textAlign=i,r.textBaseline="middle",r.font=p.string,e.x=Vm(this,w,n),r.fillStyle=n.bodyColor,cn(this.beforeBody,y),m=l&&w!=="right"?i==="center"?d/2+h:d+2+h:0,z=0,V=s.length;z<V;++z){for(S=s[z],k=this.labelTextColors[z],r.fillStyle=k,cn(S.before,y),A=S.lines,l&&A.length&&(this._drawColorBox(r,e,z,b,n),x=Math.max(p.lineHeight,c)),H=0,B=A.length;H<B;++H)y(A[H]),x=p.lineHeight;cn(S.after,y)}m=0,x=p.lineHeight,cn(this.afterBody,y),e.y-=a}drawFooter(e,r,n){const s=this.footer,a=s.length;let i,l;if(a){const c=w0(n.rtl,this.x,this.width);for(e.x=Vm(this,n.footerAlign,n),e.y+=n.footerMarginTop,r.textAlign=c.textAlign(n.footerAlign),r.textBaseline="middle",i=Ts(n.footerFont),r.fillStyle=n.footerColor,r.font=i.string,l=0;l<a;++l)r.fillText(s[l],c.x(e.x),e.y+i.lineHeight/2),e.y+=i.lineHeight+n.footerSpacing}}drawBackground(e,r,n,s){const{xAlign:a,yAlign:i}=this,{x:l,y:c}=e,{width:d,height:h}=n,{topLeft:p,topRight:x,bottomLeft:m,bottomRight:b}=tf(s.cornerRadius);r.fillStyle=s.backgroundColor,r.strokeStyle=s.borderColor,r.lineWidth=s.borderWidth,r.beginPath(),r.moveTo(l+p,c),i==="top"&&this.drawCaret(e,r,n,s),r.lineTo(l+d-x,c),r.quadraticCurveTo(l+d,c,l+d,c+x),i==="center"&&a==="right"&&this.drawCaret(e,r,n,s),r.lineTo(l+d,c+h-b),r.quadraticCurveTo(l+d,c+h,l+d-b,c+h),i==="bottom"&&this.drawCaret(e,r,n,s),r.lineTo(l+m,c+h),r.quadraticCurveTo(l,c+h,l,c+h-m),i==="center"&&a==="left"&&this.drawCaret(e,r,n,s),r.lineTo(l,c+p),r.quadraticCurveTo(l,c,l+p,c),r.closePath(),r.fill(),s.borderWidth>0&&r.stroke()}_updateAnimationTarget(e){const r=this.chart,n=this.$animations,s=n&&n.x,a=n&&n.y;if(s||a){const i=_h[e.position].call(this,this._active,this._eventPosition);if(!i)return;const l=this._size=h4(this,e),c=Object.assign({},i,this._size),d=p4(r,e,c),h=m4(e,c,d,r);(s._to!==h.x||a._to!==h.y)&&(this.xAlign=d.xAlign,this.yAlign=d.yAlign,this.width=l.width,this.height=l.height,this.caretX=i.x,this.caretY=i.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(e){const r=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(r);const s={width:this.width,height:this.height},a={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const i=Ra(r.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;r.enabled&&l&&(e.save(),e.globalAlpha=n,this.drawBackground(a,e,s,r),a6(e,r.textDirection),a.y+=i.top,this.drawTitle(a,e,r),this.drawBody(a,e,r),this.drawFooter(a,e,r),i6(e,r.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,r){const n=this._active,s=e.map(({datasetIndex:l,index:c})=>{const d=this.chart.getDatasetMeta(l);if(!d)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:d.data[c],index:c}}),a=!Px(n,s),i=this._positionChanged(s,r);(a||i)&&(this._active=s,this._eventPosition=r,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,r,n=!0){if(r&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,a=this._active||[],i=this._getActiveElements(e,a,r,n),l=this._positionChanged(i,e),c=r||!Px(i,a)||l;return c&&(this._active=i,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,r))),c}_getActiveElements(e,r,n,s){const a=this.options;if(e.type==="mouseout")return[];if(!s)return r.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const i=this.chart.getElementsAtEventForMode(e,a.mode,a,n);return a.reverse&&i.reverse(),i}_positionChanged(e,r){const{caretX:n,caretY:s,options:a}=this,i=_h[a.position].call(this,e,r);return i!==!1&&(n!==i.x||s!==i.y)}}var M6={id:"tooltip",_element:v4,positioners:_h,afterInit(t,e,r){r&&(t.tooltip=new v4({chart:t,options:r}))},beforeUpdate(t,e,r){t.tooltip&&t.tooltip.initialize(r)},reset(t,e,r){t.tooltip&&t.tooltip.initialize(r)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const r={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...r,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",r)}},afterEvent(t,e){if(t.tooltip){const r=e.replay;t.tooltip.handleEvent(e.event,r,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:O6},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const xq=(t,e,r,n)=>(typeof e=="string"?(r=t.push(e)-1,n.unshift({index:r,label:e})):isNaN(e)&&(r=null),r);function gq(t,e,r,n){const s=t.indexOf(e);if(s===-1)return xq(t,e,r,n);const a=t.lastIndexOf(e);return s!==a?r:s}const vq=(t,e)=>t===null?null:Fa(Math.round(t),0,e);function y4(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class B6 extends O0{static id="category";static defaults={ticks:{callback:y4}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const r=this._addedLabels;if(r.length){const n=this.getLabels();for(const{index:s,label:a}of r)n[s]===a&&n.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,r){if(Vr(e))return null;const n=this.getLabels();return r=isFinite(r)&&n[r]===e?r:gq(n,e,jr(r,e),this._addedLabels),vq(r,n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:r}=this.getUserBounds();let{min:n,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(n=0),r||(s=this.getLabels().length-1)),this.min=n,this.max=s}buildTicks(){const e=this.min,r=this.max,n=this.options.offset,s=[];let a=this.getLabels();a=e===0&&r===a.length-1?a:a.slice(e,r+1),this._valueRange=Math.max(a.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let i=e;i<=r;i++)s.push({value:i});return s}getLabelForValue(e){return y4.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const r=this.ticks;return e<0||e>r.length-1?null:this.getPixelForValue(r[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function yq(t,e){const r=[],{bounds:s,step:a,min:i,max:l,precision:c,count:d,maxTicks:h,maxDigits:p,includeBounds:x}=t,m=a||1,b=h-1,{min:y,max:w}=e,S=!Vr(i),k=!Vr(l),A=!Vr(d),z=(w-y)/(p+1);let H=x_((w-y)/b/m)*m,V,B,R,O;if(H<1e-14&&!S&&!k)return[{value:y},{value:w}];O=Math.ceil(w/H)-Math.floor(y/H),O>b&&(H=x_(O*H/b/m)*m),Vr(c)||(V=Math.pow(10,c),H=Math.ceil(H*V)/V),s==="ticks"?(B=Math.floor(y/H)*H,R=Math.ceil(w/H)*H):(B=y,R=w),S&&k&&a&&wH((l-i)/a,H/1e3)?(O=Math.round(Math.min((l-i)/H,h)),H=(l-i)/O,B=i,R=l):A?(B=S?i:B,R=k?l:R,O=d-1,H=(R-B)/O):(O=(R-B)/H,Ih(O,Math.round(O),H/1e3)?O=Math.round(O):O=Math.ceil(O));const ee=Math.max(g_(H),g_(B));V=Math.pow(10,Vr(c)?ee:c),B=Math.round(B*V)/V,R=Math.round(R*V)/V;let I=0;for(S&&(x&&B!==i?(r.push({value:i}),B<i&&I++,Ih(Math.round((B+I*H)*V)/V,i,b4(i,z,t))&&I++):B<i&&I++);I<O;++I){const P=Math.round((B+I*H)*V)/V;if(k&&P>l)break;r.push({value:P})}return k&&x&&R!==l?r.length&&Ih(r[r.length-1].value,l,b4(l,z,t))?r[r.length-1].value=l:r.push({value:l}):(!k||R===l)&&r.push({value:R}),r}function b4(t,e,{horizontal:r,minRotation:n}){const s=Go(n),a=(r?Math.sin(s):Math.cos(s))||.001,i=.75*e*(""+t).length;return Math.min(e/a,i)}class uv extends O0{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,r){return Vr(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:r,maxDefined:n}=this.getUserBounds();let{min:s,max:a}=this;const i=c=>s=r?s:c,l=c=>a=n?a:c;if(e){const c=Ll(s),d=Ll(a);c<0&&d<0?l(0):c>0&&d>0&&i(0)}if(s===a){let c=a===0?1:Math.abs(a*.05);l(a+c),e||i(s-c)}this.min=s,this.max=a}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:r,stepSize:n}=e,s;return n?(s=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),r=r||11),r&&(s=Math.min(r,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,r=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const s={maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:r.precision,step:r.stepSize,count:r.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:r.minRotation||0,includeBounds:r.includeBounds!==!1},a=this._range||this,i=yq(s,a);return e.bounds==="ticks"&&_H(i,this,"value"),e.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}configure(){const e=this.ticks;let r=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const s=(n-r)/Math.max(e.length-1,1)/2;r-=s,n+=s}this._startValue=r,this._endValue=n,this._valueRange=n-r}getLabelForValue(e){return xg(e,this.chart.options.locale,this.options.ticks.format)}}class U6 extends uv{static id="linear";static defaults={ticks:{callback:Dy.formatters.numeric}};determineDataLimits(){const{min:e,max:r}=this.getMinMax(!0);this.min=Gs(e)?e:0,this.max=Gs(r)?r:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),r=e?this.width:this.height,n=Go(this.options.ticks.minRotation),s=(e?Math.sin(n):Math.cos(n))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(r/Math.min(40,a.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}function dv(t){const e=t.ticks;if(e.display&&t.display){const r=Ra(e.backdropPadding);return jr(e.font&&e.font.size,rs.font.size)+r.height}return 0}function bq(t,e,r){return r=Mn(r)?r:[r],{w:HH(t,e.string,r),h:r.length*e.lineHeight}}function w4(t,e,r,n,s){return t===n||t===s?{start:e-r/2,end:e+r/2}:t<n||t>s?{start:e-r,end:e}:{start:e,end:e+r}}function wq(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},r=Object.assign({},e),n=[],s=[],a=t._pointLabels.length,i=t.options.pointLabels,l=i.centerPointLabels?Kr/a:0;for(let c=0;c<a;c++){const d=i.setContext(t.getPointLabelContext(c));s[c]=d.padding;const h=t.getPointPosition(c,t.drawingArea+s[c],l),p=Ts(d.font),x=bq(t.ctx,p,t._pointLabels[c]);n[c]=x;const m=ja(t.getIndexAngle(c)+l),b=Math.round(Ty(m)),y=w4(b,h.x,x.w,0,180),w=w4(b,h.y,x.h,90,270);_q(r,e,m,y,w)}t.setCenterPoint(e.l-r.l,r.r-e.r,e.t-r.t,r.b-e.b),t._pointLabelItems=kq(t,n,s)}function _q(t,e,r,n,s){const a=Math.abs(Math.sin(r)),i=Math.abs(Math.cos(r));let l=0,c=0;n.start<e.l?(l=(e.l-n.start)/a,t.l=Math.min(t.l,e.l-l)):n.end>e.r&&(l=(n.end-e.r)/a,t.r=Math.max(t.r,e.r+l)),s.start<e.t?(c=(e.t-s.start)/i,t.t=Math.min(t.t,e.t-c)):s.end>e.b&&(c=(s.end-e.b)/i,t.b=Math.max(t.b,e.b+c))}function Nq(t,e,r){const n=t.drawingArea,{extra:s,additionalAngle:a,padding:i,size:l}=r,c=t.getPointPosition(e,n+s+i,a),d=Math.round(Ty(ja(c.angle+ms))),h=Aq(c.y,l.h,d),p=jq(d),x=Eq(c.x,l.w,p);return{visible:!0,x:c.x,y:h,textAlign:p,left:x,top:h,right:x+l.w,bottom:h+l.h}}function Sq(t,e){if(!e)return!0;const{left:r,top:n,right:s,bottom:a}=t;return!(jc({x:r,y:n},e)||jc({x:r,y:a},e)||jc({x:s,y:n},e)||jc({x:s,y:a},e))}function kq(t,e,r){const n=[],s=t._pointLabels.length,a=t.options,{centerPointLabels:i,display:l}=a.pointLabels,c={extra:dv(a)/2,additionalAngle:i?Kr/s:0};let d;for(let h=0;h<s;h++){c.padding=r[h],c.size=e[h];const p=Nq(t,h,c);n.push(p),l==="auto"&&(p.visible=Sq(p,d),p.visible&&(d=p))}return n}function jq(t){return t===0||t===180?"center":t<180?"left":"right"}function Eq(t,e,r){return r==="right"?t-=e:r==="center"&&(t-=e/2),t}function Aq(t,e,r){return r===90||r===270?t-=e/2:(r>270||r<90)&&(t-=e),t}function Cq(t,e,r){const{left:n,top:s,right:a,bottom:i}=r,{backdropColor:l}=e;if(!Vr(l)){const c=tf(e.borderRadius),d=Ra(e.backdropPadding);t.fillStyle=l;const h=n-d.left,p=s-d.top,x=a-n+d.width,m=i-s+d.height;Object.values(c).some(b=>b!==0)?(t.beginPath(),fp(t,{x:h,y:p,w:x,h:m,radius:c}),t.fill()):t.fillRect(h,p,x,m)}}function Tq(t,e){const{ctx:r,options:{pointLabels:n}}=t;for(let s=e-1;s>=0;s--){const a=t._pointLabelItems[s];if(!a.visible)continue;const i=n.setContext(t.getPointLabelContext(s));Cq(r,i,a);const l=Ts(i.font),{x:c,y:d,textAlign:h}=a;hf(r,t._pointLabels[s],c,d+l.lineHeight/2,l,{color:i.color,textAlign:h,textBaseline:"middle"})}}function z6(t,e,r,n){const{ctx:s}=t;if(r)s.arc(t.xCenter,t.yCenter,e,0,Ln);else{let a=t.getPointPosition(0,e);s.moveTo(a.x,a.y);for(let i=1;i<n;i++)a=t.getPointPosition(i,e),s.lineTo(a.x,a.y)}}function Fq(t,e,r,n,s){const a=t.ctx,i=e.circular,{color:l,lineWidth:c}=e;!i&&!n||!l||!c||r<0||(a.save(),a.strokeStyle=l,a.lineWidth=c,a.setLineDash(s.dash||[]),a.lineDashOffset=s.dashOffset,a.beginPath(),z6(t,r,i,n),a.closePath(),a.stroke(),a.restore())}function Pq(t,e,r){return od(t,{label:r,index:e,type:"pointLabel"})}class Lq extends uv{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Dy.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=Ra(dv(this.options)/2),r=this.width=this.maxWidth-e.width,n=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+r/2+e.left),this.yCenter=Math.floor(this.top+n/2+e.top),this.drawingArea=Math.floor(Math.min(r,n)/2)}determineDataLimits(){const{min:e,max:r}=this.getMinMax(!1);this.min=Gs(e)&&!isNaN(e)?e:0,this.max=Gs(r)&&!isNaN(r)?r:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/dv(this.options))}generateTickLabels(e){uv.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((r,n)=>{const s=wn(this.options.pointLabels.callback,[r,n],this);return s||s===0?s:""}).filter((r,n)=>this.chart.getDataVisibility(n))}fit(){const e=this.options;e.display&&e.pointLabels.display?wq(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,r,n,s){this.xCenter+=Math.floor((e-r)/2),this.yCenter+=Math.floor((n-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,r,n,s))}getIndexAngle(e){const r=Ln/(this._pointLabels.length||1),n=this.options.startAngle||0;return ja(e*r+Go(n))}getDistanceFromCenterForValue(e){if(Vr(e))return NaN;const r=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*r:(e-this.min)*r}getValueForDistanceFromCenter(e){if(Vr(e))return NaN;const r=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-r:this.min+r}getPointLabelContext(e){const r=this._pointLabels||[];if(e>=0&&e<r.length){const n=r[e];return Pq(this.getContext(),e,n)}}getPointPosition(e,r,n=0){const s=this.getIndexAngle(e)-ms+n;return{x:Math.cos(s)*r+this.xCenter,y:Math.sin(s)*r+this.yCenter,angle:s}}getPointPositionForValue(e,r){return this.getPointPosition(e,this.getDistanceFromCenterForValue(r))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:r,top:n,right:s,bottom:a}=this._pointLabelItems[e];return{left:r,top:n,right:s,bottom:a}}drawBackground(){const{backgroundColor:e,grid:{circular:r}}=this.options;if(e){const n=this.ctx;n.save(),n.beginPath(),z6(this,this.getDistanceFromCenterForValue(this._endValue),r,this._pointLabels.length),n.closePath(),n.fillStyle=e,n.fill(),n.restore()}}drawGrid(){const e=this.ctx,r=this.options,{angleLines:n,grid:s,border:a}=r,i=this._pointLabels.length;let l,c,d;if(r.pointLabels.display&&Tq(this,i),s.display&&this.ticks.forEach((h,p)=>{if(p!==0||p===0&&this.min<0){c=this.getDistanceFromCenterForValue(h.value);const x=this.getContext(p),m=s.setContext(x),b=a.setContext(x);Fq(this,m,c,i,b)}}),n.display){for(e.save(),l=i-1;l>=0;l--){const h=n.setContext(this.getPointLabelContext(l)),{color:p,lineWidth:x}=h;!x||!p||(e.lineWidth=x,e.strokeStyle=p,e.setLineDash(h.borderDash),e.lineDashOffset=h.borderDashOffset,c=this.getDistanceFromCenterForValue(r.reverse?this.min:this.max),d=this.getPointPosition(l,c),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(d.x,d.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,r=this.options,n=r.ticks;if(!n.display)return;const s=this.getIndexAngle(0);let a,i;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(s),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((l,c)=>{if(c===0&&this.min>=0&&!r.reverse)return;const d=n.setContext(this.getContext(c)),h=Ts(d.font);if(a=this.getDistanceFromCenterForValue(this.ticks[c].value),d.showLabelBackdrop){e.font=h.string,i=e.measureText(l.label).width,e.fillStyle=d.backdropColor;const p=Ra(d.backdropPadding);e.fillRect(-i/2-p.left,-a-h.size/2-p.top,i+p.width,h.size+p.height)}hf(e,l.label,0,-a,h,{color:d.color,strokeColor:d.textStrokeColor,strokeWidth:d.textStrokeWidth})}),e.restore()}drawTitle(){}}const _g={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},fi=Object.keys(_g);function _4(t,e){return t-e}function N4(t,e){if(Vr(e))return null;const r=t._adapter,{parser:n,round:s,isoWeekday:a}=t._parseOpts;let i=e;return typeof n=="function"&&(i=n(i)),Gs(i)||(i=typeof n=="string"?r.parse(i,n):r.parse(i)),i===null?null:(s&&(i=s==="week"&&(up(a)||a===!0)?r.startOf(i,"isoWeek",a):r.startOf(i,s)),+i)}function S4(t,e,r,n){const s=fi.length;for(let a=fi.indexOf(t);a<s-1;++a){const i=_g[fi[a]],l=i.steps?i.steps:Number.MAX_SAFE_INTEGER;if(i.common&&Math.ceil((r-e)/(l*i.size))<=n)return fi[a]}return fi[s-1]}function Dq(t,e,r,n,s){for(let a=fi.length-1;a>=fi.indexOf(r);a--){const i=fi[a];if(_g[i].common&&t._adapter.diff(s,n,i)>=e-1)return i}return fi[r?fi.indexOf(r):0]}function Rq(t){for(let e=fi.indexOf(t)+1,r=fi.length;e<r;++e)if(_g[fi[e]].common)return fi[e]}function k4(t,e,r){if(!r)t[e]=!0;else if(r.length){const{lo:n,hi:s}=Fy(r,e),a=r[n]>=e?r[n]:r[s];t[a]=!0}}function Iq(t,e,r,n){const s=t._adapter,a=+s.startOf(e[0].value,n),i=e[e.length-1].value;let l,c;for(l=a;l<=i;l=+s.add(l,1,n))c=r[l],c>=0&&(e[c].major=!0);return e}function j4(t,e,r){const n=[],s={},a=e.length;let i,l;for(i=0;i<a;++i)l=e[i],s[l]=i,n.push({value:l,major:!1});return a===0||!r?n:Iq(t,n,s,r)}class E4 extends O0{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,r={}){const n=e.time||(e.time={}),s=this._adapter=new cW._date(e.adapters.date);s.init(r),Rh(n.displayFormats,s.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=r.normalized}parse(e,r){return e===void 0?null:N4(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,r=this._adapter,n=e.time.unit||"day";let{min:s,max:a,minDefined:i,maxDefined:l}=this.getUserBounds();function c(d){!i&&!isNaN(d.min)&&(s=Math.min(s,d.min)),!l&&!isNaN(d.max)&&(a=Math.max(a,d.max))}(!i||!l)&&(c(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&c(this.getMinMax(!1))),s=Gs(s)&&!isNaN(s)?s:+r.startOf(Date.now(),n),a=Gs(a)&&!isNaN(a)?a:+r.endOf(Date.now(),n)+1,this.min=Math.min(s,a-1),this.max=Math.max(s+1,a)}_getLabelBounds(){const e=this.getLabelTimestamps();let r=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(r=e[0],n=e[e.length-1]),{min:r,max:n}}buildTicks(){const e=this.options,r=e.time,n=e.ticks,s=n.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const a=this.min,i=this.max,l=jH(s,a,i);return this._unit=r.unit||(n.autoSkip?S4(r.minUnit,this.min,this.max,this._getLabelCapacity(a)):Dq(this,l.length,r.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:Rq(this._unit),this.initOffsets(s),e.reverse&&l.reverse(),j4(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let r=0,n=0,s,a;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?r=1-s:r=(this.getDecimalForValue(e[1])-s)/2,a=this.getDecimalForValue(e[e.length-1]),e.length===1?n=a:n=(a-this.getDecimalForValue(e[e.length-2]))/2);const i=e.length<3?.5:.25;r=Fa(r,0,i),n=Fa(n,0,i),this._offsets={start:r,end:n,factor:1/(r+1+n)}}_generate(){const e=this._adapter,r=this.min,n=this.max,s=this.options,a=s.time,i=a.unit||S4(a.minUnit,r,n,this._getLabelCapacity(r)),l=jr(s.ticks.stepSize,1),c=i==="week"?a.isoWeekday:!1,d=up(c)||c===!0,h={};let p=r,x,m;if(d&&(p=+e.startOf(p,"isoWeek",c)),p=+e.startOf(p,d?"day":i),e.diff(n,r,i)>1e5*l)throw new Error(r+" and "+n+" are too far apart with stepSize of "+l+" "+i);const b=s.ticks.source==="data"&&this.getDataTimestamps();for(x=p,m=0;x<n;x=+e.add(x,l,i),m++)k4(h,x,b);return(x===n||s.bounds==="ticks"||m===1)&&k4(h,x,b),Object.keys(h).sort(_4).map(y=>+y)}getLabelForValue(e){const r=this._adapter,n=this.options.time;return n.tooltipFormat?r.format(e,n.tooltipFormat):r.format(e,n.displayFormats.datetime)}format(e,r){const s=this.options.time.displayFormats,a=this._unit,i=r||s[a];return this._adapter.format(e,i)}_tickFormatFunction(e,r,n,s){const a=this.options,i=a.ticks.callback;if(i)return wn(i,[e,r,n],this);const l=a.time.displayFormats,c=this._unit,d=this._majorUnit,h=c&&l[c],p=d&&l[d],x=n[r],m=d&&p&&x&&x.major;return this._adapter.format(e,s||(m?p:h))}generateTickLabels(e){let r,n,s;for(r=0,n=e.length;r<n;++r)s=e[r],s.label=this._tickFormatFunction(s.value,r,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const r=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((r.start+n)*r.factor)}getValueForPixel(e){const r=this._offsets,n=this.getDecimalForPixel(e)/r.factor-r.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const r=this.options.ticks,n=this.ctx.measureText(e).width,s=Go(this.isHorizontal()?r.maxRotation:r.minRotation),a=Math.cos(s),i=Math.sin(s),l=this._resolveTickFontOptions(0).size;return{w:n*a+l*i,h:n*i+l*a}}_getLabelCapacity(e){const r=this.options.time,n=r.displayFormats,s=n[r.unit]||n.millisecond,a=this._tickFormatFunction(e,0,j4(this,[e],this._majorUnit),s),i=this._getLabelSize(a),l=Math.floor(this.isHorizontal()?this.width/i.w:this.height/i.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],r,n;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(r=0,n=s.length;r<n;++r)e=e.concat(s[r].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let r,n;if(e.length)return e;const s=this.getLabels();for(r=0,n=s.length;r<n;++r)e.push(N4(this,s[r]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Yk(e.sort(_4))}}function qm(t,e,r){let n=0,s=t.length-1,a,i,l,c;r?(e>=t[n].pos&&e<=t[s].pos&&({lo:n,hi:s}=Gd(t,"pos",e)),{pos:a,time:l}=t[n],{pos:i,time:c}=t[s]):(e>=t[n].time&&e<=t[s].time&&({lo:n,hi:s}=Gd(t,"time",e)),{time:a,pos:l}=t[n],{time:i,pos:c}=t[s]);const d=i-a;return d?l+(c-l)*(e-a)/d:l}class EG extends E4{static id="timeseries";static defaults=E4.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),r=this._table=this.buildLookupTable(e);this._minPos=qm(r,this.min),this._tableRange=qm(r,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:r,max:n}=this,s=[],a=[];let i,l,c,d,h;for(i=0,l=e.length;i<l;++i)d=e[i],d>=r&&d<=n&&s.push(d);if(s.length<2)return[{time:r,pos:0},{time:n,pos:1}];for(i=0,l=s.length;i<l;++i)h=s[i+1],c=s[i-1],d=s[i],Math.round((h+c)/2)!==d&&a.push({time:d,pos:i/(l-1)});return a}_generate(){const e=this.min,r=this.max;let n=super.getDataTimestamps();return(!n.includes(e)||!n.length)&&n.splice(0,0,e),(!n.includes(r)||n.length===1)&&n.push(r),n.sort((s,a)=>s-a)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const r=this.getDataTimestamps(),n=this.getLabelTimestamps();return r.length&&n.length?e=this.normalize(r.concat(n)):e=r.length?r:n,e=this._cache.all=e,e}getDecimalForValue(e){return(qm(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const r=this._offsets,n=this.getDecimalForPixel(e)/r.factor-r.end;return qm(this._table,n*this._tableRange+this._minPos,!0)}}const H6="label";function A4(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function Oq(t,e){const r=t.options;r&&e&&Object.assign(r,e)}function $6(t,e){t.labels=e}function W6(t,e,r=H6){const n=[];t.datasets=e.map(s=>{const a=t.datasets.find(i=>i[r]===s[r]);return!a||!s.data||n.includes(a)?{...s}:(n.push(a),Object.assign(a,s),a)})}function Mq(t,e=H6){const r={labels:[],datasets:[]};return $6(r,t.labels),W6(r,t.datasets,e),r}function Bq(t,e){const{height:r=150,width:n=300,redraw:s=!1,datasetIdKey:a,type:i,data:l,options:c,plugins:d=[],fallbackContent:h,updateMode:p,...x}=t,m=Q.useRef(null),b=Q.useRef(null),y=()=>{m.current&&(b.current=new Lp(m.current,{type:i,data:Mq(l,a),options:c&&{...c},plugins:d}),A4(e,b.current))},w=()=>{A4(e,null),b.current&&(b.current.destroy(),b.current=null)};return Q.useEffect(()=>{!s&&b.current&&c&&Oq(b.current,c)},[s,c]),Q.useEffect(()=>{!s&&b.current&&$6(b.current.config.data,l.labels)},[s,l.labels]),Q.useEffect(()=>{!s&&b.current&&l.datasets&&W6(b.current.config.data,l.datasets,a)},[s,l.datasets]),Q.useEffect(()=>{b.current&&(s?(w(),setTimeout(y)):b.current.update(p))},[s,c,l.labels,l.datasets,p]),Q.useEffect(()=>{b.current&&(w(),setTimeout(y))},[i]),Q.useEffect(()=>(y(),()=>w()),[]),o.jsx("canvas",{ref:m,role:"img",height:r,width:n,...x,children:h})}const Uq=Q.forwardRef(Bq);function Rp(t,e){return Lp.register(e),Q.forwardRef((r,n)=>o.jsx(Uq,{...r,ref:n,type:t}))}const V6=Rp("line",iW),fv=Rp("bar",sW),q6=Rp("doughnut",p6),zq=Rp("polarArea",oW),G6=Rp("pie",lW);Lp.register(B6,U6,C6,I6,M6,D6,S6,E6,Dp,P6);const Hq=()=>{const{user:t}=Jr(),e=t?.username==="davidlopez10",[r,n]=Q.useState(!0),[s,a]=Q.useState(""),[i,l]=Q.useState(30),[c,d]=Q.useState({}),[h,p]=Q.useState([]),[x,m]=Q.useState([]),[b,y]=Q.useState([]),[w,S]=Q.useState([]),[k,A]=Q.useState([]),[z,H]=Q.useState([]),[V,B]=Q.useState([]),[R,O]=Q.useState([]),[ee,I]=Q.useState([]),[P,ae]=Q.useState([]),[G,M]=Q.useState({});Q.useEffect(()=>{te()},[i]);const te=async()=>{try{n(!0),a(""),console.log("Cargando overview...");try{const Z=await ro.getOverview();d(Z.data),console.log("Overview cargado exitosamente")}catch(Z){console.error("Error cargando overview:",Z)}console.log("Cargando incidencias por sede...");try{const Z=await ro.getIncidentsBySede();p(Z.data),console.log("Incidencias por sede cargadas exitosamente")}catch(Z){console.error("Error cargando incidencias por sede:",Z)}console.log("Cargando incidencias por departamento...");try{const Z=await ro.getIncidentsByDepartment();m(Z.data),console.log("Incidencias por departamento cargadas exitosamente")}catch(Z){console.error("Error cargando incidencias por departamento:",Z)}console.log("Cargando incidencias por tipo de falla...");try{const Z=await ro.getIncidentsByFailureType();y(Z.data),console.log("Incidencias por tipo de falla cargadas exitosamente")}catch(Z){console.error("Error cargando incidencias por tipo de falla:",Z)}console.log("Cargando tendencia temporal...");try{const Z=await ro.getTemporalTrend(i);S(Z.data),console.log("Tendencia temporal cargada exitosamente")}catch(Z){console.error("Error cargando tendencia temporal:",Z)}console.log("Cargando estaciones que ms fallan...");try{const Z=await ro.getTopFailingStations(10);A(Z.data),console.log("Estaciones que ms fallan cargadas exitosamente")}catch(Z){console.error("Error cargando estaciones que ms fallan:",Z)}console.log("Cargando rendimiento de tcnicos...");try{const Z=await ro.getTechnicianPerformance();H(Z.data),console.log("Rendimiento de tcnicos cargado exitosamente")}catch(Z){console.error("Error cargando rendimiento de tcnicos:",Z)}console.log("Cargando reportes por usuario...");try{const Z=await ro.getReportsByUser();B(Z.data),console.log("Reportes por usuario cargados exitosamente")}catch(Z){console.error("Error cargando reportes por usuario:",Z)}console.log("Cargando distribucin por hora...");try{const Z=await ro.getHourlyDistribution();O(Z.data),console.log("Distribucin por hora cargada exitosamente")}catch(Z){console.error("Error cargando distribucin por hora:",Z)}console.log("Cargando distribucin por da de semana...");try{const Z=await ro.getWeekdayDistribution();I(Z.data),console.log("Distribucin por da de semana cargada exitosamente")}catch(Z){console.error("Error cargando distribucin por da de semana:",Z)}console.log("Cargando anlisis de tiempo de resolucin...");try{const Z=await ro.getResolutionTimeAnalysis();ae(Z.data),console.log("Anlisis de tiempo de resolucin cargado exitosamente")}catch(Z){console.error("Error cargando anlisis de tiempo de resolucin:",Z)}console.log("Cargando mtricas de calidad...");try{const Z=await ro.getQualityMetrics();M(Z.data),console.log("Mtricas de calidad cargadas exitosamente")}catch(Z){console.error("Error cargando mtricas de calidad:",Z)}}catch(Z){console.error("Error general cargando analticas:",Z),a("Error al cargar los datos analticos")}finally{n(!1)}},ie=e?{primary:["#00E5FF","#00B4D8","#E10600","#FF6A00","#00E5FF","#00B4D8","#E10600","#FF6A00"],gradient:{blue:"rgba(0, 229, 255, 0.6)",green:"rgba(0, 180, 216, 0.6)",yellow:"rgba(255, 106, 0, 0.6)"}}:{primary:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4","#84CC16","#F97316"],gradient:{blue:"rgba(59, 130, 246, 0.6)",green:"rgba(16, 185, 129, 0.6)",yellow:"rgba(245, 158, 11, 0.6)"}},le={labels:h.map(Z=>({bogota:"Bogot",barranquilla:"Barranquilla",villavicencio:"Villavicencio"})[Z.sede]||Z.sede),datasets:[{label:"Pendientes",data:h.map(Z=>Z.pendiente),backgroundColor:ie.gradient.yellow,borderColor:e?"#FF6A00":"#F59E0B",borderWidth:2},{label:"En Proceso",data:h.map(Z=>Z.en_proceso),backgroundColor:ie.gradient.blue,borderColor:e?"#00E5FF":"#3B82F6",borderWidth:2},{label:"En Supervisin",data:h.map(Z=>Z.en_supervision),backgroundColor:e?"rgba(0, 180, 216, 0.6)":"#8B5CF6",borderColor:e?"#00B4D8":"#7C3AED",borderWidth:2},{label:"Aprobadas",data:h.map(Z=>Z.aprobado),backgroundColor:ie.gradient.green,borderColor:e?"#00B4D8":"#10B981",borderWidth:2}]},X={labels:b.map(Z=>({pantalla:"Pantalla",perifericos:"Perifricos",internet:"Internet",software:"Software",otro:"Otro"})[Z.failure_type]||Z.failure_type),datasets:[{data:b.map(Z=>Z.total),backgroundColor:ie.primary,borderColor:"#ffffff",borderWidth:2,hoverBackgroundColor:ie.primary.map(Z=>Z+"80")}]},fe={labels:w.map(Z=>new Date(Z.date).toLocaleDateString()),datasets:[{label:"Incidencias Creadas",data:w.map(Z=>Z.total),borderColor:e?"#00E5FF":"#3B82F6",backgroundColor:e?"rgba(0, 229, 255, 0.15)":"rgba(59, 130, 246, 0.1)",tension:.4,fill:!0,pointBackgroundColor:e?"#00E5FF":"#3B82F6",pointBorderColor:e?"#0B0F14":"#ffffff",pointBorderWidth:2,pointRadius:4},{label:"Incidencias Resueltas",data:w.map(Z=>Z.resolved),borderColor:e?"#FF6A00":"#10B981",backgroundColor:e?"rgba(255, 106, 0, 0.15)":"rgba(16, 185, 129, 0.1)",tension:.4,fill:!0,pointBackgroundColor:e?"#FF6A00":"#10B981",pointBorderColor:e?"#0B0F14":"#ffffff",pointBorderWidth:2,pointRadius:4}]},K={labels:R.map(Z=>`${Z.hour}:00`),datasets:[{label:"Incidencias por Hora",data:R.map(Z=>Z.total_incidents),backgroundColor:ie.gradient.blue,borderColor:e?"#00E5FF":"#3B82F6",borderWidth:2,borderRadius:4,borderSkipped:!1}]},E={labels:ee.map(Z=>({Sunday:"Domingo",Monday:"Lunes",Tuesday:"Martes",Wednesday:"Mircoles",Thursday:"Jueves",Friday:"Viernes",Saturday:"Sbado"})[Z.day_name]||Z.day_name),datasets:[{data:ee.map(Z=>Z.total_incidents),backgroundColor:ie.primary.slice(0,7),borderColor:"#ffffff",borderWidth:2}]},W={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{padding:20,usePointStyle:!0,font:{size:12},color:e?"#E5E7EB":void 0}},tooltip:{backgroundColor:e?"rgba(15, 23, 42, 0.95)":"rgba(0, 0, 0, 0.8)",titleColor:e?"#00E5FF":"#ffffff",bodyColor:"#ffffff",borderColor:e?"#00E5FF":"#ffffff",borderWidth:1,cornerRadius:8,displayColors:!0,intersect:!1,mode:"index"}},scales:{x:{grid:{display:!1,color:e?"rgba(0, 229, 255, 0.1)":void 0},ticks:{font:{size:11},color:e?"#94A3B8":void 0}},y:{grid:{color:e?"rgba(0, 229, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},ticks:{font:{size:11},color:e?"#94A3B8":void 0}}}},L={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{padding:20,usePointStyle:!0,font:{size:12},color:e?"#E5E7EB":void 0}},tooltip:{backgroundColor:e?"rgba(15, 23, 42, 0.95)":"rgba(0, 0, 0, 0.8)",titleColor:e?"#00E5FF":"#ffffff",bodyColor:"#ffffff",borderColor:e?"#00E5FF":void 0,borderWidth:e?1:0,callbacks:{label:function(Z){const Se=Z.dataset.data.reduce((ue,nt)=>ue+nt,0),We=(Z.parsed*100/Se).toFixed(1);return`${Z.label}: ${Z.parsed} (${We}%)`}}}}};if(r)return o.jsx("div",{className:`flex items-center justify-center h-64 ${e?"bg-[#0B0F14] rounded-xl":""}`,children:o.jsx("div",{className:`animate-spin rounded-full h-12 w-12 border-b-2 ${e?"border-[#00E5FF]":"border-blue-600"}`})});if(s)return o.jsx("div",{className:`border rounded-md p-4 ${e?"bg-red-500/10 border-red-500/30":"bg-red-50 border-red-200"}`,children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(mi,{className:`h-5 w-5 mr-2 ${e?"text-[#E10600]":"text-red-400"}`}),o.jsx("p",{className:e?"text-[#E10600]":"text-red-700",children:s})]})});const F=e?"bg-[#0F172A] rounded-lg shadow-lg shadow-cyan-500/10 p-6 border border-cyan-500/20":"bg-white rounded-lg shadow p-6",q=e?"text-[#E5E7EB]":"text-gray-900",he=e?"text-[#94A3B8]":"text-gray-600",me=Z=>e?"p-2 bg-[#0B0F14] rounded-lg border border-cyan-500/30":`p-2 ${Z} rounded-lg`;return o.jsxs("div",{className:`space-y-6 ${e?"bg-[#0B0F14] p-6 rounded-xl":""}`,children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[o.jsxs("div",{children:[o.jsx("h1",{className:`text-2xl font-bold ${q} ${e?"ironman-glow":""}`,children:e?"J.A.R.V.I.S. Analytics":"Analticas del Sistema"}),o.jsx("p",{className:`${he} mt-1`,children:"Anlisis completo de incidencias, rendimiento y mtricas de calidad"})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("select",{value:i,onChange:Z=>l(parseInt(Z.target.value)),className:`border rounded-md px-3 py-2 focus:outline-none focus:ring-2 ${e?"border-cyan-500/30 bg-[#0F172A] text-[#E5E7EB] focus:ring-cyan-500/50 focus:border-cyan-500":"border-gray-300 bg-white focus:ring-blue-500 focus:border-blue-500"}`,children:[o.jsx("option",{value:7,children:"ltimos 7 das"}),o.jsx("option",{value:30,children:"ltimos 30 das"}),o.jsx("option",{value:90,children:"ltimos 90 das"}),o.jsx("option",{value:365,children:"ltimo ao"})]}),o.jsxs("button",{onClick:te,className:`inline-flex items-center px-3 py-2 border rounded-md text-sm font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 ${e?"border-cyan-500/30 text-[#00E5FF] bg-[#0F172A] hover:bg-[#0B0F14] focus:ring-cyan-500/50":"border-gray-300 text-gray-700 bg-white hover:bg-gray-50 focus:ring-blue-500"}`,children:[o.jsx(Pc,{className:`h-4 w-4 mr-2 ${e?"text-[#00E5FF]":""}`}),"Actualizar"]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[o.jsx("div",{className:F,children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:me("bg-blue-100"),children:o.jsx(Fn,{className:`h-6 w-6 ${e?"text-[#00E5FF]":"text-blue-600"}`})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:`text-sm font-medium ${he}`,children:"Total Incidencias"}),o.jsx("p",{className:`text-2xl font-bold ${q}`,children:c.total_incidents||0})]})]})}),o.jsx("div",{className:F,children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:me("bg-green-100"),children:o.jsx(_v,{className:`h-6 w-6 ${e?"text-[#00B4D8]":"text-green-600"}`})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:`text-sm font-medium ${he}`,children:"Tasa de Resolucin"}),o.jsxs("p",{className:`text-2xl font-bold ${q}`,children:[c.total_incidents?Math.round(c.approved_incidents/c.total_incidents*100):0,"%"]})]})]})}),o.jsx("div",{className:F,children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:me("bg-yellow-100"),children:o.jsx(qs,{className:`h-6 w-6 ${e?"text-[#FF6A00]":"text-yellow-600"}`})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:`text-sm font-medium ${he}`,children:"Tiempo Promedio"}),o.jsxs("p",{className:`text-2xl font-bold ${q}`,children:[Math.round(c.avg_resolution_time_hours||0),"h"]})]})]})}),o.jsx("div",{className:F,children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:me("bg-purple-100"),children:o.jsx(Gu,{className:`h-6 w-6 ${e?"text-[#E10600]":"text-purple-600"}`})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:`text-sm font-medium ${he}`,children:"Tcnicos Activos"}),o.jsx("p",{className:`text-2xl font-bold ${q}`,children:c.total_technicians||0})]})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs("div",{className:F,children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("h3",{className:`text-lg font-semibold ${q} flex items-center`,children:[o.jsx(Ac,{className:`h-5 w-5 ${e?"text-[#00E5FF]":"text-blue-600"} mr-2`}),"Incidencias por Sede"]})}),o.jsx("div",{className:"h-80",children:o.jsx(fv,{data:le,options:W})})]}),o.jsxs("div",{className:F,children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("h3",{className:`text-lg font-semibold ${q} flex items-center`,children:[o.jsx(b3,{className:`h-5 w-5 ${e?"text-[#00B4D8]":"text-green-600"} mr-2`}),"Distribucin por Tipo de Falla"]})}),o.jsx("div",{className:"h-80",children:o.jsx(G6,{data:X,options:L})})]})]}),o.jsxs("div",{className:F,children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("h3",{className:`text-lg font-semibold ${q} flex items-center`,children:[o.jsx(Wh,{className:`h-5 w-5 ${e?"text-[#FF6A00]":"text-purple-600"} mr-2`}),"Tendencia Temporal (",i," das)"]})}),o.jsx("div",{className:"h-80",children:o.jsx(V6,{data:fe,options:W})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs("div",{className:F,children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("h3",{className:`text-lg font-semibold ${q} flex items-center`,children:[o.jsx(qs,{className:`h-5 w-5 ${e?"text-[#FF6A00]":"text-orange-600"} mr-2`}),"Distribucin por Hora del Da"]})}),o.jsx("div",{className:"h-80",children:o.jsx(fv,{data:K,options:W})})]}),o.jsxs("div",{className:F,children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("h3",{className:`text-lg font-semibold ${q} flex items-center`,children:[o.jsx(ia,{className:`h-5 w-5 ${e?"text-[#00E5FF]":"text-indigo-600"} mr-2`}),"Distribucin por Da de la Semana"]})}),o.jsx("div",{className:"h-80",children:o.jsx(q6,{data:E,options:L})})]})]}),o.jsxs("div",{className:F,children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("h3",{className:`text-lg font-semibold ${q} flex items-center`,children:[o.jsx(mi,{className:`h-5 w-5 ${e?"text-[#E10600]":"text-red-600"} mr-2`}),"Top 10 Estaciones con Ms Fallas"]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:`min-w-full divide-y ${e?"divide-cyan-500/20":"divide-gray-200"}`,children:[o.jsx("thead",{className:e?"bg-[#0B0F14]":"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Estacin"}),o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Sede"}),o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Departamento"}),o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Total Incidencias"}),o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Pendientes"}),o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Resueltas"}),o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Tiempo Promedio"})]})}),o.jsx("tbody",{className:`${e?"bg-[#0F172A]":"bg-white"} divide-y ${e?"divide-cyan-500/10":"divide-gray-200"}`,children:k.map((Z,Se)=>o.jsxs("tr",{className:e?"":Se%2===0?"bg-white":"bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("span",{className:`inline-flex items-center justify-center h-8 w-8 rounded-full text-xs font-bold text-white ${e?Se<3?"bg-[#E10600]":Se<6?"bg-[#FF6A00]":"bg-[#00B4D8]":Se<3?"bg-red-500":Se<6?"bg-yellow-500":"bg-gray-500"}`,children:Se+1})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("div",{className:`text-sm font-medium ${q}`,children:Z.station_code}),o.jsx("div",{className:`text-sm ${he}`,children:Z.location_details})]})]})}),o.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${q} capitalize`,children:Z.sede}),o.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${q} capitalize`,children:Z.departamento}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${e?"bg-cyan-500/20 text-[#00E5FF]":"bg-blue-100 text-blue-800"}`,children:Z.total_incidents})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${e?"bg-orange-500/20 text-[#FF6A00]":"bg-yellow-100 text-yellow-800"}`,children:Z.pending})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${e?"bg-cyan-500/20 text-[#00B4D8]":"bg-green-100 text-green-800"}`,children:Z.resolved})}),o.jsxs("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${q}`,children:[Math.round(Z.avg_resolution_time_hours||0),"h"]})]},Z.station_code))})]})})]}),o.jsxs("div",{className:F,children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("h3",{className:`text-lg font-semibold ${q} flex items-center`,children:[o.jsx(Gu,{className:`h-5 w-5 ${e?"text-[#00B4D8]":"text-green-600"} mr-2`}),"Rendimiento de Tcnicos"]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:`min-w-full divide-y ${e?"divide-cyan-500/20":"divide-gray-200"}`,children:[o.jsx("thead",{className:e?"bg-[#0B0F14]":"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Tcnico"}),o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Sede"}),o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Asignadas"}),o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Resueltas"}),o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"En Trabajo"}),o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Tiempo Promedio"}),o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Calificacin"})]})}),o.jsx("tbody",{className:`${e?"bg-[#0F172A]":"bg-white"} divide-y ${e?"divide-cyan-500/10":"divide-gray-200"}`,children:z.map((Z,Se)=>o.jsxs("tr",{className:e?"":Se%2===0?"bg-white":"bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:`text-sm font-medium ${q}`,children:Z.full_name})}),o.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${q} capitalize`,children:Z.sede}),o.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${q}`,children:Z.total_assigned||0}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${e?"bg-cyan-500/20 text-[#00B4D8]":"bg-green-100 text-green-800"}`,children:Z.total_resolved||0})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${e?"bg-cyan-500/20 text-[#00E5FF]":"bg-blue-100 text-blue-800"}`,children:Z.currently_working||0})}),o.jsxs("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${q}`,children:[Math.round(Z.avg_resolution_time_hours||0),"h"]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(Dc,{className:`h-4 w-4 ${e?"text-[#FF6A00]":"text-yellow-400"} mr-1`}),o.jsx("span",{className:`text-sm font-medium ${q}`,children:parseFloat(Z.avg_rating||0).toFixed(1)}),o.jsxs("span",{className:`text-xs ${he} ml-1`,children:["(",Z.total_ratings||0,")"]})]})})]},Z.id))})]})})]}),o.jsxs("div",{className:F,children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("h3",{className:`text-lg font-semibold ${q} flex items-center`,children:[o.jsx(ux,{className:`h-5 w-5 ${e?"text-[#00E5FF]":"text-purple-600"} mr-2`}),"Top Usuarios que Ms Reportan"]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:`min-w-full divide-y ${e?"divide-cyan-500/20":"divide-gray-200"}`,children:[o.jsx("thead",{className:e?"bg-[#0B0F14]":"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Usuario"}),o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Rol"}),o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Sede"}),o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Total Reportes"}),o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Pendientes"}),o.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${he} uppercase tracking-wider`,children:"Resueltos"})]})}),o.jsx("tbody",{className:`${e?"bg-[#0F172A]":"bg-white"} divide-y ${e?"divide-cyan-500/10":"divide-gray-200"}`,children:V.slice(0,10).map((Z,Se)=>o.jsxs("tr",{className:e?"":Se%2===0?"bg-white":"bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:`text-sm font-medium ${q}`,children:Z.full_name})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full capitalize ${e?"bg-[#0B0F14] text-[#94A3B8] border border-cyan-500/20":"bg-gray-100 text-gray-800"}`,children:Z.role})}),o.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${q} capitalize`,children:Z.sede}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${e?"bg-cyan-500/20 text-[#00E5FF]":"bg-blue-100 text-blue-800"}`,children:Z.total_reports})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${e?"bg-orange-500/20 text-[#FF6A00]":"bg-yellow-100 text-yellow-800"}`,children:Z.pending_reports})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${e?"bg-cyan-500/20 text-[#00B4D8]":"bg-green-100 text-green-800"}`,children:Z.resolved_reports})})]},Z.full_name))})]})})]})]})},c2="http://31.97.138.23:5001/api",hv=({isOpen:t,onClose:e,activo:r=null,onSuccess:n})=>{const[s,a]=Q.useState({numero_placa:"",centro_costes:1,ubicacion:"Claro",responsable:"David Acero",proveedor:"",valor:"",fecha_compra:"",numero_social:"",poliza:"",aseguradora:"",garantia:"No",fecha_vencimiento_garantia:"",orden_compra:"",clasificacion:"Activo no productivo",clasificacion_activo_fijo:"",adjunto_archivo:null,site:"Site A",puesto:"",asignado:"",marca_modelo:"",numero_serie_fabricante:"",cpu_procesador:"",memoria_ram:"",almacenamiento:"",sistema_operativo:"",pulgadas:"",estado:"funcional"}),[i,l]=Q.useState([]),[c,d]=Q.useState(!1),[h,p]=Q.useState(""),[x,m]=Q.useState(""),[b,y]=Q.useState(""),w=["Claro","Obama","IT","Contratacin","Reclutamiento","Seleccin","Finanzas"],S=["Activo productivo","Activo no productivo"],k=["Site A","Site B"],A=["funcional","en_reparacion","dado_de_baja","en_mantenimiento","disponible","asignado","fuera_de_servicio"],z=O=>{if(!O)return"";const ee=O.toUpperCase();return ee.match(/^ECC[-']CPU[-']\d+$/)?"ECC-CPU":ee.match(/^ECC[-']SER[-']\d+$/)?"ECC-SER":ee.match(/^ECC[-']MON[-']\d+$/)?"ECC-MON":ee.match(/^ECC[-']IMP[-']\d+$/)?"ECC-IMP":ee.match(/^ECC[-']POR[-']\d+$/)?"ECC-POR":ee.match(/^ECC[-']TV[-']\d+$/)?"ECC-TV":ee.startsWith("ECC-CPU")||ee.startsWith("ECC'CPU")?"ECC-CPU":ee.startsWith("ECC-SER")||ee.startsWith("ECC'SER")?"ECC-SER":ee.startsWith("ECC-MON")||ee.startsWith("ECC'MON")?"ECC-MON":ee.startsWith("ECC-IMP")||ee.startsWith("ECC'IMP")?"ECC-IMP":ee.startsWith("ECC-POR")||ee.startsWith("ECC'POR")?"ECC-POR":ee.startsWith("ECC-TV")||ee.startsWith("ECC'TV")?"ECC-TV":"OTHER"};Q.useEffect(()=>{t&&(H(),r?(a({numero_placa:r.numero_placa||"",centro_costes:r.centro_costes||1,ubicacion:r.ubicacion||"",responsable:r.responsable||"",proveedor:r.proveedor||"",valor:r.valor||"",fecha_compra:r.fecha_compra||"",numero_social:r.numero_social||"",poliza:r.poliza||"",aseguradora:r.aseguradora||"",garantia:r.garantia||"No",fecha_vencimiento_garantia:r.fecha_vencimiento_garantia||"",orden_compra:r.orden_compra||"",clasificacion:r.clasificacion||"",clasificacion_activo_fijo:r.clasificacion_activo_fijo||"",adjunto_archivo:null,site:r.site||"",puesto:r.puesto||"",asignado:r.asignado||"",marca_modelo:r.marca_modelo||"",numero_serie_fabricante:r.numero_serie_fabricante||"",cpu_procesador:r.cpu_procesador||"",memoria_ram:r.memoria_ram||"",almacenamiento:r.almacenamiento||"",sistema_operativo:r.sistema_operativo||"",pulgadas:r.pulgadas||"",estado:r.estado||"funcional"}),m(r.adjunto_archivo||""),y(z(r.numero_placa))):(a({numero_placa:"",centro_costes:1,ubicacion:"Claro",responsable:"David Acero",proveedor:"",valor:"",fecha_compra:"",numero_social:"",poliza:"",aseguradora:"",garantia:"No",fecha_vencimiento_garantia:"",orden_compra:"",clasificacion:"Activo no productivo",clasificacion_activo_fijo:"",adjunto_archivo:null,site:"Site A",puesto:"",asignado:"",marca_modelo:"",numero_serie_fabricante:"",cpu_procesador:"",memoria_ram:"",almacenamiento:"",sistema_operativo:"",pulgadas:"",estado:"funcional"}),m(""),y("")),p(""))},[t,r]);const H=async()=>{try{const O=await Ar.get(`${c2}/activos/responsables`);l(O.data.responsables)}catch(O){console.error("Error al cargar responsables:",O)}},V=O=>{const{name:ee,value:I}=O.target;if(a(P=>({...P,[ee]:I})),ee==="numero_placa"){const P=z(I);y(P);let ae="";P==="ECC-CPU"?ae="900000":P==="ECC-MON"&&(ae="500000"),a(G=>{const M=G.valor,te=!M||M==="900000"||M==="500000"||M==="";return{...G,[ee]:I,...te&&ae?{valor:ae}:{}}});return}ee==="garantia"&&I==="No"&&a(P=>({...P,fecha_vencimiento_garantia:""}))},B=O=>{const ee=O.target.files[0];ee&&(a(I=>({...I,adjunto_archivo:ee})),m(ee.name))},R=async O=>{O.preventDefault(),d(!0),p("");try{if(!s.numero_placa||!s.ubicacion||!s.site||!s.responsable||!s.clasificacion)throw new Error("Los campos nmero de placa, ubicacin, site, responsable y clasificacin son obligatorios");if(s.garantia==="Si"&&!s.fecha_vencimiento_garantia)throw new Error('La fecha de vencimiento de garanta es requerida cuando la garanta es "S"');const ee=new FormData;Object.keys(s).forEach(P=>{P!=="adjunto_archivo"&&s[P]!==""&&ee.append(P,s[P])}),s.adjunto_archivo&&ee.append("adjunto_archivo",s.adjunto_archivo);let I;r?I=await Ar.put(`${c2}/activos/${r.id}`,ee,{headers:{"Content-Type":"multipart/form-data"}}):I=await Ar.post(`${c2}/activos`,ee,{headers:{"Content-Type":"multipart/form-data"}}),I.data.success&&(n(),e())}catch(ee){console.error("Error al guardar activo:",ee),ee.response?.data?.type==="DUPLICATE_PLATE"?p(` ${ee.response.data.message}`):p(ee.response?.data?.message||ee.message||"Error al guardar el activo")}finally{d(!1)}};return t?o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r?"Editar Activo":"Crear Nuevo Activo"}),o.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:o.jsx(gs,{className:"h-6 w-6"})})]}),o.jsxs("form",{onSubmit:R,className:"p-6",children:[h&&o.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:o.jsx("div",{className:"flex items-start",children:o.jsxs("div",{className:"flex-1",children:[h,h.includes("ya existe en el sistema")&&o.jsxs("div",{className:"mt-2 text-sm text-red-600",children:[" ",o.jsx("strong",{children:"Sugerencia:"})," Verifica que no hayas ingresado este nmero de placa anteriormente, o modifica el nmero si es correcto."]})]})})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nmero de Placa *"}),o.jsx("input",{type:"text",name:"numero_placa",value:s.numero_placa,onChange:V,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ej: ECC-CPU-001, ECC'CPU'001, ECC-MON-001..."}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Formatos: ECC-CPU-### o ECC'CPU'### (Computadoras), ECC-SER-### o ECC'SER'### (Servidores), ECC-MON-### o ECC'MON'### (Monitores), ECC-IMP-### o ECC'IMP'### (Impresoras), ECC-POR-### o ECC'POR'### (Porttiles), ECC-TV-### o ECC'TV'### (TVs)"})]}),b&&b!=="OTHER"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"md:col-span-2",children:o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[o.jsxs("h3",{className:"text-lg font-medium text-blue-900 mb-2",children:["Campos especficos para ",b]}),o.jsx("p",{className:"text-sm text-blue-700",children:"Los siguientes campos son especficos para este tipo de activo."})]})}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estado *"}),o.jsx("select",{name:"estado",value:s.estado,onChange:V,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:A.map(O=>o.jsx("option",{value:O,children:O.replace("_"," ").charAt(0).toUpperCase()+O.replace("_"," ").slice(1)},O))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Marca y Modelo *"}),o.jsx("input",{type:"text",name:"marca_modelo",value:s.marca_modelo,onChange:V,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ej. Dell OptiPlex 7080"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nmero de Serie del Fabricante *"}),o.jsx("input",{type:"text",name:"numero_serie_fabricante",value:s.numero_serie_fabricante,onChange:V,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nmero de serie del fabricante"})]}),["ECC-CPU","ECC-SER","ECC-POR"].includes(b)&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CPU / Procesador"}),o.jsx("input",{type:"text",name:"cpu_procesador",value:s.cpu_procesador,onChange:V,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ej. Intel Core i5-10400 2.9GHz"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Memoria RAM"}),o.jsx("input",{type:"text",name:"memoria_ram",value:s.memoria_ram,onChange:V,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ej. 16GB DDR4"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Disco Duro / Almacenamiento"}),o.jsx("input",{type:"text",name:"almacenamiento",value:s.almacenamiento,onChange:V,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ej. SSD 512GB"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sistema Operativo"}),o.jsx("input",{type:"text",name:"sistema_operativo",value:s.sistema_operativo,onChange:V,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ej. Windows 11 Pro"})]})]}),["ECC-MON","ECC-TV"].includes(b)&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pulgadas"}),o.jsx("input",{type:"text",name:"pulgadas",value:s.pulgadas,onChange:V,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ej. 24 pulgadas"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Centro de Costes *"}),o.jsx("select",{name:"centro_costes",value:s.centro_costes,onChange:V,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[1,2,3,4,5,6,7,8,9,10].map(O=>o.jsx("option",{value:O,children:O},O))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ubicacin *"}),o.jsxs("select",{name:"ubicacion",value:s.ubicacion,onChange:V,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Seleccione una ubicacin"}),w.map(O=>o.jsx("option",{value:O,children:O},O))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Site *"}),o.jsxs("select",{name:"site",value:s.site,onChange:V,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Seleccione un site"}),k.map(O=>o.jsx("option",{value:O,children:O},O))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Puesto"}),o.jsx("input",{type:"text",name:"puesto",value:s.puesto,onChange:V,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ej: 001, 090, 106",maxLength:50}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Nmero o identificacin del puesto fsico donde est ubicado el activo (opcional)"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Empresa"}),o.jsx("input",{type:"text",value:"Asiste",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Responsable *"}),o.jsxs("select",{name:"responsable",value:s.responsable,onChange:V,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Seleccione un responsable"}),i.map(O=>o.jsx("option",{value:O,children:O},O))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Asignado"}),o.jsx("input",{type:"text",name:"asignado",value:s.asignado,onChange:V,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nombre de la persona asignada",maxLength:100}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Persona especfica a quien est asignado el activo para uso diario (opcional)"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Proveedor"}),o.jsx("input",{type:"text",name:"proveedor",value:s.proveedor,onChange:V,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nombre del proveedor"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Valor del Activo (COP)"}),o.jsx("input",{type:"number",name:"valor",value:s.valor,onChange:V,min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha de Compra"}),o.jsx("input",{type:"date",name:"fecha_compra",value:s.fecha_compra,onChange:V,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nmero de Serie"}),o.jsx("input",{type:"text",name:"numero_social",value:s.numero_social,onChange:V,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nmero social del activo"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pliza"}),o.jsx("input",{type:"text",name:"poliza",value:s.poliza,onChange:V,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nmero de pliza (opcional)"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Aseguradora"}),o.jsx("input",{type:"text",name:"aseguradora",value:s.aseguradora,onChange:V,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nombre de la aseguradora (opcional)"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Garanta *"}),o.jsxs("select",{name:"garantia",value:s.garantia,onChange:V,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"No",children:"No"}),o.jsx("option",{value:"Si",children:"S"})]})]}),s.garantia==="Si"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha de Vencimiento de Garanta *"}),o.jsx("input",{type:"date",name:"fecha_vencimiento_garantia",value:s.fecha_vencimiento_garantia,onChange:V,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Orden de Compra"}),o.jsx("input",{type:"text",name:"orden_compra",value:s.orden_compra,onChange:V,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nmero de orden de compra"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Clasificacin *"}),o.jsxs("select",{name:"clasificacion",value:s.clasificacion,onChange:V,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Seleccione una clasificacin"}),S.map(O=>o.jsx("option",{value:O,children:O},O))]})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Clasificacin de Activo Fijo"}),o.jsx("input",{type:"text",name:"clasificacion_activo_fijo",value:s.clasificacion_activo_fijo,onChange:V,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Descripcin de la clasificacin del activo fijo"})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Archivo Adjunto (Imagen o PDF)"}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("label",{className:"flex items-center px-4 py-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[o.jsx(S3,{className:"h-5 w-5 mr-2 text-gray-400"}),"Seleccionar archivo",o.jsx("input",{type:"file",onChange:B,accept:"image/*,.pdf",className:"hidden"})]}),x&&o.jsx("span",{className:"text-sm text-gray-600",children:x})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Formatos permitidos: JPG, PNG, GIF, WebP, PDF. Mximo 15MB."})]})]}),o.jsxs("div",{className:"flex justify-end space-x-4 mt-8 pt-6 border-t border-gray-200",children:[o.jsx("button",{type:"button",onClick:e,disabled:c,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Cancelar"}),o.jsx("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2",children:c?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Guardando..."]}):o.jsxs(o.Fragment,{children:[o.jsx(bp,{className:"h-4 w-4"}),r?"Actualizar":"Crear"," Activo"]})})]})]})]})}):null},u2="http://31.97.138.23:5001/api",$q=()=>{const{user:t,isGestorActivos:e}=Jr(),[r,n]=Q.useState([]),[s,a]=Q.useState(!0),[i,l]=Q.useState(""),[c,d]=Q.useState({}),[h,p]=Q.useState(!1),[x,m]=Q.useState(!1),[b,y]=Q.useState(null),[w,S]=Q.useState(""),[k,A]=Q.useState({});if(!e)return o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md text-center",children:[o.jsx(Di,{className:"mx-auto h-16 w-16 text-red-500 mb-4"}),o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Acceso Denegado"}),o.jsx("p",{className:"text-gray-600",children:"Solo los gestores de activos pueden acceder a esta seccin."})]})});Q.useEffect(()=>{z(),H()},[]);const z=async()=>{try{a(!0);const I=await Ar.get(`${u2}/activos`);n(I.data.activos),l("")}catch(I){console.error("Error al cargar activos:",I),l("Error al cargar los activos")}finally{a(!1)}},H=async()=>{try{const I=await Ar.get(`${u2}/activos/stats`);d(I.data.stats)}catch(I){console.error("Error al cargar estadsticas:",I)}},V=()=>{y(null),p(!0)},B=I=>{y(I),m(!0)},R=async()=>{await z(),await H(),p(!1),m(!1)},O=async I=>{if(window.confirm("Est seguro de que desea eliminar este activo?"))try{await Ar.delete(`${u2}/activos/${I}`),await z(),await H()}catch(P){console.error("Error al eliminar activo:",P),l("Error al eliminar el activo")}},ee=r.filter(I=>I.numero_placa.toLowerCase().includes(w.toLowerCase())||I.responsable.toLowerCase().includes(w.toLowerCase())||I.ubicacion.toLowerCase().includes(w.toLowerCase()));return s?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),o.jsx("p",{className:"mt-4 text-gray-600",children:"Cargando activos..."})]})}):o.jsxs("div",{className:"p-6",children:[o.jsx("div",{className:"mb-6",children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Ingresar Activos"}),o.jsx("p",{className:"text-gray-600",children:"Registra y administra los activos de la empresa"})]}),o.jsxs("button",{onClick:V,className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",children:[o.jsx(w3,{className:"h-5 w-5"}),"Nuevo Activo"]})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6 mb-6",children:[o.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(Xo,{className:"h-8 w-8 text-blue-600"}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Activos"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.total||0})]})]})}),o.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(qd,{className:"h-8 w-8 text-green-600"}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Productivos"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.activos_productivos||0})]})]})}),o.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(qd,{className:"h-8 w-8 text-orange-600"}),o.jsxs("div",{className:"ml-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"No Productivos"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.activos_no_productivos||0})]})]})}),o.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(g3,{className:"h-8 w-8 text-green-600 flex-shrink-0"}),o.jsxs("div",{className:"ml-4 min-w-0 flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Valor Total"}),o.jsxs("p",{className:"font-bold text-gray-900 text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl overflow-hidden whitespace-nowrap",children:["$",new Intl.NumberFormat("es-CO").format(c.valor_total||0)]})]})]})}),o.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(Wh,{className:"h-8 w-8 text-indigo-600 flex-shrink-0"}),o.jsxs("div",{className:"ml-4 min-w-0 flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Valor Promedio"}),o.jsxs("p",{className:"font-bold text-gray-900 text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl overflow-hidden whitespace-nowrap",children:["$",new Intl.NumberFormat("es-CO").format(c.valor_promedio||0)]})]})]})})]}),o.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border mb-6",children:o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[o.jsx("div",{className:"flex-1",children:o.jsxs("div",{className:"relative",children:[o.jsx(Lc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),o.jsx("input",{type:"text",placeholder:"Buscar por nmero de placa, responsable o ubicacin...",value:w,onChange:I=>S(I.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})}),o.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[o.jsx(Xx,{className:"h-5 w-5"}),"Filtros"]})]})}),i&&o.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:i}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:[o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Activo"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ubicacin"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Responsable"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Clasificacin"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Garanta"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ee.map(I=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:I.numero_placa}),o.jsxs("div",{className:"text-sm text-gray-500",children:["Centro: ",I.centro_costes]})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:I.ubicacion})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:I.responsable}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${I.clasificacion==="Activo productivo"?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:I.clasificacion})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${I.garantia==="Si"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:I.garantia})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:I.valor?`$${new Intl.NumberFormat("es-CO").format(I.valor)}`:"No especificado"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>B(I),className:"text-blue-600 hover:text-blue-900",title:"Editar activo",children:o.jsx(Nh,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>O(I.id),className:"text-red-600 hover:text-red-900",title:"Eliminar activo",children:o.jsx(Kx,{className:"h-4 w-4"})})]})})]},I.id))})]})}),ee.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Xo,{className:"mx-auto h-12 w-12 text-gray-400"}),o.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No hay activos"}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Comience creando un nuevo activo."})]})]}),o.jsx(hv,{isOpen:h,onClose:()=>p(!1),activo:null,onSuccess:R}),o.jsx(hv,{isOpen:x,onClose:()=>m(!1),activo:b,onSuccess:R})]})},Wq=()=>{const[t,e]=Q.useState(!1),{user:r,logout:n}=Jr(),s=Jo(),a=Oi(),i=()=>{n(),a("/login")},l=[{name:"Ingresar Activos",href:"/activos",icon:w3,current:s.pathname==="/activos"},{name:"Crear desde Script",href:"/activos/script-parser",icon:qn,current:s.pathname==="/activos/script-parser"},{name:"Inventario",href:"/activos/inventario",icon:wC,current:s.pathname==="/activos/inventario"},{name:"Anlisis y Grficos",href:"/activos/charts",icon:vp,current:s.pathname==="/activos/charts"}];return o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsxs("div",{className:`fixed inset-0 flex z-40 md:hidden ${t?"block":"hidden"}`,children:[o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>e(!1)}),o.jsxs("div",{className:"relative flex-1 flex flex-col max-w-xs w-full pt-5 pb-4 bg-white",children:[o.jsx("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:o.jsx("button",{type:"button",className:"ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:()=>e(!1),children:o.jsx(gs,{className:"h-6 w-6 text-white"})})}),o.jsxs("div",{className:"flex-shrink-0 flex items-center px-4",children:[o.jsx(Xo,{className:"h-8 w-8 text-indigo-600"}),o.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"Gestin de Activos"})]}),o.jsx("div",{className:"mt-5 flex-1 h-0 overflow-y-auto",children:o.jsx("nav",{className:"px-2 space-y-1",children:l.map(c=>o.jsxs(zh,{to:c.href,className:`${c.current?"bg-indigo-100 text-indigo-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"} group flex items-center px-2 py-2 text-base font-medium rounded-md`,onClick:()=>e(!1),children:[o.jsx(c.icon,{className:`${c.current?"text-indigo-500":"text-gray-400 group-hover:text-gray-500"} mr-4 flex-shrink-0 h-6 w-6`}),c.name]},c.name))})})]})]}),o.jsx("div",{className:"hidden md:flex md:w-64 md:flex-col md:fixed md:inset-y-0",children:o.jsxs("div",{className:"flex flex-col flex-grow pt-5 bg-white overflow-y-auto border-r border-gray-200",children:[o.jsxs("div",{className:"flex items-center flex-shrink-0 px-4",children:[o.jsx(Xo,{className:"h-8 w-8 text-indigo-600"}),o.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"Gestin de Activos"})]}),o.jsx("div",{className:"mt-5 flex-grow flex flex-col",children:o.jsx("nav",{className:"flex-1 px-2 pb-4 space-y-1",children:l.map(c=>o.jsxs(zh,{to:c.href,className:`${c.current?"bg-indigo-100 text-indigo-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"} group flex items-center px-2 py-2 text-sm font-medium rounded-md`,children:[o.jsx(c.icon,{className:`${c.current?"text-indigo-500":"text-gray-400 group-hover:text-gray-500"} mr-3 flex-shrink-0 h-6 w-6`}),c.name]},c.name))})})]})}),o.jsxs("div",{className:"md:pl-64 flex flex-col flex-1",children:[o.jsxs("div",{className:"sticky top-0 z-10 flex-shrink-0 flex h-16 bg-white shadow",children:[o.jsx("button",{type:"button",className:"px-4 border-r border-gray-200 text-gray-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500 md:hidden",onClick:()=>e(!0),children:o.jsx(Nv,{className:"h-6 w-6"})}),o.jsxs("div",{className:"flex-1 px-4 flex justify-between",children:[o.jsx("div",{className:"flex-1 flex"}),o.jsx("div",{className:"ml-4 flex items-center md:ml-6",children:o.jsx("div",{className:"relative",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Bn,{className:"h-8 w-8 text-gray-400"}),o.jsxs("div",{className:"ml-3",children:[o.jsx("div",{className:"text-sm font-medium text-gray-700",children:r?.full_name||r?.fullName}),o.jsx("div",{className:"text-xs text-gray-500",children:"Gestor de Activos"})]})]}),o.jsxs("button",{onClick:i,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-gray-500 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[o.jsx(Yx,{className:"h-4 w-4 mr-2"}),"Cerrar Sesin"]})]})})})]})]}),o.jsx("main",{className:"flex-1",children:o.jsx(Ux,{})})]})]})},Vq="http://31.97.138.23:5001/api",qq=({activoId:t,canViewHistory:e=!1})=>{const[r,n]=Q.useState([]),[s,a]=Q.useState(!1),[i,l]=Q.useState(null),[c,d]=Q.useState(!1),h=async()=>{if(!(!t||!e))try{a(!0),l(null);const m=await Ar.get(`${Vq}/activos-tecnico/${t}/historial`);n(m.data.historial||[])}catch(m){console.error("Error al cargar historial:",m),m.response?.status===403?l("No tiene permisos para ver el historial"):l("Error al cargar el historial de cambios")}finally{a(!1)}};if(Q.useEffect(()=>{c&&r.length===0&&!i&&h()},[c,t,e]),!e)return null;const p=m=>m?new Date(m).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Fecha desconocida",x=m=>({cpu_procesador:"bg-blue-100 text-blue-800",memoria_ram:"bg-purple-100 text-purple-800",almacenamiento:"bg-orange-100 text-orange-800",sistema_operativo:"bg-green-100 text-green-800"})[m]||"bg-gray-100 text-gray-800";return o.jsxs("div",{className:"border-t border-gray-200 mt-6 pt-6",children:[o.jsxs("button",{onClick:()=>d(!c),className:"w-full flex items-center justify-between text-left",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Ec,{className:"h-5 w-5 text-gray-500 mr-2"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Historial de Cambios"}),r.length>0&&o.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:[r.length," cambio",r.length!==1?"s":""]})]}),c?o.jsx(Lu,{className:"h-5 w-5 text-gray-400"}):o.jsx(bc,{className:"h-5 w-5 text-gray-400"})]}),c&&o.jsxs("div",{className:"mt-4",children:[s?o.jsxs("div",{className:"flex items-center justify-center py-8",children:[o.jsx(Pc,{className:"h-6 w-6 text-gray-400 animate-spin"}),o.jsx("span",{className:"ml-2 text-gray-500",children:"Cargando historial..."})]}):i?o.jsxs("div",{className:"flex items-center justify-center py-8 text-red-500",children:[o.jsx(Di,{className:"h-5 w-5 mr-2"}),i]}):r.length===0?o.jsxs("div",{className:"text-center py-8 text-gray-500",children:[o.jsx(Ec,{className:"h-10 w-10 mx-auto mb-2 text-gray-300"}),o.jsx("p",{children:"No hay cambios registrados para este activo"})]}):o.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:r.map(m=>o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-100",children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${x(m.campo)}`,children:m.campoLabel}),o.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[o.jsx(ia,{className:"h-3 w-3 mr-1"}),p(m.fecha)]})]}),o.jsxs("div",{className:"flex items-center text-sm mt-2",children:[o.jsx("span",{className:"text-gray-500 line-through",children:m.valorAnterior||"Sin valor"}),o.jsx(m3,{className:"h-4 w-4 mx-2 text-gray-400"}),o.jsx("span",{className:"text-gray-900 font-medium",children:m.valorNuevo})]}),o.jsxs("div",{className:"flex items-center text-xs text-gray-500 mt-2",children:[o.jsx(Bn,{className:"h-3 w-3 mr-1"}),"Modificado por: ",m.modificadoPor]})]},m.id))}),!s&&!i&&o.jsxs("button",{onClick:h,className:"mt-4 flex items-center text-sm text-blue-600 hover:text-blue-700",children:[o.jsx(Pc,{className:"h-4 w-4 mr-1"}),"Refrescar historial"]})]})]})},C4="http://31.97.138.23:5001/api",Gq=({isOpen:t,onClose:e,activo:r})=>{const{canViewAssetHistory:n}=Jr();if(!t||!r)return null;const s=x=>x?new Date(x).toLocaleDateString("es-ES"):"No especificada",a=x=>!x||x===0?"No especificado":`$${Math.floor(x)}`,l=(x=>{if(!x)return"";const m=x.toUpperCase();return m.match(/^ECC[-']CPU[-']\d+$/)?"ECC-CPU":m.match(/^ECC[-']SER[-']\d+$/)?"ECC-SER":m.match(/^ECC[-']MON[-']\d+$/)?"ECC-MON":m.match(/^ECC[-']IMP[-']\d+$/)?"ECC-IMP":m.match(/^ECC[-']POR[-']\d+$/)?"ECC-POR":m.match(/^ECC[-']TV[-']\d+$/)?"ECC-TV":m.startsWith("ECC-CPU")||m.startsWith("ECC'CPU")?"ECC-CPU":m.startsWith("ECC-SER")||m.startsWith("ECC'SER")?"ECC-SER":m.startsWith("ECC-MON")||m.startsWith("ECC'MON")?"ECC-MON":m.startsWith("ECC-IMP")||m.startsWith("ECC'IMP")?"ECC-IMP":m.startsWith("ECC-POR")||m.startsWith("ECC'POR")?"ECC-POR":m.startsWith("ECC-TV")||m.startsWith("ECC'TV")?"ECC-TV":"OTHER"})(r?.numero_placa),c=x=>({"ECC-CPU":"Computadora","ECC-SER":"Servidor","ECC-MON":"Monitor","ECC-IMP":"Impresora","ECC-POR":"Porttil","ECC-TV":"Televisor",OTHER:"Otro"})[x]||"Otro",d=()=>{if(r.adjunto_archivo){const x=`${C4}/files/activos/${r.adjunto_archivo}`;window.open(x,"_blank")}},h=x=>{if(!x)return null;const m=x.split(".").pop().toLowerCase();return["jpg","jpeg","png","gif","webp"].includes(m)?"image":m==="pdf"?"pdf":"other"},p=({icon:x,label:m,value:b,fullWidth:y=!1})=>o.jsxs("div",{className:`${y?"col-span-2":""} bg-gray-50 p-4 rounded-lg`,children:[o.jsxs("div",{className:"flex items-center mb-2",children:[o.jsx(x,{className:"h-4 w-4 text-gray-500 mr-2"}),o.jsx("span",{className:"text-sm font-medium text-gray-600",children:m})]}),o.jsx("p",{className:"text-gray-900 font-semibold",children:b||"No especificado"})]});return o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-blue-50",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Xo,{className:"h-8 w-8 text-blue-600 mr-3"}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Detalles del Activo"}),o.jsx("p",{className:"text-blue-600 font-medium",children:r.numero_placa})]})]}),o.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:o.jsx(gs,{className:"h-6 w-6"})})]}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex flex-wrap gap-3 mb-6",children:[o.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${r.clasificacion==="Activo productivo"?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:[o.jsx(qd,{className:"h-4 w-4 mr-1"}),r.clasificacion]}),l!=="OTHER"&&o.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-purple-100 text-purple-800",children:[o.jsx(Xo,{className:"h-4 w-4 mr-1"}),c(l)]}),r.estado&&o.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${r.estado==="funcional"?"bg-green-100 text-green-800":r.estado==="en_reparacion"?"bg-yellow-100 text-yellow-800":r.estado==="dado_de_baja"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:[o.jsx(Yd,{className:"h-4 w-4 mr-1"}),r.estado.replace("_"," ").charAt(0).toUpperCase()+r.estado.replace("_"," ").slice(1)]}),o.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${r.garantia==="Si"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:[o.jsx(Yd,{className:"h-4 w-4 mr-1"}),"Garanta: ",r.garantia]}),o.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:[o.jsx(Ac,{className:"h-4 w-4 mr-1"}),r.ubicacion]}),r.site&&o.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-indigo-100 text-indigo-800",children:[o.jsx(b5,{className:"h-4 w-4 mr-1"}),r.site]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[o.jsx(p,{icon:gm,label:"Nmero de Placa",value:r.numero_placa}),o.jsx(p,{icon:gm,label:"Centro de Costes",value:r.centro_costes}),o.jsx(p,{icon:_0,label:"Empresa",value:r.empresa||"Asiste"}),o.jsx(p,{icon:Ac,label:"Ubicacin",value:r.ubicacion}),o.jsx(p,{icon:b5,label:"Site",value:r.site}),o.jsx(p,{icon:Bn,label:"Responsable",value:r.responsable}),o.jsx(p,{icon:Bn,label:"Asignado",value:r.asignado||"No asignado"}),o.jsx(p,{icon:Ac,label:"Puesto",value:r.puesto||"No especificado"}),o.jsx(p,{icon:DC,label:"Proveedor",value:r.proveedor}),o.jsx(p,{icon:g3,label:"Valor del Activo",value:a(r.valor)}),o.jsx(p,{icon:ia,label:"Fecha de Compra",value:s(r.fecha_compra)}),o.jsx(p,{icon:gm,label:"Nmero de Serie",value:r.numero_social}),o.jsx(p,{icon:qn,label:"Pliza",value:r.poliza}),o.jsx(p,{icon:_0,label:"Aseguradora",value:r.aseguradora}),o.jsx(p,{icon:Yd,label:"Garanta",value:r.garantia}),r.garantia==="Si"&&o.jsx(p,{icon:ia,label:"Vencimiento de Garanta",value:s(r.fecha_vencimiento_garantia)}),o.jsx(p,{icon:x3,label:"Orden de Compra",value:r.orden_compra}),o.jsx(p,{icon:qd,label:"Clasificacin",value:r.clasificacion})]}),r.clasificacion_activo_fijo&&o.jsx("div",{className:"mb-6",children:o.jsx(p,{icon:qd,label:"Clasificacin de Activo Fijo",value:r.clasificacion_activo_fijo,fullWidth:!0})}),r.adjunto_archivo&&o.jsxs("div",{className:"mb-6",children:[o.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-3 flex items-center",children:[o.jsx(qn,{className:"h-5 w-5 mr-2"}),"Archivo Adjunto"]}),o.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"bg-blue-100 p-2 rounded-lg mr-3",children:h(r.adjunto_archivo)==="image"?o.jsx(Dl,{className:"h-6 w-6 text-blue-600"}):o.jsx(qn,{className:"h-6 w-6 text-blue-600"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:r.adjunto_archivo}),o.jsx("p",{className:"text-xs text-gray-500",children:h(r.adjunto_archivo)==="image"?"Imagen":h(r.adjunto_archivo)==="pdf"?"Documento PDF":"Archivo"})]})]}),o.jsxs("button",{onClick:d,className:"flex items-center px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:[o.jsx(yp,{className:"h-4 w-4 mr-1"}),"Ver/Descargar"]})]}),h(r.adjunto_archivo)==="image"&&o.jsx("div",{className:"mt-4",children:o.jsx("img",{src:`${C4}/files/activos/${r.adjunto_archivo}`,alt:"Preview del activo",className:"max-w-xs h-auto rounded-lg border border-gray-200",onError:x=>{x.target.style.display="none"}})})]})]}),l&&l!=="OTHER"&&o.jsxs("div",{className:"mb-6",children:[o.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-3 flex items-center",children:[o.jsx(Xo,{className:"h-5 w-5 mr-2"}),"Informacin Tcnica (",c(l),")"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.marca_modelo&&o.jsx(p,{icon:qd,label:"Marca y Modelo",value:r.marca_modelo}),r.numero_serie_fabricante&&o.jsx(p,{icon:gm,label:"Nmero de Serie del Fabricante",value:r.numero_serie_fabricante}),["ECC-CPU","ECC-SER","ECC-POR"].includes(l)&&o.jsxs(o.Fragment,{children:[r.cpu_procesador&&o.jsx(p,{icon:u0,label:"CPU / Procesador",value:r.cpu_procesador}),r.memoria_ram&&o.jsx(p,{icon:dx,label:"Memoria RAM",value:r.memoria_ram}),r.almacenamiento&&o.jsx(p,{icon:dx,label:"Almacenamiento",value:r.almacenamiento}),r.sistema_operativo&&o.jsx(p,{icon:Fn,label:"Sistema Operativo",value:r.sistema_operativo})]}),["ECC-MON","ECC-TV"].includes(l)&&r.pulgadas&&o.jsx(p,{icon:Fn,label:"Pulgadas",value:r.pulgadas})]})]}),o.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Informacin del Sistema"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx(p,{icon:ia,label:"Fecha de Creacin",value:s(r.created_at)}),o.jsx(p,{icon:ia,label:"ltima Actualizacin",value:s(r.updated_at)}),r.created_by_name&&o.jsx(p,{icon:Bn,label:"Creado por",value:r.created_by_name})]})]}),o.jsx(qq,{activoId:r.id,canViewHistory:n}),o.jsx("div",{className:"flex justify-end mt-8 pt-6 border-t border-gray-200",children:o.jsx("button",{onClick:e,className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Cerrar"})})]})]})})},Xq="http://31.97.138.23:5001/api",Yq=()=>{const{user:t,isGestorActivos:e}=Jr(),[r,n]=Q.useState([]),[s,a]=Q.useState([]),[i,l]=Q.useState(!0),[c,d]=Q.useState(""),[h,p]=Q.useState(!1),[x,m]=Q.useState(!1),[b,y]=Q.useState(!1),[w,S]=Q.useState(null),[k,A]=Q.useState({numeroPlaca:"",fechaInicio:"",fechaFin:"",numeroSerie:"",proveedor:"",ordenCompra:"",ubicacion:"",clasificacion:"",garantia:"",site:"",estado:"",tipoActivo:"",puesto:"",responsable:"",asignado:""});if(!e)return o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md text-center",children:[o.jsx(Di,{className:"mx-auto h-16 w-16 text-red-500 mb-4"}),o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Acceso Denegado"}),o.jsx("p",{className:"text-gray-600",children:"Solo los gestores de activos pueden acceder a esta seccin."})]})});Q.useEffect(()=>{z()},[]),Q.useEffect(()=>{H()},[r,k]);const z=async()=>{try{l(!0);const G=await Ar.get(`${Xq}/activos`);n(G.data.activos),d("")}catch(G){console.error("Error al cargar activos:",G),d("Error al cargar el inventario")}finally{l(!1)}},H=()=>{let G=[...r];k.numeroPlaca&&(G=G.filter(M=>M.numero_placa&&M.numero_placa.toLowerCase().includes(k.numeroPlaca.toLowerCase()))),k.fechaInicio&&(G=G.filter(M=>M.fecha_compra&&M.fecha_compra>=k.fechaInicio)),k.fechaFin&&(G=G.filter(M=>M.fecha_compra&&M.fecha_compra<=k.fechaFin)),k.numeroSerie&&(G=G.filter(M=>M.numero_social&&M.numero_social.toLowerCase().includes(k.numeroSerie.toLowerCase()))),k.proveedor&&(G=G.filter(M=>M.proveedor&&M.proveedor.toLowerCase().includes(k.proveedor.toLowerCase()))),k.ordenCompra&&(G=G.filter(M=>M.orden_compra&&M.orden_compra.toLowerCase().includes(k.ordenCompra.toLowerCase()))),k.ubicacion&&(G=G.filter(M=>M.ubicacion===k.ubicacion)),k.clasificacion&&(G=G.filter(M=>M.clasificacion===k.clasificacion)),k.garantia&&(G=G.filter(M=>M.garantia===k.garantia)),k.site&&(G=G.filter(M=>M.site===k.site)),k.estado&&(G=G.filter(M=>M.estado===k.estado)),k.tipoActivo&&(G=G.filter(M=>{const ie=(M.numero_placa||"").toUpperCase();return k.tipoActivo==="ECC-CPU"?ie.startsWith("ECC-CPU"):k.tipoActivo==="ECC-SER"?ie.startsWith("ECC-SER"):k.tipoActivo==="ECC-MON"?ie.startsWith("ECC-MON"):k.tipoActivo==="ECC-IMP"?ie.startsWith("ECC-IMP"):k.tipoActivo==="ECC-POR"?ie.startsWith("ECC-POR"):k.tipoActivo==="ECC-TV"?ie.startsWith("ECC-TV"):!0})),k.puesto&&(G=G.filter(M=>M.puesto&&M.puesto.toLowerCase().includes(k.puesto.toLowerCase()))),k.responsable&&(G=G.filter(M=>M.responsable&&M.responsable.toLowerCase().includes(k.responsable.toLowerCase()))),k.asignado&&(G=G.filter(M=>M.asignado&&M.asignado.toLowerCase().includes(k.asignado.toLowerCase()))),a(G)},V=(G,M)=>{A(te=>({...te,[G]:M}))},B=()=>{A({numeroPlaca:"",fechaInicio:"",fechaFin:"",numeroSerie:"",proveedor:"",ordenCompra:"",ubicacion:"",clasificacion:"",garantia:"",site:"",estado:"",tipoActivo:"",puesto:"",responsable:"",asignado:""})},R=()=>{if(s.length===0){alert("No hay datos para exportar");return}const M=[["Nmero de Placa","Centro de Costes","Ubicacin","Responsable","Asignado","Proveedor","Fecha de Compra","Nmero de Serie","Puesto","Clasificacin","Garanta","Fecha Venc. Garanta","Orden de Compra"].join(","),...s.map(X=>[X.numero_placa,X.centro_costes,X.ubicacion,X.responsable,X.asignado||"",X.proveedor||"",X.fecha_compra||"",X.numero_social||"",X.puesto||"",X.clasificacion,X.garantia,X.fecha_vencimiento_garantia||"",X.orden_compra||""].join(","))].join(`
`),te=new Blob([M],{type:"text/csv;charset=utf-8;"}),ie=document.createElement("a"),le=URL.createObjectURL(te);ie.setAttribute("href",le),ie.setAttribute("download",`inventario_activos_${new Date().toISOString().split("T")[0]}.csv`),ie.style.visibility="hidden",document.body.appendChild(ie),ie.click(),document.body.removeChild(ie)},O=G=>{if(!G)return"Sin especificar";const M=G.toUpperCase();return M.includes("SSD")||M.includes("SLIDO")||M.includes("SOLIDO")||M.includes("NVME")||M.includes("M.2")||M.includes("SOLID STATE")?"SSD":M.includes("HDD")||M.includes("MECNICO")||M.includes("MECANICO")||M.includes("DISCO DURO")||M.includes("HARD DRIVE")||M.includes("RPM")?"HDD":"Sin clasificar"},ee=()=>{const G=r.filter(Re=>{const Ke=(Re.numero_placa||"").toUpperCase();return Ke.startsWith("ECC-CPU")||Ke.startsWith("ECC'CPU")});if(G.length===0){alert("No hay CPUs registradas en el inventario");return}const M=G.map(Re=>({...Re,tipoDisco:O(Re.almacenamiento)})),te=M.filter(Re=>Re.tipoDisco==="SSD").length,ie=M.filter(Re=>Re.tipoDisco==="HDD").length,le=M.filter(Re=>Re.tipoDisco==="Sin clasificar"||Re.tipoDisco==="Sin especificar").length,fe=[...new Set(M.map(Re=>Re.ubicacion).filter(Boolean))].sort().map(Re=>{const Ke=M.filter(it=>it.ubicacion===Re);return{ubicacion:Re,total:Ke.length,ssd:Ke.filter(it=>it.tipoDisco==="SSD").length,hdd:Ke.filter(it=>it.tipoDisco==="HDD").length}}),E=[...new Set(M.map(Re=>Re.site).filter(Boolean))].sort().map(Re=>{const Ke=M.filter(it=>it.site===Re);return{site:Re,total:Ke.length,ssd:Ke.filter(it=>it.tipoDisco==="SSD").length,hdd:Ke.filter(it=>it.tipoDisco==="HDD").length}}),L=[...new Set(M.map(Re=>Re.memoria_ram||"Sin especificar"))].sort().map(Re=>({ram:Re,cantidad:M.filter(Ke=>(Ke.memoria_ram||"Sin especificar")===Re).length})),F=new Date().toLocaleDateString("es-CO",{year:"numeric",month:"long",day:"numeric"}),q=na.book_new(),he=[["REPORTE DE CPUs - RAM Y ALMACENAMIENTO"],[""],["Fecha de generacin:",F],["Total de equipos:",G.length],[""],[""],["RESUMEN POR MEMORIA RAM"],["RAM","Cantidad","Porcentaje"],...L.map(Re=>[Re.ram,Re.cantidad,G.length>0?`${(Re.cantidad/G.length*100).toFixed(1)}%`:"0%"]),[""],[""],["RESUMEN POR TIPO DE DISCO"],["Tipo","Cantidad","Porcentaje"],["SSD (Disco Slido)",te,G.length>0?`${(te/G.length*100).toFixed(1)}%`:"0%"],["HDD (Disco Mecnico)",ie,G.length>0?`${(ie/G.length*100).toFixed(1)}%`:"0%"],["Sin clasificar",le,G.length>0?`${(le/G.length*100).toFixed(1)}%`:"0%"],[""],[""],["DISTRIBUCIN POR UBICACIN"],["Ubicacin","Total","SSD","HDD"],...fe.map(Re=>[Re.ubicacion,Re.total,Re.ssd,Re.hdd]),[""],[""],["DISTRIBUCIN POR SITE"],["Site","Total","SSD","HDD"],...E.map(Re=>[Re.site,Re.total,Re.ssd,Re.hdd])],me=na.aoa_to_sheet(he);me["!cols"]=[{wch:25},{wch:12},{wch:12},{wch:12}],na.book_append_sheet(q,me,"Resumen");const Z=[...M].sort((Re,Ke)=>{const it=(Re.ubicacion||"").localeCompare(Ke.ubicacion||"");return it!==0?it:(Re.tipoDisco||"").localeCompare(Ke.tipoDisco||"")}),Se=[["DETALLE DE EQUIPOS"],[""],["#","Placa","Ubicacin","Site","Puesto","Asignado","RAM","Almacenamiento","Tipo Disco"],...Z.map((Re,Ke)=>[Ke+1,Re.numero_placa||"",Re.ubicacion||"",Re.site||"",Re.puesto||"",Re.asignado||"",Re.memoria_ram||"",Re.almacenamiento||"",Re.tipoDisco])],We=na.aoa_to_sheet(Se);We["!cols"]=[{wch:5},{wch:18},{wch:15},{wch:10},{wch:10},{wch:25},{wch:15},{wch:20},{wch:15}],na.book_append_sheet(q,We,"Detalle Equipos");const ue=Z.filter(Re=>Re.tipoDisco==="SSD"),nt=[["EQUIPOS CON DISCO SSD (SLIDO)"],[""],[`Total: ${ue.length} equipos`],[""],["#","Placa","Ubicacin","Site","Puesto","Asignado","RAM","Almacenamiento"],...ue.map((Re,Ke)=>[Ke+1,Re.numero_placa||"",Re.ubicacion||"",Re.site||"",Re.puesto||"",Re.asignado||"",Re.memoria_ram||"",Re.almacenamiento||""])],rt=na.aoa_to_sheet(nt);rt["!cols"]=[{wch:5},{wch:18},{wch:15},{wch:10},{wch:10},{wch:25},{wch:15},{wch:20}],na.book_append_sheet(q,rt,"SSD");const De=Z.filter(Re=>Re.tipoDisco==="HDD"),ve=[["EQUIPOS CON DISCO HDD (MECNICO)"],[""],[`Total: ${De.length} equipos`],[""],["#","Placa","Ubicacin","Site","Puesto","Asignado","RAM","Almacenamiento"],...De.map((Re,Ke)=>[Ke+1,Re.numero_placa||"",Re.ubicacion||"",Re.site||"",Re.puesto||"",Re.asignado||"",Re.memoria_ram||"",Re.almacenamiento||""])],Xe=na.aoa_to_sheet(ve);Xe["!cols"]=[{wch:5},{wch:18},{wch:15},{wch:10},{wch:10},{wch:25},{wch:15},{wch:20}],na.book_append_sheet(q,Xe,"HDD"),jx(q,`Reporte_CPUs_RAM_Disco_${new Date().toISOString().split("T")[0]}.xlsx`)},I=G=>{S(G),m(!0)},P=G=>{S(G),y(!0)},ae=()=>{y(!1),S(null),z()};return i?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),o.jsx("p",{className:"mt-4 text-gray-600",children:"Cargando inventario..."})]})}):o.jsxs("div",{className:"p-6",children:[o.jsx("div",{className:"mb-6",children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Inventario de Activos"}),o.jsx("p",{className:"text-gray-600",children:"Visualiza y filtra el inventario completo de activos de la empresa"})]}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsxs("button",{onClick:()=>p(!h),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[o.jsx(Xx,{className:"h-4 w-4 mr-2"}),"Filtros"]}),o.jsxs("button",{onClick:R,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[o.jsx(yp,{className:"h-4 w-4 mr-2"}),"Exportar"]}),o.jsxs("button",{onClick:ee,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500",title:"Exportar reporte de CPUs con RAM y tipo de disco (SSD/HDD)",children:[o.jsx(dx,{className:"h-4 w-4 mr-2"}),"CPUs RAM/Disco"]}),o.jsxs("button",{onClick:z,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[o.jsx(Pc,{className:"h-4 w-4 mr-2"}),"Actualizar"]})]})]})}),h&&o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border mb-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Filtros de Bsqueda"}),o.jsx("button",{onClick:B,className:"text-sm text-indigo-600 hover:text-indigo-500",children:"Limpiar filtros"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nmero de Placa"}),o.jsx("input",{type:"text",value:k.numeroPlaca,onChange:G=>V("numeroPlaca",G.target.value),placeholder:"ECC-CPU-001, ECC'CPU'001...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha Compra (Desde)"}),o.jsx("input",{type:"date",value:k.fechaInicio,onChange:G=>V("fechaInicio",G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha Compra (Hasta)"}),o.jsx("input",{type:"date",value:k.fechaFin,onChange:G=>V("fechaFin",G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nmero de Serie"}),o.jsx("input",{type:"text",value:k.numeroSerie,onChange:G=>V("numeroSerie",G.target.value),placeholder:"Buscar por nmero de serie...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Proveedor"}),o.jsx("input",{type:"text",value:k.proveedor,onChange:G=>V("proveedor",G.target.value),placeholder:"Buscar por proveedor...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Orden de Compra"}),o.jsx("input",{type:"text",value:k.ordenCompra,onChange:G=>V("ordenCompra",G.target.value),placeholder:"Buscar por orden de compra...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ubicacin"}),o.jsxs("select",{value:k.ubicacion,onChange:G=>V("ubicacion",G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[o.jsx("option",{value:"",children:"Todas las ubicaciones"}),o.jsx("option",{value:"Claro",children:"Claro"}),o.jsx("option",{value:"Obama",children:"Obama"}),o.jsx("option",{value:"IT",children:"IT"}),o.jsx("option",{value:"Contratacin",children:"Contratacin"}),o.jsx("option",{value:"Reclutamiento",children:"Reclutamiento"}),o.jsx("option",{value:"Seleccin",children:"Seleccin"}),o.jsx("option",{value:"Finanzas",children:"Finanzas"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clasificacin"}),o.jsxs("select",{value:k.clasificacion,onChange:G=>V("clasificacion",G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[o.jsx("option",{value:"",children:"Todas las clasificaciones"}),o.jsx("option",{value:"Activo productivo",children:"Activo productivo"}),o.jsx("option",{value:"Activo no productivo",children:"Activo no productivo"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Garanta"}),o.jsxs("select",{value:k.garantia,onChange:G=>V("garantia",G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[o.jsx("option",{value:"",children:"Todas"}),o.jsx("option",{value:"Si",children:"Con garanta"}),o.jsx("option",{value:"No",children:"Sin garanta"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Site"}),o.jsxs("select",{value:k.site,onChange:G=>V("site",G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[o.jsx("option",{value:"",children:"Todos los sites"}),o.jsx("option",{value:"Site A",children:"Site A"}),o.jsx("option",{value:"Site B",children:"Site B"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),o.jsxs("select",{value:k.estado,onChange:G=>V("estado",G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[o.jsx("option",{value:"",children:"Todos los estados"}),o.jsx("option",{value:"funcional",children:"Funcional"}),o.jsx("option",{value:"en_reparacion",children:"En reparacin"}),o.jsx("option",{value:"dado_de_baja",children:"Dado de baja"}),o.jsx("option",{value:"en_mantenimiento",children:"En mantenimiento"}),o.jsx("option",{value:"disponible",children:"Disponible"}),o.jsx("option",{value:"asignado",children:"Asignado"}),o.jsx("option",{value:"fuera_de_servicio",children:"Fuera de servicio"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Activo"}),o.jsxs("select",{value:k.tipoActivo,onChange:G=>V("tipoActivo",G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[o.jsx("option",{value:"",children:"Todos los tipos"}),o.jsx("option",{value:"ECC-CPU",children:"Computadoras (ECC-CPU)"}),o.jsx("option",{value:"ECC-SER",children:"Servidores (ECC-SER)"}),o.jsx("option",{value:"ECC-MON",children:"Monitores (ECC-MON)"}),o.jsx("option",{value:"ECC-IMP",children:"Impresoras (ECC-IMP)"}),o.jsx("option",{value:"ECC-POR",children:"Porttiles (ECC-POR)"}),o.jsx("option",{value:"ECC-TV",children:"Televisores (ECC-TV)"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Puesto"}),o.jsx("input",{type:"text",value:k.puesto,onChange:G=>V("puesto",G.target.value),placeholder:"001, 090, 106...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Responsable"}),o.jsx("input",{type:"text",value:k.responsable,onChange:G=>V("responsable",G.target.value),placeholder:"Buscar por responsable...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asignado"}),o.jsx("input",{type:"text",value:k.asignado,onChange:G=>V("asignado",G.target.value),placeholder:"Buscar por asignado...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[o.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(Xo,{className:"h-8 w-8 text-indigo-600 flex-shrink-0"}),o.jsxs("div",{className:"ml-3 min-w-0 flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Mostrado"}),o.jsx("p",{className:"font-bold text-gray-900 text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl overflow-hidden whitespace-nowrap",children:s.length})]})]})}),o.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500 mb-2",children:"Con Garanta"}),o.jsx("p",{className:"font-bold text-gray-900 text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl overflow-hidden whitespace-nowrap",children:s.filter(G=>G.garantia==="Si").length})]})}),o.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:o.jsxs("div",{className:"flex items-start",children:[o.jsx(Xo,{className:"h-8 w-8 text-blue-600 flex-shrink-0"}),o.jsxs("div",{className:"ml-3 min-w-0 flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Productivos"}),o.jsx("p",{className:"text-xl font-bold text-gray-900 break-words",children:s.filter(G=>G.clasificacion==="Activo productivo").length})]})]})}),o.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:o.jsxs("div",{className:"flex items-start",children:[o.jsx(ia,{className:"h-8 w-8 text-orange-600 flex-shrink-0"}),o.jsxs("div",{className:"ml-3 min-w-0 flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Con Fecha Compra"}),o.jsx("p",{className:"text-xl font-bold text-gray-900 break-words",children:s.filter(G=>G.fecha_compra).length})]})]})})]}),c&&o.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:c}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:[o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Activo"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ubicacin"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Responsable"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Asignado"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Puesto"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"N Serie"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Clasificacin"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(G=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:G.numero_placa}),o.jsxs("div",{className:"text-sm text-gray-500",children:["Centro: ",G.centro_costes]})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:G.ubicacion})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:G.responsable}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:G.asignado||"-"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:G.puesto||"-"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:G.numero_social||"-"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${G.clasificacion==="Activo productivo"?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:G.clasificacion})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>I(G),className:"text-green-600 hover:text-green-900",title:"Ver detalles completos",children:o.jsx(Dl,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>P(G),className:"text-blue-600 hover:text-blue-900",title:"Editar activo",children:o.jsx(Sh,{className:"h-4 w-4"})})]})})]},G.id))})]})}),s.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Xo,{className:"mx-auto h-12 w-12 text-gray-400"}),o.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No hay activos"}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r.length===0?"No hay activos registrados en el inventario.":"No se encontraron activos que coincidan con los filtros aplicados."})]})]}),o.jsx(Gq,{isOpen:x,onClose:()=>m(!1),activo:w}),o.jsx(hv,{isOpen:b,onClose:()=>{y(!1),S(null)},activo:w,onSuccess:ae})]})};Lp.register(B6,U6,Lq,C6,I6,M6,D6,S6,E6,Dp,P6);const Kq=()=>{const{user:t,isGestorActivos:e}=Jr(),[r,n]=Q.useState("month"),[s,a]=Q.useState(!1);if(!e)return o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md text-center",children:[o.jsx(Di,{className:"mx-auto h-16 w-16 text-red-500 mb-4"}),o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Acceso Denegado"}),o.jsx("p",{className:"text-gray-600",children:"Solo los gestores de activos pueden acceder a esta seccin."})]})});const i={assetsByLocation:{labels:["Claro","Obama","IT","Contratacin","Reclutamiento","Seleccin","Finanzas"],datasets:[{label:"Activos Productivos",data:[45,38,52,28,31,24,19],backgroundColor:"rgba(34, 197, 94, 0.8)",borderColor:"rgba(34, 197, 94, 1)",borderWidth:2,borderRadius:4},{label:"Activos No Productivos",data:[12,8,15,7,9,6,4],backgroundColor:"rgba(251, 146, 60, 0.8)",borderColor:"rgba(251, 146, 60, 1)",borderWidth:2,borderRadius:4}]},assetsByClassification:{labels:["Activos Productivos","Activos No Productivos"],datasets:[{data:[237,61],backgroundColor:["rgba(34, 197, 94, 0.8)","rgba(251, 146, 60, 0.8)"],borderColor:["rgba(34, 197, 94, 1)","rgba(251, 146, 60, 1)"],borderWidth:2,hoverOffset:4}]},warrantyStatus:{labels:["Con Garanta Vigente","Sin Garanta","Garanta Vencida"],datasets:[{data:[156,98,44],backgroundColor:["rgba(59, 130, 246, 0.8)","rgba(156, 163, 175, 0.8)","rgba(239, 68, 68, 0.8)"],borderColor:["rgba(59, 130, 246, 1)","rgba(156, 163, 175, 1)","rgba(239, 68, 68, 1)"],borderWidth:2,cutout:"60%"}]},acquisitionTrend:{labels:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],datasets:[{label:"Activos Adquiridos",data:[12,8,15,22,18,25,19,32,28,24,16,21],borderColor:"rgba(147, 51, 234, 1)",backgroundColor:"rgba(147, 51, 234, 0.1)",borderWidth:3,fill:!0,tension:.4,pointBackgroundColor:"rgba(147, 51, 234, 1)",pointBorderColor:"#ffffff",pointBorderWidth:2,pointRadius:6,pointHoverRadius:8}]},assetsByProvider:{labels:["HP Inc.","Lenovo","Dell Technologies","Apple","Samsung","Otros"],datasets:[{data:[67,52,43,28,19,89],backgroundColor:["rgba(239, 68, 68, 0.7)","rgba(34, 197, 94, 0.7)","rgba(59, 130, 246, 0.7)","rgba(251, 146, 60, 0.7)","rgba(147, 51, 234, 0.7)","rgba(156, 163, 175, 0.7)"],borderColor:["rgba(239, 68, 68, 1)","rgba(34, 197, 94, 1)","rgba(59, 130, 246, 1)","rgba(251, 146, 60, 1)","rgba(147, 51, 234, 1)","rgba(156, 163, 175, 1)"],borderWidth:2}]}},l={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{usePointStyle:!0,padding:20,font:{size:12,family:"'Inter', sans-serif"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"rgba(255, 255, 255, 0.2)",borderWidth:1,cornerRadius:8,displayColors:!0}}},c={...l,scales:{x:{grid:{display:!1},ticks:{font:{size:11}}},y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.05)"},ticks:{font:{size:11}}}}},d={...l,scales:{x:{grid:{color:"rgba(0, 0, 0, 0.05)"}},y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.05)"}}}},h=async()=>{a(!0),setTimeout(()=>{a(!1)},1e3)},p=()=>{alert("Funcionalidad de exportacin en desarrollo")},x=[{title:"Total de Activos",value:"298",icon:Xo,color:"blue",change:"+12%",changeType:"increase"},{title:"Valor Total",value:"$2.4M",icon:Wh,color:"green",change:"+8%",changeType:"increase"},{title:"Con Garanta",value:"156",icon:Yd,color:"purple",change:"-3%",changeType:"decrease"},{title:"Ubicaciones",value:"7",icon:_0,color:"orange",change:"0%",changeType:"neutral"}];return o.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[o.jsx("div",{className:"mb-6",children:o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Anlisis de Activos"}),o.jsx("p",{className:"text-gray-600",children:"Visualizacin y anlisis estadstico del inventario de activos"})]}),o.jsxs("div",{className:"flex flex-wrap gap-3",children:[o.jsxs("select",{value:r,onChange:m=>n(m.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white",children:[o.jsx("option",{value:"week",children:"Esta Semana"}),o.jsx("option",{value:"month",children:"Este Mes"}),o.jsx("option",{value:"quarter",children:"Este Trimestre"}),o.jsx("option",{value:"year",children:"Este Ao"})]}),o.jsxs("button",{onClick:h,disabled:s,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:opacity-50",children:[o.jsx(Pc,{className:`h-4 w-4 mr-2 ${s?"animate-spin":""}`}),"Actualizar"]}),o.jsxs("button",{onClick:p,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[o.jsx(yp,{className:"h-4 w-4 mr-2"}),"Exportar"]})]})]})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:x.map((m,b)=>{const y=m.icon;return o.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:`p-2 rounded-lg bg-${m.color}-100 flex-shrink-0`,children:o.jsx(y,{className:`h-6 w-6 text-${m.color}-600`})}),o.jsxs("div",{className:"ml-4 min-w-0 flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:m.title}),o.jsx("p",{className:"font-bold text-gray-900 text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl overflow-hidden whitespace-nowrap",children:m.value})]})]}),o.jsx("div",{className:`text-sm font-medium ${m.changeType==="increase"?"text-green-600":m.changeType==="decrease"?"text-red-600":"text-gray-600"}`,children:m.change})]})},b)})}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(vp,{className:"h-5 w-5 text-indigo-600 mr-2"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Activos por Ubicacin"})]}),o.jsx(qd,{className:"h-5 w-5 text-gray-400"})]}),o.jsx("div",{className:"h-80",children:o.jsx(fv,{data:i.assetsByLocation,options:c})})]}),o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(b3,{className:"h-5 w-5 text-green-600 mr-2"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Distribucin por Clasificacin"})]})}),o.jsx("div",{className:"h-80",children:o.jsx(G6,{data:i.assetsByClassification,options:l})})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(Yd,{className:"h-5 w-5 text-blue-600 mr-2"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Estado de Garantas"})]})}),o.jsx("div",{className:"h-64",children:o.jsx(q6,{data:i.warrantyStatus,options:l})})]}),o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(_0,{className:"h-5 w-5 text-purple-600 mr-2"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Por Proveedor"})]})}),o.jsx("div",{className:"h-64",children:o.jsx(zq,{data:i.assetsByProvider,options:l})})]}),o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(ia,{className:"h-5 w-5 text-orange-600 mr-2"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Resumen del Perodo"})]})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Activos Nuevos"}),o.jsx("span",{className:"text-sm font-semibold text-green-600",children:"+24"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Garantas Vencidas"}),o.jsx("span",{className:"text-sm font-semibold text-red-600",children:"8"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Valor Promedio"}),o.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"$8,053"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Depreciacin"}),o.jsx("span",{className:"text-sm font-semibold text-orange-600",children:"-2.4%"})]}),o.jsx("div",{className:"pt-2 border-t border-gray-200",children:o.jsxs("div",{className:"flex justify-between items-center gap-2",children:[o.jsx("span",{className:"text-sm font-medium text-gray-900 flex-shrink-0",children:"Valor Total Actual"}),o.jsx("span",{className:"font-bold text-indigo-600 text-xs sm:text-sm md:text-base lg:text-lg overflow-hidden whitespace-nowrap",children:"$2,399,784"})]})})]})]})]}),o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Wh,{className:"h-5 w-5 text-purple-600 mr-2"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Tendencia de Adquisiciones"})]}),o.jsx("div",{className:"text-sm text-gray-500",children:"Datos del ao actual"})]}),o.jsx("div",{className:"h-80",children:o.jsx(V6,{data:i.acquisitionTrend,options:d})})]})]})},Jq="http://31.97.138.23:5001/api",Qq=()=>{const[t,e]=Q.useState(""),[r,n]=Q.useState(""),[s,a]=Q.useState(!1),[i,l]=Q.useState(null),[c,d]=Q.useState(""),[h,p]=Q.useState("preview"),x=async y=>{if(y.preventDefault(),!t.trim()){d("Por favor, pega el contenido del script");return}if(!r.trim()){d("Por favor, ingresa el consecutivo del equipo");return}a(!0),d(""),l(null);try{const w=await Ar.post(`${Jq}/script-parser/parse`,{scriptText:t,mode:h,equipmentId:r});l(w.data),h==="create"&&w.data.success&&(e(""),n(""))}catch(w){console.error("Error al procesar script:",w),d(w.response?.data?.message||"Error al procesar el script")}finally{a(!1)}},m=()=>{e(""),n(""),l(null),d("")},b=()=>{i&&(navigator.clipboard.writeText(JSON.stringify(i,null,2)),alert("Resultado copiado al portapapeles"))};return o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx("div",{className:"bg-white shadow-sm border-b",children:o.jsx("div",{className:"max-w-6xl mx-auto px-6 py-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(qn,{className:"h-8 w-8 text-indigo-600 mr-3"}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Crear Activo desde Script"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Pega el output completo del script de resumen del equipo y se crear automticamente el activo"})]})]})})}),o.jsx("div",{className:"max-w-6xl mx-auto p-6",children:o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:o.jsxs("form",{onSubmit:x,children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[o.jsx(qn,{className:"inline h-4 w-4 mr-1"}),"Consecutivo del Equipo *"]}),o.jsx("input",{type:"text",value:r,onChange:y=>n(y.target.value),placeholder:"ECC-CPU-00119",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ejemplo: ECC-CPU-00119, ECC'CPU'00120, etc."})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contenido del Script *"}),o.jsx("textarea",{value:t,onChange:y=>e(y.target.value),placeholder:"Pega aqu todo el output del script de resumen del equipo...",rows:15,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 font-mono text-sm",required:!0}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Pega todo el texto que comienza con "RESUMEN DEL EQUIPO" hasta "FIN DEL RESUMEN"'})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Modo"}),o.jsxs("div",{className:"flex space-x-4",children:[o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"radio",value:"preview",checked:h==="preview",onChange:y=>p(y.target.value),className:"mr-2"}),o.jsx(Dl,{className:"h-4 w-4 mr-1"}),"Preview (solo ver)"]}),o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"radio",value:"create",checked:h==="create",onChange:y=>p(y.target.value),className:"mr-2"}),o.jsx(Ws,{className:"h-4 w-4 mr-1"}),"Crear Activo"]})]})]}),c&&o.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:o.jsxs("div",{className:"flex",children:[o.jsx(Cc,{className:"h-5 w-5 text-red-400 mr-2 flex-shrink-0 mt-0.5"}),o.jsx("span",{className:"text-red-700 text-sm",children:c})]})}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx("button",{type:"submit",disabled:s,className:`flex-1 flex items-center justify-center px-4 py-2 rounded-lg font-medium ${h==="create"?"bg-green-600 hover:bg-green-700 text-white":"bg-blue-600 hover:bg-blue-700 text-white"} disabled:opacity-50 disabled:cursor-not-allowed`,children:s?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Procesando..."]}):o.jsxs(o.Fragment,{children:[o.jsx(_3,{className:"h-4 w-4 mr-2"}),h==="create"?"Crear Activo":"Vista Previa"]})}),o.jsxs("button",{type:"button",onClick:m,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 flex items-center",children:[o.jsx(Kx,{className:"h-4 w-4 mr-2"}),"Limpiar"]})]})]})}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Resultado"}),i&&o.jsxs("button",{onClick:b,className:"text-sm text-blue-600 hover:text-blue-800 flex items-center",children:[o.jsx(_C,{className:"h-4 w-4 mr-1"}),"Copiar"]})]}),i?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:`p-3 rounded-lg flex items-center ${i.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[i.success?o.jsx(Ws,{className:"h-5 w-5 text-green-500 mr-2"}):o.jsx(Cc,{className:"h-5 w-5 text-red-500 mr-2"}),o.jsx("span",{className:`font-medium ${i.success?"text-green-800":"text-red-800"}`,children:i.message})]}),i.success&&i.datos_extraidos&&o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Datos Extrados:"}),o.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-sm space-y-1",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Placa:"})," ",i.datos_extraidos.numero_placa]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Marca/Modelo:"})," ",i.datos_extraidos.marca_modelo]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Serie:"})," ",i.datos_extraidos.numero_serie_fabricante]}),o.jsxs("div",{children:[o.jsx("strong",{children:"CPU:"})," ",i.datos_extraidos.cpu_procesador]}),o.jsxs("div",{children:[o.jsx("strong",{children:"RAM:"})," ",i.datos_extraidos.memoria_ram]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Disco:"})," ",i.datos_extraidos.almacenamiento]}),o.jsxs("div",{children:[o.jsx("strong",{children:"SO:"})," ",i.datos_extraidos.sistema_operativo]})]})]}),i.success&&i.activo&&o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-green-800 mb-2",children:" Activo Creado Exitosamente:"}),o.jsxs("div",{className:"bg-green-50 p-3 rounded-lg text-sm",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"ID del Activo:"})," ",i.activo.id]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Nmero de Placa:"})," ",i.activo.numero_placa]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Valor:"})," $",new Intl.NumberFormat("es-CO").format(i.activo.valor)]})]})]}),o.jsxs("details",{className:"border border-gray-200 rounded-lg",children:[o.jsx("summary",{className:"px-3 py-2 cursor-pointer text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Ver JSON Completo"}),o.jsx("pre",{className:"p-3 bg-gray-900 text-green-400 text-xs overflow-auto max-h-64",children:JSON.stringify(i,null,2)})]})]}):o.jsxs("div",{className:"text-center py-12",children:[o.jsx(qn,{className:"mx-auto h-12 w-12 text-gray-400"}),o.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"El resultado aparecer aqu despus de procesar el script"})]})]})]})})]})},Zq=()=>{const[t,e]=Q.useState(!1),{user:r,logout:n}=Jr(),s=Jo(),a=Oi(),i=()=>{n(),a("/login")},l=[{name:"Editar Componentes",href:"/inventario-tecnico",icon:Nh,current:s.pathname==="/inventario-tecnico"}];return o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsxs("div",{className:`fixed inset-0 flex z-40 md:hidden ${t?"block":"hidden"}`,children:[o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>e(!1)}),o.jsxs("div",{className:"relative flex-1 flex flex-col max-w-xs w-full pt-5 pb-4 bg-white",children:[o.jsx("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:o.jsx("button",{type:"button",className:"ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:()=>e(!1),children:o.jsx(gs,{className:"h-6 w-6 text-white"})})}),o.jsxs("div",{className:"flex-shrink-0 flex items-center px-4",children:[o.jsx(u0,{className:"h-8 w-8 text-emerald-600"}),o.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"Tcnico Inventario"})]}),o.jsx("div",{className:"mt-5 flex-1 h-0 overflow-y-auto",children:o.jsx("nav",{className:"px-2 space-y-1",children:l.map(c=>o.jsxs(zh,{to:c.href,className:`${c.current?"bg-emerald-100 text-emerald-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"} group flex items-center px-2 py-2 text-base font-medium rounded-md`,onClick:()=>e(!1),children:[o.jsx(c.icon,{className:`${c.current?"text-emerald-500":"text-gray-400 group-hover:text-gray-500"} mr-4 flex-shrink-0 h-6 w-6`}),c.name]},c.name))})})]})]}),o.jsx("div",{className:"hidden md:flex md:w-64 md:flex-col md:fixed md:inset-y-0",children:o.jsxs("div",{className:"flex flex-col flex-grow pt-5 bg-white overflow-y-auto border-r border-gray-200",children:[o.jsxs("div",{className:"flex items-center flex-shrink-0 px-4",children:[o.jsx(u0,{className:"h-8 w-8 text-emerald-600"}),o.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"Tcnico Inventario"})]}),o.jsx("div",{className:"mt-5 flex-grow flex flex-col",children:o.jsx("nav",{className:"flex-1 px-2 pb-4 space-y-1",children:l.map(c=>o.jsxs(zh,{to:c.href,className:`${c.current?"bg-emerald-100 text-emerald-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"} group flex items-center px-2 py-2 text-sm font-medium rounded-md`,children:[o.jsx(c.icon,{className:`${c.current?"text-emerald-500":"text-gray-400 group-hover:text-gray-500"} mr-3 flex-shrink-0 h-6 w-6`}),c.name]},c.name))})}),o.jsx("div",{className:"px-4 pb-4",children:o.jsxs("div",{className:"bg-emerald-50 rounded-lg p-4",children:[o.jsx("h4",{className:"text-sm font-medium text-emerald-800 mb-2",children:"Permisos"}),o.jsxs("ul",{className:"text-xs text-emerald-700 space-y-1",children:[o.jsx("li",{children:" Editar componentes de hardware"}),o.jsx("li",{children:" CPU, Porttiles y Servidores"}),o.jsx("li",{children:" Procesador, RAM, Disco, SO"})]})]})})]})}),o.jsxs("div",{className:"md:pl-64 flex flex-col flex-1",children:[o.jsxs("div",{className:"sticky top-0 z-10 flex-shrink-0 flex h-16 bg-white shadow",children:[o.jsx("button",{type:"button",className:"px-4 border-r border-gray-200 text-gray-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-emerald-500 md:hidden",onClick:()=>e(!0),children:o.jsx(Nv,{className:"h-6 w-6"})}),o.jsxs("div",{className:"flex-1 px-4 flex justify-between",children:[o.jsx("div",{className:"flex-1 flex items-center",children:o.jsx("h1",{className:"text-lg font-semibold text-gray-700",children:"Panel de Edicin de Componentes"})}),o.jsx("div",{className:"ml-4 flex items-center md:ml-6",children:o.jsx("div",{className:"relative",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Bn,{className:"h-8 w-8 text-gray-400"}),o.jsxs("div",{className:"ml-3",children:[o.jsx("div",{className:"text-sm font-medium text-gray-700",children:r?.full_name||r?.fullName}),o.jsx("div",{className:"text-xs text-emerald-600",children:"Tcnico de Inventario"})]})]}),o.jsxs("button",{onClick:i,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-gray-500 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500",children:[o.jsx(Yx,{className:"h-4 w-4 mr-2"}),"Cerrar Sesin"]})]})})})]})]}),o.jsx("main",{className:"flex-1",children:o.jsx(Ux,{})})]})]})},d2="http://31.97.138.23:5001/api",eG=()=>{const[t,e]=Q.useState([]),[r,n]=Q.useState(!0),[s,a]=Q.useState(""),[i,l]=Q.useState(null),[c,d]=Q.useState([]),[h,p]=Q.useState(null),[x,m]=Q.useState(""),[b,y]=Q.useState(!1),[w,S]=Q.useState({type:"",text:""}),[k,A]=Q.useState(!1),[z,H]=Q.useState(null),V=async(M="")=>{try{n(!0);const te=M?`?numero_placa=${encodeURIComponent(M)}`:"",ie=await Ar.get(`${d2}/activos-tecnico${te}`);e(ie.data.data||[])}catch(te){console.error("Error al cargar activos:",te),S({type:"error",text:"Error al cargar los activos"})}finally{n(!1)}},B=async M=>{try{const te=await Ar.get(`${d2}/activos-tecnico/${M}/componentes`);l(te.data.activo),d(te.data.componentes)}catch(te){console.error("Error al cargar componentes:",te),S({type:"error",text:"Error al cargar los componentes del activo"})}};Q.useEffect(()=>{V()},[]),Q.useEffect(()=>{const M=setTimeout(()=>{V(s)},300);return()=>clearTimeout(M)},[s]);const R=M=>{switch(M){case"ECC-CPU":return o.jsx(Fn,{className:"h-5 w-5 text-blue-500"});case"ECC-POR":return o.jsx(kC,{className:"h-5 w-5 text-purple-500"});case"ECC-SER":return o.jsx(PC,{className:"h-5 w-5 text-orange-500"});default:return o.jsx(u0,{className:"h-5 w-5 text-gray-500"})}},O=M=>({"ECC-CPU":"Computadora","ECC-POR":"Porttil","ECC-SER":"Servidor"})[M]||M,ee=M=>{switch(M){case"cpu_procesador":return o.jsx(u0,{className:"h-4 w-4"});case"memoria_ram":case"almacenamiento":return o.jsx(dx,{className:"h-4 w-4"});case"sistema_operativo":return o.jsx(Fn,{className:"h-4 w-4"});default:return o.jsx(Nh,{className:"h-4 w-4"})}},I=(M,te)=>{p(M),m(te||""),S({type:"",text:""})},P=()=>{p(null),m("")},ae=()=>{if(!x.trim()){S({type:"error",text:"El valor no puede estar vaco"});return}const M=c.find(te=>te.campo===h);if(M&&M.valorActual===x.trim()){S({type:"error",text:"El nuevo valor es igual al actual"});return}H({campo:h,label:M?.label||h,valorAnterior:M?.valorActual,valorNuevo:x.trim()}),A(!0)},G=async()=>{if(z)try{y(!0);const M=await Ar.put(`${d2}/activos-tecnico/${i.id}/componente`,{campo:z.campo,nuevoValor:z.valorNuevo});S({type:"success",text:M.data.msg}),d(te=>te.map(ie=>ie.campo===z.campo?{...ie,valorActual:z.valorNuevo}:ie)),e(te=>te.map(ie=>ie.id===i.id?{...ie,[z.campo]:z.valorNuevo}:ie)),P()}catch(M){console.error("Error al guardar:",M),S({type:"error",text:M.response?.data?.msg||"Error al guardar el cambio"})}finally{y(!1),A(!1),H(null)}};return o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Edicin de Componentes de Hardware"}),o.jsx("p",{className:"text-gray-600",children:"Busque activos por nmero de placa y edite sus componentes"})]}),w.text&&o.jsxs("div",{className:`mb-4 p-4 rounded-lg flex items-center ${w.type==="error"?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:[w.type==="error"?o.jsx(Di,{className:"h-5 w-5 mr-2"}):o.jsx(Ws,{className:"h-5 w-5 mr-2"}),w.text,o.jsx("button",{onClick:()=>S({type:"",text:""}),className:"ml-auto",children:o.jsx(gs,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Buscar Activo"}),o.jsxs("div",{className:"relative mb-4",children:[o.jsx(Lc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Buscar por nmero de placa (ej: ECC-CPU-001)",value:s,onChange:M=>a(M.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),o.jsxs("button",{onClick:()=>V(s),className:"mb-4 flex items-center text-sm text-emerald-600 hover:text-emerald-700",children:[o.jsx(Pc,{className:"h-4 w-4 mr-1"}),"Refrescar lista"]}),o.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:r?o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600 mx-auto"}),o.jsx("p",{className:"mt-2 text-gray-500",children:"Cargando activos..."})]}):t.length===0?o.jsxs("div",{className:"text-center py-8 text-gray-500",children:[o.jsx(u0,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),o.jsx("p",{children:"No se encontraron activos"}),o.jsx("p",{className:"text-sm",children:"Solo se muestran CPU, Porttiles y Servidores"})]}):t.map(M=>o.jsx("button",{onClick:()=>B(M.id),className:`w-full text-left p-3 rounded-lg border transition-colors ${i?.id===M.id?"border-emerald-500 bg-emerald-50":"border-gray-200 hover:border-emerald-300 hover:bg-gray-50"}`,children:o.jsxs("div",{className:"flex items-center",children:[R(M.tipo_activo),o.jsxs("div",{className:"ml-3 flex-1",children:[o.jsx("div",{className:"font-medium text-gray-900",children:M.numero_placa}),o.jsxs("div",{className:"text-sm text-gray-500",children:[O(M.tipo_activo),"  ",M.ubicacion]})]})]})},M.id))})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Componentes"}),i?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[o.jsxs("div",{className:"flex items-center mb-2",children:[R(i.tipo_activo),o.jsx("span",{className:"ml-2 font-semibold text-gray-900",children:i.numero_placa})]}),o.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Tipo:"})," ",O(i.tipo_activo)]}),i.marca_modelo&&o.jsxs("p",{children:[o.jsx("strong",{children:"Marca/Modelo:"})," ",i.marca_modelo]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Ubicacin:"})," ",i.ubicacion]}),i.site&&o.jsxs("p",{children:[o.jsx("strong",{children:"Site:"})," ",i.site]}),i.asignado&&o.jsxs("p",{children:[o.jsx("strong",{children:"Asignado a:"})," ",i.asignado]})]})]}),o.jsx("div",{className:"space-y-3",children:c.map(M=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center text-gray-700",children:[ee(M.campo),o.jsx("span",{className:"ml-2 font-medium",children:M.label})]}),h!==M.campo&&o.jsxs("button",{onClick:()=>I(M.campo,M.valorActual),className:"text-emerald-600 hover:text-emerald-700 text-sm flex items-center",children:[o.jsx(Nh,{className:"h-4 w-4 mr-1"}),"Editar"]})]}),h===M.campo?o.jsxs("div",{className:"space-y-2",children:[o.jsx("input",{type:"text",value:x,onChange:te=>m(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:`Nuevo valor para ${M.label}`,autoFocus:!0}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs("button",{onClick:ae,disabled:b,className:"flex-1 flex items-center justify-center px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50",children:[o.jsx(bp,{className:"h-4 w-4 mr-2"}),"Guardar"]}),o.jsx("button",{onClick:P,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancelar"})]})]}):o.jsx("p",{className:`${M.valorActual?"text-gray-900":"text-gray-400 italic"}`,children:M.valorActual||"No especificado"})]},M.campo))})]}):o.jsxs("div",{className:"text-center py-12 text-gray-500",children:[o.jsx(Nh,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),o.jsx("p",{children:"Seleccione un activo para editar sus componentes"})]})]})]}),k&&z&&o.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Confirmar Cambio"}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[o.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[o.jsx("strong",{children:"Campo:"})," ",z.label]}),o.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[o.jsx("strong",{children:"Valor anterior:"})," ",o.jsx("span",{className:"text-red-600",children:z.valorAnterior||"Sin valor"})]}),o.jsxs("p",{className:"text-sm text-gray-600",children:[o.jsx("strong",{children:"Nuevo valor:"})," ",o.jsx("span",{className:"text-green-600",children:z.valorNuevo})]})]}),o.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Este cambio quedar registrado en el historial del activo."}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx("button",{onClick:G,disabled:b,className:"flex-1 flex items-center justify-center px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50",children:b?o.jsxs(o.Fragment,{children:[o.jsx(Pc,{className:"h-4 w-4 mr-2 animate-spin"}),"Guardando..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Ws,{className:"h-4 w-4 mr-2"}),"Confirmar"]})}),o.jsx("button",{onClick:()=>{A(!1),H(null)},disabled:b,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Cancelar"})]})]})})]})},tG=({children:t})=>{const{user:e}=Jr();return e?.role==="anonimo"?o.jsx(H3,{children:t}):e?.role==="gestorActivos"?o.jsx(Wq,{children:t}):e?.role==="tecnicoInventario"?o.jsx(Zq,{children:t}):o.jsx(I8,{children:t})},rG=({children:t})=>{const{user:e,loading:r}=Jr();return r?o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e?.role==="anonimo"?t:o.jsx(Wo,{to:"/dashboard",replace:!0})},T4=()=>{const{user:t,loading:e}=Jr();return console.log("RedirectByRole - user:",t,"loading:",e),e?o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):t?.role==="anonimo"?o.jsx(Wo,{to:"/chat",replace:!0}):t?.role==="gestorActivos"?o.jsx(Wo,{to:"/activos",replace:!0}):t?.role==="tecnicoInventario"?o.jsx(Wo,{to:"/inventario-tecnico",replace:!0}):o.jsx(Wo,{to:"/dashboard",replace:!0})},nG=()=>{const{user:t,loading:e}=Jr();return console.log("DashboardRoute - user:",t,"loading:",e),e?o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):t?.role==="anonimo"?o.jsx(Wo,{to:"/chat",replace:!0}):t?.role==="gestorActivos"?o.jsx(Wo,{to:"/activos",replace:!0}):t?.role==="tecnicoInventario"?o.jsx(Wo,{to:"/inventario-tecnico",replace:!0}):o.jsx(K8,{})},Pu=({children:t})=>{const{user:e,loading:r}=Jr();return r?o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e?.role==="anonimo"?o.jsx(Wo,{to:"/chat",replace:!0}):t},F4=({children:t})=>{const{isAuthenticated:e,loading:r}=Jr();return r?o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e?t:o.jsx(Wo,{to:"/login",replace:!0})},f2=({children:t})=>{const{isAdmin:e,loading:r}=Jr();return r?o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e?t:o.jsxs("div",{className:"text-center py-12",children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Acceso Denegado"}),o.jsx("p",{className:"text-gray-600",children:"Solo los administradores pueden acceder a esta seccin."})]})},h2=({children:t})=>{const{isGestorActivos:e,loading:r}=Jr();return r?o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e?t:o.jsxs("div",{className:"text-center py-12",children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Acceso Denegado"}),o.jsx("p",{className:"text-gray-600",children:"Solo los gestores de activos pueden acceder a esta seccin."})]})},sG=({children:t})=>{const{isTecnicoInventario:e,loading:r}=Jr();return r?o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e?t:o.jsxs("div",{className:"text-center py-12",children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Acceso Denegado"}),o.jsx("p",{className:"text-gray-600",children:"Solo los tcnicos de inventario pueden acceder a esta seccin."})]})};function aG(){return o.jsx(gC,{children:o.jsx(OE,{children:o.jsx("div",{className:"min-h-screen bg-gray-50",children:o.jsxs(TE,{children:[o.jsx(Vn,{path:"/login",element:o.jsx(IC,{})}),o.jsx(Vn,{path:"/activos/script-parser",element:o.jsx(Qq,{})}),o.jsx(Vn,{path:"/chat",element:o.jsx(F4,{children:o.jsx(rG,{children:o.jsx(H3,{children:o.jsx(O8,{})})})})}),o.jsxs(Vn,{path:"/",element:o.jsx(F4,{children:o.jsx(tG,{})}),children:[o.jsx(Vn,{index:!0,element:o.jsx(T4,{})}),o.jsx(Vn,{path:"dashboard",element:o.jsx(nG,{})}),o.jsx(Vn,{path:"incidents/create",element:o.jsx(Pu,{children:o.jsx(J8,{})})}),o.jsx(Vn,{path:"incidents/pending",element:o.jsx(Pu,{children:o.jsx(Z8,{})})}),o.jsx(Vn,{path:"incidents/my-incidents",element:o.jsx(Pu,{children:o.jsx(eT,{})})}),o.jsx(Vn,{path:"incidents/supervision",element:o.jsx(Pu,{children:o.jsx(Q8,{})})}),o.jsx(Vn,{path:"incidents/my-supervision",element:o.jsx(Pu,{children:o.jsx(Mz,{})})}),o.jsx(Vn,{path:"incidents/my-reports",element:o.jsx(Pu,{children:o.jsx(Bz,{})})}),o.jsx(Vn,{path:"incidents/approved",element:o.jsx(Pu,{children:o.jsx(Iz,{})})}),o.jsx(Vn,{path:"incidents/returned",element:o.jsx(Pu,{children:o.jsx(Oz,{})})}),o.jsx(Vn,{path:"users",element:o.jsx(f2,{children:o.jsx(Uz,{})})}),o.jsx(Vn,{path:"workstations",element:o.jsx(f2,{children:o.jsx(zz,{})})}),o.jsx(Vn,{path:"analytics",element:o.jsx(f2,{children:o.jsx(Hq,{})})}),o.jsx(Vn,{path:"activos",element:o.jsx(h2,{children:o.jsx($q,{})})}),o.jsx(Vn,{path:"activos/inventario",element:o.jsx(h2,{children:o.jsx(Yq,{})})}),o.jsx(Vn,{path:"activos/charts",element:o.jsx(h2,{children:o.jsx(Kq,{})})}),o.jsx(Vn,{path:"inventario-tecnico",element:o.jsx(sG,{children:o.jsx(eG,{})})})]}),o.jsx(Vn,{path:"*",element:o.jsx(T4,{})})]})})})})}Oj.createRoot(document.getElementById("root")).render(o.jsx(Q.StrictMode,{children:o.jsx(aG,{})}));export{dn as _,iG as c,Ej as g};
